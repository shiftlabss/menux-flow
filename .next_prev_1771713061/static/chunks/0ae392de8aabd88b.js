(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,60289,51804,85396,e=>{"use strict";var t=e.i(75254);let a=(0,t.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);e.s(["LayoutDashboard",()=>a],60289);let s=(0,t.default)("calendar-check",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);e.s(["CalendarCheck",()=>s],51804);let n=(0,t.default)("kanban",[["path",{d:"M5 3v14",key:"9nsxs2"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"M19 3v18",key:"1sk56x"}]]);e.s(["Kanban",()=>n],85396)},80663,e=>{"use strict";let t={master:{canAccessIntelligence:!0,canBriefingAllCards:!0,canBriefingOwnCards:!0,canViewAllFunnel:!0,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!0,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!0},admin:{canAccessIntelligence:!0,canBriefingAllCards:!0,canBriefingOwnCards:!0,canViewAllFunnel:!0,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!0},comercial:{canAccessIntelligence:!0,canBriefingAllCards:!1,canBriefingOwnCards:!0,canViewAllFunnel:!1,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!1},cs:{canAccessIntelligence:!0,canBriefingAllCards:!1,canBriefingOwnCards:!0,canViewAllFunnel:!1,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!1},leitura:{canAccessIntelligence:!1,canBriefingAllCards:!1,canBriefingOwnCards:!1,canViewAllFunnel:!1,canViewOwnFunnel:!1,canGhostwrite:!1,canUseObjectionsAndPitch:!1,canQueryMenuxBase:!1,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!1,canSelectAllClientsInPicker:!1}};function a(e){let a=t[e];return a?.canAccessIntelligence??!1}e.s(["canAccessIntelligence",()=>a])},44787,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),n=e.i(45060),i=e.i(68834),r=e.i(79473);let l=(0,i.create)()((0,r.persist)(e=>({isExpanded:!0,toggle:()=>e(e=>({isExpanded:!e.isExpanded})),setExpanded:t=>e({isExpanded:t})}),{name:"flow-sidebar"}));var o=e.i(22016),c=e.i(57688),d=e.i(60289),m=e.i(51804),u=e.i(85396),x=e.i(61911),h=e.i(12426),p=e.i(39616),g=e.i(73375),b=e.i(63059),f=e.i(20278),v=e.i(83086),j=e.i(46932),y=e.i(88653),N=e.i(19455),w=e.i(46798),S=e.i(82943),C=e.i(80663);let z=[{label:"Dashboard",href:"/dashboard",icon:d.LayoutDashboard},{label:"Atividades",href:"/activities",icon:m.CalendarCheck,badge:3},{label:"Pipes",href:"/pipes",icon:u.Kanban},{label:"Clientes",href:"/clients",icon:x.Users},{label:"Financeiro",href:"/finance",icon:h.DollarSign,permission:"canViewFinance"},{label:"Metas",href:"/goals",icon:f.Target,permission:"canManageGoals"},{label:"Configurações",href:"/settings/general",icon:p.Settings,permission:"canManageSettings"}];function k(){let e=(0,s.usePathname)(),{isExpanded:i,toggle:r}=l(),{permissions:d,user:m}=(0,S.useAuthStore)(),u=function(e){let[t,s]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let t=window.matchMedia(e);function n(e){(0,a.startTransition)(()=>{s(e.matches)})}return(0,a.startTransition)(()=>{s(t.matches)}),t.addEventListener("change",n),()=>t.removeEventListener("change",n)},[e]),t}("(min-width: 768px)"),[x,h]=(0,a.useState)(!1),p=!!m?.role&&(0,C.canAccessIntelligence)(m.role);(0,a.useEffect)(()=>{(0,a.startTransition)(()=>{h(!1)})},[e]),(0,a.useEffect)(()=>{},[u]);let f=z.filter(e=>!e.permission||!!d&&d[e.permission]),k=!u||i;return(0,a.useEffect)(()=>{if(!u)return l.subscribe((e,t)=>{e.isExpanded!==t.isExpanded&&h(e=>!e)})},[u]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.AnimatePresence,{children:!u&&x&&(0,t.jsx)(j.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 top-16 z-40 bg-black/30 backdrop-blur-sm",onClick:()=>h(!1)})}),(0,t.jsxs)("aside",{className:(0,n.cn)("fixed left-0 top-0 z-40 flex h-screen flex-col border-r border-zinc-200/70 bg-white/90 backdrop-blur-xl transition-[width,transform] duration-200 ease-[cubic-bezier(0.4,0,0.2,1)]",u?i?"w-60":"w-16":"w-60",!u&&!x&&"-translate-x-full"),children:[(0,t.jsx)("div",{className:"border-b border-zinc-200/80 p-3",children:(0,t.jsx)(o.default,{href:"/dashboard",onClick:()=>{u||h(!1)},className:(0,n.cn)("premium-shine flex h-11 items-center justify-center rounded-[14px] px-0 transition-colors","hover:bg-zinc-100/80"),children:(0,t.jsx)(y.AnimatePresence,{mode:"wait",children:k?(0,t.jsx)(j.motion.div,{initial:{opacity:0,x:-6},animate:{opacity:1,x:0},exit:{opacity:0,x:-6},transition:{duration:.14},children:(0,t.jsx)(c.default,{src:"/flow-logo.svg",alt:"Flow by Menux",width:84,height:22,priority:!0,className:"h-[22px] w-auto"})},"expanded-logo"):(0,t.jsx)(j.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.14},className:"flex h-8 w-8 items-center justify-center rounded-full bg-brand/10 font-heading text-base font-semibold text-brand-strong",children:"F"},"collapsed-logo")})})}),(0,t.jsx)("nav",{className:"flex flex-1 flex-col gap-1 p-3",children:f.map(a=>{let s=e===a.href||e.startsWith(a.href+"/"),i=a.icon,r=a.badge&&a.badge>0,l=(0,t.jsxs)(o.default,{href:a.href,onClick:()=>{u||h(!1)},className:(0,n.cn)("premium-shine flex items-center gap-3 rounded-[15px] px-3 py-2.5 text-sm font-medium transition-colors duration-100",s?"bg-brand/10 text-brand-strong ring-1 ring-brand/15":"text-zinc-600 hover:bg-zinc-100/80 hover:text-black"),children:[(0,t.jsxs)("div",{className:"relative shrink-0",children:[(0,t.jsx)(i,{className:"h-5 w-5"}),r&&!k&&(0,t.jsx)("span",{className:"absolute -right-1.5 -top-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-status-danger text-[10px] font-bold text-white",children:a.badge})]}),(0,t.jsx)(y.AnimatePresence,{children:k&&(0,t.jsx)(j.motion.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"overflow-hidden whitespace-nowrap font-body",children:a.label})}),r&&k&&(0,t.jsx)("span",{className:"ml-auto flex h-5 w-5 items-center justify-center rounded-full bg-status-danger text-[10px] font-bold text-white",children:a.badge})]});return k?(0,t.jsx)("div",{children:l},a.href):(0,t.jsxs)(w.Tooltip,{children:[(0,t.jsx)(w.TooltipTrigger,{asChild:!0,children:l}),(0,t.jsx)(w.TooltipContent,{side:"right",children:(0,t.jsx)("p",{children:a.label})})]},a.href)})}),p&&(0,t.jsx)("div",{className:"px-3 pb-3",children:(0,t.jsxs)(w.Tooltip,{children:[(0,t.jsx)(w.TooltipTrigger,{asChild:!0,children:(0,t.jsxs)(o.default,{href:"/intelligence",className:(0,n.cn)("premium-shine group flex items-center gap-3 rounded-[15px] px-3 py-2.5 text-sm font-medium transition-all duration-200","/intelligence"===e?"menux-intelligence-btn text-slate-100":"menux-intelligence-btn-soft"),onClick:()=>{u||h(!1)},children:[(0,t.jsxs)("div",{className:"relative shrink-0",children:[(0,t.jsx)(v.Sparkles,{className:(0,n.cn)("h-5 w-5 transition-transform duration-300","/intelligence"===e?"text-cyan-100":"text-cyan-200","group-hover:scale-110")}),"/intelligence"===e&&(0,t.jsx)("span",{className:"absolute inset-0 animate-ping rounded-full bg-white opacity-30"})]}),(0,t.jsx)(y.AnimatePresence,{children:k&&(0,t.jsx)(j.motion.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"overflow-hidden whitespace-nowrap font-heading font-semibold",children:"Menux Intelligence"})})]})}),(0,t.jsx)(w.TooltipContent,{side:"right",children:(0,t.jsx)("p",{children:"Menux Intelligence"})})]})}),u&&(0,t.jsx)("div",{className:"border-t border-zinc-200 p-3",children:(0,t.jsx)(N.Button,{variant:"ghost",size:"icon",onClick:r,className:(0,n.cn)("h-9 w-9 rounded-full text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700",i&&"ml-auto"),children:i?(0,t.jsx)(g.ChevronLeft,{className:"h-4 w-4"}):(0,t.jsx)(b.ChevronRight,{className:"h-4 w-4"})})})]})]})}function M({children:e}){let{isExpanded:i}=l(),r=(0,a.useRef)(null),o=(0,s.usePathname)(),c="/intelligence"===o||o.startsWith("/intelligence/");return(0,t.jsxs)("div",{className:"flex h-screen w-full overflow-hidden premium-mesh",children:[(0,t.jsx)(k,{}),(0,t.jsx)("div",{className:(0,n.cn)("flex min-w-0 flex-1 flex-col h-full relative transition-[margin-left] duration-200 ease-[cubic-bezier(0.4,0,0.2,1)]","ml-0 md:ml-0"),style:{marginLeft:i?"15rem":"4rem"},children:(0,t.jsx)("main",{ref:r,className:(0,n.cn)("flex-1 overflow-x-hidden",c?"overflow-hidden p-0":"overflow-y-auto px-6 pb-24 pt-4 md:pb-8"),children:e})})]})}e.s(["AppShell",()=>M],44787)},49685,17056,e=>{"use strict";let t=(0,e.i(75254).default)("handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);e.s(["Handshake",()=>t],49685);var a=e.i(43476),s=/[\\\/_+.#"@\[\(\{&]/,n=/[\\\/_+.#"@\[\(\{&]/g,i=/[\s-]/,r=/[\s-]/g;function l(e){return e.toLowerCase().replace(r," ")}var o=e.i(26999),c=e.i(71645);e.i(74080);var d=e.i(20783),m=Symbol.for("react.lazy"),u=c[" use ".trim().toString()];function x(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===m&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}var h=Symbol("radix.slottable");function p(e){return c.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===h}var g=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{var s,n;let i,r,l,o=(n=s=`Primitive.${t}`,(i=c.forwardRef((e,t)=>{let{children:a,...s}=e;if(x(a)&&"function"==typeof u&&(a=u(a._payload)),c.isValidElement(a)){var n;let e,i,r=(n=a,(i=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(i=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),l=function(e,t){let a={...t};for(let s in t){let n=e[s],i=t[s];/^on[A-Z]/.test(s)?n&&i?a[s]=(...e)=>{let t=i(...e);return n(...e),t}:n&&(a[s]=n):"style"===s?a[s]={...n,...i}:"className"===s&&(a[s]=[n,i].filter(Boolean).join(" "))}return{...e,...a}}(s,a.props);return a.type!==c.Fragment&&(l.ref=t?(0,d.composeRefs)(t,r):r),c.cloneElement(a,l)}return c.Children.count(a)>1?c.Children.only(null):null})).displayName=`${n}.SlotClone`,r=i,(l=c.forwardRef((e,t)=>{let{children:s,...n}=e;x(s)&&"function"==typeof u&&(s=u(s._payload));let i=c.Children.toArray(s),l=i.find(p);if(l){let e=l.props.children,s=i.map(t=>t!==l?t:c.Children.count(e)>1?c.Children.only(null):c.isValidElement(e)?e.props.children:null);return(0,a.jsx)(r,{...n,ref:t,children:c.isValidElement(e)?c.cloneElement(e,void 0,s):null})}return(0,a.jsx)(r,{...n,ref:t,children:s})})).displayName=`${s}.Slot`,l),m=c.forwardRef((e,s)=>{let{asChild:n,...i}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,a.jsx)(n?o:t,{...i,ref:s})});return m.displayName=`Primitive.${t}`,{...e,[t]:m}},{}),b=e.i(10772),f='[cmdk-group=""]',v='[cmdk-group-items=""]',j='[cmdk-item=""]',y=`${j}:not([aria-disabled="true"])`,N="cmdk-item-select",w="data-value",S=(e,t,a)=>{var o;return o=e,function e(t,a,l,o,c,d,m){if(d===a.length)return c===t.length?1:.99;var u=`${c},${d}`;if(void 0!==m[u])return m[u];for(var x,h,p,g,b=o.charAt(d),f=l.indexOf(b,c),v=0;f>=0;)(x=e(t,a,l,o,f+1,d+1,m))>v&&(f===c?x*=1:s.test(t.charAt(f-1))?(x*=.8,(p=t.slice(c,f-1).match(n))&&c>0&&(x*=Math.pow(.999,p.length))):i.test(t.charAt(f-1))?(x*=.9,(g=t.slice(c,f-1).match(r))&&c>0&&(x*=Math.pow(.999,g.length))):(x*=.17,c>0&&(x*=Math.pow(.999,f-c))),t.charAt(f)!==a.charAt(d)&&(x*=.9999)),(x<.1&&l.charAt(f-1)===o.charAt(d+1)||o.charAt(d+1)===o.charAt(d)&&l.charAt(f-1)!==o.charAt(d))&&.1*(h=e(t,a,l,o,f+1,d+2,m))>x&&(x=.1*h),x>v&&(v=x),f=l.indexOf(b,f+1);return m[u]=v,v}(o=a&&a.length>0?`${o+" "+a.join(" ")}`:o,t,l(o),l(t),0,0,{})},C=c.createContext(void 0),z=c.createContext(void 0),k=c.createContext(void 0),M=c.forwardRef((e,t)=>{let a=O(()=>{var t,a;return{search:"",value:null!=(a=null!=(t=e.value)?t:e.defaultValue)?a:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),s=O(()=>new Set),n=O(()=>new Map),i=O(()=>new Map),r=O(()=>new Set),l=V(e),{label:o,children:d,value:m,onValueChange:u,filter:x,shouldFilter:h,loop:p,disablePointerSelection:k=!1,vimBindings:M=!0,...I}=e,D=(0,b.useId)(),A=(0,b.useId)(),T=(0,b.useId)(),R=c.useRef(null),P=$();L(()=>{if(void 0!==m){let e=m.trim();a.current.value=e,E.emit()}},[m]),L(()=>{P(6,G)},[]);let E=c.useMemo(()=>({subscribe:e=>(r.current.add(e),()=>r.current.delete(e)),snapshot:()=>a.current,setState:(e,t,s)=>{var n,i,r,o;if(!Object.is(a.current[e],t)){if(a.current[e]=t,"search"===e)W(),H(),P(1,U);else if("value"===e){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let e=document.getElementById(T);e?e.focus():null==(n=document.getElementById(D))||n.focus()}if(P(7,()=>{var e;a.current.selectedItemId=null==(e=X())?void 0:e.id,E.emit()}),s||P(5,G),(null==(i=l.current)?void 0:i.value)!==void 0){null==(o=(r=l.current).onValueChange)||o.call(r,null!=t?t:"");return}}E.emit()}},emit:()=>{r.current.forEach(e=>e())}}),[]),B=c.useMemo(()=>({value:(e,t,s)=>{var n;t!==(null==(n=i.current.get(e))?void 0:n.value)&&(i.current.set(e,{value:t,keywords:s}),a.current.filtered.items.set(e,F(t,s)),P(2,()=>{H(),E.emit()}))},item:(e,t)=>(s.current.add(e),t&&(n.current.has(t)?n.current.get(t).add(e):n.current.set(t,new Set([e]))),P(3,()=>{W(),H(),a.current.value||U(),E.emit()}),()=>{i.current.delete(e),s.current.delete(e),a.current.filtered.items.delete(e);let t=X();P(4,()=>{W(),(null==t?void 0:t.getAttribute("id"))===e&&U(),E.emit()})}),group:e=>(n.current.has(e)||n.current.set(e,new Set),()=>{i.current.delete(e),n.current.delete(e)}),filter:()=>l.current.shouldFilter,label:o||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:D,inputId:T,labelId:A,listInnerRef:R}),[]);function F(e,t){var s,n;let i=null!=(n=null==(s=l.current)?void 0:s.filter)?n:S;return e?i(e,a.current.search,t):0}function H(){if(!a.current.search||!1===l.current.shouldFilter)return;let e=a.current.filtered.items,t=[];a.current.filtered.groups.forEach(a=>{let s=n.current.get(a),i=0;s.forEach(t=>{i=Math.max(e.get(t),i)}),t.push([a,i])});let s=R.current;Y().sort((t,a)=>{var s,n;let i=t.getAttribute("id"),r=a.getAttribute("id");return(null!=(s=e.get(r))?s:0)-(null!=(n=e.get(i))?n:0)}).forEach(e=>{let t=e.closest(v);t?t.appendChild(e.parentElement===t?e:e.closest(`${v} > *`)):s.appendChild(e.parentElement===s?e:e.closest(`${v} > *`))}),t.sort((e,t)=>t[1]-e[1]).forEach(e=>{var t;let a=null==(t=R.current)?void 0:t.querySelector(`${f}[${w}="${encodeURIComponent(e[0])}"]`);null==a||a.parentElement.appendChild(a)})}function U(){let e=Y().find(e=>"true"!==e.getAttribute("aria-disabled")),t=null==e?void 0:e.getAttribute(w);E.setState("value",t||void 0)}function W(){var e,t,r,o;if(!a.current.search||!1===l.current.shouldFilter){a.current.filtered.count=s.current.size;return}a.current.filtered.groups=new Set;let c=0;for(let n of s.current){let s=F(null!=(t=null==(e=i.current.get(n))?void 0:e.value)?t:"",null!=(o=null==(r=i.current.get(n))?void 0:r.keywords)?o:[]);a.current.filtered.items.set(n,s),s>0&&c++}for(let[e,t]of n.current)for(let s of t)if(a.current.filtered.items.get(s)>0){a.current.filtered.groups.add(e);break}a.current.filtered.count=c}function G(){var e,t,a;let s=X();s&&((null==(e=s.parentElement)?void 0:e.firstChild)===s&&(null==(a=null==(t=s.closest(f))?void 0:t.querySelector('[cmdk-group-heading=""]'))||a.scrollIntoView({block:"nearest"})),s.scrollIntoView({block:"nearest"}))}function X(){var e;return null==(e=R.current)?void 0:e.querySelector(`${j}[aria-selected="true"]`)}function Y(){var e;return Array.from((null==(e=R.current)?void 0:e.querySelectorAll(y))||[])}function Q(e){let t=Y()[e];t&&E.setState("value",t.getAttribute(w))}function Z(e){var t;let a=X(),s=Y(),n=s.findIndex(e=>e===a),i=s[n+e];null!=(t=l.current)&&t.loop&&(i=n+e<0?s[s.length-1]:n+e===s.length?s[0]:s[n+e]),i&&E.setState("value",i.getAttribute(w))}function K(e){let t=X(),a=null==t?void 0:t.closest(f),s;for(;a&&!s;)s=null==(a=e>0?function(e,t){let a=e.nextElementSibling;for(;a;){if(a.matches(t))return a;a=a.nextElementSibling}}(a,f):function(e,t){let a=e.previousElementSibling;for(;a;){if(a.matches(t))return a;a=a.previousElementSibling}}(a,f))?void 0:a.querySelector(y);s?E.setState("value",s.getAttribute(w)):Z(e)}let J=()=>Q(Y().length-1),ee=e=>{e.preventDefault(),e.metaKey?J():e.altKey?K(1):Z(1)},et=e=>{e.preventDefault(),e.metaKey?Q(0):e.altKey?K(-1):Z(-1)};return c.createElement(g.div,{ref:t,tabIndex:-1,...I,"cmdk-root":"",onKeyDown:e=>{var t;null==(t=I.onKeyDown)||t.call(I,e);let a=e.nativeEvent.isComposing||229===e.keyCode;if(!(e.defaultPrevented||a))switch(e.key){case"n":case"j":M&&e.ctrlKey&&ee(e);break;case"ArrowDown":ee(e);break;case"p":case"k":M&&e.ctrlKey&&et(e);break;case"ArrowUp":et(e);break;case"Home":e.preventDefault(),Q(0);break;case"End":e.preventDefault(),J();break;case"Enter":{e.preventDefault();let t=X();if(t){let e=new Event(N);t.dispatchEvent(e)}}}}},c.createElement("label",{"cmdk-label":"",htmlFor:B.inputId,id:B.labelId,style:q},o),_(e,e=>c.createElement(z.Provider,{value:E},c.createElement(C.Provider,{value:B},e))))}),I=c.forwardRef((e,t)=>{var a,s;let n=(0,b.useId)(),i=c.useRef(null),r=c.useContext(k),l=c.useContext(C),o=V(e),m=null!=(s=null==(a=o.current)?void 0:a.forceMount)?s:null==r?void 0:r.forceMount;L(()=>{if(!m)return l.item(n,null==r?void 0:r.id)},[m]);let u=F(n,i,[e.value,e.children,i],e.keywords),x=c.useContext(z),h=B(e=>e.value&&e.value===u.current),p=B(e=>!!m||!1===l.filter()||!e.search||e.filtered.items.get(n)>0);function f(){var e,t;v(),null==(t=(e=o.current).onSelect)||t.call(e,u.current)}function v(){x.setState("value",u.current,!0)}if(c.useEffect(()=>{let t=i.current;if(!(!t||e.disabled))return t.addEventListener(N,f),()=>t.removeEventListener(N,f)},[p,e.onSelect,e.disabled]),!p)return null;let{disabled:j,value:y,onSelect:w,forceMount:S,keywords:M,...I}=e;return c.createElement(g.div,{ref:(0,d.composeRefs)(i,t),...I,id:n,"cmdk-item":"",role:"option","aria-disabled":!!j,"aria-selected":!!h,"data-disabled":!!j,"data-selected":!!h,onPointerMove:j||l.getDisablePointerSelection()?void 0:v,onClick:j?void 0:f},e.children)}),D=c.forwardRef((e,t)=>{let{heading:a,children:s,forceMount:n,...i}=e,r=(0,b.useId)(),l=c.useRef(null),o=c.useRef(null),m=(0,b.useId)(),u=c.useContext(C),x=B(e=>!!n||!1===u.filter()||!e.search||e.filtered.groups.has(r));L(()=>u.group(r),[]),F(r,l,[e.value,e.heading,o]);let h=c.useMemo(()=>({id:r,forceMount:n}),[n]);return c.createElement(g.div,{ref:(0,d.composeRefs)(l,t),...i,"cmdk-group":"",role:"presentation",hidden:!x||void 0},a&&c.createElement("div",{ref:o,"cmdk-group-heading":"","aria-hidden":!0,id:m},a),_(e,e=>c.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":a?m:void 0},c.createElement(k.Provider,{value:h},e))))}),A=c.forwardRef((e,t)=>{let{alwaysRender:a,...s}=e,n=c.useRef(null),i=B(e=>!e.search);return a||i?c.createElement(g.div,{ref:(0,d.composeRefs)(n,t),...s,"cmdk-separator":"",role:"separator"}):null}),T=c.forwardRef((e,t)=>{let{onValueChange:a,...s}=e,n=null!=e.value,i=c.useContext(z),r=B(e=>e.search),l=B(e=>e.selectedItemId),o=c.useContext(C);return c.useEffect(()=>{null!=e.value&&i.setState("search",e.value)},[e.value]),c.createElement(g.input,{ref:t,...s,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":o.listId,"aria-labelledby":o.labelId,"aria-activedescendant":l,id:o.inputId,type:"text",value:n?e.value:r,onChange:e=>{n||i.setState("search",e.target.value),null==a||a(e.target.value)}})}),R=c.forwardRef((e,t)=>{let{children:a,label:s="Suggestions",...n}=e,i=c.useRef(null),r=c.useRef(null),l=B(e=>e.selectedItemId),o=c.useContext(C);return c.useEffect(()=>{if(r.current&&i.current){let e=r.current,t=i.current,a,s=new ResizeObserver(()=>{a=requestAnimationFrame(()=>{let a=e.offsetHeight;t.style.setProperty("--cmdk-list-height",a.toFixed(1)+"px")})});return s.observe(e),()=>{cancelAnimationFrame(a),s.unobserve(e)}}},[]),c.createElement(g.div,{ref:(0,d.composeRefs)(i,t),...n,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":s,id:o.listId},_(e,e=>c.createElement("div",{ref:(0,d.composeRefs)(r,o.listInnerRef),"cmdk-list-sizer":""},e)))}),P=c.forwardRef((e,t)=>{let{open:a,onOpenChange:s,overlayClassName:n,contentClassName:i,container:r,...l}=e;return c.createElement(o.Root,{open:a,onOpenChange:s},c.createElement(o.Portal,{container:r},c.createElement(o.Overlay,{"cmdk-overlay":"",className:n}),c.createElement(o.Content,{"aria-label":e.label,"cmdk-dialog":"",className:i},c.createElement(M,{ref:t,...l}))))}),E=Object.assign(M,{List:R,Item:I,Input:T,Group:D,Separator:A,Dialog:P,Empty:c.forwardRef((e,t)=>B(e=>0===e.filtered.count)?c.createElement(g.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Loading:c.forwardRef((e,t)=>{let{progress:a,children:s,label:n="Loading...",...i}=e;return c.createElement(g.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":a,"aria-valuemin":0,"aria-valuemax":100,"aria-label":n},_(e,e=>c.createElement("div",{"aria-hidden":!0},e)))})});function V(e){let t=c.useRef(e);return L(()=>{t.current=e}),t}var L="u"<typeof window?c.useEffect:c.useLayoutEffect;function O(e){let t=c.useRef();return void 0===t.current&&(t.current=e()),t}function B(e){let t=c.useContext(z),a=()=>e(t.snapshot());return c.useSyncExternalStore(t.subscribe,a,a)}function F(e,t,a,s=[]){let n=c.useRef(),i=c.useContext(C);return L(()=>{var r;let l=(()=>{var e;for(let t of a){if("string"==typeof t)return t.trim();if("object"==typeof t&&"current"in t)return t.current?null==(e=t.current.textContent)?void 0:e.trim():n.current}})(),o=s.map(e=>e.trim());i.value(e,l,o),null==(r=t.current)||r.setAttribute(w,l),n.current=l}),n}var $=()=>{let[e,t]=c.useState(),a=O(()=>new Map);return L(()=>{a.current.forEach(e=>e()),a.current=new Map},[e]),(e,s)=>{a.current.set(e,s),t({})}};function _({asChild:e,children:t},a){let s;return e&&c.isValidElement(t)?c.cloneElement("function"==typeof(s=t.type)?s(t.props):"render"in s?s.render(t.props):t,{ref:t.ref},a(t.props.children)):a(t)}var q={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},H=e.i(54943),H=H,U=e.i(75157),W=e.i(76639);function G({className:e,...t}){return(0,a.jsx)(E,{"data-slot":"command",className:(0,U.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function X({title:e="Command Palette",description:t="Search for a command to run...",children:s,className:n,showCloseButton:i=!0,...r}){return(0,a.jsxs)(W.Dialog,{...r,children:[(0,a.jsxs)(W.DialogHeader,{className:"sr-only",children:[(0,a.jsx)(W.DialogTitle,{children:e}),(0,a.jsx)(W.DialogDescription,{children:t})]}),(0,a.jsx)(W.DialogContent,{className:(0,U.cn)("overflow-hidden p-0",n),showCloseButton:i,children:(0,a.jsx)(G,{className:"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:s})})]})}function Y({className:e,...t}){return(0,a.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,a.jsx)(H.default,{className:"size-4 shrink-0 opacity-50"}),(0,a.jsx)(E.Input,{"data-slot":"command-input",className:(0,U.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function Q({className:e,...t}){return(0,a.jsx)(E.List,{"data-slot":"command-list",className:(0,U.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function Z({...e}){return(0,a.jsx)(E.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function K({className:e,...t}){return(0,a.jsx)(E.Group,{"data-slot":"command-group",className:(0,U.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function J({className:e,...t}){return(0,a.jsx)(E.Separator,{"data-slot":"command-separator",className:(0,U.cn)("bg-border -mx-1 h-px",e),...t})}function ee({className:e,...t}){return(0,a.jsx)(E.Item,{"data-slot":"command-item",className:(0,U.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}e.s(["Command",()=>G,"CommandDialog",()=>X,"CommandEmpty",()=>Z,"CommandGroup",()=>K,"CommandInput",()=>Y,"CommandItem",()=>ee,"CommandList",()=>Q,"CommandSeparator",()=>J],17056)},80376,e=>{"use strict";var t=e.i(43476),a=e.i(95926),s=e.i(64053),n=e.i(75157);function i({...e}){return(0,t.jsx)(s.Dialog.Root,{"data-slot":"sheet",...e})}function r({...e}){return(0,t.jsx)(s.Dialog.Portal,{"data-slot":"sheet-portal",...e})}function l({className:e,...a}){return(0,t.jsx)(s.Dialog.Overlay,{"data-slot":"sheet-overlay",className:(0,n.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50 backdrop-blur-[2px] duration-300",e),...a})}function o({className:e,children:i,side:o="right",showCloseButton:c=!0,...d}){return(0,t.jsxs)(r,{children:[(0,t.jsx)(l,{}),(0,t.jsxs)(s.Dialog.Content,{"data-slot":"sheet-content",className:(0,n.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-2xl transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===o&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===o&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===o&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===o&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...d,children:[i,c&&(0,t.jsxs)(s.Dialog.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,t.jsx)(a.XIcon,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function c({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"sheet-header",className:(0,n.cn)("flex flex-col gap-1.5 p-4",e),...a})}function d({className:e,...a}){return(0,t.jsx)("div",{"data-slot":"sheet-footer",className:(0,n.cn)("mt-auto flex flex-col gap-2 p-4",e),...a})}function m({className:e,...a}){return(0,t.jsx)(s.Dialog.Title,{"data-slot":"sheet-title",className:(0,n.cn)("text-foreground font-semibold",e),...a})}e.s(["Sheet",()=>i,"SheetContent",()=>o,"SheetFooter",()=>d,"SheetHeader",()=>c,"SheetTitle",()=>m])},67892,e=>{"use strict";var t=e.i(43476);e.i(47167);var a=e.i(71645),s=e.i(37727),n=e.i(43432),i=e.i(94983),r=e.i(14683),l=e.i(63488),o=e.i(87316),c=e.i(75254);let d=(0,c.default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var m=e.i(12426),u=e.i(84614),x=e.i(61911);let h=(0,c.default)("store",[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]]);var p=e.i(3116),g=e.i(58377),b=e.i(10059),f=e.i(54498),v=e.i(41071),j=e.i(7486),y=e.i(7233),N=e.i(27612),w=e.i(70273),S=e.i(98919),C=e.i(63059),z=e.i(43531),k=e.i(69638),M=e.i(88699);let I=(0,c.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var D=e.i(46897),A=e.i(25652),T=e.i(78583),R=e.i(72520),P=e.i(78894),E=e.i(16715),V=e.i(31278),L=e.i(64659),O=e.i(21218),B=e.i(87130);let F=(0,c.default)("instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);var $=e.i(78917);let _=(0,c.default)("utensils-crossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);var q=e.i(74886);let H=(0,c.default)("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),U=(0,c.default)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),W=(0,c.default)("beer",[["path",{d:"M17 11h1a3 3 0 0 1 0 6h-1",key:"1yp76v"}],["path",{d:"M9 12v6",key:"1u1cab"}],["path",{d:"M13 12v6",key:"1sugkk"}],["path",{d:"M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z",key:"1510fo"}],["path",{d:"M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8",key:"19jb7n"}]]),G=(0,c.default)("pizza",[["path",{d:"m12 14-1 1",key:"11onhr"}],["path",{d:"m13.75 18.25-1.25 1.42",key:"1yisr3"}],["path",{d:"M17.775 5.654a15.68 15.68 0 0 0-12.121 12.12",key:"1qtqk6"}],["path",{d:"M18.8 9.3a1 1 0 0 0 2.1 7.7",key:"fbbbr2"}],["path",{d:"M21.964 20.732a1 1 0 0 1-1.232 1.232l-18-5a1 1 0 0 1-.695-1.232A19.68 19.68 0 0 1 15.732 2.037a1 1 0 0 1 1.232.695z",key:"1hyfdd"}]]),X=(0,c.default)("shopping-basket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]]),Y=(0,c.default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),Q=(0,c.default)("glass-water",[["path",{d:"M5.116 4.104A1 1 0 0 1 6.11 3h11.78a1 1 0 0 1 .994 1.105L17.19 20.21A2 2 0 0 1 15.2 22H8.8a2 2 0 0 1-2-1.79z",key:"p55z4y"}],["path",{d:"M6 12a5 5 0 0 1 6 0 5 5 0 0 0 6 0",key:"mjntcy"}]]),Z=(0,c.default)("chef-hat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]]),K=(0,c.default)("wine",[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]]);var J=e.i(23934),ee=e.i(46932),et=e.i(88653),ea=e.i(75157),es=e.i(19455),en=e.i(72436);let ei={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function er(e){return (t={})=>{let a=t.width?String(t.width):e.defaultWidth;return e.formats[a]||e.formats[e.defaultWidth]}}let el={date:er({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:er({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:er({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},eo={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function ec(e){return(t,a)=>{let s;if("formatting"===(a?.context?String(a.context):"standalone")&&e.formattingValues){let t=e.defaultFormattingWidth||e.defaultWidth,n=a?.width?String(a.width):t;s=e.formattingValues[n]||e.formattingValues[t]}else{let t=e.defaultWidth,n=a?.width?String(a.width):e.defaultWidth;s=e.values[n]||e.values[t]}return s[e.argumentCallback?e.argumentCallback(t):t]}}function ed(e){return(t,a={})=>{let s,n=a.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],r=t.match(i);if(!r)return null;let l=r[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?function(e,t){for(let a=0;a<e.length;a++)if(t(e[a]))return a}(o,e=>e.test(l)):function(e,t){for(let a in e)if(Object.prototype.hasOwnProperty.call(e,a)&&t(e[a]))return a}(o,e=>e.test(l));return s=e.valueCallback?e.valueCallback(c):c,{value:s=a.valueCallback?a.valueCallback(s):s,rest:t.slice(l.length)}}}function em(e){return(t,a={})=>{let s=t.match(e.matchPattern);if(!s)return null;let n=s[0],i=t.match(e.parsePattern);if(!i)return null;let r=e.valueCallback?e.valueCallback(i[0]):i[0];return{value:r=a.valueCallback?a.valueCallback(r):r,rest:t.slice(n.length)}}}let eu={code:"en-US",formatDistance:(e,t,a)=>{let s,n=ei[e];if(s="string"==typeof n?n:1===t?n.one:n.other.replace("{{count}}",t.toString()),a?.addSuffix)if(a.comparison&&a.comparison>0)return"in "+s;else return s+" ago";return s},formatLong:el,formatRelative:(e,t,a,s)=>eo[e],localize:{ordinalNumber:(e,t)=>{let a=Number(e),s=a%100;if(s>20||s<10)switch(s%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},era:ec({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:ec({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:ec({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:ec({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:ec({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:em({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:ed({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:ed({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:ed({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:ed({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:ed({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},ex={},eh=Symbol.for("constructDateFrom");function ep(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&eh in e?e[eh](t):e instanceof Date?new e.constructor(t):new Date(t)}function eg(e,t){return ep(t||e,e)}function eb(e){let t=eg(e),a=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return a.setUTCFullYear(t.getFullYear()),e-a}function ef(e,t){let a=eg(e,t?.in);return a.setHours(0,0,0,0),a}function ev(e,t){let a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??ex.weekStartsOn??ex.locale?.options?.weekStartsOn??0,s=eg(e,t?.in),n=s.getDay();return s.setDate(s.getDate()-(7*(n<a)+n-a)),s.setHours(0,0,0,0),s}function ej(e,t){return ev(e,{...t,weekStartsOn:1})}function ey(e,t){let a=eg(e,t?.in),s=a.getFullYear(),n=ep(a,0);n.setFullYear(s+1,0,4),n.setHours(0,0,0,0);let i=ej(n),r=ep(a,0);r.setFullYear(s,0,4),r.setHours(0,0,0,0);let l=ej(r);return a.getTime()>=i.getTime()?s+1:a.getTime()>=l.getTime()?s:s-1}function eN(e,t){let a=eg(e,t?.in),s=a.getFullYear(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??ex.firstWeekContainsDate??ex.locale?.options?.firstWeekContainsDate??1,i=ep(t?.in||e,0);i.setFullYear(s+1,0,n),i.setHours(0,0,0,0);let r=ev(i,t),l=ep(t?.in||e,0);l.setFullYear(s,0,n),l.setHours(0,0,0,0);let o=ev(l,t);return+a>=+r?s+1:+a>=+o?s:s-1}function ew(e,t){let a=Math.abs(e).toString().padStart(t,"0");return(e<0?"-":"")+a}let eS={y(e,t){let a=e.getFullYear(),s=a>0?a:1-a;return ew("yy"===t?s%100:s,t.length)},M(e,t){let a=e.getMonth();return"M"===t?String(a+1):ew(a+1,2)},d:(e,t)=>ew(e.getDate(),t.length),a(e,t){let a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];default:return"am"===a?"a.m.":"p.m."}},h:(e,t)=>ew(e.getHours()%12||12,t.length),H:(e,t)=>ew(e.getHours(),t.length),m:(e,t)=>ew(e.getMinutes(),t.length),s:(e,t)=>ew(e.getSeconds(),t.length),S(e,t){let a=t.length;return ew(Math.trunc(e.getMilliseconds()*Math.pow(10,a-3)),t.length)}},eC={G:function(e,t,a){let s=+(e.getFullYear()>0);switch(t){case"G":case"GG":case"GGG":return a.era(s,{width:"abbreviated"});case"GGGGG":return a.era(s,{width:"narrow"});default:return a.era(s,{width:"wide"})}},y:function(e,t,a){if("yo"===t){let t=e.getFullYear();return a.ordinalNumber(t>0?t:1-t,{unit:"year"})}return eS.y(e,t)},Y:function(e,t,a,s){let n=eN(e,s),i=n>0?n:1-n;return"YY"===t?ew(i%100,2):"Yo"===t?a.ordinalNumber(i,{unit:"year"}):ew(i,t.length)},R:function(e,t){return ew(ey(e),t.length)},u:function(e,t){return ew(e.getFullYear(),t.length)},Q:function(e,t,a){let s=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return ew(s,2);case"Qo":return a.ordinalNumber(s,{unit:"quarter"});case"QQQ":return a.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(s,{width:"narrow",context:"formatting"});default:return a.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,a){let s=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return ew(s,2);case"qo":return a.ordinalNumber(s,{unit:"quarter"});case"qqq":return a.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(s,{width:"narrow",context:"standalone"});default:return a.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,a){let s=e.getMonth();switch(t){case"M":case"MM":return eS.M(e,t);case"Mo":return a.ordinalNumber(s+1,{unit:"month"});case"MMM":return a.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(s,{width:"narrow",context:"formatting"});default:return a.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,a){let s=e.getMonth();switch(t){case"L":return String(s+1);case"LL":return ew(s+1,2);case"Lo":return a.ordinalNumber(s+1,{unit:"month"});case"LLL":return a.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(s,{width:"narrow",context:"standalone"});default:return a.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,a,s){let n,i,r,l,o=Math.round((ev(n=eg(e,s?.in),s)-(i=s?.firstWeekContainsDate??s?.locale?.options?.firstWeekContainsDate??ex.firstWeekContainsDate??ex.locale?.options?.firstWeekContainsDate??1,r=eN(n,s),(l=ep(s?.in||n,0)).setFullYear(r,0,i),l.setHours(0,0,0,0),ev(l,s)))/6048e5)+1;return"wo"===t?a.ordinalNumber(o,{unit:"week"}):ew(o,t.length)},I:function(e,t,a){let s,n,i,r=Math.round((ej(s=eg(e,void 0))-(n=ey(s,void 0),(i=ep(s,0)).setFullYear(n,0,4),i.setHours(0,0,0,0),ej(i)))/6048e5)+1;return"Io"===t?a.ordinalNumber(r,{unit:"week"}):ew(r,t.length)},d:function(e,t,a){return"do"===t?a.ordinalNumber(e.getDate(),{unit:"date"}):eS.d(e,t)},D:function(e,t,a){let s,n,i=function(e,t,a){let[s,n]=function(e,...t){let a=ep.bind(null,e||t.find(e=>"object"==typeof e));return t.map(a)}(void 0,e,t),i=ef(s),r=ef(n);return Math.round((i-eb(i)-(r-eb(r)))/864e5)}(s=eg(e,void 0),((n=eg(s,void 0)).setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n))+1;return"Do"===t?a.ordinalNumber(i,{unit:"dayOfYear"}):ew(i,t.length)},E:function(e,t,a){let s=e.getDay();switch(t){case"E":case"EE":case"EEE":return a.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(s,{width:"short",context:"formatting"});default:return a.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,a,s){let n=e.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return ew(i,2);case"eo":return a.ordinalNumber(i,{unit:"day"});case"eee":return a.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(n,{width:"short",context:"formatting"});default:return a.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,a,s){let n=e.getDay(),i=(n-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return ew(i,t.length);case"co":return a.ordinalNumber(i,{unit:"day"});case"ccc":return a.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(n,{width:"narrow",context:"standalone"});case"cccccc":return a.day(n,{width:"short",context:"standalone"});default:return a.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,a){let s=e.getDay(),n=0===s?7:s;switch(t){case"i":return String(n);case"ii":return ew(n,t.length);case"io":return a.ordinalNumber(n,{unit:"day"});case"iii":return a.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(s,{width:"short",context:"formatting"});default:return a.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,a){let s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,a){let s,n=e.getHours();switch(s=12===n?"noon":0===n?"midnight":n/12>=1?"pm":"am",t){case"b":case"bb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,a){let s,n=e.getHours();switch(s=n>=17?"evening":n>=12?"afternoon":n>=4?"morning":"night",t){case"B":case"BB":case"BBB":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(s,{width:"narrow",context:"formatting"});default:return a.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,a){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),a.ordinalNumber(t,{unit:"hour"})}return eS.h(e,t)},H:function(e,t,a){return"Ho"===t?a.ordinalNumber(e.getHours(),{unit:"hour"}):eS.H(e,t)},K:function(e,t,a){let s=e.getHours()%12;return"Ko"===t?a.ordinalNumber(s,{unit:"hour"}):ew(s,t.length)},k:function(e,t,a){let s=e.getHours();return(0===s&&(s=24),"ko"===t)?a.ordinalNumber(s,{unit:"hour"}):ew(s,t.length)},m:function(e,t,a){return"mo"===t?a.ordinalNumber(e.getMinutes(),{unit:"minute"}):eS.m(e,t)},s:function(e,t,a){return"so"===t?a.ordinalNumber(e.getSeconds(),{unit:"second"}):eS.s(e,t)},S:function(e,t){return eS.S(e,t)},X:function(e,t,a){let s=e.getTimezoneOffset();if(0===s)return"Z";switch(t){case"X":return ek(s);case"XXXX":case"XX":return eM(s);default:return eM(s,":")}},x:function(e,t,a){let s=e.getTimezoneOffset();switch(t){case"x":return ek(s);case"xxxx":case"xx":return eM(s);default:return eM(s,":")}},O:function(e,t,a){let s=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ez(s,":");default:return"GMT"+eM(s,":")}},z:function(e,t,a){let s=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ez(s,":");default:return"GMT"+eM(s,":")}},t:function(e,t,a){return ew(Math.trunc(e/1e3),t.length)},T:function(e,t,a){return ew(+e,t.length)}};function ez(e,t=""){let a=e>0?"-":"+",s=Math.abs(e),n=Math.trunc(s/60),i=s%60;return 0===i?a+String(n):a+String(n)+t+ew(i,2)}function ek(e,t){return e%60==0?(e>0?"-":"+")+ew(Math.abs(e)/60,2):eM(e,t)}function eM(e,t=""){let a=Math.abs(e);return(e>0?"-":"+")+ew(Math.trunc(a/60),2)+t+ew(a%60,2)}let eI=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},eD=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},eA={p:eD,P:(e,t)=>{let a,s=e.match(/(P+)(p+)?/)||[],n=s[1],i=s[2];if(!i)return eI(e,t);switch(n){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;default:a=t.dateTime({width:"full"})}return a.replace("{{date}}",eI(n,t)).replace("{{time}}",eD(i,t))}},eT=/^D+$/,eR=/^Y+$/,eP=["D","DD","YY","YYYY"],eE=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,eV=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,eL=/^'([^]*?)'?$/,eO=/''/g,eB=/[a-zA-Z]/;function eF(e,t,a){let s=a?.locale??ex.locale??eu,n=a?.firstWeekContainsDate??a?.locale?.options?.firstWeekContainsDate??ex.firstWeekContainsDate??ex.locale?.options?.firstWeekContainsDate??1,i=a?.weekStartsOn??a?.locale?.options?.weekStartsOn??ex.weekStartsOn??ex.locale?.options?.weekStartsOn??0,r=eg(e,a?.in);if(!(r instanceof Date||"object"==typeof r&&"[object Date]"===Object.prototype.toString.call(r))&&"number"!=typeof r||isNaN(+eg(r)))throw RangeError("Invalid time value");let l=t.match(eV).map(e=>{let t=e[0];return"p"===t||"P"===t?(0,eA[t])(e,s.formatLong):e}).join("").match(eE).map(e=>{if("''"===e)return{isToken:!1,value:"'"};let t=e[0];if("'"===t){var a;let t;return{isToken:!1,value:(t=(a=e).match(eL))?t[1].replace(eO,"'"):a}}if(eC[t])return{isToken:!0,value:e};if(t.match(eB))throw RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});s.localize.preprocessor&&(l=s.localize.preprocessor(r,l));let o={firstWeekContainsDate:n,weekStartsOn:i,locale:s};return l.map(n=>{if(!n.isToken)return n.value;let i=n.value;return(!a?.useAdditionalWeekYearTokens&&eR.test(i)||!a?.useAdditionalDayOfYearTokens&&eT.test(i))&&function(e,t,a){var s,n,i;let r,l=(s=e,n=t,i=a,r="Y"===s[0]?"years":"days of the month",`Use \`${s.toLowerCase()}\` instead of \`${s}\` (in \`${n}\`) for formatting ${r} to the input \`${i}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`);if(console.warn(l),eP.includes(e))throw RangeError(l)}(i,t,String(e)),(0,eC[i[0]])(r,i,s.localize,o)}).join("")}let e$={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 mês",other:"cerca de {{count}} meses"},xMonths:{one:"1 mês",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},e_={date:er({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},defaultWidth:"full"}),time:er({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:er({formats:{full:"{{date}} 'às' {{time}}",long:"{{date}} 'às' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},eq={lastWeek:e=>{let t=e.getDay();return"'"+(0===t||6===t?"último":"última")+"' eeee 'às' p"},yesterday:"'ontem às' p",today:"'hoje às' p",tomorrow:"'amanhã às' p",nextWeek:"eeee 'às' p",other:"P"},eH={code:"pt-BR",formatDistance:(e,t,a)=>{let s,n=e$[e];if(s="string"==typeof n?n:1===t?n.one:n.other.replace("{{count}}",String(t)),a?.addSuffix)if(a.comparison&&a.comparison>0)return"em "+s;else return"há "+s;return s},formatLong:e_,formatRelative:(e,t,a,s)=>{let n=eq[e];return"function"==typeof n?n(t):n},localize:{ordinalNumber:(e,t)=>{let a=Number(e);return t?.unit==="week"?a+"ª":a+"º"},era:ec({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},defaultWidth:"wide"}),quarter:ec({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:ec({values:{narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},defaultWidth:"wide"}),day:ec({values:{narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","terça","quarta","quinta","sexta","sábado"],wide:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"]},defaultWidth:"wide"}),dayPeriod:ec({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:em({matchPattern:/^(\d+)[ºªo]?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:ed({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},defaultParseWidth:"any"}),quarter:ed({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:ed({matchPatterns:{narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|março|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},defaultParseWidth:"any"}),day:ed({matchPatterns:{narrow:/^(dom|[23456]ª?|s[aá]b)/i,short:/^(dom|[23456]ª?|s[aá]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[aá]b)/i,wide:/^(domingo|(segunda|ter[cç]a|quarta|quinta|sexta)([- ]feira)?|s[aá]bado)/i},defaultMatchWidth:"wide",parsePatterns:{short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[aá]b/i]},defaultParseWidth:"any"}),dayPeriod:ed({matchPatterns:{narrow:/^(a|p|mn|md|(da) (manhã|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manhã|tarde|noite))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manhã/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},eU=(0,c.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var eW=e.i(63209),eG=e.i(87486),eX=e.i(55146);let eY={presencial:"Visita Presencial",remoto:"Reunião Remota",outro:"Outro"},eQ={agendada:"Agendada",realizada:"Realizada",cancelada:"Cancelada"},eZ={agendada:"bg-blue-100 text-blue-700",realizada:"bg-green-100 text-green-700",cancelada:"bg-red-100 text-red-700"};function eK({visit:e,isExpanded:a,isLocked:n=!1,onToggleDetails:i,onStatusChange:r,onReschedule:l,onDuplicate:c,onFollowUp:d,onDelete:m}){let x="presencial"===e.type?e.location:"remoto"===e.type?e.platform||"Online":"Outro",h="agendada"===e.status,g="cancelada"===e.status;return(0,t.jsxs)("div",{className:(0,ea.cn)("group relative rounded-2xl border bg-white transition-all duration-200",a?"border-brand/30 shadow-[0_8px_24px_rgba(0,0,0,0.08)] ring-1 ring-brand/10":"border-zinc-100 hover:border-zinc-200 hover:shadow-sm"),children:[(0,t.jsxs)("div",{className:"flex cursor-pointer items-start gap-4 p-4",onClick:i,children:[(0,t.jsx)("div",{className:(0,ea.cn)("flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl border transition-colors","presencial"===e.type?"border-purple-100 bg-purple-50 text-purple-600":"remoto"===e.type?"border-blue-100 bg-blue-50 text-blue-600":"border-zinc-200 bg-zinc-50 text-zinc-500"),children:"presencial"===e.type?(0,t.jsx)(D.MapPin,{className:"h-6 w-6"}):"remoto"===e.type?(0,t.jsx)(eU,{className:"h-6 w-6"}):(0,t.jsx)(o.Calendar,{className:"h-6 w-6"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:(0,ea.cn)("font-heading text-sm font-semibold transition-colors",a?"text-brand":"text-zinc-900",g&&"text-zinc-500 line-through decoration-zinc-400"),children:e.title||eY[e.type]}),(0,t.jsx)("p",{className:"truncate text-xs text-zinc-500",children:x||"Sem local definido"})]}),(0,t.jsx)(eG.Badge,{variant:"secondary",className:(0,ea.cn)("shrink-0 rounded-full px-2.5 py-0.5 text-[10px] font-bold uppercase tracking-wide",eZ[e.status]),children:eQ[e.status]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 pt-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500",children:[(0,t.jsx)(o.Calendar,{className:"h-3.5 w-3.5 text-zinc-400"}),(0,t.jsx)("span",{className:"font-medium text-zinc-700",children:(e=>{if(!e)return"--/--";let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))return"--/--";let a=new Date;return t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()?`Hoje, ${eF(t,"HH:mm")}`:eF(t,"dd/MM, HH:mm",{locale:eH})})(e.startAt||(e.date&&e.time?`${e.date}T${e.time}`:void 0))})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500",children:[(0,t.jsx)(u.User,{className:"h-3.5 w-3.5 text-zinc-400"}),(0,t.jsx)("span",{className:"truncate max-w-[120px]",children:e.responsible||"Sem responsável"})]}),e.durationMinutes?(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500",children:[(0,t.jsx)(p.Clock,{className:"h-3.5 w-3.5 text-zinc-400"}),(0,t.jsxs)("span",{children:[e.durationMinutes," min"]})]}):null]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between border-t border-zinc-50 bg-zinc-50/50 px-4 py-2 rounded-b-2xl",children:[(0,t.jsx)(es.Button,{size:"sm",variant:"ghost",className:(0,ea.cn)("h-8 -ml-2 gap-1.5 rounded-full px-3 text-xs font-medium transition-colors hover:bg-white hover:shadow-sm",a?"text-brand bg-brand/5":"text-zinc-600"),onClick:i,children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.X,{className:"h-3.5 w-3.5"})," Fechar detalhes"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y.Plus,{className:"h-3.5 w-3.5"})," Ver detalhes"]})}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[h&&!n&&(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)(es.Button,{size:"sm",variant:"ghost",className:"h-8 gap-1.5 rounded-full px-3 text-xs font-medium text-green-700 hover:bg-green-50 hover:text-green-800",onClick:()=>r(e.id,"realizada"),children:[(0,t.jsx)(k.CheckCircle,{className:"h-3.5 w-3.5"}),"Realizada"]})}),(0,t.jsxs)(eX.DropdownMenu,{children:[(0,t.jsx)(eX.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(es.Button,{size:"sm",variant:"ghost",className:"h-8 w-8 rounded-full p-0 text-zinc-400 hover:bg-white hover:text-zinc-600 hover:shadow-sm",disabled:n,children:(0,t.jsx)(v.MoreHorizontal,{className:"h-4 w-4"})})}),(0,t.jsxs)(eX.DropdownMenuContent,{align:"end",className:"w-48 rounded-xl p-1",children:[h&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>l(e.id,1),children:[(0,t.jsx)(E.RefreshCw,{className:"mr-2 h-3.5 w-3.5"}),"Reagendar (+1 dia)"]}),(0,t.jsxs)(eX.DropdownMenuItem,{className:"text-red-600 focus:text-red-700 focus:bg-red-50",onClick:()=>r(e.id,"cancelada"),children:[(0,t.jsx)(s.X,{className:"mr-2 h-3.5 w-3.5"}),"Cancelar visita"]}),(0,t.jsx)(eX.DropdownMenuSeparator,{})]}),(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>c(e.id),children:[(0,t.jsx)(q.Copy,{className:"mr-2 h-3.5 w-3.5"}),"Duplicar"]}),(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>d(e),children:[(0,t.jsx)(y.Plus,{className:"mr-2 h-3.5 w-3.5"}),"Criar follow-up"]}),(0,t.jsx)(eX.DropdownMenuSeparator,{}),(0,t.jsxs)(eX.DropdownMenuItem,{className:"text-red-600 focus:text-red-700 focus:bg-red-50",onClick:()=>m(e.id),children:[(0,t.jsx)(N.Trash2,{className:"mr-2 h-3.5 w-3.5"}),"Excluir"]})]})]})]})]}),(0,t.jsx)(et.AnimatePresence,{children:a&&(0,t.jsx)(ee.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2,ease:"easeInOut"},className:"overflow-hidden border-t border-zinc-100 bg-zinc-50/50",children:(0,t.jsxs)("div",{className:"grid gap-4 p-5 text-sm",children:[e.objective&&(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h5",{className:"font-heading text-xs font-bold uppercase tracking-wider text-zinc-400",children:"Objetivo"}),(0,t.jsx)("p",{className:"text-zinc-700 leading-relaxed",children:e.objective})]}),e.result&&(0,t.jsxs)("div",{className:"space-y-1 rounded-lg bg-green-50/50 p-3 border border-green-100",children:[(0,t.jsxs)("h5",{className:"flex items-center gap-1.5 font-heading text-xs font-bold uppercase tracking-wider text-green-700",children:[(0,t.jsx)(k.CheckCircle,{className:"h-3 w-3"})," Resultado"]}),(0,t.jsx)("p",{className:"text-zinc-700 leading-relaxed",children:e.result})]}),e.cancellationReason&&(0,t.jsxs)("div",{className:"space-y-1 rounded-lg bg-red-50/50 p-3 border border-red-100",children:[(0,t.jsxs)("h5",{className:"flex items-center gap-1.5 font-heading text-xs font-bold uppercase tracking-wider text-red-700",children:[(0,t.jsx)(eW.AlertCircle,{className:"h-3 w-3"})," Motivo do Cancelamento"]}),(0,t.jsx)("p",{className:"text-zinc-700 leading-relaxed",children:e.cancellationReason})]}),e.details&&(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h5",{className:"font-heading text-xs font-bold uppercase tracking-wider text-zinc-400",children:"Detalhes Internos"}),(0,t.jsx)("p",{className:"text-zinc-600 leading-relaxed whitespace-pre-wrap",children:e.details})]}),e.link&&"remoto"===e.type&&(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsxs)(es.Button,{variant:"outline",className:"h-9 gap-2 w-full justify-start text-zinc-700 hover:text-brand hover:border-brand/30",onClick:()=>window.open(e.link,"_blank"),children:[(0,t.jsx)(eU,{className:"h-4 w-4"}),"Entrar na reunião agora",(0,t.jsx)($.ExternalLink,{className:"ml-auto h-3 w-3 opacity-50"})]})})]})})})]})}var eJ=e.i(93479),e0=e.i(10204),e1=e.i(50637),e2=e.i(7353),e5=e.i(99375),e3=e.i(25913),e4=e.i(81140),e6=e.i(30030),e7=e.i(42727),e8=e.i(96626);e.i(74080);var e9=e.i(91918),te=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,s)=>{let n=(0,e9.createSlot)(`Primitive.${s}`),i=a.forwardRef((e,a)=>{let{asChild:i,...r}=e;return"u">typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,t.jsx)(i?n:s,{...r,ref:a})});return i.displayName=`Primitive.${s}`,{...e,[s]:i}},{}),tt=e.i(86318),ta=e.i(69340),ts=e.i(10772),tn="Tabs",[ti,tr]=(0,e6.createContextScope)(tn,[e7.createRovingFocusGroupScope]),tl=(0,e7.createRovingFocusGroupScope)(),[to,tc]=ti(tn),td=a.forwardRef((e,a)=>{let{__scopeTabs:s,value:n,onValueChange:i,defaultValue:r,orientation:l="horizontal",dir:o,activationMode:c="automatic",...d}=e,m=(0,tt.useDirection)(o),[u,x]=(0,ta.useControllableState)({prop:n,onChange:i,defaultProp:r??"",caller:tn});return(0,t.jsx)(to,{scope:s,baseId:(0,ts.useId)(),value:u,onValueChange:x,orientation:l,dir:m,activationMode:c,children:(0,t.jsx)(te.div,{dir:m,"data-orientation":l,...d,ref:a})})});td.displayName=tn;var tm="TabsList",tu=a.forwardRef((e,a)=>{let{__scopeTabs:s,loop:n=!0,...i}=e,r=tc(tm,s),l=tl(s);return(0,t.jsx)(e7.Root,{asChild:!0,...l,orientation:r.orientation,dir:r.dir,loop:n,children:(0,t.jsx)(te.div,{role:"tablist","aria-orientation":r.orientation,...i,ref:a})})});tu.displayName=tm;var tx="TabsTrigger",th=a.forwardRef((e,a)=>{let{__scopeTabs:s,value:n,disabled:i=!1,...r}=e,l=tc(tx,s),o=tl(s),c=tb(l.baseId,n),d=tf(l.baseId,n),m=n===l.value;return(0,t.jsx)(e7.Item,{asChild:!0,...o,focusable:!i,active:m,children:(0,t.jsx)(te.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":d,"data-state":m?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:c,...r,ref:a,onMouseDown:(0,e4.composeEventHandlers)(e.onMouseDown,e=>{i||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(n)}),onKeyDown:(0,e4.composeEventHandlers)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(n)}),onFocus:(0,e4.composeEventHandlers)(e.onFocus,()=>{let e="manual"!==l.activationMode;m||i||!e||l.onValueChange(n)})})})});th.displayName=tx;var tp="TabsContent",tg=a.forwardRef((e,s)=>{let{__scopeTabs:n,value:i,forceMount:r,children:l,...o}=e,c=tc(tp,n),d=tb(c.baseId,i),m=tf(c.baseId,i),u=i===c.value,x=a.useRef(u);return a.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,t.jsx)(e8.Presence,{present:r||u,children:({present:a})=>(0,t.jsx)(te.div,{"data-state":u?"active":"inactive","data-orientation":c.orientation,role:"tabpanel","aria-labelledby":d,hidden:!a,id:m,tabIndex:0,...o,ref:s,style:{...e.style,animationDuration:x.current?"0s":void 0},children:a&&l})})});function tb(e,t){return`${e}-trigger-${t}`}function tf(e,t){return`${e}-content-${t}`}tg.displayName=tp,e.s(["Content",()=>tg,"List",()=>tu,"Root",()=>td,"Tabs",()=>td,"TabsContent",()=>tg,"TabsList",()=>tu,"TabsTrigger",()=>th,"Trigger",()=>th,"createTabsScope",()=>tr],26209);var tv=e.i(26209),tv=tv;function tj({className:e,orientation:a="horizontal",...s}){return(0,t.jsx)(tv.Root,{"data-slot":"tabs","data-orientation":a,orientation:a,className:(0,ea.cn)("group/tabs flex gap-2 data-[orientation=horizontal]:flex-col",e),...s})}let ty=(0,e3.cva)("rounded-lg p-[3px] group-data-[orientation=horizontal]/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-[orientation=vertical]/tabs:h-fit group-data-[orientation=vertical]/tabs:flex-col",{variants:{variant:{default:"bg-muted",line:"gap-1 bg-transparent"}},defaultVariants:{variant:"default"}});function tN({className:e,variant:a="default",...s}){return(0,t.jsx)(tv.List,{"data-slot":"tabs-list","data-variant":a,className:(0,ea.cn)(ty({variant:a}),e),...s})}function tw({className:e,...a}){return(0,t.jsx)(tv.Trigger,{"data-slot":"tabs-trigger",className:(0,ea.cn)("focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all group-data-[orientation=vertical]/tabs:w-full group-data-[orientation=vertical]/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 group-data-[variant=default]/tabs-list:data-[state=active]:shadow-sm group-data-[variant=line]/tabs-list:data-[state=active]:shadow-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:border-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent","data-[state=active]:bg-background dark:data-[state=active]:text-foreground dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 data-[state=active]:text-foreground","after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-[orientation=horizontal]/tabs:after:inset-x-0 group-data-[orientation=horizontal]/tabs:after:bottom-[-5px] group-data-[orientation=horizontal]/tabs:after:h-0.5 group-data-[orientation=vertical]/tabs:after:inset-y-0 group-data-[orientation=vertical]/tabs:after:-right-1 group-data-[orientation=vertical]/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-[state=active]:after:opacity-100",e),...a})}function tS({className:e,...a}){return(0,t.jsx)(tv.Content,{"data-slot":"tabs-content",className:(0,ea.cn)("flex-1 outline-none",e),...a})}var tC=e.i(67489),tz=e.i(24687),tk=e.i(59684),tM=e.i(76639),tI=e.i(68499),tD=e.i(32171),tA=e.i(34288);e.i(5010);var tT=e.i(38342);let tR={text:"Texto curto",textarea:"Texto longo",number:"Número decimal",integer:"Número inteiro",currency:"Moeda (R$)",percentage:"Porcentagem (%)",url:"URL",email:"E-mail",phone:"Telefone",date:"Data",time:"Hora",datetime:"Data e hora",select:"Seleção única",multiselect:"Múltipla seleção",boolean:"Sim/Não",user:"Usuário",contact:"Contato",file:"Arquivo"},tP={text:"Para nomes, títulos e textos curtos",textarea:"Para descrições e observações longas",number:"Valores numéricos com decimais",integer:"Valores numéricos inteiros exatos",currency:"Valores monetários formatados em R$",percentage:"Valores em porcentagem (%)",url:"Links e endereços de sites",email:"Endereços de e-mail válidos",phone:"Números de telefone ou WhatsApp",date:"Para selecionar uma data específica",time:"Para definir um horário",datetime:"Data e hora combinadas",select:"Escolher uma única opção",multiselect:"Escolher múltiplas opções",boolean:"Verdadeiro ou Falso (Sim/Não)",user:"Vincular a um usuário do sistema",contact:"Vincular a um contato salvo",file:"Anexar documentos ou imagens"},tE={"lead-in":[{id:"sf-lead-in-1",stageId:"lead-in",key:"origem_lead",label:"Origem do Lead",type:"select",required:!0,order:0,isActive:!0,options:[{label:"Google",value:"google"},{label:"Indicação",value:"indicacao"},{label:"Instagram",value:"instagram"},{label:"Outros",value:"outros"}]},{id:"sf-lead-in-2",stageId:"lead-in",key:"decisor",label:"Nome do Decisor",type:"text",order:1,isActive:!0,placeholder:"Quem decide a compra?"}],"contato-feito":[{id:"sf-contato-feito-1",stageId:"contato-feito",key:"interesse",label:"Nível de Interesse",type:"select",order:0,isActive:!0,options:[{label:"Alto",value:"alto"},{label:"Médio",value:"medio"},{label:"Baixo",value:"baixo"}]},{id:"sf-contato-feito-2",stageId:"contato-feito",key:"melhor_horario",label:"Melhor Horário para Contato",type:"text",order:1,isActive:!0,placeholder:"Ex: Manhã, após as 14h..."},{id:"sf-contato-feito-3",stageId:"contato-feito",key:"dores_cliente",label:"Principais Dores",type:"textarea",order:2,isActive:!0,placeholder:"Descreva as dificuldades atuais do cliente..."}],"reuniao-agendada":[{id:"sf-reuniao-1",stageId:"reuniao-agendada",key:"data_reuniao",label:"Data da Reunião",type:"date",required:!0,order:0,isActive:!0},{id:"sf-reuniao-2",stageId:"reuniao-agendada",key:"pauta",label:"Pauta da Reunião",type:"textarea",order:1,isActive:!0,placeholder:"O que será discutido?"},{id:"sf-reuniao-3",stageId:"reuniao-agendada",key:"participantes",label:"Participantes Esperados",type:"text",order:2,isActive:!0,helperText:"Separe por vírgulas"}],"proposta-enviada":[{id:"sf-proposta-1",stageId:"proposta-enviada",key:"valor_proposta",label:"Valor da Proposta (R$)",type:"currency",required:!0,order:0,isActive:!0},{id:"sf-proposta-2",stageId:"proposta-enviada",key:"link_proposta",label:"Link da Proposta",type:"url",order:1,isActive:!0,placeholder:"URL do documento"},{id:"sf-proposta-3",stageId:"proposta-enviada",key:"prazo_validade",label:"Validade da Proposta",type:"date",order:2,isActive:!0}],negociacao:[{id:"sf-negociacao-1",stageId:"negociacao",key:"objecoes",label:"Objeções Levantadas",type:"textarea",order:0,isActive:!0},{id:"sf-negociacao-2",stageId:"negociacao",key:"desconto_aprovado",label:"Desconto Aprovado (%)",type:"percentage",order:1,isActive:!0,validationRules:{min:0,max:100}},{id:"sf-negociacao-3",stageId:"negociacao",key:"concorrentes",label:"Concorrentes Envolvidos",type:"text",order:2,isActive:!0}],fechamento:[{id:"sf-fechamento-1",stageId:"fechamento",key:"data_assinatura",label:"Data de Assinatura",type:"date",required:!0,order:0,isActive:!0},{id:"sf-fechamento-2",stageId:"fechamento",key:"contrato_anexado",label:"Contrato Assinado",type:"file",order:1,isActive:!0,helperText:"PDF ou Imagem"},{id:"sf-fechamento-3",stageId:"fechamento",key:"obs_finais",label:"Observações Finais",type:"textarea",order:2,isActive:!0}]};function tV(e){return!!(null==e||"string"==typeof e&&""===e.trim()||Array.isArray(e)&&0===e.length)}let tL=(0,c.default)("layout-list",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);var tO=e.i(37822),tB=e.i(17056),tF=e.i(68834),t$=e.i(79473);function t_(e,t){return`${e}:${t}`}let tq=(0,tF.create)()((0,t$.devtools)((e,t)=>({opportunityId:null,opportunityStage:null,fieldDefinitions:{},fieldValues:{},fieldSaveStates:{},fieldErrors:{},isSaving:!1,isLoadingFields:!1,isChangingStage:!1,loadError:null,banner:null,isNewFieldModalOpen:!1,initForOpportunity:(a,s,n)=>{let i={};for(let[e,t]of Object.entries(tE))i[e]=t.filter(e=>e.isActive);let r=t_(a,s),l=t().fieldValues[r];e({opportunityId:a,opportunityStage:s,fieldDefinitions:i,fieldValues:{...t().fieldValues,[r]:l??n??{}},fieldSaveStates:{},fieldErrors:{},isSaving:!1,isLoadingFields:!1,isChangingStage:!1,loadError:null,banner:null,isNewFieldModalOpen:!1})},updateFieldValue:(a,s)=>{let{opportunityId:n,opportunityStage:i,fieldValues:r}=t();if(!n||!i)return;let l=t_(n,i),o={...r[l]||{},[a]:s},c={...t().fieldErrors};delete c[a],e({fieldValues:{...r,[l]:o},fieldErrors:c,banner:null,fieldSaveStates:{...t().fieldSaveStates,[a]:"saving"}}),setTimeout(()=>{e(e=>({fieldSaveStates:{...e.fieldSaveStates,[a]:"saved"}})),setTimeout(()=>{e(e=>({fieldSaveStates:{...e.fieldSaveStates,[a]:"idle"}}))},1400)},280)},saveAllFields:()=>{let{opportunityId:a,opportunityStage:s,fieldDefinitions:n,fieldValues:i}=t();if(!a||!s)return;let r=n[s]||[],l=i[t_(a,s)]||{},o={},c=[];for(let e of r){let t=function(e,t){if(e.required&&tV(t))return"Preencha este campo para avançar etapa.";if(tV(t))return null;let a=e.validationRules;if(!a)return null;if("string"==typeof t){if(a.minLength&&t.length<a.minLength)return`M\xednimo ${a.minLength} caracteres.`;if(a.maxLength&&t.length>a.maxLength)return`M\xe1ximo ${a.maxLength} caracteres.`}if("number"==typeof t){if(void 0!==a.min&&t<a.min)return`Valor m\xednimo: ${a.min}.`;if(void 0!==a.max&&t>a.max)return`Valor m\xe1ximo: ${a.max}.`}if("url"===e.type&&"string"==typeof t)try{new URL(t)}catch{return"URL inválida."}if("email"===e.type&&"string"==typeof t&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return"E-mail inválido.";if(("select"===e.type||"multiselect"===e.type)&&e.options){let s=e.options.map(e=>e.value);if("string"==typeof t&&!s.includes(t))return"Opção inválida.";if(Array.isArray(t)){if(t.filter(e=>!s.includes(e)).length>0)return"Opção(ões) inválida(s).";if(a?.minItems&&t.length<a.minItems)return`Selecione no m\xednimo ${a.minItems} item(ns).`;if(a?.maxItems&&t.length>a.maxItems)return`Selecione no m\xe1ximo ${a.maxItems} item(ns).`}}return null}(e,l[e.id]);t&&(o[e.id]=t,e.required&&c.push(e))}if(c.length>0)return void e({fieldErrors:o,banner:{message:`Faltam ${c.length} campo(s) obrigat\xf3rio(s) para salvar e avan\xe7ar.`,variant:"warning"}});e({isSaving:!0});let d={};r.forEach(e=>{d[e.id]="saving"}),e({fieldSaveStates:d}),setTimeout(()=>{let t={};r.forEach(e=>{t[e.id]="saved"});let a=new Date().toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});e({fieldSaveStates:t,isSaving:!1,fieldErrors:{},banner:{message:`Salvo agora \xe0s ${a}`,variant:"success"}}),setTimeout(()=>{let t={};r.forEach(e=>{t[e.id]="idle"}),e({fieldSaveStates:t})},1400)},380)},updateOpportunityStage:(a,s)=>{let{opportunityId:n}=t();if(!n)return;e({isChangingStage:!0,banner:null});let i=s(a);setTimeout(()=>{if(!1===i)return void e({isChangingStage:!1,banner:{message:"Não consegui mudar a etapa. Tente novamente.",variant:"error"}});let{fieldDefinitions:s,fieldValues:r}=t(),l={...s};l[a]||(l[a]=(tE[a]||[]).filter(e=>e.isActive));let o=t_(n,a),c={...r};c[o]||(c[o]={}),e({opportunityStage:a,fieldDefinitions:l,fieldValues:c,fieldSaveStates:{},fieldErrors:{},isChangingStage:!1,banner:{message:"Etapa alterada. Preencha os campos para continuar.",variant:"success"}})},600)},advanceStage:(a,s)=>{let{opportunityId:n,opportunityStage:i,fieldDefinitions:r,fieldValues:l}=t();if(!n||!i)return;let o=r[i]||[],c=l[t_(n,i)]||{},d={},m=[];for(let e of o)e.required&&tV(c[e.id])&&(d[e.id]="Preencha este campo para avançar etapa.",m.push(e));m.length>0?e({fieldErrors:d,banner:{message:"Preencha os campos obrigatórios para avançar etapa.",variant:"warning"}}):!1!==s(a)&&e({opportunityStage:a,fieldSaveStates:{},fieldErrors:{},banner:null})},addFieldDefinition:(a,s)=>{let{fieldDefinitions:n}=t(),i=n[a]||[],r={...s,id:`sf-${a}-${Date.now()}`,stageId:a,order:i.length,isActive:!0},l=tE[a];l&&l.push(r),e({fieldDefinitions:{...n,[a]:[...i,r]},isNewFieldModalOpen:!1,banner:{message:`Campo "${r.label}" criado com sucesso.`,variant:"success"}})},setNewFieldModalOpen:t=>e({isNewFieldModalOpen:t}),setBanner:t=>e({banner:t}),reset:()=>e({opportunityId:null,opportunityStage:null,fieldSaveStates:{},fieldErrors:{},isSaving:!1,isLoadingFields:!1,isChangingStage:!1,loadError:null,banner:null,isNewFieldModalOpen:!1})}),{name:"stage-fields-store"}));function tH(){let e=tq(e=>e.opportunityStage),t=tq(e=>e.fieldDefinitions);return e?(t[e]||[]).sort((e,t)=>e.order-t.order):[]}function tU(){let e=tq(e=>e.opportunityId),t=tq(e=>e.opportunityStage),a=tq(e=>e.fieldValues);return e&&t&&a[t_(e,t)]||{}}function tW({field:e,value:a,onChange:n,disabled:i=!1,error:r,saveState:l="idle"}){return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-1.5 flex items-center justify-between gap-2",children:[(0,t.jsxs)(e0.Label,{className:"font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:[e.label," ",e.required&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),"saving"===l&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-[10px] text-zinc-400",children:[(0,t.jsx)(V.Loader2,{className:"h-3 w-3 animate-spin"}),"Salvando..."]}),"saved"===l&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-[10px] text-emerald-600",children:[(0,t.jsx)(z.Check,{className:"h-3 w-3"}),"Salvo"]}),"error"===l&&(0,t.jsx)("span",{className:"text-[10px] text-red-600",children:"Falha ao salvar"})]}),(0,t.jsx)("div",{className:"mt-1.5",children:function(e,a,n,i,r){let l=r?"border-red-300 focus:ring-red-200 focus-visible:ring-red-200":"",o=(0,ea.cn)("h-9 rounded-lg border-zinc-200 font-body text-xs focus:ring-brand/10",l);switch(e.type){case"select":return(0,t.jsxs)(tC.Select,{value:"string"==typeof a?a:"",onValueChange:e=>n(e),disabled:i,children:[(0,t.jsx)(tC.SelectTrigger,{className:(0,ea.cn)("h-9 w-full rounded-lg border-zinc-200 font-body text-xs focus:ring-brand/10",l),children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione..."})}),(0,t.jsx)(tC.SelectContent,{children:e.options?.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.value,className:"text-xs",children:e.label},e.value))})]});case"multiselect":{let r=Array.isArray(a)?a:[];return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:r.map(a=>{let l=e.options?.find(e=>e.value===a);return(0,t.jsxs)(eG.Badge,{variant:"secondary",className:"gap-1 rounded-full px-2 py-0.5 text-[10px]",children:[l?.label||a,!i&&(0,t.jsx)("button",{type:"button",onClick:()=>n(r.filter(e=>e!==a)),className:"ml-0.5 hover:text-red-600",children:(0,t.jsx)(s.X,{className:"h-2.5 w-2.5"})})]},a)})}),(0,t.jsxs)(tC.Select,{value:"",onValueChange:e=>{r.includes(e)||n([...r,e])},disabled:i,children:[(0,t.jsx)(tC.SelectTrigger,{className:(0,ea.cn)("h-9 w-full rounded-lg border-zinc-200 font-body text-xs focus:ring-brand/10",l),children:(0,t.jsx)(tC.SelectValue,{placeholder:"Adicionar..."})}),(0,t.jsx)(tC.SelectContent,{children:e.options?.filter(e=>!r.includes(e.value)).map(e=>(0,t.jsx)(tC.SelectItem,{value:e.value,className:"text-xs",children:e.label},e.value))})]})]})}case"textarea":return(0,t.jsx)(tz.Textarea,{value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),className:(0,ea.cn)("min-h-[86px] resize-none rounded-lg border border-zinc-200 px-3 py-2 text-xs placeholder:text-zinc-400 focus-visible:ring-2 focus-visible:ring-brand/10",l),placeholder:e.placeholder,disabled:i});case"boolean":return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(e5.Switch,{checked:!!a,onCheckedChange:e=>n(e),disabled:i}),(0,t.jsx)("span",{className:"text-xs text-zinc-600",children:a?"Sim":"Não"})]});case"currency":return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-zinc-400",children:"R$"}),(0,t.jsx)(eJ.Input,{type:"text",inputMode:"decimal",value:null!=a?String(a):"",onChange:e=>{n(e.target.value.replace(/[^\d.,]/g,""))},placeholder:e.placeholder||"0,00",className:(0,ea.cn)(o,"pl-9"),disabled:i})]});case"percentage":return(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eJ.Input,{type:"number",inputMode:"decimal",value:null!=a?String(a):"",onChange:e=>n(e.target.value?Number(e.target.value):null),placeholder:e.placeholder||"0",className:(0,ea.cn)(o,"pr-8"),disabled:i,min:e.validationRules?.min,max:e.validationRules?.max}),(0,t.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-zinc-400",children:"%"})]});case"url":return(0,t.jsx)(eJ.Input,{type:"url",value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),placeholder:e.placeholder||"https://...",className:o,disabled:i});case"email":return(0,t.jsx)(eJ.Input,{type:"email",value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),placeholder:e.placeholder||"email@exemplo.com",className:o,disabled:i});case"phone":return(0,t.jsx)(eJ.Input,{type:"tel",value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),placeholder:e.placeholder||"(00) 00000-0000",className:o,disabled:i});case"date":return(0,t.jsx)(eJ.Input,{type:"date",value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),className:o,disabled:i});case"time":return(0,t.jsx)(eJ.Input,{type:"time",value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),className:o,disabled:i});case"datetime":return(0,t.jsx)(eJ.Input,{type:"datetime-local",value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),className:o,disabled:i});case"integer":return(0,t.jsx)(eJ.Input,{type:"number",inputMode:"numeric",step:"1",value:null!=a?String(a):"",onChange:e=>n(e.target.value?parseInt(e.target.value,10):null),placeholder:e.placeholder,className:o,disabled:i});case"number":return(0,t.jsx)(eJ.Input,{type:"number",inputMode:"decimal",value:null!=a?String(a):"",onChange:e=>n(e.target.value?Number(e.target.value):null),placeholder:e.placeholder,className:o,disabled:i});case"file":return(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsx)(eJ.Input,{type:"file",onChange:()=>n("arquivo_anexado"),className:(0,ea.cn)(o,"cursor-pointer file:mr-2 file:rounded-md file:border-0 file:bg-zinc-100 file:px-2 file:py-1 file:text-[10px] file:font-medium file:text-zinc-700"),disabled:i})});case"user":case"contact":return(0,t.jsx)(eJ.Input,{type:"text",value:"string"==typeof a?a:"",onChange:e=>n(e.target.value),placeholder:e.placeholder||("user"===e.type?"Nome do usuário":"Nome do contato"),className:o,disabled:i});default:return(0,t.jsx)(eJ.Input,{type:"text",value:"string"==typeof a?a:null!=a?String(a):"",onChange:e=>n(e.target.value),placeholder:e.placeholder,className:o,disabled:i})}}(e,a,t=>{n(e.id,t)},i,r)}),r&&(0,t.jsx)("p",{className:"mt-1 text-[10px] text-red-600",children:r}),!r&&e.helperText&&(0,t.jsx)("p",{className:"mt-1 text-[9px] text-zinc-400",children:e.helperText}),!r&&e.description&&!e.helperText&&(0,t.jsx)("p",{className:"mt-1 text-[9px] text-zinc-400",children:e.description})]})}let tG=(0,c.default)("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),tX=(0,c.default)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]]),tY=(0,c.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var tQ=e.i(70956),tZ=e.i(56272);let tK=(0,c.default)("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),tJ=(0,c.default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),t0=(0,c.default)("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var t1=e.i(86536);let t2=(0,c.default)("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]),t5=["select","multiselect"],t3={text:tX,textarea:tK,number:tY,integer:tY,currency:m.DollarSign,percentage:t0,url:tJ,email:l.Mail,phone:n.Phone,date:o.Calendar,datetime:o.Calendar,time:p.Clock,select:tQ.List,multiselect:tZ.CheckSquare,boolean:t2,user:u.User,contact:x.Users,file:T.FileText};function t4({open:e,onOpenChange:n,stageId:i,stageName:r,onSave:l}){let[o,c]=(0,a.useState)(""),[d,m]=(0,a.useState)("text"),[u,x]=(0,a.useState)(!1),[h,p]=(0,a.useState)(!1),[g,b]=(0,a.useState)(""),[f,v]=(0,a.useState)(""),[j,N]=(0,a.useState)([]),[w,S]=(0,a.useState)(""),[C,k]=(0,a.useState)({}),[M,I]=(0,a.useState)(!1),[D,A]=(0,a.useState)({}),T=t5.includes(d),R=(0,a.useMemo)(()=>o.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"_").replace(/^_|_$/g,""),[o]),P=(0,a.useMemo)(()=>({id:"preview",stageId:i,key:R||"preview",label:o||"Nome do campo",type:d,required:h,order:0,description:g,placeholder:f,options:T?j:void 0,validationRules:Object.keys(C).length>0?C:void 0,isActive:!0}),[o,d,h,g,f,j,C,i,R,T]),E=()=>{let e=w.trim();if(!e)return;let t=e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"_");j.some(e=>e.value===t)||(N([...j,{label:e,value:t}]),S(""))},L=()=>{c(""),m("text"),p(!1),b(""),v(""),N([]),S(""),k({}),A({})},O=e=>{e||L(),n(e)},B=t3[d]||tX;return(0,t.jsx)(tM.Dialog,{open:e,onOpenChange:O,children:(0,t.jsxs)(tM.DialogContent,{className:"max-h-[90vh] w-full sm:max-w-4xl flex-col gap-0 p-0 overflow-hidden bg-white border-zinc-200/50 shadow-2xl sm:rounded-2xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-100 bg-white/50 px-6 py-4 backdrop-blur-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-brand/5 border border-brand/10 text-brand shadow-sm",children:(0,t.jsx)(y.Plus,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(tM.DialogTitle,{className:"text-base font-semibold text-zinc-900",children:"Novo Campo Personalizado"}),(0,t.jsxs)("p",{className:"text-xs text-zinc-500",children:["Adicionando em ",(0,t.jsx)("span",{className:"font-medium text-zinc-700",children:r})]})]})]}),(0,t.jsx)(tM.DialogClose,{asChild:!0,children:(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-zinc-400 hover:text-zinc-600",children:(0,t.jsx)(s.X,{className:"h-4 w-4"})})})]}),(0,t.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6 lg:p-10 scrollbar-thin scrollbar-thumb-zinc-200 scrollbar-track-transparent",children:(0,t.jsxs)("div",{className:"space-y-10 max-w-2xl mx-auto",children:[(0,t.jsxs)("section",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-semibold text-zinc-900",children:"Informações Básicas"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500 mt-0.5",children:"Defina o nome principal e o formato de dados que este campo irá receber no card."})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(e0.Label,{className:"text-sm font-semibold text-zinc-900 flex items-center gap-1.5",children:["Nome do Campo ",(0,t.jsx)("span",{className:"text-red-500 text-xs",children:"*"})]}),(0,t.jsx)(eJ.Input,{value:o,onChange:e=>{c(e.target.value),D.label&&A(e=>{let t={...e};return delete t.label,t})},placeholder:"Ex: Data de follow-up",className:(0,ea.cn)("h-10 bg-white transition-all hover:bg-zinc-50 focus:bg-white text-sm shadow-sm",D.label?"border-red-300 focus-visible:ring-red-100":"border-zinc-200 focus-visible:ring-brand/15")}),D.label?(0,t.jsxs)("p",{className:"flex items-center gap-1.5 text-[11px] font-medium text-red-600 mt-1",children:[(0,t.jsx)(eW.AlertCircle,{className:"h-3.5 w-3.5"})," ",D.label]}):R&&(0,t.jsxs)("p",{className:"text-[11px] text-zinc-400 font-mono mt-1",children:["ID interno: ",R]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(e0.Label,{className:"text-sm font-semibold text-zinc-900 flex items-center gap-1.5",children:["Tipo de Dado ",(0,t.jsx)("span",{className:"text-red-500 text-xs",children:"*"})]}),(0,t.jsxs)(tO.Popover,{open:u,onOpenChange:x,children:[(0,t.jsx)(tO.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(es.Button,{variant:"outline",role:"combobox","aria-expanded":u,className:"w-full justify-between h-auto py-2.5 px-3.5 bg-white border-zinc-200 focus:ring-brand/15 transition-all hover:bg-zinc-50 hover:border-zinc-300 font-normal shadow-sm group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 text-left",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-zinc-50 border border-zinc-200 shadow-xs text-zinc-600 group-hover:text-brand transition-colors",children:(0,t.jsx)(B,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:tR[d]}),(0,t.jsx)("span",{className:"text-xs text-zinc-500 truncate",children:tP[d]})]})]}),(0,t.jsx)(tG,{className:"ml-2 h-4 w-4 shrink-0 opacity-50 text-zinc-500"})]})}),(0,t.jsx)(tO.PopoverContent,{className:"w-(--radix-popover-trigger-width) p-0 shadow-xl border-zinc-200/80 rounded-xl",align:"start",children:(0,t.jsxs)(tB.Command,{className:"max-h-[380px]",children:[(0,t.jsx)(tB.CommandInput,{placeholder:"Buscar tipo de campo...",className:"h-10 text-sm"}),(0,t.jsxs)(tB.CommandList,{className:"max-h-[330px] scrollbar-thin scrollbar-thumb-zinc-200",children:[(0,t.jsx)(tB.CommandEmpty,{className:"py-6 text-center text-sm text-zinc-500",children:"Nenhum tipo encontrado."}),(0,t.jsx)(tB.CommandGroup,{heading:"Texto e Números",className:"px-1.5 pt-1.5 pb-0",children:["text","textarea","number","currency","percentage","integer"].map(e=>{let a=t3[e];return(0,t.jsxs)(tB.CommandItem,{value:`${tR[e]} ${tP[e]}`,onSelect:()=>{m(e),N([]),k({}),x(!1)},className:"flex items-start gap-3 rounded-md px-2 py-2 cursor-pointer mb-1 data-[selected=true]:bg-zinc-100/80",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-white border border-zinc-200/60 shadow-xs text-zinc-500 mt-0.5",children:(0,t.jsx)(a,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:tR[e]}),(0,t.jsx)("span",{className:"text-xs text-zinc-500 leading-tight",children:tP[e]})]}),d===e&&(0,t.jsx)(z.Check,{className:"ml-auto h-4 w-4 text-brand mt-2"})]},e)})}),(0,t.jsx)(tB.CommandGroup,{heading:"Seleção",className:"px-1.5 py-0",children:["select","multiselect","boolean","date","datetime"].map(e=>{let a=t3[e];return(0,t.jsxs)(tB.CommandItem,{value:`${tR[e]} ${tP[e]}`,onSelect:()=>{m(e),N([]),k({}),x(!1)},className:"flex items-start gap-3 rounded-md px-2 py-2 cursor-pointer mb-1 data-[selected=true]:bg-zinc-100/80",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-white border border-zinc-200/60 shadow-xs text-zinc-500 mt-0.5",children:(0,t.jsx)(a,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:tR[e]}),(0,t.jsx)("span",{className:"text-xs text-zinc-500 leading-tight",children:tP[e]})]}),d===e&&(0,t.jsx)(z.Check,{className:"ml-auto h-4 w-4 text-brand mt-2"})]},e)})}),(0,t.jsx)(tB.CommandGroup,{heading:"Contato e Especial",className:"px-1.5 pb-1.5 pt-0",children:["email","phone","url","file"].map(e=>{let a=t3[e];return(0,t.jsxs)(tB.CommandItem,{value:`${tR[e]} ${tP[e]}`,onSelect:()=>{m(e),N([]),k({}),x(!1)},className:"flex items-start gap-3 rounded-md px-2 py-2 cursor-pointer mb-1 data-[selected=true]:bg-zinc-100/80",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-white border border-zinc-200/60 shadow-xs text-zinc-500 mt-0.5",children:(0,t.jsx)(a,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:tR[e]}),(0,t.jsx)("span",{className:"text-xs text-zinc-500 leading-tight",children:tP[e]})]}),d===e&&(0,t.jsx)(z.Check,{className:"ml-auto h-4 w-4 text-brand mt-2"})]},e)})})]})]})})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-xl border border-zinc-200 bg-zinc-50/50 hover:bg-zinc-50 transition-colors",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(e0.Label,{className:"text-sm font-semibold text-zinc-900 cursor-pointer",htmlFor:"required-switch",children:"Campo Obrigatório"}),(0,t.jsx)(eG.Badge,{variant:"secondary",className:"h-5 px-1.5 text-[10px] font-semibold text-brand bg-brand/5 border-brand/20 uppercase tracking-wider hidden sm:inline-flex",children:"Required"})]}),(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:"O card não avançará para a próxima etapa se este campo estiver vazio."})]}),(0,t.jsx)(e5.Switch,{id:"required-switch",checked:h,onCheckedChange:p,className:"data-[state=checked]:bg-brand"})]})]})]}),(0,t.jsx)("hr",{className:"border-t border-zinc-100"}),(0,t.jsxs)("section",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-base font-semibold text-zinc-900",children:"Aparência e Configuração"}),(0,t.jsx)("p",{className:"text-sm text-zinc-500 mt-0.5",children:"Ajuste como o campo será exibido e preenchido pela equipe."})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[T&&(0,t.jsxs)("div",{className:"space-y-4 pb-6 border-b border-zinc-100/80",children:[(0,t.jsxs)(e0.Label,{className:"text-sm font-semibold text-zinc-900 flex items-center gap-1.5",children:["Opções de seleção ",(0,t.jsx)("span",{className:"text-red-500 text-xs",children:"*"})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(eJ.Input,{value:w,onChange:e=>S(e.target.value),placeholder:"Digite uma opção e pressione Enter",className:"h-10 flex-1 bg-white border-zinc-200 focus:ring-brand/15 text-sm shadow-sm transition-all",onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),E())}}),(0,t.jsxs)(es.Button,{type:"button",size:"sm",variant:"secondary",onClick:E,disabled:!w.trim(),className:"h-10 px-4 bg-zinc-100 text-zinc-700 hover:bg-zinc-200 shadow-sm transition-all",children:[(0,t.jsx)(y.Plus,{className:"mr-1.5 h-4 w-4"})," Adicionar"]})]}),(0,t.jsx)("div",{className:"min-h-[60px] rounded-xl border border-dashed border-zinc-200 bg-zinc-50/50 p-3 transition-colors",children:j.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:j.map(e=>(0,t.jsxs)(eG.Badge,{variant:"outline",className:"gap-1.5 rounded-lg px-2.5 py-1.5 text-xs font-semibold border-zinc-200/80 bg-white text-zinc-700 shadow-sm hover:border-zinc-300 transition-colors",children:[e.label,(0,t.jsx)("button",{type:"button",onClick:()=>{var t;return t=e.value,void N(j.filter(e=>e.value!==t))},className:"ml-1 rounded-full p-0.5 text-zinc-400 hover:bg-red-50 hover:text-red-600 transition-colors",children:(0,t.jsx)(s.X,{className:"h-3.5 w-3.5"})})]},e.value))}):(0,t.jsx)("div",{className:"flex h-full items-center justify-center py-4 text-sm font-medium text-zinc-400",children:"Nenhuma opção adicionada ainda."})}),D.options&&(0,t.jsx)("p",{className:"text-[11px] font-medium text-red-600 mt-1",children:D.options})]}),(0,t.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"text-sm font-semibold text-zinc-900",children:"Placeholder"}),(0,t.jsx)(eJ.Input,{value:f,onChange:e=>v(e.target.value),placeholder:"Texto de fundo vazio",className:"h-10 bg-white border-zinc-200 focus:ring-brand/15 text-sm shadow-sm transition-all"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"text-sm font-semibold text-zinc-900",children:"Texto de Ajuda"}),(0,t.jsx)(eJ.Input,{value:g,onChange:e=>b(e.target.value),placeholder:"Dica exibida abaixo do campo",className:"h-10 bg-white border-zinc-200 focus:ring-brand/15 text-sm shadow-sm transition-all"})]})]})]})]})]})}),(0,t.jsxs)("div",{className:"w-80 border-l border-zinc-100 bg-zinc-50/50 hidden md:flex flex-col",children:[(0,t.jsx)("div",{className:"p-4 border-b border-zinc-100 bg-white/50",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,t.jsx)(t1.Eye,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider",children:"Pré-visualização"})]})}),(0,t.jsxs)("div",{className:"flex-1 p-6 flex flex-col items-center justify-center",children:[(0,t.jsxs)("div",{className:"w-full space-y-2 rounded-xl border border-zinc-200 bg-white p-4 shadow-sm",children:[(0,t.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,t.jsx)("span",{className:"text-[10px] text-zinc-400 font-medium",children:"Como aparecerá no card"})}),(0,t.jsx)(tW,{field:P,value:null,onChange:()=>{},disabled:!1})]}),(0,t.jsx)("p",{className:"mt-4 text-center text-[10px] text-zinc-400 max-w-[200px]",children:"Esta é uma representação visual de como o campo será exibido para sua equipe."})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between border-t border-zinc-100 bg-white px-6 py-4",children:[(0,t.jsx)(es.Button,{variant:"ghost",type:"button",onClick:()=>O(!1),className:"text-zinc-500 hover:text-zinc-900",children:"Cancelar"}),(0,t.jsxs)(es.Button,{onClick:()=>{let e;e={},o.trim()||(e.label="Nome do campo é obrigatório."),d||(e.type="Tipo é obrigatório."),T&&0===j.length&&(e.options="Adicione pelo menos uma opção."),A(e),0===Object.keys(e).length&&(I(!0),setTimeout(()=>{l({key:R,label:o.trim(),type:d,required:h,description:g.trim()||void 0,placeholder:f.trim()||void 0,helperText:g.trim()||void 0,options:T?j:void 0}),L(),I(!1)},500))},disabled:M,className:"bg-zinc-900 text-white hover:bg-black shadow-lg shadow-zinc-900/10 min-w-[140px]",children:[M?(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(y.Plus,{className:"mr-2 h-4 w-4"}),"Criar campo"]})]})]})})}function t6({banner:e,onDismiss:s}){(0,a.useEffect)(()=>{if("success"===e.variant||"info"===e.variant){let e=setTimeout(s,3e3);return()=>clearTimeout(e)}},[e,s]);let n={success:(0,t.jsx)(z.Check,{className:"h-3.5 w-3.5 shrink-0"}),error:(0,t.jsx)(P.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"}),info:(0,t.jsx)(O.Activity,{className:"h-3.5 w-3.5 shrink-0"}),warning:(0,t.jsx)(P.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"})};return(0,t.jsxs)("div",{className:`flex items-center gap-2 rounded-[10px] border px-3 py-2 font-body text-xs font-medium animate-in fade-in slide-in-from-top-1 duration-200 ${{success:"bg-status-success/10 text-status-success border-status-success/20",error:"bg-status-danger/10 text-status-danger border-status-danger/20",info:"bg-brand/10 text-brand border-brand/20",warning:"bg-status-warning/10 text-status-warning border-status-warning/20"}[e.variant]}`,role:"error"===e.variant?"alert":"status","aria-live":"error"===e.variant?"assertive":"polite",children:[n[e.variant],(0,t.jsx)("span",{className:"flex-1",children:e.message}),(0,t.jsx)("button",{onClick:s,className:"ml-auto shrink-0 opacity-70 hover:opacity-100","aria-label":"Fechar",children:"×"})]})}function t7({title:e,description:a,headerAction:s,children:n}){return(0,t.jsxs)(ee.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.25,delay:.1},className:"rounded-2xl border border-zinc-200/80 bg-white p-5 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-4 flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-zinc-100 text-zinc-600",children:(0,t.jsx)(tL,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:e}),(0,t.jsx)("p",{className:"text-[11px] text-zinc-500",children:a})]})]}),s]}),(0,t.jsx)("div",{className:"space-y-4",children:n})]})}function t8({opportunityId:e,currentStage:s,stages:n,initialValues:i,isLocked:r,onStageChange:l,canCreateFields:o=!1,advanceBlockedReason:c=null}){let d,m,u,x,h=tq(),p=tH(),g=tU(),b=(d=tH(),m=tU(),x=(u=d.filter(e=>e.required)).filter(e=>!tV(m[e.id])),{total:u.length,completed:x.length,missing:u.length-x.length,missingFields:u.filter(e=>tV(m[e.id]))});(0,a.useEffect)(()=>{h.initForOpportunity(e,s,i)},[e,s]),(0,a.useEffect)(()=>{h.opportunityStage!==s&&h.initForOpportunity(e,s,i)},[s]);let f=(0,a.useCallback)((e,t)=>{r||h.isChangingStage||h.updateFieldValue(e,t)},[r,h]),v=(0,a.useCallback)(()=>{r||h.saveAllFields()},[r,h]),j=(0,a.useCallback)(e=>{h.opportunityStage&&h.addFieldDefinition(h.opportunityStage,e)},[h]),N=(0,a.useMemo)(()=>n.find(e=>e.id===h.opportunityStage)?.label??"Etapa",[n,h.opportunityStage]),w=(0,a.useMemo)(()=>p.filter(e=>e.required),[p]),S=(0,a.useMemo)(()=>p.filter(e=>!e.required),[p]),C=!r&&!h.isChangingStage,k=!!(c&&c.trim().length>0);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"sticky top-4",children:(0,t.jsxs)(t7,{title:"Campos da etapa",description:"Preencha para destravar avanço e fechamento.",headerAction:(0,t.jsx)(eG.Badge,{variant:"outline",className:"rounded-full border-zinc-200 bg-zinc-50 text-[11px] text-zinc-700",children:N}),children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsxs)(tO.Popover,{children:[(0,t.jsxs)("div",{className:"group relative w-full",children:[(0,t.jsx)("div",{className:"absolute -top-2 left-2 z-10 bg-white px-1 text-[10px] font-semibold tracking-wide text-zinc-500",children:"Etapa atual"}),(0,t.jsx)(tO.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(es.Button,{variant:"outline",role:"combobox",className:"h-11 w-full justify-between rounded-xl border-zinc-200 bg-white px-3 font-normal text-zinc-900 shadow-sm transition-all hover:border-brand/40 hover:bg-zinc-50 focus:border-brand/40 focus:ring-2 focus:ring-brand/10 disabled:opacity-70",disabled:h.isChangingStage,children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[h.isChangingStage?(0,t.jsx)(V.Loader2,{className:"h-4 w-4 animate-spin text-brand"}):(0,t.jsx)("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-brand/10 text-brand",children:(0,t.jsx)(O.Activity,{className:"h-3 w-3"})}),(0,t.jsx)("span",{className:"text-sm font-semibold",children:h.isChangingStage?"Alterando etapa...":N})]}),(0,t.jsx)(L.ChevronDown,{className:"h-4 w-4 opacity-50"})]})})]}),(0,t.jsx)(tO.PopoverContent,{className:"w-[280px] p-0 rounded-2xl shadow-xl border-zinc-100",align:"start",children:(0,t.jsx)(tB.Command,{children:(0,t.jsxs)(tB.CommandList,{className:"max-h-[300px] p-1.5",children:[(0,t.jsx)("div",{className:"px-2 py-1.5 text-[10px] font-semibold uppercase tracking-wider text-zinc-400",children:"Alterar etapa da oportunidade"}),(0,t.jsx)(tB.CommandGroup,{children:n.map((e,a)=>{let s=e.id===h.opportunityStage,i=n.findIndex(e=>e.id===h.opportunityStage);return(0,t.jsxs)(tB.CommandItem,{value:e.label,onSelect:()=>{s||h.updateOpportunityStage(e.id,l)},className:(0,ea.cn)("group flex items-center gap-3 rounded-xl px-3 py-2.5 text-xs transition-colors cursor-pointer",s?"bg-zinc-50":"hover:bg-zinc-50"),children:[(0,t.jsx)("div",{className:(0,ea.cn)("flex h-2 w-2 shrink-0 rounded-full",a<i?"bg-brand/40":s?"bg-brand ring-2 ring-brand/20":"bg-zinc-200")}),(0,t.jsx)("span",{className:(0,ea.cn)("flex-1 truncate font-medium",s?"text-zinc-900":"text-zinc-600"),children:e.label}),s&&(0,t.jsx)(eG.Badge,{variant:"secondary",className:"ml-auto h-5 rounded-full bg-brand/10 px-1.5 text-[9px] font-semibold text-brand",children:"Atual"})]},e.id)})})]})})})]})}),o&&(0,t.jsxs)(es.Button,{size:"sm",className:"h-11 rounded-xl bg-zinc-900 px-4 text-sm font-medium text-white shadow-sm transition-all hover:bg-black hover:shadow-md",onClick:()=>h.setNewFieldModalOpen(!0),children:[(0,t.jsx)(y.Plus,{className:"mr-1.5 h-4 w-4"}),"Novo campo"]})]}),(0,t.jsx)(et.AnimatePresence,{children:h.banner&&(0,t.jsx)(ee.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:(0,t.jsx)(t6,{banner:h.banner,onDismiss:()=>h.setBanner(null)})})}),b.missingFields.length>0&&!h.isChangingStage&&(0,t.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold text-amber-700",children:"Pendências para avanço"}),(0,t.jsx)("ul",{className:"mt-1 space-y-1 text-[11px] text-amber-700",children:b.missingFields.map(e=>(0,t.jsxs)("li",{children:["• ",e.label]},e.id))})]}),k&&!h.isChangingStage&&(0,t.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold text-amber-700",children:"Avanço bloqueado"}),(0,t.jsx)("p",{className:"mt-1 text-[11px] text-amber-700",children:c})]}),p.length>0?(0,t.jsxs)("div",{className:"space-y-4",children:[w.map(e=>(0,t.jsx)(tW,{field:e,value:g[e.id],onChange:f,disabled:!C,error:h.fieldErrors[e.id],saveState:h.fieldSaveStates[e.id]||"idle"},e.id)),S.length>0&&w.length>0&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-px flex-1 bg-zinc-100"}),(0,t.jsx)("span",{className:"text-[9px] font-medium uppercase tracking-wider text-zinc-400",children:"Opcionais"}),(0,t.jsx)("div",{className:"h-px flex-1 bg-zinc-100"})]}),S.map(e=>(0,t.jsx)(tW,{field:e,value:g[e.id],onChange:f,disabled:!C,error:h.fieldErrors[e.id],saveState:h.fieldSaveStates[e.id]||"idle"},e.id))]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-xl border border-dashed border-zinc-200 bg-zinc-50/50 py-8 text-center",children:[(0,t.jsx)(tL,{className:"mb-2 h-8 w-8 text-zinc-200"}),(0,t.jsx)("p",{className:"font-heading text-xs font-medium text-zinc-400",children:"Esta etapa não possui campos configurados"}),o&&(0,t.jsxs)(es.Button,{size:"sm",variant:"outline",className:"mt-3 h-7 rounded-full px-3 text-[10px]",onClick:()=>h.setNewFieldModalOpen(!0),children:[(0,t.jsx)(y.Plus,{className:"mr-1 h-3 w-3"}),"Criar primeiro campo"]})]}),(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,t.jsxs)(es.Button,{size:"sm",variant:"outline",className:"h-9 rounded-xl px-4 text-xs font-semibold shadow-sm hover:bg-zinc-50 hover:text-zinc-900",onClick:v,disabled:r||h.isSaving||h.isChangingStage||0===p.length,children:[h.isSaving?(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,t.jsx)(z.Check,{className:"mr-1.5 h-3.5 w-3.5"}),h.isSaving?"Salvando...":"Salvar campos"]})})]})}),(0,t.jsx)(t4,{open:h.isNewFieldModalOpen,onOpenChange:h.setNewFieldModalOpen,stageId:h.opportunityStage||"",stageName:N,onSave:j})]})}var t9=e.i(55900),ae=e.i(40160),at=e.i(49685),aa=e.i(14764),as=e.i(95468),an=e.i(73884);let ai=(0,c.default)("git-compare-arrows",[["circle",{cx:"5",cy:"6",r:"3",key:"1qnov2"}],["path",{d:"M12 6h5a2 2 0 0 1 2 2v7",key:"1yj91y"}],["path",{d:"m15 9-3-3 3-3",key:"1lwv8l"}],["circle",{cx:"19",cy:"18",r:"3",key:"1qljk2"}],["path",{d:"M12 18H7a2 2 0 0 1-2-2V9",key:"16sdep"}],["path",{d:"m9 15 3 3-3 3",key:"1m3kbl"}]]);var ar=e.i(59208);let al=(0,c.default)("badge-check",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var ao=e.i(26076);let ac=[{id:"u1",name:"Maria Silva"},{id:"u2",name:"Pedro Santos"},{id:"u3",name:"Julia Fernandes"}],ad={proposal:{label:"Proposta",badgeClass:"border-blue-200 bg-blue-50 text-blue-700",icon:T.FileText},counter:{label:"Contra proposta",badgeClass:"border-amber-200 bg-amber-50 text-amber-700",icon:R.ArrowRight},internal:{label:"Ajuste interno",badgeClass:"border-zinc-200 bg-zinc-100 text-zinc-700",icon:at.Handshake},agreement:{label:"Fechamento",badgeClass:"border-emerald-200 bg-emerald-50 text-emerald-700",icon:al}},am={draft:{label:"Rascunho",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-600"},sent:{label:"Enviada",chipClass:"border-sky-200 bg-sky-50 text-sky-700"},awaiting:{label:"Aguardando cliente",chipClass:"border-violet-200 bg-violet-50 text-violet-700"},accepted:{label:"Aceita",chipClass:"border-emerald-200 bg-emerald-50 text-emerald-700"},rejected:{label:"Rejeitada",chipClass:"border-red-200 bg-red-50 text-red-700"}},au={client:{label:"Visível ao cliente",chipClass:"border-zinc-200 bg-zinc-50 text-zinc-600"},internal:{label:"Interna",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-500"}},ax=[{id:"call",label:"Ligação"},{id:"whatsapp",label:"WhatsApp"},{id:"email",label:"E-mail"},{id:"meeting",label:"Reunião"},{id:"visit",label:"Visita"}],ah=[{id:"proposal",label:"Proposta do time"},{id:"counter",label:"Contra proposta do cliente"},{id:"internal",label:"Ajuste interno"},{id:"agreement",label:"Fechamento"}],ap=[{id:"draft",label:"Rascunho"},{id:"sent",label:"Enviada ao cliente"},{id:"awaiting",label:"Aguardando resposta"},{id:"accepted",label:"Aceita"},{id:"rejected",label:"Rejeitada"}],ag=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),ab=e=>{if(!e)return"Sem data";let t=new Date(e);return Number.isNaN(t.getTime())?"Sem data":eF(t,"dd MMM, HH:mm",{locale:eH})},af=e=>{let t=Number(e);return Number.isNaN(t)?0:t},av=e=>"proposal"===e||"counter"===e||"agreement"===e,aj=e=>("proposal"===e.type||"agreement"===e.type)&&"team"===e.actorRole&&"client"===e.visibility,ay=e=>{if("u1"!==e.authorId||"draft"!==e.lifecycleStatus)return!1;let t=new Date(e.createdAt).getTime();return!Number.isNaN(t)&&Date.now()-t<=864e5},aN=e=>ay(e)&&!e.isFinal,aw=()=>new Date().toISOString();function aS(e){let t=[...e].sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),a=[...t].reverse().find(e=>aj(e)&&"accepted"===e.lifecycleStatus);if(a)return a.id;let s=[...t].reverse().find(e=>aj(e)&&("sent"===e.lifecycleStatus||"awaiting"===e.lifecycleStatus));return s?.id??null}function aC(e){return e?{type:e.type,actorRole:e.actorRole,visibility:e.visibility,lifecycleStatus:e.lifecycleStatus,monthlyValue:String(e.monthlyValue??""),setupValue:String(e.setupValue??""),termMonths:String(e.termMonths??12),notes:e.details??"",conditionsText:e.conditions.join(", "),rejectedReason:e.rejectedReason??""}:{type:"proposal",actorRole:"team",visibility:"client",lifecycleStatus:"draft",monthlyValue:"",setupValue:"",termMonths:"12",notes:"",conditionsText:"",rejectedReason:""}}function az({dealId:e,dealTitle:s}){let n=(0,a.useMemo)(()=>ao.mockNegotiationRounds.map(e=>"counter"===e.type?{...e,actorRole:"client",visibility:"client",lifecycleStatus:"awaiting",sentAt:e.createdAt}:"internal"===e.type?{...e,actorRole:"team",visibility:"internal",lifecycleStatus:"draft"}:"agreement"===e.type?{...e,actorRole:"team",visibility:"client",lifecycleStatus:"accepted",sentAt:e.createdAt,acceptedAt:e.createdAt,isFinal:!0}:{...e,actorRole:"team",visibility:"client",lifecycleStatus:"sent",sentAt:e.createdAt}),[]),[i,r]=(0,a.useState)(n),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)("create"),[m,u]=(0,a.useState)(aC()),[x,h]=(0,a.useState)(null),[p,g]=(0,a.useState)(!1),[b,f]=(0,a.useState)(null),[v,j]=(0,a.useState)(aS(n)),[N,w]=(0,a.useState)({}),[S,C]=(0,a.useState)(null),[z,k]=(0,a.useState)(!1),[M,I]=(0,a.useState)(null),[D,A]=(0,a.useState)(null),[T,R]=(0,a.useState)({action:"Validar retorno do cliente sobre a proposta vigente",dueAt:"",channel:"whatsapp",ownerId:"u1"}),[P,E]=(0,a.useState)("idle"),[L,O]=(0,a.useState)(null),[B,F]=(0,a.useState)(null),[$,_]=(0,a.useState)(!1),H=(0,a.useMemo)(()=>[...i].sort((e,t)=>new Date(e.createdAt).getTime()-new Date(t.createdAt).getTime()),[i]),U=(0,a.useMemo)(()=>H.find(e=>e.id===v)??null,[H,v]),W=(0,a.useMemo)(()=>{if(!U)return null;let e=H.findIndex(e=>e.id===U.id);return e>=0?e+1:null},[U,H]),G=(0,a.useMemo)(()=>(function(e){if(!e||!av(e.type))return null;let t=e.monthlyValue??0,a=e.setupValue??0,s=e.termMonths??12;return{sourceRoundId:e.id,monthlyValue:t,setupValue:a,termMonths:s,totalValue:t*s+a,updatedAt:e.updatedAt??e.createdAt,updatedBy:e.authorName,sourceStatus:e.lifecycleStatus,sourceVisibility:e.visibility}})(U),[U]),X=(0,a.useMemo)(()=>[...H].reverse().find(e=>aj(e))??null,[H]),Y=(0,a.useMemo)(()=>[...H].reverse().find(e=>"counter"===e.type)??null,[H]),Q=(0,a.useMemo)(()=>(function(e,t){if(0===e.length)return{label:"Não iniciada",description:"Nenhuma rodada registrada até agora.",tone:"neutral"};if(e.find(e=>"accepted"===e.lifecycleStatus))return{label:"Aceita",description:"Rodada aceita pelo cliente. Pronta para fechamento.",tone:"success"};let a=e.find(e=>e.id===t);return a?.lifecycleStatus==="awaiting"||a?.lifecycleStatus==="sent"?{label:"Aguardando cliente",description:`Aguardando resposta da rodada vigente enviada em ${ab(a.sentAt)}.`,tone:"warning"}:{label:"Em negociação",description:"Negociação ativa com ajustes internos e respostas em andamento.",tone:"info"}})(H,v),[H,v]),Z=async(e,t,a,s)=>{w(a=>({...a,[e]:t}));try{await new Promise(e=>setTimeout(e,220)),a()}catch{C({type:"error",message:s})}finally{w(t=>({...t,[e]:null}))}},K=e=>{C(e),window.setTimeout(()=>C(null),2200)},en=e=>{F(e),window.setTimeout(()=>{F(t=>t===e?null:t)},1800)},ei=e=>{let t=aC(e??void 0);d("create"),h(null),f(null),u({...t,type:e?.type==="counter"?"proposal":t.type,actorRole:"team",visibility:e?.visibility==="internal"?"client":t.visibility,lifecycleStatus:"draft",rejectedReason:""}),o(!0)},er=e=>{ay(e)?(d("edit"),h(e.id),f(null),u(aC(e)),o(!0)):K({type:"warning",message:"Você só pode editar rodadas próprias em rascunho dentro da janela de 24h."})},el=()=>{o(!1),f(null),h(null),u(aC())},eo=async t=>{g(!0),f(null);try{if(await new Promise(e=>setTimeout(e,250)),"edit"===c&&x)r(e=>e.map(e=>{let a,s,n;if(e.id!==x)return e;let i=(a=t.monthlyValue,s=t.setupValue,n=t.termMonths,a*n+s);return{...e,type:t.type,actorRole:t.actorRole,visibility:t.visibility,lifecycleStatus:t.lifecycleStatus,monthlyValue:t.monthlyValue,setupValue:t.setupValue,termMonths:t.termMonths,totalValue:i,conditions:t.conditions,details:t.notes,rejectedReason:"rejected"===t.lifecycleStatus?t.rejectedReason:void 0,sentAt:"sent"===t.lifecycleStatus||"awaiting"===t.lifecycleStatus||"accepted"===t.lifecycleStatus?e.sentAt??aw():void 0,acceptedAt:"accepted"===t.lifecycleStatus?e.acceptedAt??aw():void 0,rejectedAt:"rejected"===t.lifecycleStatus?e.rejectedAt??aw():void 0,updatedAt:aw()}})),"accepted"===t.lifecycleStatus&&"team"===t.actorRole&&"client"===t.visibility&&("proposal"===t.type||"agreement"===t.type)&&(j(x),en(x)),K({type:"success",message:"Rodada atualizada com sucesso."});else{let a,s,n,i=aw(),l=(a=t.monthlyValue,s=t.setupValue,n=t.termMonths,a*n+s),o={id:`round-${Date.now()}-${Math.floor(999*Math.random())}`,opportunityId:e,type:t.type,authorId:"team"===t.actorRole?"u1":"client-user",authorName:"team"===t.actorRole?"Maria Silva - Equipe":"Cliente - Cliente",actorRole:t.actorRole,visibility:t.visibility,lifecycleStatus:t.lifecycleStatus,createdAt:i,monthlyValue:t.monthlyValue,setupValue:t.setupValue,termMonths:t.termMonths,totalValue:l,conditions:t.conditions,details:t.notes,rejectedReason:"rejected"===t.lifecycleStatus?t.rejectedReason:void 0,sentAt:"sent"===t.lifecycleStatus||"awaiting"===t.lifecycleStatus||"accepted"===t.lifecycleStatus?i:void 0,acceptedAt:"accepted"===t.lifecycleStatus?i:void 0,rejectedAt:"rejected"===t.lifecycleStatus?i:void 0,status:"active"};r(e=>[...e,o]),"accepted"===o.lifecycleStatus&&aj(o)&&(j(o.id),en(o.id)),K({type:"success",message:"Rodada registrada. Histórico e resumo atualizados."})}el()}catch{f("Não consegui salvar a rodada. Revise os campos e tente novamente.")}finally{g(!1)}},ec=async e=>{aj(e)?"draft"!==e.lifecycleStatus?K({type:"warning",message:"Apenas rodadas em rascunho podem ser enviadas."}):window.confirm("Confirmar envio desta rodada ao cliente?")&&await Z(e.id,"send",()=>{r(t=>t.map(t=>t.id===e.id?{...t,lifecycleStatus:"sent",sentAt:aw(),updatedAt:aw()}:t)),K({type:"success",message:"Rodada enviada ao cliente e pronta para acompanhamento."})},"Não consegui marcar a rodada como enviada."):K({type:"warning",message:"Somente propostas visíveis ao cliente podem ser enviadas."})},ed=async e=>{"sent"===e.lifecycleStatus&&await Z(e.id,"awaiting",()=>{r(t=>t.map(t=>t.id===e.id?{...t,lifecycleStatus:"awaiting",updatedAt:aw()}:t)),K({type:"info",message:"Status atualizado para aguardando resposta do cliente."})},"Não consegui atualizar o status da rodada.")},em=async e=>{window.confirm("Confirmar esta rodada como aceita?")&&await Z(e.id,"accept",()=>{r(t=>t.map(t=>t.id===e.id?{...t,lifecycleStatus:"accepted",acceptedAt:aw(),updatedAt:aw()}:t)),aj(e)&&(j(e.id),en(e.id)),K({type:"success",message:aj(e)?"Rodada aceita e promovida para termos vigentes.":"Rodada aceita com sucesso."})},"Não consegui marcar a rodada como aceita.")},eu=async e=>{let t=window.prompt("Informe o motivo da rejeição (mínimo 5 caracteres):");!t||t.trim().length<5?K({type:"warning",message:"Motivo obrigatório para rejeitar a rodada."}):await Z(e.id,"reject",()=>{r(a=>a.map(a=>a.id===e.id?{...a,lifecycleStatus:"rejected",rejectedAt:aw(),rejectedReason:t.trim(),updatedAt:aw()}:a)),K({type:"warning",message:"Rodada marcada como rejeitada."})},"Não consegui rejeitar a rodada.")},ex=async e=>{aj(e)?await Z(e.id,"set-current",()=>{j(e.id),en(e.id),K({type:"success",message:`Rodada ${e.id} definida como fonte dos termos vigentes.`})},"Não consegui definir os termos vigentes desta rodada."):K({type:"warning",message:"Somente proposta do time visível ao cliente pode virar termo vigente."})},eh=async e=>{aN(e)?window.confirm("Excluir esta rodada? Esta ação remove o item do histórico.")&&await Z(e.id,"delete",()=>{r(t=>{let a=t.filter(t=>t.id!==e.id);return v===e.id&&j(aS(a)),a}),K({type:"success",message:"Rodada excluída com sucesso."})},"Não consegui excluir a rodada."):K({type:"warning",message:"Você só pode excluir rodadas próprias em rascunho dentro da janela permitida."})},ep=async()=>{if(!G){I("Export bloqueado. Defina termos vigentes antes de exportar."),K({type:"warning",message:"Defina os termos vigentes para gerar um resumo confiável."});return}k(!0),I(null);try{var t;let a,n,i,r;await new Promise(e=>setTimeout(e,260));let l=(a=H.filter(e=>"client"===e.visibility&&"internal"!==e.type).map((e,t)=>{let a=ad[e.type].label,s=am[e.lifecycleStatus].label;return`${t+1}. ${a} | ${s} | Mensal ${ag(e.monthlyValue??0)} | Setup ${ag(e.setupValue??0)} | ${e.termMonths??12} meses`}),[`Resumo de negocia\xe7\xe3o - ${s}`,"","Termos vigentes",`Mensal: ${ag(G.monthlyValue)}`,`Setup: ${ag(G.setupValue)}`,`Prazo: ${G.termMonths} meses`,`Valor total: ${ag(G.totalValue)}`,`Origem: rodada ${G.sourceRoundId}`,`Atualizado por: ${G.updatedBy} em ${ab(G.updatedAt)}`,"","Rodadas relevantes para cliente",...a].join("\n"));A(l),t=`negociacao-${e}.txt`,n=new Blob([l],{type:"text/plain;charset=utf-8"}),i=URL.createObjectURL(n),(r=document.createElement("a")).href=i,r.download=t,document.body.append(r),r.click(),r.remove(),URL.revokeObjectURL(i),K({type:"success",message:"Resumo exportado com base nos termos vigentes."})}catch{I("Não consegui gerar o resumo. Tente novamente.")}finally{k(!1)}},eg=async()=>{if(D)try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(D);else{let e=document.createElement("textarea");e.value=D,document.body.append(e),e.select(),document.execCommand("copy"),e.remove()}K({type:"success",message:"Resumo copiado para a área de transferência."})}catch{K({type:"error",message:"Não consegui copiar o resumo."})}},eb=async()=>{if(E("saving"),O(null),T.action.trim().length<4){E("error"),O("Defina uma ação objetiva para o próximo passo.");return}if(!T.dueAt){E("error"),O("Defina a data para o próximo passo.");return}try{await new Promise(e=>setTimeout(e,220)),E("saved"),K({type:"success",message:"Próximo passo salvo com sucesso."}),window.setTimeout(()=>E("idle"),1600)}catch{E("error"),O("Não consegui salvar o próximo passo. Tente novamente.")}},ef="success"===Q.tone?"border-emerald-200 bg-emerald-50 text-emerald-700":"warning"===Q.tone?"border-amber-200 bg-amber-50 text-amber-700":"info"===Q.tone?"border-sky-200 bg-sky-50 text-sky-700":"border-zinc-200 bg-zinc-100 text-zinc-600";return(0,t.jsxs)("div",{className:"space-y-5","data-deal-id":e,children:[(0,t.jsxs)("header",{className:"space-y-4 border-b border-zinc-100 pb-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg border border-violet-200 bg-violet-50 text-violet-700",children:(0,t.jsx)(at.Handshake,{className:"h-4 w-4"})}),(0,t.jsx)("h2",{className:"font-heading text-lg font-semibold text-zinc-900",children:"Negociação"})]}),(0,t.jsx)("p",{className:"pl-10 text-sm text-zinc-500",children:"Rodadas, termos vigentes e próximo passo em uma única execução."})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsxs)(es.Button,{variant:"outline",size:"sm",className:"h-8 gap-1.5 rounded-full text-xs",onClick:ep,disabled:z,children:[z?(0,t.jsx)(V.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,t.jsx)(ae.Download,{className:"h-3.5 w-3.5"}),z?"Gerando...":"Exportar resumo"]}),(0,t.jsxs)(es.Button,{size:"sm",className:"h-8 gap-1.5 rounded-full bg-zinc-900 text-xs text-white hover:bg-zinc-800",onClick:()=>ei(X),children:[(0,t.jsx)(y.Plus,{className:"h-3.5 w-3.5"}),"Nova rodada"]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,t.jsxs)("div",{className:(0,ea.cn)("inline-flex items-center gap-2 rounded-full border px-2.5 py-1 text-[11px] font-medium",ef),children:[(0,t.jsx)(J.Clock3,{className:"h-3.5 w-3.5"}),Q.label]}),(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:Q.description})]})]}),S?(0,t.jsx)("div",{className:(0,ea.cn)("rounded-lg border px-3 py-2 text-xs font-medium","success"===S.type&&"border-emerald-200 bg-emerald-50 text-emerald-700","error"===S.type&&"border-red-200 bg-red-50 text-red-700","warning"===S.type&&"border-amber-200 bg-amber-50 text-amber-700","info"===S.type&&"border-sky-200 bg-sky-50 text-sky-700"),role:"status",children:S.message}):null,(0,t.jsxs)("div",{className:"grid grid-cols-1 items-start gap-5 lg:grid-cols-12",children:[(0,t.jsxs)("div",{className:"space-y-4 lg:col-span-8 lg:min-h-[calc(100vh-24rem)] lg:space-y-3",children:[(0,t.jsx)(et.AnimatePresence,{children:l&&(0,t.jsx)(ee.motion.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.16},children:(0,t.jsx)(aE,{mode:c,seed:m,isSaving:p,errorMessage:b,onCancel:el,onSave:eo})})}),0===H.length?(0,t.jsx)(aP,{onStart:()=>ei()}):(0,t.jsxs)("div",{className:"relative space-y-2.5 rounded-2xl border border-zinc-200 bg-white p-3",children:[(0,t.jsx)("div",{className:"absolute bottom-3 left-[1.35rem] top-3 w-px bg-zinc-200"}),H.map((e,a)=>(0,t.jsx)(aT,{round:e,displayIndex:a+1,isCurrentTerms:e.id===v,isLast:a===H.length-1,isHighlighted:B===e.id,loadingAction:N[e.id]??null,onEdit:er,onDelete:eh,onSend:ec,onAwaiting:ed,onAccept:em,onReject:eu,onSetCurrent:ex,onCreateFromRound:e=>ei(e)},e.id))]}),(0,t.jsx)(aA,{hasRounds:H.length>0,hasCurrentTerms:!!G,sourceRound:U,hasClientCounter:!!Y,nextStep:T,onCreateRound:()=>ei(X??U),onExport:ep,onRegisterClientReturn:()=>{d("create"),h(null),f(null),u({type:"counter",actorRole:"client",visibility:"client",lifecycleStatus:"awaiting",monthlyValue:String(Y?.monthlyValue??G?.monthlyValue??X?.monthlyValue??0),setupValue:String(Y?.setupValue??G?.setupValue??X?.setupValue??0),termMonths:String(Y?.termMonths??G?.termMonths??X?.termMonths??12),notes:"",conditionsText:"",rejectedReason:""}),o(!0)},onFocusNextStep:()=>{let e=document.querySelector('[data-next-step-card="true"]');e instanceof HTMLElement&&(e.scrollIntoView({behavior:"smooth",block:"center"}),_(!0),window.setTimeout(()=>_(!1),1600))},isExporting:z})]}),(0,t.jsxs)("div",{className:"space-y-4 lg:col-span-4 lg:sticky lg:top-4 lg:self-start",children:[(0,t.jsx)(ak,{terms:G,sourceRound:U,sourceRoundNumber:W,onJumpToSourceRound:e=>{let t=document.querySelector(`[data-round-anchor="${e}"]`);t instanceof HTMLElement&&(t.scrollIntoView({behavior:"smooth",block:"center"}),en(e))},onCreateFromCurrent:()=>ei(U)}),(0,t.jsx)(aI,{currentOfferRound:U??X,lastClientCounter:Y}),(0,t.jsx)(aD,{draft:T,saveState:P,errorMessage:L,onChange:R,onSave:eb,highlighted:$}),(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Resumo para envio"}),(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:"O export usa os termos vigentes e ignora rodadas internas por padrão."})]}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,t.jsxs)(es.Button,{type:"button",variant:"outline",size:"sm",className:"h-8 gap-1.5 rounded-full text-xs",onClick:ep,disabled:z,children:[z?(0,t.jsx)(V.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,t.jsx)(ae.Download,{className:"h-3.5 w-3.5"}),"Exportar"]}),(0,t.jsxs)(es.Button,{type:"button",variant:"ghost",size:"sm",className:"h-8 gap-1.5 rounded-full text-xs text-zinc-600 hover:bg-zinc-100",onClick:eg,disabled:!D,children:[(0,t.jsx)(q.Copy,{className:"h-3.5 w-3.5"}),"Copiar texto"]})]}),M?(0,t.jsx)("p",{className:"mt-2 text-xs text-red-600",children:M}):null,D?(0,t.jsx)("p",{className:"mt-2 text-xs text-emerald-700",children:"Resumo pronto para compartilhamento."}):null]})]})]})]})}function ak({terms:e,sourceRound:a,sourceRoundNumber:s,onJumpToSourceRound:n,onCreateFromCurrent:i}){return(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Termos vigentes"}),(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:"Fonte de verdade para resumo e decisão de fechamento."})]}),e&&a?(0,t.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsx)(aM,{label:"Mensal",value:ag(e.monthlyValue)}),(0,t.jsx)(aM,{label:"Setup",value:ag(e.setupValue)}),(0,t.jsx)(aM,{label:"Prazo",value:`${e.termMonths} meses`}),(0,t.jsx)(aM,{label:"Total",value:ag(e.totalValue)})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-[11px]",children:[(0,t.jsxs)("button",{type:"button",onClick:()=>n(a.id),className:"inline-flex h-6 items-center rounded-full border border-zinc-200 bg-zinc-100 px-2 text-[11px] font-medium text-zinc-700 transition-colors hover:border-brand/30 hover:text-brand",children:["Rodada fonte: ",s?`Rodada ${s}`:a.id]}),(0,t.jsx)(eG.Badge,{className:(0,ea.cn)("border",am[a.lifecycleStatus].chipClass),children:am[a.lifecycleStatus].label}),(0,t.jsx)(eG.Badge,{className:(0,ea.cn)("border",au[a.visibility].chipClass),children:au[a.visibility].label})]}),(0,t.jsxs)("p",{className:"text-[11px] text-zinc-500",children:["Atualizado por ",e.updatedBy," em ",ab(e.updatedAt),"."]})]}):(0,t.jsx)("div",{className:"mt-4 rounded-xl border border-dashed border-zinc-200 bg-zinc-50 p-3",children:(0,t.jsx)("p",{className:"text-xs text-zinc-600",children:"Ainda não existem termos vigentes. Defina uma rodada do time como vigente."})}),(0,t.jsxs)(es.Button,{type:"button",variant:"outline",size:"sm",className:"mt-4 h-8 w-full gap-1.5 rounded-full text-xs",onClick:i,children:[(0,t.jsx)(y.Plus,{className:"h-3.5 w-3.5"}),"Nova rodada baseada na última oferta"]})]})}function aM({label:e,value:a}){return(0,t.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-2.5",children:[(0,t.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:e}),(0,t.jsx)("p",{className:"mt-1 text-sm font-semibold text-zinc-900",children:a})]})}function aI({currentOfferRound:e,lastClientCounter:a}){let s=(a?.monthlyValue??0)-(e?.monthlyValue??0),n=(a?.setupValue??0)-(e?.setupValue??0);return(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ai,{className:"h-4 w-4 text-zinc-500"}),(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Comparador de negociação"})]}),(0,t.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-3",children:[(0,t.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:"Nossa última oferta"}),(0,t.jsxs)("p",{className:"mt-1 text-sm font-semibold text-zinc-900",children:[e?ag(e.monthlyValue??0):"--"," /mês"]}),(0,t.jsxs)("p",{className:"text-[11px] text-zinc-500",children:["Setup ",e?ag(e.setupValue??0):"--"]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50/70 p-3",children:[(0,t.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-amber-700",children:"Última contra proposta do cliente"}),(0,t.jsxs)("p",{className:"mt-1 text-sm font-semibold text-amber-900",children:[a?ag(a.monthlyValue??0):"--"," /mês"]}),(0,t.jsxs)("p",{className:"text-[11px] text-amber-700",children:["Setup ",a?ag(a.setupValue??0):"--"]})]})]}),e&&a?(0,t.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-white p-2.5",children:[(0,t.jsx)("p",{className:"text-[10px] uppercase tracking-wide text-zinc-500",children:"Delta mensal"}),(0,t.jsxs)("p",{className:(0,ea.cn)("mt-1 text-sm font-semibold",s<=0?"text-emerald-700":"text-amber-700"),children:[s>0?"+":"",ag(s)]})]}),(0,t.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-white p-2.5",children:[(0,t.jsx)("p",{className:"text-[10px] uppercase tracking-wide text-zinc-500",children:"Delta setup"}),(0,t.jsxs)("p",{className:(0,ea.cn)("mt-1 text-sm font-semibold",n<=0?"text-emerald-700":"text-amber-700"),children:[n>0?"+":"",ag(n)]})]})]}):(0,t.jsx)("p",{className:"mt-3 text-xs text-zinc-500",children:"Registre ao menos uma proposta do time e uma contra proposta do cliente para comparar."})]})}function aD({draft:e,saveState:a,errorMessage:s,onChange:n,onSave:i,highlighted:r}){return(0,t.jsxs)("div",{className:(0,ea.cn)("rounded-2xl border border-zinc-200 bg-white p-4 transition-all duration-200",r&&"ring-2 ring-brand/30"),"data-next-step-card":"true",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(ar.CalendarClock,{className:"h-4 w-4 text-zinc-500"}),(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Próximo passo"})]}),(0,t.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Defina ação, data, canal e responsável para manter a negociação no ritmo."}),(0,t.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Ação"}),(0,t.jsx)(eJ.Input,{value:e.action,onChange:t=>n({...e,action:t.target.value}),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Ligar para validar objeção de setup"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Data"}),(0,t.jsx)(eJ.Input,{type:"date",value:e.dueAt,onChange:t=>n({...e,dueAt:t.target.value}),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Canal"}),(0,t.jsxs)(tC.Select,{value:e.channel,onValueChange:t=>n({...e,channel:t}),children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsx)(tC.SelectContent,{children:ax.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.label},e.id))})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Responsável"}),(0,t.jsxs)(tC.Select,{value:e.ownerId,onValueChange:t=>n({...e,ownerId:t}),children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsx)(tC.SelectContent,{children:ac.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.name},e.id))})]})]}),(0,t.jsx)(es.Button,{type:"button",size:"sm",className:"h-8 w-full rounded-full bg-zinc-900 text-xs text-white hover:bg-zinc-800",onClick:i,disabled:"saving"===a,children:"saving"===a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}),"Salvando..."]}):"Salvar próximo passo"}),"saved"===a?(0,t.jsx)("p",{className:"text-xs text-emerald-700",children:"Próximo passo salvo."}):null,"error"===a&&s?(0,t.jsx)("p",{className:"text-xs text-red-600",children:s}):null]})]})}function aA({hasRounds:e,hasCurrentTerms:a,sourceRound:s,hasClientCounter:n,nextStep:i,onCreateRound:r,onExport:l,onRegisterClientReturn:o,onFocusNextStep:c,isExporting:d}){let m=i.action.trim().length>=4&&!!i.dueAt,u=i.dueAt?new Date(`${i.dueAt}T00:00:00`):null,x=u&&!Number.isNaN(u.getTime())?eF(u,"dd MMM",{locale:eH}):"Sem data",h=s?.visibility==="client"&&("sent"===s.lifecycleStatus||"awaiting"===s.lifecycleStatus||"accepted"===s.lifecycleStatus);return(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Execução da negociação"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Fechamento visual da timeline com checklist e ações rápidas da rodada vigente."})]}),e?null:(0,t.jsx)(eG.Badge,{className:"border-zinc-200 bg-zinc-100 text-[10px] text-zinc-600",children:"Sem rodadas"})]}),(0,t.jsxs)("div",{className:"mt-3 rounded-xl border border-zinc-200 bg-zinc-50/80 p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-zinc-800",children:"Próximo passo"}),(0,t.jsx)("button",{type:"button",className:"text-[11px] font-medium text-brand transition-colors hover:text-brand/80",onClick:c,children:"Editar"})]}),(0,t.jsx)("p",{className:"mt-1 text-xs text-zinc-600",children:m?`${i.action} \xb7 ${x} \xb7 ${ax.find(e=>e.id===i.channel)?.label??"Canal"}`:"Defina ação, data e canal para não perder o timing da negociação."})]}),(0,t.jsx)("div",{className:"mt-3 grid gap-2 sm:grid-cols-2",children:[{id:"terms",label:"Termos vigentes definidos",done:a},{id:"source",label:"Rodada vigente enviada ao cliente",done:h},{id:"counter",label:"Retorno do cliente registrado",done:n},{id:"next-step",label:"Próximo passo com data",done:m}].map(e=>(0,t.jsxs)("div",{className:(0,ea.cn)("flex items-center gap-2 rounded-lg border px-2.5 py-2",e.done?"border-emerald-200 bg-emerald-50 text-emerald-700":"border-zinc-200 bg-zinc-50 text-zinc-600"),children:[e.done?(0,t.jsx)(as.CheckCircle2,{className:"h-3.5 w-3.5"}):(0,t.jsx)(J.Clock3,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{className:"text-[11px] font-medium",children:e.label})]},e.id))}),(0,t.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,t.jsxs)(es.Button,{type:"button",size:"sm",className:"h-8 rounded-full bg-zinc-900 px-3 text-xs text-white hover:bg-zinc-800",onClick:r,children:[(0,t.jsx)(y.Plus,{className:"mr-1.5 h-3.5 w-3.5"}),"Nova rodada"]}),(0,t.jsx)(es.Button,{type:"button",size:"sm",variant:"outline",className:"h-8 rounded-full px-3 text-xs",onClick:o,children:"Registrar retorno do cliente"}),(0,t.jsxs)(es.Button,{type:"button",size:"sm",variant:"outline",className:"h-8 rounded-full px-3 text-xs",onClick:l,disabled:d,children:[d?(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,t.jsx)(ae.Download,{className:"mr-1.5 h-3.5 w-3.5"}),"Exportar resumo"]})]})]})}function aT({round:e,displayIndex:s,isCurrentTerms:n,isLast:i,isHighlighted:r,loadingAction:l,onEdit:o,onDelete:c,onSend:d,onAwaiting:m,onAccept:u,onReject:x,onSetCurrent:h,onCreateFromRound:p}){let[g,b]=(0,a.useState)(i),f=ad[e.type],v=f.icon,j=aj(e)&&"draft"===e.lifecycleStatus,w="sent"===e.lifecycleStatus,S="sent"===e.lifecycleStatus||"awaiting"===e.lifecycleStatus,C="sent"===e.lifecycleStatus||"awaiting"===e.lifecycleStatus,z=aj(e)&&"draft"!==e.lifecycleStatus,k=ay(e),I=aN(e);return(0,t.jsxs)("div",{className:"relative pl-6","data-round-anchor":e.id,children:[(0,t.jsx)("div",{className:(0,ea.cn)("absolute left-3 top-5 h-6 w-6 -translate-x-1/2 rounded-full border-2 bg-white",n?"border-brand":"border-zinc-300"),children:(0,t.jsx)("div",{className:(0,ea.cn)("absolute left-1/2 top-1/2 h-2 w-2 -translate-x-1/2 -translate-y-1/2 rounded-full",n?"bg-brand":"bg-zinc-300")})}),(0,t.jsxs)(ee.motion.div,{layout:!0,className:(0,ea.cn)("rounded-xl border bg-white shadow-sm transition-all duration-200",g&&"ring-1 ring-zinc-200",r&&"border-brand/50 ring-2 ring-brand/20"),children:[(0,t.jsxs)("button",{type:"button",className:"flex w-full items-center gap-3 p-3 text-left",onClick:()=>b(e=>!e),children:[(0,t.jsx)("div",{className:(0,ea.cn)("flex h-8 w-8 shrink-0 items-center justify-center rounded-lg border",f.badgeClass),children:(0,t.jsx)(v,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 space-y-1",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,t.jsxs)("span",{className:"text-[11px] font-bold uppercase tracking-wide text-zinc-500",children:["Rodada ",s]}),(0,t.jsx)(eG.Badge,{className:(0,ea.cn)("border text-[10px]",f.badgeClass),children:f.label}),(0,t.jsx)(eG.Badge,{className:(0,ea.cn)("border text-[10px]",am[e.lifecycleStatus].chipClass),children:am[e.lifecycleStatus].label}),(0,t.jsx)(eG.Badge,{className:(0,ea.cn)("border text-[10px]",au[e.visibility].chipClass),children:au[e.visibility].label}),n?(0,t.jsx)(eG.Badge,{className:"border-emerald-200 bg-emerald-50 text-[10px] text-emerald-700",children:"Fonte dos termos vigentes"}):null]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2.5 text-xs text-zinc-600",children:[(0,t.jsx)("span",{className:"font-medium text-zinc-800",children:e.authorName}),(0,t.jsxs)("span",{children:[ag(e.monthlyValue??0)," /mês"]}),(0,t.jsxs)("span",{children:["Setup ",ag(e.setupValue??0)]}),(0,t.jsxs)("span",{className:"text-zinc-500",children:[e.termMonths??12," meses"]})]}),(0,t.jsxs)("div",{className:"text-[11px] text-zinc-400",children:["Criada em ",ab(e.createdAt),e.sentAt?` \xb7 Enviada em ${ab(e.sentAt)}`:""]})]}),g?(0,t.jsx)(t9.ChevronUp,{className:"h-4 w-4 text-zinc-400"}):(0,t.jsx)(L.ChevronDown,{className:"h-4 w-4 text-zinc-400"})]}),(0,t.jsx)(et.AnimatePresence,{children:g&&(0,t.jsx)(ee.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.16},className:"overflow-hidden",children:(0,t.jsxs)("div",{className:"space-y-3 px-3 pb-3 pt-0",children:[(0,t.jsx)(en.Separator,{}),av(e.type)?(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[(0,t.jsx)(aM,{label:"Mensal",value:ag(e.monthlyValue??0)}),(0,t.jsx)(aM,{label:"Setup",value:ag(e.setupValue??0)}),(0,t.jsx)(aM,{label:"Prazo",value:`${e.termMonths??12} meses`}),(0,t.jsx)(aM,{label:"Total",value:ag(e.totalValue??0)})]}):(0,t.jsx)("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-3 text-xs text-zinc-600",children:"Ajuste interno sem alteração direta de termos vigentes."}),e.conditions.length>0?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:"Condições"}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[e.conditions.slice(0,3).map(a=>(0,t.jsx)(eG.Badge,{className:"border-zinc-200 bg-zinc-100 text-[10px] font-normal text-zinc-700",children:a},`${e.id}-${a}`)),e.conditions.length>3?(0,t.jsxs)(eG.Badge,{className:"border-zinc-200 bg-zinc-100 text-[10px] font-normal text-zinc-700",children:["+",e.conditions.length-3]}):null]})]}):null,e.details?(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:"Observações"}),(0,t.jsx)("p",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-3 text-xs text-zinc-700",children:e.details})]}):null,e.rejectedReason?(0,t.jsxs)("p",{className:"rounded-lg border border-red-200 bg-red-50 px-2.5 py-2 text-xs text-red-700",children:["Motivo da rejeição: ",e.rejectedReason]}):null,(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,t.jsx)(aR,{label:"Marcar enviada",icon:aa.Send,visible:j,loading:"send"===l,onClick:()=>d(e)}),(0,t.jsx)(aR,{label:"Aguardando",icon:J.Clock3,visible:w,loading:"awaiting"===l,onClick:()=>m(e)}),(0,t.jsx)(aR,{label:"Aceita",icon:as.CheckCircle2,visible:S,loading:"accept"===l,onClick:()=>u(e)}),(0,t.jsx)(aR,{label:"Rejeitar",icon:an.XCircle,visible:C,loading:"reject"===l,onClick:()=>x(e)}),(0,t.jsx)(aR,{label:"Definir vigente",icon:al,visible:z&&!n,loading:"set-current"===l,onClick:()=>h(e)}),(0,t.jsx)(aR,{label:"Nova rodada",icon:y.Plus,visible:!0,loading:!1,onClick:()=>p(e)}),(0,t.jsx)(aR,{label:"Editar",icon:M.Pencil,visible:k,loading:"save-edit"===l,onClick:()=>o(e)}),(0,t.jsx)(aR,{label:"Excluir",icon:N.Trash2,visible:I,loading:"delete"===l,onClick:()=>c(e)})]})]})})})]})]})}function aR({label:e,icon:a,visible:s,loading:n,onClick:i}){return s?(0,t.jsxs)(es.Button,{type:"button",size:"sm",variant:"outline",className:"h-7 gap-1.5 rounded-full px-2.5 text-[11px]",onClick:i,disabled:n,children:[n?(0,t.jsx)(V.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,t.jsx)(a,{className:"h-3.5 w-3.5"}),e]}):null}function aP({onStart:e}){return(0,t.jsxs)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50/70 p-8 text-center",children:[(0,t.jsx)("div",{className:"mx-auto flex h-11 w-11 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:(0,t.jsx)(at.Handshake,{className:"h-5 w-5"})}),(0,t.jsx)("h3",{className:"mt-3 font-heading text-base font-semibold text-zinc-900",children:"Nenhuma rodada registrada"}),(0,t.jsx)("p",{className:"mt-1 text-sm text-zinc-500",children:"Registre a primeira rodada para iniciar os termos e o fluxo de decisão."}),(0,t.jsxs)(es.Button,{type:"button",variant:"outline",className:"mt-4 h-8 rounded-full text-xs",onClick:e,children:[(0,t.jsx)(y.Plus,{className:"mr-1.5 h-3.5 w-3.5"}),"Registrar primeira rodada"]})]})}function aE({mode:e,seed:s,isSaving:n,errorMessage:i,onCancel:r,onSave:l}){let[o,c]=(0,a.useState)(s),[d,m]=(0,a.useState)(null),u=av(o.type),x="internal"===o.type||"internal"===o.visibility,h=async e=>{if(e.preventDefault(),m(null),u){let e=af(o.monthlyValue),t=af(o.setupValue),a=af(o.termMonths);if(e<0||e>999999)return void m("Valor mensal inválido.");if(t<0||t>999999)return void m("Valor de setup inválido.");if(a<1||a>36)return void m("Prazo deve estar entre 1 e 36 meses.")}if("rejected"===o.lifecycleStatus&&o.rejectedReason.trim().length<5)return void m("Informe motivo de rejeição com pelo menos 5 caracteres.");if(("sent"===o.lifecycleStatus||"awaiting"===o.lifecycleStatus)&&"internal"===o.visibility)return void m("Rodadas internas não podem ser marcadas como enviadas.");if(o.notes.trim().length>0&&o.notes.trim().length<10)return void m(`Observa\xe7\xf5es devem ter no m\xednimo 10 caracteres.`);let t={type:o.type,actorRole:o.actorRole,visibility:o.visibility,lifecycleStatus:o.lifecycleStatus,monthlyValue:u?af(o.monthlyValue):0,setupValue:u?af(o.setupValue):0,termMonths:u?af(o.termMonths):12,notes:o.notes.trim(),conditions:o.conditionsText.split(",").map(e=>e.trim()).filter(Boolean),rejectedReason:"rejected"===o.lifecycleStatus?o.rejectedReason.trim():void 0};await l(t)};return(0,t.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"create"===e?"Nova rodada":"Editar rodada"}),(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:"Defina tipo, status, termos e condições com validação antes de salvar."})]}),(0,t.jsx)(es.Button,{type:"button",variant:"ghost",size:"sm",className:"h-7 rounded-full px-2.5 text-xs",onClick:r,children:"Cancelar"})]}),(0,t.jsxs)("form",{className:"space-y-3",onSubmit:h,children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Tipo da rodada"}),(0,t.jsxs)(tC.Select,{value:o.type,onValueChange:e=>{c(t=>({...t,type:e,actorRole:"counter"===e?"client":"team",visibility:"internal"===e?"internal":t.visibility,lifecycleStatus:"internal"===e?"draft":t.lifecycleStatus}))},children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsx)(tC.SelectContent,{children:ah.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.label},e.id))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Status operacional"}),(0,t.jsxs)(tC.Select,{value:o.lifecycleStatus,onValueChange:e=>c(t=>({...t,lifecycleStatus:e})),disabled:x,children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsx)(tC.SelectContent,{children:ap.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.label},e.id))})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Origem"}),(0,t.jsxs)(tC.Select,{value:o.actorRole,onValueChange:e=>c(t=>({...t,actorRole:e})),disabled:"counter"===o.type,children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsxs)(tC.SelectContent,{children:[(0,t.jsx)(tC.SelectItem,{value:"team",children:"Time interno"}),(0,t.jsx)(tC.SelectItem,{value:"client",children:"Cliente"}),(0,t.jsx)(tC.SelectItem,{value:"system",children:"Sistema"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Visibilidade"}),(0,t.jsxs)(tC.Select,{value:o.visibility,onValueChange:e=>c(t=>({...t,visibility:e,lifecycleStatus:"internal"===e?"draft":t.lifecycleStatus})),disabled:"internal"===o.type,children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsxs)(tC.SelectContent,{children:[(0,t.jsx)(tC.SelectItem,{value:"client",children:"Visível ao cliente"}),(0,t.jsx)(tC.SelectItem,{value:"internal",children:"Interna"})]})]})]})]}),u?(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Mensal"}),(0,t.jsx)(eJ.Input,{type:"number",min:0,max:999999,value:o.monthlyValue,onChange:e=>c(t=>({...t,monthlyValue:e.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Setup"}),(0,t.jsx)(eJ.Input,{type:"number",min:0,max:999999,value:o.setupValue,onChange:e=>c(t=>({...t,setupValue:e.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"0"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Prazo (meses)"}),(0,t.jsx)(eJ.Input,{type:"number",min:1,max:36,value:o.termMonths,onChange:e=>c(t=>({...t,termMonths:e.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"12"})]})]}):null,(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Condições (separe por vírgula)"}),(0,t.jsx)(eJ.Input,{value:o.conditionsText,onChange:e=>c(t=>({...t,conditionsText:e.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Setup reduzido, carência de 15 dias"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Observações"}),(0,t.jsx)(tz.Textarea,{value:o.notes,onChange:e=>c(t=>({...t,notes:e.target.value})),className:"mt-1 min-h-[86px] resize-none rounded-lg border-zinc-200 text-xs",placeholder:"Contexto da rodada e próximos pontos de negociação..."})]}),"rejected"===o.lifecycleStatus?(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Motivo da rejeição"}),(0,t.jsx)(eJ.Input,{value:o.rejectedReason,onChange:e=>c(t=>({...t,rejectedReason:e.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Cliente não aprovou condição de setup"})]}):null,d?(0,t.jsx)("p",{className:"text-xs text-red-600",children:d}):null,i?(0,t.jsx)("p",{className:"text-xs text-red-600",children:i}):null,(0,t.jsxs)("div",{className:"flex justify-end gap-2 pt-1",children:[(0,t.jsx)(es.Button,{type:"button",variant:"ghost",size:"sm",className:"h-8 rounded-full px-3 text-xs",onClick:r,children:"Fechar"}),(0,t.jsx)(es.Button,{type:"submit",size:"sm",className:"h-8 rounded-full bg-zinc-900 px-3 text-xs text-white hover:bg-zinc-800",disabled:n,children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}),"Salvando..."]}):"create"===e?"Salvar rodada":"Salvar alterações"})]})]})]})}var aV=e.i(75378),aL=e.i(53145),aO=e.i(94814);let aB=(0,c.default)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var aF=e.i(20278),a$=e.i(83086),a_=e.i(82458),a_=a_,aq=e.i(81307);let aH=aq.z.object({type:aq.z.enum(["presencial","remoto","outro"]),status:aq.z.enum(["agendada","realizada","cancelada"]),date:aq.z.string().optional(),time:aq.z.string().optional(),duration:aq.z.string().optional(),location:aq.z.string().optional(),accessSearch:aq.z.string().optional(),platform:aq.z.enum(["google-meet","zoom","whatsapp","outro"]).optional(),link:aq.z.string().optional(),typeDescription:aq.z.string().optional(),details:aq.z.string().optional(),responsibleId:aq.z.string().min(1,"Responsável é obrigatório"),participants:aq.z.array(aq.z.string()).optional(),objective:aq.z.string().max(500,"Objetivo deve ter no máximo 500 caracteres").optional(),result:aq.z.string().optional(),outcome:aq.z.enum(["realizada","no-show","remarcada"]).optional(),cancellationReason:aq.z.string().optional()}).superRefine((e,t)=>{if("agendada"===e.status&&(e.date||t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Data é obrigatória",path:["date"]}),e.time||t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Hora é obrigatória",path:["time"]}),e.duration||t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Duração é obrigatória",path:["duration"]})),"agendada"===e.status&&e.date&&e.time){let a=new Date;new Date(`${e.date}T${e.time}`)<a&&t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Data e hora não podem ficar no passado para visitas agendadas",path:["date"]})}if("cancelada"!==e.status||e.cancellationReason?.trim()||t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Motivo do cancelamento é obrigatório",path:["cancellationReason"]}),"presencial"===e.type&&(!e.location?.trim()||e.location.trim().length<3)&&t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Local é obrigatório e deve ter ao menos 3 caracteres",path:["location"]}),"remoto"===e.type)if(e.platform||t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Plataforma é obrigatória para visita remota",path:["platform"]}),e.link?.trim())try{new URL(e.link)}catch{t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Informe um link válido (https://...)",path:["link"]})}else t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Link da reunião é obrigatório",path:["link"]});"outro"===e.type&&(!e.typeDescription?.trim()||e.typeDescription.trim().length<3)&&t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Detalhe do tipo é obrigatório (mínimo 3 caracteres)",path:["typeDescription"]}),"realizada"!==e.status||e.outcome||t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Selecione o resultado da visita",path:["outcome"]}),"realizada"===e.status&&(!e.result?.trim()||e.result.trim().length<10)&&t.addIssue({code:aq.z.ZodIssueCode.custom,message:"Informe uma nota de resultado com pelo menos 10 caracteres",path:["result"]})}),aU=[{id:"presencial",label:"Presencial",icon:D.MapPin},{id:"remoto",label:"Remoto",icon:eU},{id:"outro",label:"Outro",icon:aB}],aW=[{id:"agendada",label:"Agendada"},{id:"realizada",label:"Realizada"},{id:"cancelada",label:"Cancelada"}],aG=["15","30","45","60","90","120"],aX=[{id:"google-meet",label:"Google Meet"},{id:"zoom",label:"Zoom"},{id:"whatsapp",label:"WhatsApp"},{id:"outro",label:"Outro"}],aY=[{id:"realizada",label:"Realizada"},{id:"no-show",label:"No-show"},{id:"remarcada",label:"Remarcada"}],aQ=[{id:"u1",label:"Eu (Logado)",role:"Sales Executive"},{id:"u2",label:"Ana Costa",role:"Closer"},{id:"u3",label:"Carlos Mendes",role:"SDR"}];function aZ({isOpen:e,onClose:n,onSave:i,dealId:r,contacts:l=[],onAddContact:c}){let[d,m]=a.useState(!1),[h,g]=a.useState(!1),[b,f]=a.useState(null),[v,j]=a.useState(!1),[N,w]=a.useState(!1),[S,C]=a.useState(null),[M,I]=a.useState(null),[A,T]=a.useState(!1),[R,P]=a.useState(!1),[E,O]=a.useState(!1),[B,F]=a.useState(!1),[$,_]=a.useState(!1),[H,U]=a.useState({nome:"",cargo:"",telefone:"",email:""}),W=(0,aL.useForm)({resolver:(0,aO.zodResolver)(aH),mode:"onChange",reValidateMode:"onChange",defaultValues:{type:"presencial",status:"agendada",duration:"60",platform:"google-meet",responsibleId:"u1",participants:[],objective:"",result:"",outcome:void 0,location:"",accessSearch:"",link:"",typeDescription:"",details:"",cancellationReason:"",date:"",time:""}}),{control:G,handleSubmit:X,watch:Y,setValue:Q,trigger:Z,formState:{errors:K,isDirty:J,isValid:ee,submitCount:et}}=W,en=Y("type"),ei=Y("status"),er=Y("date"),el=Y("time"),eo=Y("duration"),ec=Y("participants")||[],ed=Y("responsibleId"),em=Y("platform"),eu=Y("location"),ex=Y("link"),eh=Y("typeDescription"),ep=a.useCallback(e=>{if(!e)return"??";let t=e.trim().split(/\s+/).filter(Boolean);return 0===t.length?"??":1===t.length?t[0].slice(0,2).toUpperCase():`${t[0][0]}${t[t.length-1][0]}`.toUpperCase()},[]),eg=a.useCallback(e=>e?e.replace(/-/g," ").replace(/\s+/g," ").trim().replace(/\b\w/g,e=>e.toUpperCase()):"Sem cargo definido",[]);a.useEffect(()=>{if(e){g(!1),m(!1),f(null),j(!1),w(!1),C(null),I(null),O(!1),P(!1),T(!1),W.reset(),_(!0),F(!0);let e=setTimeout(()=>{_(!1),F(!1)},250);return()=>clearTimeout(e)}},[e,W]);let eb=a.useRef(l.length);a.useEffect(()=>{if(l.length>eb.current){let e=l[l.length-1];if(e){let t=W.getValues("participants")||[];t.includes(e.id)||W.setValue("participants",[...t,e.id],{shouldValidate:!0,shouldDirty:!0}),P(!1)}}eb.current=l.length},[l,W]),a.useEffect(()=>{"presencial"===en&&(Q("platform","google-meet",{shouldValidate:!1}),Q("link","",{shouldValidate:!1}),Q("typeDescription","",{shouldValidate:!1}),Q("details","",{shouldValidate:!1})),"remoto"===en&&(Q("location","",{shouldValidate:!1}),Q("accessSearch","",{shouldValidate:!1}),Q("typeDescription","",{shouldValidate:!1}),Q("details","",{shouldValidate:!1}),Y("platform")||Q("platform","google-meet",{shouldValidate:!1})),"outro"===en&&(Q("location","",{shouldValidate:!1}),Q("accessSearch","",{shouldValidate:!1}),Q("platform","google-meet",{shouldValidate:!1}),Q("link","",{shouldValidate:!1}))},[en,Q]),a.useEffect(()=>{"realizada"!==ei&&(Q("outcome",void 0,{shouldValidate:!1}),Q("result","",{shouldValidate:!1})),"cancelada"!==ei&&Q("cancellationReason","",{shouldValidate:!1})},[ei,Q]);let ef=a.useCallback(e=>{let t=new Date;t.setDate(t.getDate()+1);let a=t.getFullYear(),s=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0");Q("date",`${a}-${s}-${n}`),Q("time",e),Z(["date","time"])},[Q,Z]),ev=a.useCallback(()=>{let e=`Ol\xe1! Confirmando nossa ${"presencial"===en?"visita":"reunião"} para ${er?eF(new Date(er),"dd/MM"):"dia a confirmar"} \xe0s ${el||"horário a confirmar"}.`;navigator.clipboard.writeText(e)},[en,er,el]),ej=a.useMemo(()=>{let e=[];return ed||e.push("Responsável"),"agendada"===ei&&(er||e.push("Data"),el||e.push("Hora"),eo||e.push("Duração")),"presencial"===en&&(!eu||eu.trim().length<3)&&e.push("Local"),"remoto"===en&&(em||e.push("Plataforma"),ex?.trim()||e.push("Link da reunião")),"outro"===en&&(!eh||eh.trim().length<3)&&e.push("Detalhe do tipo"),"realizada"===ei&&(Y("outcome")||e.push("Resultado da visita"),(!Y("result")||10>(Y("result")?.trim().length||0))&&e.push("Nota do resultado")),"cancelada"!==ei||Y("cancellationReason")?.trim()||e.push("Motivo do cancelamento"),e},[ed,ei,er,el,eo,en,eu,em,ex,eh,Y]),ey=ej.length>0,eN=et>0&&Object.keys(K).length>1&&!b,ew=a.useCallback(async e=>{m(!0),f(null),I(e);try{await new Promise(e=>setTimeout(e,700)),await Promise.resolve(i(e)),g(!0),setTimeout(()=>{n()},450)}catch{f("Não consegui salvar agora. Verifique sua conexão e tente novamente.")}finally{m(!1)}},[n,i]),eS=X(a.useCallback(async e=>{if("realizada"===e.status){C(e),w(!0);return}await ew(e)},[ew]),a.useCallback(()=>{let e=Object.keys(W.formState.errors)[0];if(!e)return;let t=document.querySelector(`[name="${e}"]`);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.focus())},[W.formState.errors])),eC=a.useCallback(async()=>{M&&await ew(M)},[ew,M]),ez=a.useCallback(()=>{if(!H.nome.trim())return;let e={...H,isDecisionMaker:!1};c?.(e),U({nome:"",cargo:"",telefone:"",email:""})},[H,c]),ek=a.useCallback(()=>{!J||v||h?(j(!1),w(!1),C(null),n()):j(!0)},[J,n,h,v]),eM=a.useCallback(()=>{j(!1),w(!1),C(null),n()},[n]),eI=a.useMemo(()=>[{label:"Tipo",value:aU.find(e=>e.id===en)?.label??"Não definido"},{label:"Status",value:aW.find(e=>e.id===ei)?.label??"Não definido"},{label:"Quando",value:er&&el?`${eF(new Date(`${er}T${el}`),"dd/MM/yyyy HH:mm")}`:"A definir"},{label:"Duração",value:eo?`${eo} min`:"A definir"},{label:"remoto"===en?"Link":"Local",value:"remoto"===en?ex||"Não informado":"presencial"===en?eu||"Não informado":eh||"Não informado"},{label:"Responsável",value:aQ.find(e=>e.id===ed)?.label??"Não definido"},{label:"Participantes",value:ec.length>0?`${ec.length} selecionado${ec.length>1?"s":""}`:"Nenhum selecionado"}],[er,eo,eu,ex,ec.length,ed,el,eh,ei,en]),eD=(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white",children:[(0,t.jsxs)("div",{className:"sticky top-0 z-20 flex-none border-b border-zinc-100 bg-white px-8 py-6",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"flex items-center gap-2 text-lg font-semibold text-zinc-900",children:h?(0,t.jsxs)("span",{className:"flex items-center gap-2 text-emerald-600 animate-in fade-in slide-in-from-bottom-2",children:[(0,t.jsx)(k.CheckCircle,{className:"h-5 w-5"})," Visita registrada"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Calendar,{className:"h-5 w-5 text-brand"})," Nova Visita"]})}),!h&&(0,t.jsx)("p",{className:"text-sm text-zinc-500",children:"Registre uma visita ou reunião para este cliente"})]}),(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",onClick:ek,title:"Fechar",children:(0,t.jsx)(s.X,{className:"h-5 w-5"})})]}),(eN||b)&&(0,t.jsx)("div",{className:(0,ea.cn)("mt-3 rounded-xl border px-3 py-2 text-xs",b?"border-red-200 bg-red-50 text-red-700":"border-amber-200 bg-amber-50 text-amber-700"),children:b||"Revise os campos destacados para continuar."})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-8 overflow-y-auto px-8 py-8",children:[(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"text-[11px] uppercase tracking-[0.08em] text-zinc-500",children:"Tipo da visita"}),(0,t.jsx)(aL.Controller,{name:"type",control:G,render:({field:e})=>(0,t.jsx)("div",{className:"inline-flex rounded-xl border border-zinc-200 bg-zinc-50 p-1",children:aU.map(a=>(0,t.jsxs)("button",{type:"button",onClick:()=>e.onChange(a.id),className:(0,ea.cn)("flex h-9 items-center gap-2 rounded-lg px-3 text-sm font-medium transition-all duration-[120ms]",e.value===a.id?"bg-white text-brand shadow-sm ring-1 ring-black/5":"text-zinc-500 hover:bg-zinc-100 hover:text-zinc-800"),children:[(0,t.jsx)(a.icon,{className:"h-4 w-4"}),a.label]},a.id))})})]}),(0,t.jsxs)("div",{className:"w-full max-w-[240px] space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Status ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(aL.Controller,{name:"status",control:G,render:({field:e})=>(0,t.jsxs)(tC.Select,{value:e.value,onValueChange:e.onChange,children:[(0,t.jsx)(tC.SelectTrigger,{className:(0,ea.cn)(K.status&&"border-red-300 ring-red-100"),children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsx)(tC.SelectContent,{children:aW.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.label},e.id))})]})}),K.status&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.status.message})]})]}),"cancelada"===ei&&(0,t.jsxs)("div",{className:"mt-4 animate-in fade-in slide-in-from-top-2 space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Motivo do cancelamento ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(eJ.Input,{...W.register("cancellationReason"),placeholder:"Ex: Cliente pediu para remarcar",className:(0,ea.cn)(K.cancellationReason&&"border-red-300")}),K.cancellationReason&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.cancellationReason.message})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:[(0,t.jsx)(p.Clock,{className:"h-4 w-4 text-zinc-400"}),(0,t.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Quando"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Data ","agendada"===ei&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(eJ.Input,{type:"date",...W.register("date"),className:(0,ea.cn)(K.date&&"border-red-300")}),K.date&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.date.message})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Hora ","agendada"===ei&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(eJ.Input,{type:"time",...W.register("time"),className:(0,ea.cn)(K.time&&"border-red-300")}),K.time&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.time.message})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Duração ","agendada"===ei&&(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(aL.Controller,{name:"duration",control:G,render:({field:e})=>(0,t.jsxs)(tC.Select,{value:e.value,onValueChange:e.onChange,children:[(0,t.jsx)(tC.SelectTrigger,{className:(0,ea.cn)(K.duration&&"border-red-300"),children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione..."})}),(0,t.jsx)(tC.SelectContent,{children:aG.map(e=>(0,t.jsxs)(tC.SelectItem,{value:e,children:[e," min"]},e))})]})}),K.duration&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.duration.message})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:[(0,t.jsx)(x.Users,{className:"h-4 w-4 text-zinc-400"}),(0,t.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Quem"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Responsável ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),$?(0,t.jsx)("div",{className:"h-10 w-full animate-pulse rounded-md border border-zinc-200 bg-zinc-100"}):(0,t.jsx)(aL.Controller,{name:"responsibleId",control:G,render:({field:e})=>(0,t.jsxs)(tC.Select,{value:e.value,onValueChange:e.onChange,disabled:!0,children:[(0,t.jsx)(tC.SelectTrigger,{className:(0,ea.cn)(K.responsibleId&&"border-red-300"),children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsx)(tC.SelectContent,{children:aQ.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{children:e.label}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-500",children:e.role})]})},e.id))})]})}),(0,t.jsx)("p",{className:"text-[11px] text-zinc-500",children:"Delegação desabilitada para seu perfil."}),K.responsibleId&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.responsibleId.message})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(e0.Label,{children:"Participantes (Clientes)"}),B?(0,t.jsx)("div",{className:"h-10 w-full animate-pulse rounded-md border border-zinc-200 bg-zinc-100"}):(0,t.jsx)(aL.Controller,{name:"participants",control:G,render:({field:e})=>(0,t.jsxs)(tO.Popover,{open:A,onOpenChange:T,children:[(0,t.jsx)(tO.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(es.Button,{variant:"outline",role:"combobox","aria-expanded":A,className:"h-10 w-full justify-between px-3 font-normal text-zinc-600",children:[e.value?.length?`${e.value.length} participante${e.value.length>1?"s":""} selecionado${e.value.length>1?"s":""}`:"Selecionar participantes...",(0,t.jsx)(L.ChevronDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,t.jsx)(tO.PopoverContent,{className:"w-[calc(100vw-4rem)] sm:w-[340px] md:w-[var(--radix-popover-trigger-width)] min-w-[300px] overflow-hidden rounded-2xl border border-zinc-200/90 p-0 shadow-[0_18px_40px_rgba(15,23,42,0.14)]",align:"start",children:R?(0,t.jsxs)("div",{className:"space-y-3 p-3 animate-in slide-in-from-right-2 duration-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-100 pb-2",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold text-zinc-900",children:"Novo contato"}),(0,t.jsx)(es.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-zinc-500 hover:text-zinc-900",onClick:()=>P(!1),children:(0,t.jsx)(s.X,{className:"h-3 w-3"})})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(eJ.Input,{placeholder:"Nome *",value:H.nome,onChange:e=>U(t=>({...t,nome:e.target.value})),className:"h-8 text-sm"}),(0,t.jsx)(eJ.Input,{placeholder:"Cargo",value:H.cargo,onChange:e=>U(t=>({...t,cargo:e.target.value})),className:"h-8 text-sm"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,t.jsx)(eJ.Input,{placeholder:"Telefone",value:H.telefone,onChange:e=>U(t=>({...t,telefone:e.target.value})),className:"h-8 text-sm"}),(0,t.jsx)(eJ.Input,{placeholder:"Email",value:H.email,onChange:e=>U(t=>({...t,email:e.target.value})),className:"h-8 text-sm"})]}),(0,t.jsx)(es.Button,{size:"sm",className:"mt-2 w-full",disabled:!H.nome.trim(),onClick:ez,children:"Cadastrar"})]})]}):(0,t.jsxs)(tB.Command,{className:"bg-white",children:[(0,t.jsxs)("div",{className:"border-b border-zinc-100 px-3 py-2",children:[(0,t.jsx)("p",{className:"font-body text-[10px] font-semibold uppercase tracking-[0.08em] text-zinc-500",children:"Participantes"}),(0,t.jsxs)("p",{className:"font-body text-xs text-zinc-500",children:[(e.value||[]).length," selecionado",1===(e.value||[]).length?"":"s"]})]}),(0,t.jsx)("div",{className:"px-3 pb-2 pt-2",children:(0,t.jsx)(tB.CommandInput,{placeholder:"Buscar contato...",className:"h-9 rounded-xl border border-zinc-200 bg-zinc-50/60 px-2 text-sm"})}),(0,t.jsxs)(tB.CommandList,{className:"max-h-[260px] px-2 pb-2",children:[(0,t.jsx)(tB.CommandEmpty,{className:"py-8 text-center font-body text-xs text-zinc-500",children:"Nenhum contato encontrado."}),(0,t.jsx)(tB.CommandGroup,{className:"space-y-1",children:l.map(a=>{let s=(e.value||[]).includes(a.id);return(0,t.jsxs)(tB.CommandItem,{value:`${a.nome} ${a.cargo||""}`,className:(0,ea.cn)("group flex cursor-pointer items-center gap-3 rounded-xl border px-2.5 py-2.5 transition-all duration-[140ms]",s?"border-brand/30 bg-brand/10 shadow-[0_6px_14px_rgba(37,99,235,0.14)]":"border-transparent hover:border-zinc-200 hover:bg-zinc-50"),onSelect:()=>{let t=e.value||[];t.includes(a.id)?e.onChange(t.filter(e=>e!==a.id)):e.onChange([...t,a.id])},children:[(0,t.jsx)("div",{className:(0,ea.cn)("flex h-8 w-8 shrink-0 items-center justify-center rounded-full border font-body text-[11px] font-semibold transition-colors",s?"border-brand/35 bg-brand text-white":"border-zinc-200 bg-white text-zinc-600"),children:ep(a.nome)}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:(0,ea.cn)("truncate font-body text-sm font-medium",s?"text-zinc-900":"text-zinc-800"),children:a.nome}),(0,t.jsx)("p",{className:"truncate font-body text-[11px] text-zinc-500",children:eg(a.cargo)})]}),(0,t.jsx)("div",{className:(0,ea.cn)("flex h-5 w-5 shrink-0 items-center justify-center rounded-full border transition-all",s?"border-brand bg-brand text-white":"border-zinc-300 bg-white text-zinc-400 opacity-0 group-hover:opacity-100"),children:(0,t.jsx)(z.Check,{className:"h-3 w-3"})})]},a.id)})}),(0,t.jsx)(tB.CommandSeparator,{className:"mx-1 my-2"}),(0,t.jsx)(tB.CommandGroup,{children:(0,t.jsxs)(tB.CommandItem,{onSelect:()=>P(!0),className:"group flex cursor-pointer items-center gap-2.5 rounded-xl border border-dashed border-zinc-300 bg-zinc-50/50 px-2.5 py-2.5 text-zinc-600 transition-colors duration-[120ms] hover:border-brand/40 hover:bg-brand/5 hover:text-brand",children:[(0,t.jsx)("span",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-white border border-zinc-200 text-zinc-400 group-hover:border-brand/30 group-hover:text-brand",children:(0,t.jsx)(y.Plus,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-col",children:[(0,t.jsx)("span",{className:"font-body text-sm font-semibold",children:"Cadastrar novo contato"}),(0,t.jsx)("span",{className:"font-body text-[11px] text-zinc-400 group-hover:text-brand/80",children:"Adicione e selecione sem sair da visita"})]})]})})]})]})})]})}),0===ec.length?(0,t.jsx)("p",{className:"text-[11px] text-amber-600",children:"Nenhum participante cliente selecionado. Recomendado incluir ao menos 1 contato."}):(0,t.jsx)("div",{className:"flex flex-wrap gap-1.5 pt-1",children:ec.map(e=>{let a=l.find(t=>t.id===e);return a?(0,t.jsx)(eG.Badge,{variant:"outline",className:"h-6 rounded-full border-zinc-200 text-[11px]",children:a.nome},e):null})})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:["presencial"===en?(0,t.jsx)(D.MapPin,{className:"h-4 w-4 text-zinc-400"}):"remoto"===en?(0,t.jsx)(tJ,{className:"h-4 w-4 text-zinc-400"}):(0,t.jsx)(aB,{className:"h-4 w-4 text-zinc-400"}),(0,t.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Onde"})]}),"presencial"===en&&(0,t.jsxs)("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-2",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Local ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(eJ.Input,{...W.register("location"),placeholder:"Endereço, unidade ou ponto de referência",className:(0,ea.cn)(K.location&&"border-red-300")}),K.location&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.location.message})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(e0.Label,{className:"text-zinc-500",children:"Observação de acesso (Opcional)"}),(0,t.jsx)(tz.Textarea,{...W.register("accessSearch"),placeholder:"Instruções para portaria, estacionamento...",className:"h-20 resize-none"})]})]}),"remoto"===en&&(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 animate-in fade-in slide-in-from-top-2",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Plataforma ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(aL.Controller,{name:"platform",control:G,render:({field:e})=>(0,t.jsxs)(tC.Select,{value:e.value,onValueChange:e.onChange,children:[(0,t.jsx)(tC.SelectTrigger,{className:(0,ea.cn)(K.platform&&"border-red-300"),children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione..."})}),(0,t.jsx)(tC.SelectContent,{children:aX.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.label},e.id))})]})}),K.platform&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.platform.message})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Link da reunião ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(eJ.Input,{...W.register("link"),placeholder:"https://meet.google.com/...",className:(0,ea.cn)(K.link&&"border-red-300")}),K.link&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.link.message})]})]}),"outro"===en&&(0,t.jsxs)("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-2",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Tipo ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(eJ.Input,{...W.register("typeDescription"),placeholder:"Ex: Ligação, WhatsApp, Evento",className:(0,ea.cn)(K.typeDescription&&"border-red-300")}),K.typeDescription&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.typeDescription.message})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)(e0.Label,{children:"Detalhe (Opcional)"}),(0,t.jsx)(tz.Textarea,{...W.register("details"),className:"h-20 resize-none",placeholder:"Contexto adicional desta interação"})]})]})]}),"realizada"===ei&&(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-4 animate-in fade-in slide-in-from-top-2",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:[(0,t.jsx)(aF.Target,{className:"h-4 w-4 text-zinc-400"}),(0,t.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Resultado"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsxs)(e0.Label,{children:["Resultado da visita ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(aL.Controller,{name:"outcome",control:G,render:({field:e})=>(0,t.jsxs)(tC.Select,{value:e.value,onValueChange:e.onChange,children:[(0,t.jsx)(tC.SelectTrigger,{className:(0,ea.cn)(K.outcome&&"border-red-300"),children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione..."})}),(0,t.jsx)(tC.SelectContent,{children:aY.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.label},e.id))})]})}),K.outcome&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.outcome.message})]}),(0,t.jsxs)("div",{className:"space-y-1.5 md:col-span-1",children:[(0,t.jsxs)(e0.Label,{children:["Nota do resultado ",(0,t.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,t.jsx)(tz.Textarea,{...W.register("result"),placeholder:"Resuma o que aconteceu e próximos passos (mín. 10 caracteres)",className:(0,ea.cn)("h-24 resize-none",K.result&&"border-red-300")}),K.result&&(0,t.jsx)("p",{className:"text-xs text-red-500",children:K.result.message})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-4",children:[(0,t.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between",onClick:()=>O(e=>!e),children:[(0,t.jsx)("span",{className:"text-sm font-semibold text-zinc-700",children:"Observações"}),(0,t.jsx)("span",{className:"text-xs text-zinc-500",children:E?"Ocultar":"Mostrar"})]}),E&&(0,t.jsxs)("div",{className:"mt-3 space-y-1.5 animate-in fade-in slide-in-from-top-2",children:[(0,t.jsx)(e0.Label,{children:"Notas (Opcional)"}),(0,t.jsx)(tz.Textarea,{...W.register("objective"),placeholder:"Contexto para o time, objeções, detalhes importantes...",className:"h-24 resize-none"})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-brand/10 bg-brand/5 p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-brand",children:[(0,t.jsx)(a$.Sparkles,{className:"h-4 w-4 fill-brand/20"}),(0,t.jsx)("h4",{className:"text-xs font-semibold uppercase tracking-wider",children:"Menux Intelligence"})]}),!er&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-xs text-zinc-600",children:"Sugestão de horários para esta oportunidade:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:["09:00","14:30","16:00"].map(e=>(0,t.jsxs)(eG.Badge,{variant:"outline",className:"cursor-pointer border-brand/20 text-zinc-600 transition-colors hover:bg-brand/10 hover:text-brand",onClick:()=>ef(e),children:["Amanhã, ",e]},e))})]}),er&&el&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-xs text-zinc-600",children:"Mensagem de confirmação sugerida:"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 rounded border border-brand/10 bg-white p-2 text-xs text-zinc-500 italic",children:[(0,t.jsxs)("span",{className:"flex-1 truncate",children:["Olá! Confirmando nossa ","presencial"===en?"visita":"reunião"," para ",eF(new Date(er),"dd/MM")," às ",el,"..."]}),(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:ev,title:"Copiar",children:(0,t.jsx)(q.Copy,{className:"h-3 w-3"})})]})]})]}),(0,t.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-zinc-50/70 p-4",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,t.jsx)(u.User,{className:"h-4 w-4 text-zinc-500"}),(0,t.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Resumo antes de salvar"})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:eI.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-zinc-200/80 bg-white px-3 py-2",children:[(0,t.jsx)("span",{className:"text-xs text-zinc-500",children:e.label}),(0,t.jsx)("span",{className:"max-w-[60%] truncate text-xs font-medium text-zinc-800",children:e.value})]},e.label))}),ej.length>0&&(0,t.jsxs)("div",{className:"mt-3 rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 font-medium",children:[(0,t.jsx)(a_.default,{className:"h-3.5 w-3.5"}),"Faltando para salvar"]}),(0,t.jsx)("p",{className:"mt-1",children:ej.join(" • ")})]})]})]}),(0,t.jsx)("div",{className:"flex-none border-t border-zinc-100 bg-white px-8 py-6 z-10",children:v?(0,t.jsxs)("div",{className:"flex w-full items-center justify-end gap-2 animate-in fade-in slide-in-from-right-2",children:[(0,t.jsx)("span",{className:"mr-2 text-xs text-zinc-500",children:"Alterações não salvas. Descartar?"}),(0,t.jsx)(es.Button,{variant:"outline",size:"sm",onClick:()=>j(!1),children:"Voltar"}),(0,t.jsx)(es.Button,{variant:"destructive",size:"sm",onClick:eM,children:"Descartar"})]}):N&&S?(0,t.jsxs)("div",{className:"flex flex-col gap-3 rounded-xl border border-amber-200 bg-amber-50 px-3 py-2 animate-in fade-in slide-in-from-bottom-2 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("p",{className:"text-xs text-amber-700",children:["Você selecionou status ",(0,t.jsx)("strong",{children:"Realizada"}),". Confirmar criação agora com este status?"]}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(es.Button,{variant:"outline",size:"sm",onClick:()=>{w(!1),C(null)},children:"Revisar"}),(0,t.jsx)(es.Button,{size:"sm",onClick:async()=>{w(!1),await ew(S),C(null)},children:"Confirmar realizada"})]})]}):(0,t.jsxs)("div",{className:"space-y-2",children:[b&&(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 rounded-lg border border-red-200 bg-red-50 px-3 py-2",children:[(0,t.jsx)("p",{className:"text-xs text-red-700",children:b}),(0,t.jsx)(es.Button,{variant:"outline",size:"sm",className:"h-7",onClick:eC,disabled:!M||d,children:"Tentar novamente"})]}),!ee&&(0,t.jsx)("p",{className:"text-xs text-zinc-500",children:"Complete os campos obrigatórios para liberar o salvamento."}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(es.Button,{variant:"ghost",onClick:ek,children:"Cancelar"}),(0,t.jsx)(es.Button,{onClick:eS,disabled:d||h||ey,className:"min-w-[140px]",children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Salvando..."]}):h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.CheckCircle,{className:"mr-2 h-4 w-4"})," Salvo"]}):"Salvar Visita"})]})]})})]});return(0,t.jsx)(tM.Dialog,{open:e,onOpenChange:e=>!e&&ek(),children:(0,t.jsx)(tM.DialogContent,{showCloseButton:!1,className:"flex max-h-[90vh] w-full sm:max-w-2xl md:max-w-3xl flex-col gap-0 p-0 overflow-hidden bg-white border-zinc-200/50 shadow-2xl sm:rounded-2xl",children:eD})})}let aK=(0,c.default)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var aJ=e.i(80376);let a0=(0,c.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function a1({options:e,value:s,onValueChange:n,placeholder:i="Selecionar...",searchPlaceholder:r="Buscar...",emptyMessage:l="Nenhum resultado encontrado.",disabled:o=!1,locked:c=!1,className:d,...m}){let[u,x]=a.useState(!1),h=a.useMemo(()=>e.find(e=>e.value===s)??null,[e,s]);return(0,t.jsxs)(tO.Popover,{open:u,onOpenChange:c||o?void 0:x,children:[(0,t.jsx)(tO.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(es.Button,{variant:"outline",role:"combobox","aria-expanded":u,"aria-label":m["aria-label"],disabled:o,className:(0,ea.cn)("w-full justify-between font-normal h-10",!h&&"text-muted-foreground",c&&"cursor-default opacity-100 bg-zinc-50",d),onClick:e=>{c&&e.preventDefault()},children:[(0,t.jsx)("span",{className:"truncate",children:h?h.label:i}),c?(0,t.jsx)(a0,{className:"ml-2 h-3.5 w-3.5 shrink-0 text-zinc-400"}):(0,t.jsx)(tG,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,t.jsx)(tO.PopoverContent,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:(0,t.jsxs)(tB.Command,{children:[(0,t.jsx)(tB.CommandInput,{placeholder:r}),(0,t.jsxs)(tB.CommandList,{children:[(0,t.jsx)(tB.CommandEmpty,{children:l}),(0,t.jsx)(tB.CommandGroup,{children:e.map(e=>(0,t.jsxs)(tB.CommandItem,{value:e.label,disabled:e.disabled,onSelect:()=>{let t=e.value===s?null:e.value;n(t,t?e:null),x(!1)},children:[(0,t.jsx)(z.Check,{className:(0,ea.cn)("mr-2 h-4 w-4 shrink-0",s===e.value?"opacity-100":"opacity-0")}),(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,t.jsx)("span",{className:"truncate",children:e.label}),e.subtitle&&(0,t.jsx)("span",{className:"text-xs text-muted-foreground truncate",children:e.subtitle})]})]},e.value))})]})]})})]})}function a2({options:e,values:n,onValuesChange:i,placeholder:r="Selecionar...",searchPlaceholder:l="Buscar...",emptyMessage:o="Nenhum resultado encontrado.",disabled:c=!1,className:d,...m}){let[u,x]=a.useState(!1),h=a.useMemo(()=>e.filter(e=>n.includes(e.value)),[e,n]),p=a.useCallback(t=>{let a;a=n.includes(t.value)?n.filter(e=>e!==t.value):[...n,t.value];let s=e.filter(e=>a.includes(e.value));i(a,s)},[n,e,i]),g=a.useCallback(t=>{let a=n.filter(e=>e!==t),s=e.filter(e=>a.includes(e.value));i(a,s)},[n,e,i]);return(0,t.jsxs)("div",{className:(0,ea.cn)("space-y-1.5",d),children:[(0,t.jsxs)(tO.Popover,{open:u,onOpenChange:c?void 0:x,children:[(0,t.jsx)(tO.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(es.Button,{variant:"outline",role:"combobox","aria-expanded":u,"aria-label":m["aria-label"],disabled:c,className:(0,ea.cn)("w-full justify-between font-normal h-10",0===n.length&&"text-muted-foreground"),children:[(0,t.jsx)("span",{className:"truncate",children:0===n.length?r:`${n.length} selecionado${n.length>1?"s":""}`}),(0,t.jsx)(tG,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,t.jsx)(tO.PopoverContent,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:(0,t.jsxs)(tB.Command,{children:[(0,t.jsx)(tB.CommandInput,{placeholder:l}),(0,t.jsxs)(tB.CommandList,{children:[(0,t.jsx)(tB.CommandEmpty,{children:o}),(0,t.jsx)(tB.CommandGroup,{children:e.map(e=>{let a=n.includes(e.value);return(0,t.jsxs)(tB.CommandItem,{value:e.label,disabled:e.disabled,onSelect:()=>p(e),children:[(0,t.jsx)(z.Check,{className:(0,ea.cn)("mr-2 h-4 w-4 shrink-0",a?"opacity-100":"opacity-0")}),(0,t.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,t.jsx)("span",{className:"truncate",children:e.label}),e.subtitle&&(0,t.jsx)("span",{className:"text-xs text-muted-foreground truncate",children:e.subtitle})]})]},e.value)})})]})]})})]}),h.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:h.map(e=>(0,t.jsxs)(eG.Badge,{variant:"secondary",className:"gap-1 pr-1 text-xs font-normal",children:[e.label,(0,t.jsx)("button",{type:"button",onClick:()=>g(e.value),className:"ml-0.5 rounded-full p-0.5 hover:bg-zinc-300/50","aria-label":`Remover ${e.label}`,children:(0,t.jsx)(s.X,{className:"h-3 w-3"})})]},e.value))})]})}var a5=e.i(62201),a3=e.i(58829);let a4=a5.object({type:a5.enum(["call","email","meeting","visit","task","follow-up","whatsapp"]),title:a5.string().min(6,"O título deve ter pelo menos 6 caracteres").max(120,"O título deve ter no máximo 120 caracteres"),date:a5.string().min(1,"Data é obrigatória"),time:a5.string().optional(),description:a5.string().max(2e3,"Descrição pode ter no máximo 2000 caracteres").optional(),responsible:a5.string().optional(),clientId:a5.string().optional(),clientName:a5.string().optional(),contactIds:a5.array(a5.string()).optional(),contactNames:a5.array(a5.string()).optional(),opportunityId:a5.string().optional(),opportunityTitle:a5.string().optional()}).superRefine((e,t)=>{["call","meeting","whatsapp","email"].includes(e.type)&&!e.time&&t.addIssue({code:a3.ZodIssueCode.custom,message:"Horário é obrigatório para este tipo de atividade",path:["time"]}),e.contactIds?.length&&!e.clientId&&t.addIssue({code:a3.ZodIssueCode.custom,message:"Selecione um cliente antes de vincular contatos",path:["contactIds"]}),e.opportunityId&&!e.clientId&&t.addIssue({code:a3.ZodIssueCode.custom,message:"Selecione um cliente antes de vincular uma oportunidade",path:["opportunityId"]})}),a6=a5.object({type:a5.enum(["call","email","meeting","visit","task","follow-up","whatsapp"]),title:a5.string().min(6,"O título deve ter pelo menos 6 caracteres").max(120,"O título deve ter no máximo 120 caracteres"),date:a5.string().min(1,"Data é obrigatória"),time:a5.string().optional(),description:a5.string().max(2e3,"Descrição pode ter no máximo 2000 caracteres").optional(),responsible:a5.string().optional(),clientId:a5.string().min(1,"Cliente é obrigatório"),clientName:a5.string().min(1),contactIds:a5.array(a5.string()).optional(),contactNames:a5.array(a5.string()).optional(),opportunityId:a5.string().optional(),opportunityTitle:a5.string().optional()}).superRefine((e,t)=>{["call","meeting","whatsapp","email"].includes(e.type)&&!e.time&&t.addIssue({code:a3.ZodIssueCode.custom,message:"Horário é obrigatório para este tipo de atividade",path:["time"]})});var a7=e.i(96435),a8=e.i(13034);let a9=(0,tF.create)()((0,t$.devtools)((e,t)=>({contacts:a8.mockContacts,isLoading:!1,getByClient:e=>t().contacts.filter(t=>t.clientId===e),getById:e=>t().contacts.find(t=>t.id===e)}),{name:"contact-store"})),se=[{id:"call",label:"Ligação",icon:n.Phone},{id:"whatsapp",label:"WhatsApp",icon:i.MessageCircle},{id:"email",label:"E-mail",icon:l.Mail},{id:"meeting",label:"Reunião",icon:x.Users},{id:"task",label:"Tarefa",icon:tZ.CheckSquare}],st=new Set(["call","meeting","whatsapp","email"]);function sa({isOpen:e,onClose:n,onSave:i,dealId:r,initialType:l="task",initialClientId:c,initialClientName:d,initialContactIds:m,initialContactNames:u,initialOpportunityId:x,initialOpportunityTitle:h,lockClient:g=!1,requireClient:b=!1}){let f=function(e){let[t,s]=a.useState(!1);return a.useEffect(()=>{function t(e){s(e.matches)}let a=window.matchMedia(e);return a.addEventListener("change",t),s(a.matches),()=>a.removeEventListener("change",t)},[e]),t}("(min-width: 768px)"),[v,j]=a.useState(!1),[y,N]=a.useState(!1),[w,S]=a.useState(null),C=(0,a7.useClientStore)(e=>e.clients),z=a9(e=>e.getByClient),M=(0,aV.useOpportunityStore)(e=>e.opportunities),I=b?a6:a4,D=(0,aL.useForm)({resolver:(0,aO.zodResolver)(I),mode:"onChange",defaultValues:{type:l,title:"",date:eF(new Date,"yyyy-MM-dd"),time:eF(new Date,"HH:mm"),description:"",clientId:c??"",clientName:d??"",contactIds:m??[],contactNames:u??[],opportunityId:x??"",opportunityTitle:h??""}}),{register:A,handleSubmit:T,control:R,setValue:P,formState:{errors:E,isValid:L},reset:O}=D,B=(0,aL.useWatch)({control:R,name:"type"}),F=(0,aL.useWatch)({control:R,name:"clientId"}),$=(0,aL.useWatch)({control:R,name:"description"}),_=(0,aL.useWatch)({control:R,name:"contactIds"}),q=(0,aL.useWatch)({control:R,name:"opportunityId"}),H=a.useMemo(()=>C.map(e=>({value:e.id,label:e.companyName,subtitle:e.city??void 0})),[C]),U=a.useMemo(()=>F?z(F).map(e=>{var t;return{value:e.id,label:e.nome,subtitle:(t=e.cargo,tA.RESTAURANT_POSITIONS.find(e=>e.value===t)?.label??t)}}):[],[F,z]),W=a.useMemo(()=>F?M.filter(e=>e.clientId===F&&"open"===e.status).map(e=>({value:e.id,label:e.title})):[],[F,M]),G=a.useCallback((e,t)=>{P("clientId",e??"",{shouldValidate:!0}),P("clientName",t?.label??""),P("contactIds",[]),P("contactNames",[]),P("opportunityId",""),P("opportunityTitle","")},[P]),X=a.useCallback((e,t)=>{P("contactIds",e),P("contactNames",t.map(e=>e.label))},[P]),Y=a.useCallback((e,t)=>{P("opportunityId",e??""),P("opportunityTitle",t?.label??"")},[P]),Q=a.useRef(F);a.useEffect(()=>{if(F&&F!==Q.current&&!g){let e=M.filter(e=>e.clientId===F&&"open"===e.status).sort((e,t)=>t.updatedAt.localeCompare(e.updatedAt));e.length>0&&(P("opportunityId",e[0].id),P("opportunityTitle",e[0].title))}Q.current=F},[F,g,M,P]),a.useEffect(()=>{e&&setTimeout(()=>{O({type:l,title:"",date:eF(new Date,"yyyy-MM-dd"),time:eF(new Date,"HH:mm"),description:"",clientId:c??"",clientName:d??"",contactIds:m??[],contactNames:u??[],opportunityId:x??"",opportunityTitle:h??""}),Q.current=c??"",N(!1),S(null)},50)},[e,O,l,c,d,m,u,x,h]);let Z=async e=>{j(!0),S(null);try{await Promise.resolve(i(e)),N(!0),setTimeout(()=>{j(!1),n()},320)}catch{j(!1),N(!1),S("Não foi possível criar a atividade. Tente novamente.")}},K=st.has(B),J=(0,t.jsxs)("div",{className:"flex h-full flex-col bg-white",children:[(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(0,t.jsxs)("form",{id:"activity-form",onSubmit:T(Z),className:"space-y-5",children:[(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(e0.Label,{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Tipo de Atividade"}),(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-5",children:se.map(e=>{let a=e.icon,s=B===e.id;return(0,t.jsxs)("button",{type:"button",onClick:()=>P("type",e.id,{shouldValidate:!0}),className:(0,ea.cn)("flex h-[72px] flex-col items-center justify-center gap-2 rounded-xl border p-2 transition-all hover:bg-zinc-50",s?"border-brand bg-brand/5 text-brand ring-1 ring-brand":"border-zinc-200 bg-white text-zinc-600"),children:[(0,t.jsx)(a,{className:(0,ea.cn)("h-5 w-5",s?"text-brand":"text-zinc-400")}),(0,t.jsx)("span",{className:"text-[10px] font-medium",children:e.label})]},e.id)})})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)(e0.Label,{className:"flex items-center gap-1.5 text-xs font-semibold uppercase tracking-wider text-zinc-500",children:[(0,t.jsx)(aK,{className:"h-3.5 w-3.5"}),"Vincular a"]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(e0.Label,{className:"mb-1.5 block text-xs text-zinc-500",children:["Cliente (restaurante)",b&&(0,t.jsx)("span",{className:"ml-0.5 text-red-500",children:"*"})]}),(0,t.jsx)(a1,{options:H,value:F||null,onValueChange:G,placeholder:"Buscar cliente...",searchPlaceholder:"Digite o nome do cliente...",emptyMessage:"Nenhum cliente encontrado.",locked:g,"aria-label":"Cliente"}),E.clientId&&(0,t.jsx)("p",{className:"mt-1 text-xs text-red-500",children:E.clientId.message}),!b&&!F&&(0,t.jsx)("p",{className:"mt-1 text-[11px] text-amber-600",children:"Vincular a um cliente melhora a rastreabilidade da atividade"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block text-xs text-zinc-500",children:"Contatos (pessoas)"}),(0,t.jsx)(a2,{options:U,values:_??[],onValuesChange:X,placeholder:F?"Selecionar contatos...":"Selecione um restaurante primeiro",searchPlaceholder:"Buscar contato...",emptyMessage:"Nenhum contato encontrado.",disabled:!F,"aria-label":"Contatos"})]}),F&&W.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block text-xs text-zinc-500",children:"Oportunidade (opcional)"}),(0,t.jsx)(a1,{options:W,value:q||null,onValueChange:Y,placeholder:"Selecionar oportunidade...",searchPlaceholder:"Buscar oportunidade...",emptyMessage:"Nenhuma oportunidade aberta.","aria-label":"Oportunidade"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Título"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eJ.Input,{...A("title"),placeholder:"Ex: Ligar para confirmar recebimento...",className:(0,ea.cn)("pr-10 font-medium",E.title&&"border-red-300 ring-red-100")}),(0,t.jsx)("button",{type:"button",onClick:()=>{let e=D.getValues("clientName")||"",t=se.find(e=>e.id===B)?.label??"Follow-up";P("title",e?`${t} com ${e}`:"Follow-up da proposta enviada",{shouldValidate:!0});let a=r?` para a negocia\xe7\xe3o`:"";P("description",`Verificar se o cliente teve alguma d\xfavida sobre os valores apresentados${a}.`)},className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full p-1 text-brand transition-colors hover:bg-brand/10",title:"Sugestão Menux AI",children:(0,t.jsx)(a$.Sparkles,{className:"h-4 w-4"})})]}),E.title&&(0,t.jsx)("p",{className:"mt-1 text-xs text-red-500",children:E.title.message})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Data"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(o.Calendar,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-zinc-400"}),(0,t.jsx)(eJ.Input,{type:"date",...A("date"),className:(0,ea.cn)("pl-9",E.date&&"border-red-300 ring-red-100")})]}),E.date&&(0,t.jsx)("p",{className:"mt-1 text-xs text-red-500",children:E.date.message})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)(e0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:["Hora"," ",K?(0,t.jsx)("span",{className:"text-red-500",children:"*"}):(0,t.jsx)("span",{className:"font-normal normal-case text-zinc-400",children:"(opcional)"})]}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(p.Clock,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-zinc-400"}),(0,t.jsx)(eJ.Input,{type:"time",...A("time"),className:(0,ea.cn)("pl-9",E.time&&"border-red-300 ring-red-100")})]}),E.time&&(0,t.jsx)("p",{className:"mt-1 text-xs text-red-500",children:E.time.message})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Descrição (Opcional)"}),(0,t.jsx)(tz.Textarea,{...A("description"),placeholder:"Detalhes adicionais sobre a atividade...",className:"min-h-[100px] resize-none",maxLength:2e3}),(0,t.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[E.description?(0,t.jsx)("p",{className:"text-xs text-red-500",children:E.description.message}):(0,t.jsx)("span",{}),(0,t.jsxs)("span",{className:"text-[11px] text-zinc-400",children:[$?.length??0,"/2000"]})]})]}),F&&B&&(0,t.jsx)("div",{className:"rounded-lg border border-indigo-100 bg-indigo-50/50 p-3",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(a$.Sparkles,{className:"mt-0.5 h-4 w-4 text-indigo-500"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-indigo-900",children:"Sugestão Menux"}),(0,t.jsxs)("p",{className:"text-[11px] leading-relaxed text-indigo-700",children:["Baseado no histórico, o melhor horário para ligar para este cliente é entre ",(0,t.jsx)("strong",{children:"14:00 e 16:00"}),"."]})]})]})}),w&&(0,t.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2",children:(0,t.jsx)("p",{className:"text-xs text-red-700",children:w})})]})}),(0,t.jsx)("div",{className:"mt-auto border-t border-zinc-100 bg-zinc-50/50 p-4 md:px-6 md:py-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,t.jsx)(es.Button,{variant:"ghost",onClick:n,disabled:v,children:"Cancelar"}),(0,t.jsx)(es.Button,{type:"submit",form:"activity-form",className:"min-w-[160px] bg-brand text-white hover:bg-brand/90",disabled:v||y||!L,children:v?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):y?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.CheckCircle,{className:"mr-2 h-4 w-4"}),"Criado!"]}):"Criar Atividade"})]})})]});return f?(0,t.jsx)(tM.Dialog,{open:e,onOpenChange:n,children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-md gap-0 overflow-hidden border-0 p-0 shadow-2xl sm:max-w-xl",children:[(0,t.jsx)(tM.DialogHeader,{className:"border-b border-zinc-100 bg-white px-6 py-4",children:(0,t.jsx)(tM.DialogTitle,{className:"flex items-center gap-2 font-heading text-lg font-semibold text-zinc-900",children:"Nova Atividade"})}),J]})}):(0,t.jsx)(aJ.Sheet,{open:e,onOpenChange:n,children:(0,t.jsxs)(aJ.SheetContent,{side:"bottom",className:"h-[90vh] gap-0 overflow-hidden rounded-t-[20px] p-0",children:[(0,t.jsx)(aJ.SheetHeader,{className:"border-b border-zinc-100 bg-white px-4 py-3 text-left",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)(aJ.SheetTitle,{className:"font-heading text-lg font-semibold text-zinc-900",children:"Nova Atividade"}),(0,t.jsx)("button",{onClick:n,className:"rounded-full p-2 hover:bg-zinc-100",children:(0,t.jsx)(s.X,{className:"h-5 w-5 text-zinc-500"})})]})}),J]})})}var ss=e.i(13917);let sn=(0,tF.create)()((0,t$.devtools)((e,t)=>({visits:ss.mockVisits,isLoading:!1,getByOpportunity:e=>t().visits.filter(t=>t.opportunityId===e),getByClient:e=>t().visits.filter(t=>t.clientId===e),getById:e=>t().visits.find(t=>t.id===e)}),{name:"visit-store"}));var si=e.i(40351);let sr=(0,tF.create)()((0,t$.devtools)((e,t)=>({notes:si.mockNotes,isLoading:!1,getByOpportunity:e=>t().notes.filter(t=>t.opportunityId===e),getById:e=>t().notes.find(t=>t.id===e)}),{name:"note-store"}));var sl=e.i(47691);let so="proposta-enviada",sc="Maria Silva",sd=[{id:"pedido_cliente",label:"Pedido do cliente"},{id:"objecao",label:"Objeção"},{id:"decisao",label:"Decisão"},{id:"proximo_passo",label:"Próximo passo"}],sm=[{id:"all",label:"Todos"},{id:"cliente",label:"Cliente"},{id:"decisao",label:"Decisões"},{id:"proximo_passo",label:"Próximo passo"}],su={general:{label:"Registro",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-700"},pedido_cliente:{label:"Pedido do cliente",chipClass:"border-sky-200 bg-sky-50 text-sky-700"},objecao:{label:"Objeção",chipClass:"border-amber-200 bg-amber-50 text-amber-700"},decisao:{label:"Decisão",chipClass:"border-emerald-200 bg-emerald-50 text-emerald-700"},proximo_passo:{label:"Próximo passo",chipClass:"border-brand/20 bg-brand/10 text-brand"},system:{label:"Sistema",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-500"}};function sx(e){if("string"!=typeof e)return"empresa";switch(e.trim().toLowerCase()){case"empresa":default:return"empresa";case"contatos":return"contatos";case"visitas":return"visitas";case"atividades":return"atividades";case"negociacao":case"negociação":return"negociacao";case"anotacoes":case"anotações":case"notes":return"anotacoes";case"linha-do-tempo":case"timeline":return"linha-do-tempo"}}function sh(e,t){}let sp={hot:{label:"Quente",icon:(0,t.jsx)(g.Flame,{className:"h-3.5 w-3.5"}),color:"text-status-danger",bg:"bg-status-danger-light",border:"border-status-danger/15",chipClass:"bg-red-50 text-red-600 border-red-200/40 hover:bg-red-100/60"},warm:{label:"Morna",icon:(0,t.jsx)(b.Thermometer,{className:"h-3.5 w-3.5"}),color:"text-status-warning",bg:"bg-status-warning-light",border:"border-status-warning/15",chipClass:"bg-amber-50 text-amber-600 border-amber-200/40 hover:bg-amber-100/60"},cold:{label:"Fria",icon:(0,t.jsx)(f.Snowflake,{className:"h-3.5 w-3.5"}),color:"text-status-info",bg:"bg-status-info-light",border:"border-status-info/15",chipClass:"bg-sky-50 text-sky-600 border-sky-200/40 hover:bg-sky-100/60"}},sg=[{id:"lead-in",label:"Lead-In"},{id:"contato-feito",label:"Contato Feito"},{id:"reuniao-agendada",label:"Reuniao Agendada"},{id:"proposta-enviada",label:"Proposta Enviada"},{id:"negociacao",label:"Negociacao"},{id:"fechamento",label:"Fechamento"}],sb={open:{label:"Aberto",color:"text-brand",bg:"bg-brand/10"},won:{label:"Ganho",color:"text-status-success",bg:"bg-status-success/10"},lost:{label:"Perdido",color:"text-status-danger",bg:"bg-status-danger/10"}},sf=[{id:"restaurante",label:"Restaurante",icon:_},{id:"cafeteria",label:"Cafeteria",icon:U},{id:"bar",label:"Bar / Pub",icon:W},{id:"pizzaria",label:"Pizzaria",icon:G},{id:"hamburgueria",label:"Hamburgueria",icon:Z},{id:"padaria",label:"Padaria",icon:X},{id:"sorveteria",label:"Sorveteria",icon:Q},{id:"delivery",label:"Delivery",icon:Y},{id:"food-truck",label:"Food Truck",icon:g.Flame},{id:"bistro",label:"Bistrô",icon:K},{id:"buffet",label:"Buffet",icon:x.Users},{id:"adega",label:"Adega / Empório",icon:h}],sv=[{id:"seg",label:"Segunda"},{id:"ter",label:"Terça"},{id:"qua",label:"Quarta"},{id:"qui",label:"Quinta"},{id:"sex",label:"Sexta"},{id:"sab",label:"Sábado"},{id:"dom",label:"Domingo"}],sj=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],sy={id:"1",clientId:"client-1",title:"Restaurante Bela Vista",clientName:"Restaurante Bela Vista Ltda",nomeFantasia:"Restaurante Bela Vista",segmento:"Food service premium",nomeInterno:"",fonte:"Indicação parceiro",cep:"01411-000",logradouro:"Rua das Flores",numero:"123",complemento:"",bairro:"Jardim Paulista",cidade:"Sao Paulo",estado:"SP",telefoneEmpresa:"(11) 3456-7890",emailEmpresa:"contato@belavista.com",value:12e3,monthlyValue:1e3,stage:"contato-feito",temperature:"hot",score:78,responsibleId:"u1",responsibleName:"Maria Silva",responsibleAvatar:"",tags:["food-service","restaurante","premium"],source:"Indicacao",currency:"BRL",expectedCloseDate:"2026-03-15",createdAt:"2026-01-15",updatedAt:"2026-02-05",notes:"Cliente muito interessado. Agendar reuniao de apresentacao do modulo financeiro.",groupName:null,website:"https://belavista.com.br",instagram:"https://instagram.com/belavistarestaurante",cardapio:"https://belavista.com.br/cardapio",metadata:{stageValues:{origem_lead:"google"}}};function sN(e){return tA.RESTAURANT_POSITIONS.find(t=>t.value===e)?.label??e}function sw(e){return(0,tA.getPositionPatentScore)(e)}let sS=sl.mockUsers.filter(e=>e.isActive).map(e=>({id:e.id,name:e.name,avatar:""})),sC={"google-meet":"Google Meet",zoom:"Zoom",whatsapp:"WhatsApp",outro:"Outra plataforma"},sz={realizada:"Realizada","no-show":"No-show",remarcada:"Remarcada"},sk={agendada:0,realizada:1,cancelada:2},sM=[{id:"v1",type:"presencial",location:"Restaurante Bela Vista",status:"agendada",startAt:"2026-02-15T14:00:00.000Z",responsible:"Maria Silva",objective:"Validar escopo de onboarding e próximos marcos.",durationMinutes:60,createdAt:"2026-02-10T09:00:00.000Z"},{id:"v2",type:"remoto",location:"Google Meet",status:"realizada",startAt:"2026-02-10T10:00:00.000Z",responsible:"Pedro Santos",result:"Cliente demonstrou interesse no módulo financeiro.",objective:"Apresentar proposta e mapear objeções.",platform:"google-meet",link:"https://meet.google.com/abc-defg-hij",durationMinutes:60,createdAt:"2026-02-06T12:00:00.000Z"}],sI=[{id:"n1",authorId:"u1",authorName:"Maria Silva",createdAt:"2026-02-14T09:30:00.000Z",body:"Cliente solicitou nova proposta com desconto de 5% para fechar ainda este mês.",intent:"pedido_cliente",visibility:"team"},{id:"n2",authorId:"u2",authorName:"Pedro Santos",createdAt:"2026-02-10T16:15:00.000Z",body:"Reunião de alinhamento realizada. O cliente gostou bastante da demonstração do painel financeiro.",intent:"decisao",visibility:"team"},{id:"n3",authorId:"system",authorName:"Sistema",createdAt:"2026-02-05T10:00:00.000Z",body:"Oportunidade movida para a etapa de Negociação.",intent:"system",visibility:"team",isSystem:!0}],sD=["Preco alto","Escolheu concorrente","Sem orcamento","Projeto cancelado","Sem resposta","Outro"];function sA(e){return e.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase()}function sT({banner:e,onDismiss:n}){(0,a.useEffect)(()=>{if("success"===e.variant||"info"===e.variant){let e=setTimeout(n,3e3);return()=>clearTimeout(e)}},[e,n]);let i={success:(0,t.jsx)(z.Check,{className:"h-3.5 w-3.5 shrink-0"}),error:(0,t.jsx)(P.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"}),info:(0,t.jsx)(O.Activity,{className:"h-3.5 w-3.5 shrink-0"}),warning:(0,t.jsx)(P.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"})};return(0,t.jsxs)("div",{className:`flex items-center gap-2 rounded-[10px] border px-3 py-2 font-body text-xs font-medium animate-in fade-in slide-in-from-top-1 duration-200 ${{success:"bg-status-success/10 text-status-success border-status-success/20",error:"bg-status-danger/10 text-status-danger border-status-danger/20",info:"bg-brand/10 text-brand border-brand/20",warning:"bg-status-warning/10 text-status-warning border-status-warning/20"}[e.variant]}`,role:"error"===e.variant?"alert":"status","aria-live":"error"===e.variant?"assertive":"polite",children:[i[e.variant],(0,t.jsx)("span",{className:"flex-1",children:e.message}),e.action&&(0,t.jsx)("button",{onClick:e.action.onClick,className:"shrink-0 underline underline-offset-2 transition-opacity hover:opacity-70",children:e.action.label}),(0,t.jsx)("button",{onClick:n,className:"shrink-0 rounded p-0.5 transition-colors hover:bg-black/10","aria-label":"Fechar",children:(0,t.jsx)(s.X,{className:"h-3 w-3"})})]})}function sR({value:e,onSave:n,className:i="",inputClassName:r="",type:l="text",readOnly:o=!1,validate:c}){let[d,m]=(0,a.useState)(!1),[u,x]=(0,a.useState)(e),[h,p]=(0,a.useState)(null),g=(0,a.useRef)(null);function b(){if(c){let e=c(u);if(e)return void p(e)}m(!1),p(null),u!==e&&n(u)}function f(){x(e),m(!1),p(null)}return((0,a.useEffect)(()=>{d&&g.current&&(g.current.focus(),g.current.select())},[d]),o)?(0,t.jsx)("span",{className:i,children:e||"--"}):d?(0,t.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(eJ.Input,{ref:g,type:l,value:u,onChange:e=>{x(e.target.value),p(null)},onBlur:b,onKeyDown:e=>{"Enter"===e.key&&b(),"Escape"===e.key&&f()},className:`h-7 rounded-[10px] font-body text-sm ${r}`}),(0,t.jsx)("button",{onMouseDown:e=>e.preventDefault(),onClick:b,className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md text-status-success transition-colors hover:bg-status-success/10","aria-label":"Salvar",children:(0,t.jsx)(z.Check,{className:"h-3.5 w-3.5"})}),(0,t.jsx)("button",{onMouseDown:e=>e.preventDefault(),onClick:f,className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md text-zinc-400 transition-colors hover:bg-zinc-100","aria-label":"Cancelar",children:(0,t.jsx)(s.X,{className:"h-3.5 w-3.5"})})]}),h&&(0,t.jsx)("p",{className:"font-body text-[10px] text-status-danger",role:"alert",children:h})]}):(0,t.jsx)("span",{onClick:()=>{x(e),m(!0)},className:`cursor-pointer rounded-md px-1 py-0.5 transition-colors hover:bg-zinc-100 ${i}`,title:"Clique para editar",role:"button",tabIndex:0,onKeyDown:t=>{("Enter"===t.key||" "===t.key)&&(t.preventDefault(),x(e),m(!0))},children:e||"--"})}function sP({currentStage:e,onStageChange:a,disabled:s=!1,statusBanner:n,onBannerDismiss:i}){let r=sg.findIndex(t=>t.id===e),l=sg[r]?.label??"Etapa";return(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(eX.DropdownMenu,{children:[(0,t.jsx)(eX.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)("button",{disabled:s,className:`inline-flex h-8 items-center gap-1.5 rounded-full border border-brand/20 bg-brand/10 px-3 py-1.5 font-body text-xs font-semibold text-brand transition-all duration-150 ease-out hover:bg-brand/15 hover:border-brand/30 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 focus-visible:ring-offset-1 ${s?"pointer-events-none opacity-50":""}`,"aria-label":`Etapa atual: ${l}`,children:[(0,t.jsx)("span",{className:"font-body text-[10px] font-medium text-brand/60",children:"Etapa"}),(0,t.jsx)("span",{className:"font-body text-[11px]",children:l}),(0,t.jsx)(L.ChevronDown,{className:"h-3 w-3 opacity-60"})]})}),(0,t.jsx)(eX.DropdownMenuContent,{align:"start",className:"rounded-[var(--radius-bento-card)] min-w-[200px]",children:sg.map((s,n)=>{let i=s.id===e,l=n<r;return(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>a(s.id),className:`flex items-center gap-2 font-body text-sm ${i?"font-semibold text-brand":l?"text-brand/70":"text-zinc-500"}`,children:[l&&(0,t.jsx)(z.Check,{className:"h-3.5 w-3.5 text-brand"}),i&&(0,t.jsx)(C.ChevronRight,{className:"h-3.5 w-3.5 text-brand"}),!l&&!i&&(0,t.jsx)("span",{className:"h-3.5 w-3.5"}),s.label,i&&(0,t.jsx)("span",{className:"ml-auto rounded-full bg-brand/10 px-1.5 py-0.5 font-body text-[9px] font-medium text-brand",children:"Atual"})]},s.id)})})]}),n&&(0,t.jsx)(sT,{banner:n,onDismiss:i})]})}function sE({events:e}){let[s,n]=(0,a.useState)("all"),i="all"===s?e:e.filter(e=>e.type===s);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(B.Filter,{className:"h-3.5 w-3.5 text-zinc-300"}),[{value:"all",label:"Todos"},{value:"activity",label:"Atividades"},{value:"stage-change",label:"Etapas"},{value:"note",label:"Notas"},{value:"value-change",label:"Valores"}].map(e=>(0,t.jsx)("button",{onClick:()=>n(e.value),className:(0,ea.cn)("rounded-full px-2.5 py-1 font-body text-[11px] font-medium transition-all",s===e.value?"bg-brand/10 text-brand":"bg-zinc-50 text-zinc-400 hover:bg-zinc-100"),children:e.label},e.value))]}),0===i.length?(0,t.jsxs)("div",{className:"flex flex-col items-center py-8 text-center",children:[(0,t.jsx)(O.Activity,{className:"h-8 w-8 text-zinc-200"}),(0,t.jsx)("p",{className:"mt-2 font-body text-sm text-zinc-400",children:"Sem atividades encontradas"}),(0,t.jsx)(es.Button,{size:"sm",variant:"ghost",className:"mt-2 rounded-full font-body text-xs text-brand",onClick:()=>n("all"),children:"Limpar filtro"})]}):(0,t.jsx)("div",{className:"relative space-y-0",children:i.map((e,a)=>(0,t.jsxs)("div",{className:"group relative flex gap-3 pb-5",children:[a<i.length-1&&(0,t.jsx)("div",{className:"absolute left-[13px] top-7 h-full w-px bg-zinc-100"}),(0,t.jsx)("div",{className:(0,ea.cn)("relative z-10 flex h-7 w-7 shrink-0 items-center justify-center rounded-full transition-all ring-4 ring-white",function(e){switch(e){case"activity":return"bg-brand/10 text-brand";case"stage-change":return"bg-purple-50 text-purple-600";case"note":return"bg-yellow-50 text-yellow-600";case"value-change":return"bg-green-50 text-green-600";default:return"bg-zinc-100 text-zinc-500"}}(e.type)),children:function(e,a){if(a)return(0,t.jsx)(a,{className:"h-3.5 w-3.5"});switch(e){case"activity":return(0,t.jsx)(k.CheckCircle,{className:"h-3.5 w-3.5"});case"stage-change":return(0,t.jsx)(R.ArrowRight,{className:"h-3.5 w-3.5"});case"note":return(0,t.jsx)(T.FileText,{className:"h-3.5 w-3.5"});case"value-change":return(0,t.jsx)(m.DollarSign,{className:"h-3.5 w-3.5"});case"tag-added":return(0,t.jsx)(d,{className:"h-3.5 w-3.5"});default:return(0,t.jsx)(p.Clock,{className:"h-3.5 w-3.5"})}}(e.type,e.icon)}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 pt-0.5",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-heading text-xs font-semibold text-zinc-900",children:e.title||"Evento"}),(0,t.jsx)("p",{className:"font-body text-sm text-zinc-600",children:e.description||e.message})]}),(0,t.jsxs)("div",{className:"mt-1 flex items-center gap-1.5",children:[(0,t.jsx)("div",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-zinc-100 text-[9px] font-bold text-zinc-500",children:(e.author||e.user||"?").charAt(0)}),(0,t.jsxs)("p",{className:"font-body text-[10px] text-zinc-400",children:[e.author||e.user," · ",e.date]})]})]})]},e.id))})]})}function sV({contact:e,patentScore:a,isPrimary:s,onEdit:i,onDelete:r,onToggleDecisionMaker:o}){return(0,t.jsxs)("div",{className:"group flex items-stretch rounded-[14px] border border-zinc-100 transition-all hover:border-zinc-200 hover:shadow-sm",children:[(0,t.jsx)("button",{type:"button",onClick:o,className:`flex w-9 shrink-0 items-center justify-center rounded-l-[14px] border-r transition-colors ${e.isDecisionMaker?"border-brand/20 bg-brand/10 text-brand":"border-zinc-100 bg-zinc-50/50 text-zinc-300 hover:bg-zinc-100 hover:text-zinc-400"}`,"aria-label":e.isDecisionMaker?"Remover como decisor":"Marcar como decisor",title:e.isDecisionMaker?"Decisor (clique para remover)":"Marcar como decisor",children:(0,t.jsx)(S.Shield,{className:"h-3.5 w-3.5"})}),(0,t.jsxs)("div",{className:"flex flex-1 items-start justify-between p-3.5",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-zinc-50",children:(0,t.jsx)(u.User,{className:"h-4 w-4 text-zinc-400"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-heading text-sm font-semibold text-black",children:e.nome}),s&&(0,t.jsx)(eG.Badge,{className:"rounded-[6px] bg-zinc-100 px-1.5 py-0.5 font-body text-[9px] text-zinc-700",children:"Principal"}),e.isDecisionMaker&&(0,t.jsxs)(eG.Badge,{className:"gap-0.5 rounded-[6px] bg-brand/10 px-1.5 py-0.5 font-body text-[9px] text-brand",children:[(0,t.jsx)(S.Shield,{className:"h-2.5 w-2.5"})," Decisor"]}),(0,t.jsxs)(eG.Badge,{className:"gap-0.5 rounded-[6px] bg-indigo-50 px-1.5 py-0.5 font-body text-[9px] text-indigo-700",children:["Patente ",a]})]}),(0,t.jsx)("p",{className:"font-body text-[11px] text-zinc-400",children:sN(e.cargo)}),(0,t.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-3",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1 font-body text-[11px] text-zinc-500",children:[(0,t.jsx)(l.Mail,{className:"h-3 w-3"})," ",e.email]}),(0,t.jsxs)("span",{className:"flex items-center gap-1 font-body text-[11px] text-zinc-500",children:[(0,t.jsx)(n.Phone,{className:"h-3 w-3"})," ",e.telefone]})]}),e.personalidade&&(0,t.jsxs)("p",{className:"mt-1.5 font-body text-[11px] italic text-zinc-400",children:["“",e.personalidade,"”"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-0.5 opacity-0 transition-opacity group-hover:opacity-100",children:[(0,t.jsx)("button",{onClick:i,className:"flex h-7 w-7 items-center justify-center rounded-md text-zinc-400 transition-colors hover:bg-zinc-100 hover:text-zinc-600","aria-label":"Editar contato",children:(0,t.jsx)(M.Pencil,{className:"h-3.5 w-3.5"})}),(0,t.jsx)("button",{onClick:r,className:"flex h-7 w-7 items-center justify-center rounded-md text-zinc-400 transition-colors hover:bg-status-danger/10 hover:text-status-danger","aria-label":"Remover contato",children:(0,t.jsx)(N.Trash2,{className:"h-3.5 w-3.5"})})]})]})]})}function sL({current:e,onChange:a,suggested:s,disabled:n=!1}){let i=sp[e];return(0,t.jsx)("div",{className:`flex items-center gap-2 ${n?"pointer-events-none opacity-50":""}`,children:(0,t.jsxs)(eX.DropdownMenu,{children:[(0,t.jsx)(eX.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)("button",{disabled:n,className:`inline-flex h-8 items-center gap-1.5 rounded-full border px-3 py-1.5 font-body text-[11px] font-semibold transition-all duration-150 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 focus-visible:ring-offset-1 ${i.chipClass}`,"aria-label":`Temperatura: ${i.label}`,children:[i.icon,i.label,(0,t.jsx)(L.ChevronDown,{className:"h-3 w-3 opacity-50"})]})}),(0,t.jsxs)(eX.DropdownMenuContent,{align:"start",className:"rounded-[var(--radius-bento-card)] min-w-[180px]",children:[["hot","warm","cold"].map(s=>{let n=sp[s],i=e===s;return(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>a(s),className:`flex items-center gap-2 font-body text-sm ${i?"font-semibold":""}`,children:[(0,t.jsx)("span",{className:n.color,children:n.icon}),(0,t.jsx)("span",{className:i?n.color:"text-zinc-600",children:n.label}),i&&(0,t.jsx)(z.Check,{className:"ml-auto h-3.5 w-3.5 text-brand"})]},s)}),s&&s!==e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eX.DropdownMenuSeparator,{}),(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>a(s),className:"flex items-center gap-2 font-body text-xs text-brand",children:[(0,t.jsx)(w.Star,{className:"h-3 w-3"}),"Sugestao: ",sp[s].label]})]})]})]})})}function sO({onConfirm:e,onCancel:s,isLoading:n}){let[i,r]=(0,a.useState)("");return(0,t.jsxs)("div",{className:"animate-in slide-in-from-right-2 space-y-4 rounded-[14px] border border-status-danger/20 bg-status-danger/5 p-4 duration-200",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-heading text-sm font-semibold text-status-danger",children:"Motivo da perda"}),(0,t.jsx)("p",{className:"mt-0.5 font-body text-xs text-zinc-500",children:"Marcar como perdido encerra a oportunidade. Voce quer continuar?"})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:sD.map(e=>(0,t.jsx)("button",{onClick:()=>r(e),className:`rounded-full border px-3 py-1.5 font-body text-xs transition-all ${i===e?"border-status-danger bg-status-danger text-white":"border-zinc-200 bg-white text-zinc-600 hover:border-zinc-300"}`,children:e},e))}),(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,t.jsx)(es.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-xs",onClick:s,disabled:n,children:"Cancelar"}),(0,t.jsxs)(es.Button,{size:"sm",className:"rounded-full bg-status-danger font-heading text-xs text-white hover:bg-status-danger/90",onClick:()=>{i&&e(i)},disabled:!i||n,children:[n?(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):null,"Confirmar perda"]})]})]})}function sB({value:e,children:s,className:n=""}){let[i,r]=(0,a.useState)(!1),l=(0,a.useCallback)(()=>{navigator.clipboard.writeText(e).then(()=>{r(!0),setTimeout(()=>r(!1),1200)})},[e]);return(0,t.jsxs)("button",{onClick:l,className:`group/copy relative inline-flex items-center gap-1.5 transition-all duration-120 ease-out hover:scale-[1.03] hover:bg-black/[0.04] active:scale-[0.97] rounded-md px-1 py-0.5 ${n}`,title:`Copiar: ${e}`,children:[s,i?(0,t.jsxs)("span",{className:"inline-flex items-center gap-0.5 font-body text-[9px] font-semibold text-status-success animate-in fade-in duration-[90ms]",children:[(0,t.jsx)(z.Check,{className:"h-2.5 w-2.5"}),"Copiado"]}):(0,t.jsx)(q.Copy,{className:"h-2.5 w-2.5 text-zinc-300 opacity-0 transition-opacity duration-120 group-hover/copy:opacity-100"})]})}function sF({nomeFantasia:e,segmento:s,enderecoFormatado:i,telefoneEmpresa:r,emailEmpresa:o,website:c,instagramUrl:d,cardapioUrl:m,primaryContact:x,stage:h,temperature:p,responsibleName:g,responsibleId:b,suggestedTemperature:f,onStageChange:v,onTemperatureChange:N,onResponsibleChange:w,onOpenPrimaryContact:S,onCreatePrimaryContact:k,teamMembers:I,isLocked:A,stageBanner:T,onStageBannerDismiss:R}){let[P,E]=(0,a.useState)(null),V=c||d||m,L=r||o||V,O=(0,a.useCallback)(e=>{E(e),setTimeout(()=>E(null),1200)},[]);return(0,t.jsx)("div",{className:"mt-4 pb-2 animate-in fade-in slide-in-from-bottom-1 duration-[180ms] ease-out",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-12 md:gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-5 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,t.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg bg-brand/8",children:(0,t.jsx)(j.Building2,{className:"h-3.5 w-3.5 text-brand"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"truncate font-heading text-[13px] font-bold text-black leading-tight",children:e||"Sem empresa vinculada"}),s&&(0,t.jsx)("p",{className:"truncate font-body text-[10px] text-zinc-400 leading-tight",children:s})]})]}),(0,t.jsxs)("div",{className:"mt-1.5 pl-[38px]",children:[i?(0,t.jsxs)("p",{className:"truncate font-body text-[10px] text-zinc-400 leading-tight",title:i,children:[(0,t.jsx)(D.MapPin,{className:"mr-0.5 inline h-2.5 w-2.5 text-zinc-300 align-[-1px]"}),i]}):(0,t.jsxs)("p",{className:"font-body text-[10px] text-zinc-300 italic leading-tight",children:[(0,t.jsx)(D.MapPin,{className:"mr-0.5 inline h-2.5 w-2.5 text-zinc-200 align-[-1px]"}),"Endereco nao informado"]}),L?(0,t.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-0.5",children:[r&&(0,t.jsxs)(sB,{value:r,className:"!px-1 !py-0.5",children:[(0,t.jsx)(n.Phone,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,t.jsx)("span",{className:"font-body text-[10px] text-zinc-500",children:r})]}),o&&(0,t.jsxs)(sB,{value:o,className:"!px-1 !py-0.5",children:[(0,t.jsx)(l.Mail,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,t.jsx)("span",{className:"truncate max-w-[120px] font-body text-[10px] text-zinc-500",children:o})]}),c&&(0,t.jsxs)("a",{href:c,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 rounded px-1 py-0.5 font-body text-[10px] text-brand/70 transition-all duration-[120ms] hover:bg-brand/5 hover:text-brand hover:scale-[1.05] active:scale-[0.97]",children:[(0,t.jsx)($.ExternalLink,{className:"h-2.5 w-2.5"}),"Site"]}),d&&(0,t.jsxs)("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 rounded px-1 py-0.5 font-body text-[10px] text-brand/70 transition-all duration-[120ms] hover:bg-brand/5 hover:text-brand hover:scale-[1.05] active:scale-[0.97]",children:[(0,t.jsx)(F,{className:"h-2.5 w-2.5"}),"IG"]}),m&&(0,t.jsxs)("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 rounded px-1 py-0.5 font-body text-[10px] text-brand/70 transition-all duration-[120ms] hover:bg-brand/5 hover:text-brand hover:scale-[1.05] active:scale-[0.97]",children:[(0,t.jsx)(_,{className:"h-2.5 w-2.5"}),"Menu"]})]}):(0,t.jsx)("p",{className:"mt-1.5 font-body text-[10px] text-zinc-300 italic",children:"Sem links cadastrados"})]})]}),(0,t.jsx)("div",{className:"md:col-span-4 md:border-l md:border-zinc-200/30 md:pl-4 min-w-0",children:x?(0,t.jsxs)("div",{className:"group/contact relative",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-zinc-100",children:(0,t.jsx)(u.User,{className:"h-3.5 w-3.5 text-zinc-500"})}),(0,t.jsxs)("div",{className:"min-w-0",children:[(0,t.jsx)("p",{className:"truncate font-heading text-[13px] font-semibold text-black leading-tight",children:x.nome}),(0,t.jsx)("p",{className:"truncate font-body text-[10px] text-zinc-400 leading-tight",children:sN(x.cargo)}),(0,t.jsxs)("p",{className:"truncate font-body text-[10px] text-zinc-500 leading-tight",children:["Patente ",sw(x.cargo)]})]})]}),(0,t.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-0.5 pl-[36px]",children:[x.email&&(0,t.jsxs)(sB,{value:x.email,className:"!px-1 !py-0.5",children:[(0,t.jsx)(l.Mail,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,t.jsx)("span",{className:"truncate max-w-[110px] font-body text-[10px] text-zinc-500",children:x.email})]}),x.telefone&&(0,t.jsxs)(sB,{value:x.telefone,className:"!px-1 !py-0.5",children:[(0,t.jsx)(n.Phone,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,t.jsx)("span",{className:"font-body text-[10px] text-zinc-500",children:x.telefone})]})]}),(0,t.jsxs)("button",{type:"button",onClick:S,className:"absolute top-0 right-0 inline-flex items-center gap-0.5 rounded-md border border-zinc-200/50 bg-white px-1.5 py-0.5 font-body text-[9px] font-medium text-zinc-400 shadow-sm opacity-0 transition-all duration-[120ms] group-hover/contact:opacity-100 hover:text-brand hover:border-brand/20 active:scale-[0.98]",children:[(0,t.jsx)(C.ChevronRight,{className:"h-2 w-2"}),"Abrir"]})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-zinc-100",children:(0,t.jsx)(u.User,{className:"h-3.5 w-3.5 text-zinc-300"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-body text-[10px] text-zinc-400",children:"Sem decisor definido"}),(0,t.jsxs)("button",{type:"button",onClick:k,className:"mt-0.5 inline-flex items-center gap-0.5 font-body text-[10px] font-medium text-brand transition-colors hover:text-brand/80",children:[(0,t.jsx)(y.Plus,{className:"h-2.5 w-2.5"}),"Definir contato"]})]})]})}),(0,t.jsx)("div",{className:"md:col-span-3 md:border-l md:border-zinc-200/30 md:pl-4 min-w-0",children:(0,t.jsxs)("div",{className:"relative space-y-1.5",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,t.jsx)(sP,{currentStage:h,onStageChange:e=>{v(e),O("Atualizado")},disabled:A,statusBanner:T,onBannerDismiss:R}),(0,t.jsx)(sL,{current:p,onChange:e=>{N(e),O("Atualizado")},suggested:f,disabled:A})]}),(0,t.jsx)("div",{className:"flex items-center justify-end",children:(0,t.jsxs)(eX.DropdownMenu,{children:[(0,t.jsx)(eX.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)("button",{className:"group/owner flex items-center gap-1.5 rounded-full py-0.5 pl-0.5 pr-2 transition-colors duration-[140ms] hover:bg-white/80 active:scale-[0.98]",children:[(0,t.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-brand text-[8px] font-bold text-white",children:sA(g)}),(0,t.jsx)("span",{className:"font-body text-[10px] text-zinc-500",children:g}),(0,t.jsx)(M.Pencil,{className:"h-2 w-2 text-zinc-300 opacity-0 transition-opacity duration-[140ms] group-hover/owner:opacity-100"})]})}),(0,t.jsx)(eX.DropdownMenuContent,{align:"end",className:"rounded-xl min-w-[180px]",children:I.map(e=>(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>{w(e.id,e.name),O("Atualizado")},className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-zinc-200 text-[9px] font-bold text-zinc-600",children:sA(e.name)}),(0,t.jsx)("span",{className:"font-body text-xs",children:e.name}),e.id===b&&(0,t.jsx)(z.Check,{className:"ml-auto h-3.5 w-3.5 text-brand"})]},e.id))})]})}),P&&(0,t.jsxs)("div",{className:"absolute -top-1.5 right-0 inline-flex items-center gap-0.5 rounded-full bg-status-success/10 px-1.5 py-0.5 font-body text-[8px] font-semibold text-status-success animate-in fade-in duration-90",children:[(0,t.jsx)(z.Check,{className:"h-2 w-2"}),P]})]})})]})})}function s$({children:e,title:a,description:s,icon:n,delay:i=0,successMessage:r,headerAction:l}){return(0,t.jsxs)(ee.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18,delay:i,ease:"easeOut"},className:"relative rounded-[20px] border border-zinc-100 bg-white p-5 shadow-sm transition-all duration-300 hover:shadow-md group",children:[(0,t.jsx)(et.AnimatePresence,{children:r&&(0,t.jsxs)(ee.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute -top-3 right-5 z-20 flex items-center gap-1.5 rounded-full bg-emerald-50 px-3 py-1 font-heading text-[11px] font-bold text-emerald-600 shadow-sm border border-emerald-100",children:[(0,t.jsx)(z.Check,{className:"h-3 w-3"}),r]})}),(0,t.jsxs)("div",{className:"mb-5 flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3.5",children:[(0,t.jsx)("div",{className:"flex h-11 w-11 items-center justify-center rounded-[14px] bg-zinc-50 text-zinc-400 group-hover:bg-brand/5 group-hover:text-brand transition-colors",children:(0,t.jsx)(n,{className:"h-5.5 w-5.5"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-[15px] font-semibold tracking-tight text-zinc-900",children:a}),(0,t.jsx)("p",{className:"font-body text-[11px] text-zinc-400 leading-relaxed",children:s})]})]}),l&&(0,t.jsx)("div",{children:l})]}),(0,t.jsx)("div",{className:"space-y-4",children:e})]})}function s_(){let{modalType:e,modalData:c,closeModal:m}=(0,tD.useUIStore)(),h="lead-card"===e,g=c?.id,b=(0,a.useMemo)(()=>{let e=c?.opportunitySnapshot;return e&&"object"==typeof e?"string"!=typeof e.id?null:e:null},[c?.opportunitySnapshot]),f=(0,a.useMemo)(()=>{let e=c?.focusFields;return Array.isArray(e)?e.filter(e=>"string"==typeof e&&e.trim().length>0):[]},[c?.focusFields]),j=(0,a.useMemo)(()=>"string"!=typeof c?.pendingStage?null:c.pendingStage,[c?.pendingStage]),w=(0,a.useMemo)(()=>sx(c?.initialTab),[c?.initialTab]),T=(0,a.useMemo)(()=>{let e=c?.prefillNote;return"string"==typeof e?e.trim():""},[c?.prefillNote]),P=(0,aV.useOpportunityStore)(e=>e.opportunities),L=(0,a.useMemo)(()=>{let e=P.find(e=>e.id===g);return e||(b?.id===g?b:null)},[P,b,g]),O=(0,a.useMemo)(()=>L?{...sy,id:L.id,title:L.title,clientName:L.clientName,nomeFantasia:L.clientName||L.title,value:L.value,monthlyValue:L.monthlyValue,stage:L.stage,temperature:L.temperature,responsibleId:L.responsibleId,responsibleName:L.responsibleName,tags:L.tags,source:L.source??sy.source,expectedCloseDate:L.expectedCloseDate??sy.expectedCloseDate,createdAt:L.createdAt,updatedAt:L.updatedAt,notes:L.notes??sy.notes}:sy,[L]),$=(0,a.useMemo)(()=>O.metadata?.stageValues||{},[O.metadata?.stageValues]),U=(0,a.useMemo)(()=>O.notes?.trim()||"",[O.notes]),W=(0,a.useMemo)(()=>O.responsibleId??"u1",[O.responsibleId]),G=(0,a.useMemo)(()=>O.stage,[O.stage]),[X,Y]=(0,a.useState)(O.title),[Q,Z]=(0,a.useState)(G),[K,ei]=(0,a.useState)(O.temperature),[er,el]=(0,a.useState)(O.responsibleId),[eo,ec]=(0,a.useState)(O.responsibleName),[ed,em]=(0,a.useState)(()=>{let e=a9.getState().getByClient(O.clientId??"");return e.length>0?e:[]}),eu=(0,a.useMemo)(()=>[...ed].sort((e,t)=>sw(t.cargo)-sw(e.cargo)),[ed]),[ex,eh]=(0,a.useState)("open"),ep="open"!==ex,[eg]=(0,a.useState)(O.source),[eb]=(0,a.useState)(O.nomeFantasia),[ef]=(0,a.useState)(O.segmento),[ev,ej]=(0,a.useState)(O.cep),[ey,eN]=(0,a.useState)(O.logradouro),[ew,eS]=(0,a.useState)(O.numero),[eC,ez]=(0,a.useState)(O.complemento),[ek,eM]=(0,a.useState)(O.bairro),[eI,eD]=(0,a.useState)(O.cidade),[eA,eT]=(0,a.useState)(O.estado),[eR,eP]=(0,a.useState)(!1),[eE,eV]=(0,a.useState)(null),[eL]=(0,a.useState)(O.telefoneEmpresa),[eO]=(0,a.useState)(O.emailEmpresa),[eB,eF]=(0,a.useState)(O.website),[e$,e_]=(0,a.useState)(O.instagram),[eq,eH]=(0,a.useState)(O.cardapio),[eU,eW]=(0,a.useState)([]),[eG,eY]=(0,a.useState)("daily"),[eQ,eZ]=(0,a.useState)({open:"08:00",close:"18:00"}),[e3,e4]=(0,a.useState)(sv.reduce((e,t)=>({...e,[t.id]:{active:!0,open:"08:00",close:"19:00",isClosed:!1}}),{})),[e6]=(0,a.useState)({localizacao:null,tipo:null,horario:null,online:null}),[e7,e8]=(0,a.useState)($),[,e9]=(0,a.useState)({}),[,te]=(0,a.useState)({}),[,tt]=(0,a.useState)(null),[,ta]=(0,a.useState)(!1),ts=(0,a.useRef)({}),[tn,ti]=(0,a.useState)(""),[tr,tl]=(0,a.useState)("general"),[to,tc]=(0,a.useState)("team"),[td,tm]=(0,a.useState)("idle"),[tu,tx]=(0,a.useState)(null),[th,tp]=(0,a.useState)("all"),[tg,tb]=(0,a.useState)(null),[tf,tv]=(0,a.useState)(""),[ty,tN]=(0,a.useState)("idle"),[tw,tR]=(0,a.useState)(null),[tP,tV]=(0,a.useState)({action:"",dueDate:"",channel:"call",ownerId:W}),[tL,tO]=(0,a.useState)("idle"),[tB,tF]=(0,a.useState)(null),[t$,t_]=(0,a.useState)(()=>{let e=[...sI];return U&&e.unshift({id:`n-init-${O.id}`,authorId:"u1",authorName:sc,createdAt:new Date().toISOString(),body:U,intent:"general",visibility:"team"}),e}),tq=async e=>{ej((0,e1.maskCep)(e)),eV(null);let t=e.replace(/\D/g,"").slice(0,8);if(8===t.length){eP(!0);try{let e=await fetch(`https://viacep.com.br/ws/${t}/json/`),a=await e.json();a.erro?eV("CEP não encontrado."):(eN(a.logradouro||""),eM(a.bairro||""),eD(a.localidade||""),eT(a.uf||""),a.complemento&&ez(a.complemento),sh("cep_lookup_success",{cep:t}))}catch{eV("Erro ao buscar CEP. Verifique sua conexão.")}finally{eP(!1)}}},tH=(0,a.useMemo)(()=>{let e=[];return ey&&e.push(ew?`${ey}, ${ew}`:ey),eC&&e.push(eC),ek&&e.push(ek),eI&&eA?e.push(`${eI} - ${eA}`):eI&&e.push(eI),e.join(", ")},[ey,ew,eC,ek,eI,eA]),[tU,tW]=(0,a.useState)(null),[tG,tX]=(0,a.useState)(null),[tY,tQ]=(0,a.useState)(!1),[tZ,tK]=(0,a.useState)(!1),[tJ,t0]=(0,a.useState)(!1),[t1,t2]=(0,a.useState)(!1),[t5,t3]=(0,a.useState)(!1),[t4,t6]=(0,a.useState)(!1),[t7,t9]=(0,a.useState)(null),[ae,at]=(0,a.useState)(null),[aa,as]=(0,a.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),[an,ai]=(0,a.useState)(null),[ar,al]=(0,a.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),[ao,ac]=(0,a.useState)(w),ad=(0,a.useMemo)(()=>tn.trim().length>0||null!==tg&&tf.trim().length>0||tP.action.trim().length>0,[tn,tg,tf,tP.action]),[am,au]=(0,a.useState)(null),[ax,ah]=(0,a.useState)(!1),[ap,ag]=(0,a.useState)(null),ab=(0,a.useCallback)(e=>{let t=sx(e);t!==ao&&(ad?(au(t),ag("tab"),ah(!0)):ac(t))},[ao,ad]),af=(0,a.useCallback)(()=>{ad?(ag("close"),ah(!0)):m()},[ad,m]),av=(0,a.useCallback)(()=>{ah(!1),ti(""),tv(""),tb(null),tV({action:"",dueDate:"",channel:"call",ownerId:W}),"tab"===ap&&am?ac(am):"close"===ap&&m(),ag(null),au(null)},[ap,am,m,W]),aj=(0,a.useCallback)(()=>{ah(!1),ag(null),au(null)},[]),[ay,aN]=(0,a.useState)(!1),[aw,aS]=(0,a.useState)(!1),[aC,ak]=(0,a.useState)("task"),aM=(0,a.useCallback)((e="task")=>{ep||(ak(e),aS(!0))},[ep]),[aI,aD]=(0,a.useState)("all"),[aA,aT]=(0,a.useState)(null),[aR,aP]=(0,a.useState)(sM),aE=(0,a.useMemo)(()=>{let e={all:aR.length,agendada:0,realizada:0,cancelada:0};for(let t of aR)e[t.status]+=1;return e},[aR]),aL=(0,a.useMemo)(()=>[..."all"===aI?aR:aR.filter(e=>e.status===aI)].sort((e,t)=>{if("all"===aI&&e.status!==t.status)return sk[e.status]-sk[t.status];let a=new Date(e.startAt).getTime(),s=new Date(t.startAt).getTime();return"agendada"===aI||"agendada"===e.status&&"agendada"===t.status?a-s:s-a}),[aI,aR]),aO=(0,a.useCallback)((e,t)=>{ep||aR.find(t=>t.id===e)&&(aP(a=>a.map(a=>a.id===e?{...a,status:t,result:"realizada"!==t||a.result?a.result:"Visita concluída. Próximos passos registrados.",cancellationReason:"cancelada"===t?a.cancellationReason||"Cancelada pelo responsável":void 0}:a)),tW({message:`Visita marcada como ${t}.`,variant:"cancelada"===t?"warning":"success"}))},[ep,aR]),aB=(0,a.useCallback)(e=>{if(ep)return;let t=aR.find(t=>t.id===e);if(!t)return;let a=new Date(t.startAt),s=Number.isNaN(a.getTime())?new Date:new Date(a.getTime()+6048e5),n={...t,id:`visit-${Date.now()}`,status:"agendada",result:void 0,cancellationReason:void 0,startAt:s.toISOString(),createdAt:new Date().toISOString()};aP(e=>[n,...e]),aD("agendada"),aT(n.id),tW({message:"Visita duplicada e reagendada para a próxima semana",variant:"success"})},[ep,aR]),aF=(0,a.useCallback)((e,t)=>{if(ep)return;let a=aR.find(t=>t.id===e);if(!a)return;let s=new Date(a.startAt);Number.isNaN(s.getTime())||(s.setDate(s.getDate()+t),aP(t=>t.map(t=>t.id===e?{...t,startAt:s.toISOString(),status:"agendada",cancellationReason:void 0}:t)),tW({message:`Visita reagendada em ${t} dia${t>1?"s":""}.`,variant:"info"}))},[ep,aR]),a$=(0,a.useCallback)(e=>{ep||(aP(t=>t.filter(t=>t.id!==e)),aA===e&&aT(null),tW({message:"Visita removida da agenda",variant:"info"}))},[aA,ep]),a_=(0,a.useCallback)(e=>{aT(t=>t===e?null:e)},[]),[aq,aH]=(0,a.useState)("all"),[aU,aW]=(0,a.useState)(()=>tT.mockActivities.filter(e=>e.opportunityId===O.id)),aG=(0,a.useMemo)(()=>sg.findIndex(e=>e.id===Q),[Q]),aX=(0,a.useMemo)(()=>ed.some(e=>e.isDecisionMaker),[ed]),aY=(0,a.useMemo)(()=>(0,tA.calculateCardPatentScore)(ed),[ed]),aQ=(0,a.useMemo)(()=>sg[aG+1]??null,[aG]),aK=(0,a.useMemo)(()=>ed.find(e=>e.isDecisionMaker)??eu[0]??null,[ed,eu]),aJ=(0,a.useMemo)(()=>aU,[aU]),a0=(0,a.useMemo)(()=>"pending"===aq?aU.filter(e=>"completed"!==e.status):"completed"===aq?aU.filter(e=>"completed"===e.status):aU,[aq,aU]),a1=(0,a.useMemo)(()=>(0,tA.calculateLeadScore)(O,aJ),[O,aJ]),a2=(0,a.useMemo)(()=>(0,tA.calculateTemperature)(O),[O]),a5=(0,a.useMemo)(()=>"all"===th?t$:"cliente"===th?t$.filter(e=>"pedido_cliente"===e.intent):"decisao"===th?t$.filter(e=>"decisao"===e.intent):t$.filter(e=>"proximo_passo"===e.intent),[th,t$]),a3=(0,a.useMemo)(()=>{let e=new Map;return[...a5].sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).forEach(t=>{let a=t.createdAt.slice(0,10);e.has(a)||e.set(a,{dayLabel:new Date(t.createdAt).toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"2-digit"}),items:[]}),e.get(a)?.items.push(t)}),Array.from(e.values())},[a5]),a4=(0,a.useMemo)(()=>{let e=Date.now()-6048e5,t=t$.some(t=>{if(t.isSystem)return!1;let a=new Date(t.createdAt).getTime();return!Number.isNaN(a)&&a>=e}),a=aU.some(t=>{let a=new Date(t.createdAt).getTime();return!Number.isNaN(a)&&a>=e});return t||a},[aU,t$]),a6=(0,a.useCallback)(e=>{let t=(tE[e]||[]).filter(e=>e.required),a={},s=t.filter(e=>{var t;let s=null==(t=e7[e.id])||"boolean"!=typeof t&&("number"==typeof t?Number.isNaN(t)||0===t:0===t.toString().trim().length);return s&&(a[e.id]="Preencha este campo para avançar etapa."),s});return te(e=>({...e,...a})),s},[e7]);(0,a.useEffect)(()=>{h&&sh("view_opened",{entity_type:"deal",entity_id:O.id})},[h,O.id]),(0,a.useEffect)(()=>{let e=ts.current;return()=>{Object.values(e).forEach(e=>clearTimeout(e))}},[]),(0,a.useEffect)(()=>{ac(w),aP([...sM]),aD("all"),aT(null),aN(!1),aH("all"),aW(tT.mockActivities.filter(e=>e.opportunityId===O.id)),Z(G),t6(!1),e8($),te({}),e9({}),tt(null),t9(null),at(null),ta(!1),ti(T),tl("general"),tc("team"),tm("idle"),tx(null),tp("all"),tb(null),tv(""),tN("idle"),tR(null),tV({action:"",dueDate:"",channel:"call",ownerId:W}),tO("idle"),tF(null),tW(null),tX(null);let e=[...sI];U&&e.unshift({id:`n-init-${O.id}`,authorId:"u1",authorName:sc,createdAt:new Date().toISOString(),body:U,intent:"general",visibility:"team"}),t_(e)},[U,W,G,$,w,T,O.id]),(0,a.useEffect)(()=>{if(!h||0===f.length)return;let e=j?sg.find(e=>e.id===j)?.label:null;ac("empresa"),tW({message:e?`Movimento bloqueado para ${e}. Preencha os campos obrigat\xf3rios.`:"Movimento bloqueado. Preencha os campos obrigatórios para avançar etapa.",variant:"warning",action:{label:"Ir para campos",onClick:()=>ac("empresa")}})},[f.length,h,j]);let a7=(0,a.useCallback)(e=>{if(ep||e===Q)return!1;let t=sg.findIndex(e=>e.id===Q);if(sg.findIndex(t=>t.id===e)>t){if(ed.length<1)return ac("contatos"),t9({message:"Adicione pelo menos 1 contato para avançar no funil.",variant:"warning"}),tX({message:"Etapa bloqueada. O card precisa ter ao menos 1 contato.",variant:"warning"}),sh("stage_change_blocked_missing_contact",{from_stage_id:Q,to_stage_id:e,entity_id:O.id}),!1;if(e===so&&!aX)return ac("contatos"),t9({message:"Defina ao menos 1 decisor para avançar para Proposta.",variant:"warning"}),tX({message:"Etapa bloqueada. É obrigatório ter um decisor para avançar para Proposta.",variant:"warning"}),sh("stage_change_blocked_missing_decision_maker",{from_stage_id:Q,to_stage_id:e,entity_id:O.id}),!1;let t=a6(Q);if(t.length>0){let a=t.map(e=>e.label).join(", ");return tX({message:`Etapa bloqueada. Preencha: ${a}`,variant:"warning"}),tt({message:`${t.length} campo(s) obrigat\xf3rio(s) pendente(s) para avan\xe7ar.`,variant:"warning"}),sh("stage_change_blocked_missing_required",{from_stage_id:Q,to_stage_id:e,missing_count:t.length,entity_id:O.id}),!1}}return sh("stage_changed",{from_stage_id:Q,to_stage_id:e,entity_id:O.id}),Z(e),tX({message:"Etapa atualizada",variant:"success"}),tt({message:`Checklist atualizado para ${sg.find(t=>t.id===e)?.label??"nova etapa"}.`,variant:"info"}),!0},[ed.length,aX,ep,O.id,Q,a6]),a8=(0,a.useCallback)(e=>a7(e),[a7]),se=(0,a.useCallback)(()=>{if("fechamento"!==Q){tQ(!1),tW({message:"Para marcar como ganho, mova a oportunidade para a etapa Fechamento.",variant:"warning"});return}if(a6(Q).length>0){tQ(!1),ac("anotacoes"),tt({message:"Checklist incompleto. Preencha os campos obrigatórios antes de fechar.",variant:"warning"}),tW({message:"Fechamento bloqueado por pendências nos campos da etapa.",variant:"warning"});return}if(!a4){tQ(!1),ac("anotacoes"),tW({message:"Registre ao menos uma nota ou atividade recente antes de encerrar como ganho.",variant:"warning"});return}sh("mark_won_clicked",{entity_id:O.id}),t0(!0),setTimeout(()=>{eh("won"),tQ(!1),t0(!1),tW({message:"Oportunidade marcada como ganho",variant:"success"}),sh("mark_won_succeeded",{entity_id:O.id})},600)},[a4,O.id,Q,a6]),st=(0,a.useCallback)(e=>{if("fechamento"!==Q){tK(!1),tW({message:"Para marcar como perdido, mova a oportunidade para a etapa Fechamento.",variant:"warning"});return}if(!e?.trim())return void tW({message:"Selecione um motivo de perda para continuar.",variant:"warning"});if(!a4){tK(!1),ac("anotacoes"),tW({message:"Adicione uma nota de contexto antes de encerrar como perdido.",variant:"warning"});return}sh("mark_lost_clicked",{entity_id:O.id,reason:e}),t2(!0),setTimeout(()=>{eh("lost"),tK(!1),t2(!1),tW({message:`Oportunidade marcada como perdida — ${e}`,variant:"info"}),sh("mark_lost_succeeded",{entity_id:O.id,reason:e})},600)},[a4,O.id,Q]),ss=()=>{if(an){if(!ar.nome.trim())return void t9({message:"O nome do contato é obrigatório.",variant:"warning"});if(!ar.cargo)return void t9({message:"Selecione o cargo para manter o score de patente correto.",variant:"warning"});em(ed.map(e=>e.id===an?{...e,...ar}:e)),ai(null),al({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),t9({message:"Contato atualizado. Score de patente recalculado.",variant:"success"})}},si=(0,a.useCallback)((e,t="follow-up")=>{let a=new Date(Date.now()+36e5),s=`${a.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})} ${a.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`,n={id:`activity-${Date.now()}`,title:e,type:t,status:"pending",dueDate:s,responsibleId:er,responsibleName:eo,opportunityId:O.id,opportunityTitle:X,clientId:O.id,clientName:O.clientName??eb,createdAt:new Date().toISOString()};aW(e=>[n,...e]),tW({message:"Atividade criada com sucesso",variant:"success"})},[eb,O.clientName,O.id,er,eo,X]),sl=(0,a.useCallback)(e=>!e.isSystem&&"u1"===e.authorId&&Date.now()-new Date(e.createdAt).getTime()<=9e5,[]),sp=(0,a.useCallback)(()=>{if(ep)return;let e=tn.trim();if(e.length<10){tx("A nota precisa ter pelo menos 10 caracteres."),tm("error"),sh("validation_failed",{field:"noteDraft"});return}if(e.length>2e3){tx("A nota excedeu o limite de 2000 caracteres."),tm("error"),sh("validation_failed",{field:"noteDraft_max"});return}tx(null),tm("saving"),setTimeout(()=>{let t={id:`note-${Date.now()}`,body:e,authorId:"u1",authorName:sc,createdAt:new Date().toISOString(),intent:tr,visibility:to};t_(e=>[t,...e]),ti(""),tl("general"),tc("team"),tm("saved"),tW({message:"Nota salva e adicionada ao histórico.",variant:"success"}),sh("note_created",{entity_id:O.id}),setTimeout(()=>tm("idle"),1600)},320)},[ep,tn,tr,to,O.id]),sN=(0,a.useCallback)(()=>{if(ep)return;let e=tP.action.trim()||tn.trim();if(e.length<3){tF("Defina uma ação para criar o próximo passo."),tO("error");return}if("proximo_passo"===tr&&!tP.dueDate){tF("Defina a data do próximo passo."),tO("error");return}tF(null),tO("saving");let t={call:"call",whatsapp:"whatsapp",email:"email",meeting:"meeting",visit:"visit"};setTimeout(()=>{let a=sS.find(e=>e.id===tP.ownerId)?.name??eo,s=tP.dueDate?` at\xe9 ${new Date(tP.dueDate).toLocaleDateString("pt-BR")}`:"";si(`${e}${s} • ${a}`,t[tP.channel]),tO("saved"),tW({message:"Próximo passo criado na aba Atividades.",variant:"success"}),setTimeout(()=>tO("idle"),1600)},280)},[si,ep,tP,tn,tr,eo]),sD=(0,a.useCallback)(e=>{sl(e)&&(tb(e.id),tv(e.body),tR(null),tN("idle"))},[sl]),sA=(0,a.useCallback)(()=>{if(!tg)return;let e=tf.trim();if(e.length<10){tR("A nota precisa ter pelo menos 10 caracteres."),tN("error");return}tR(null),tN("saving"),setTimeout(()=>{t_(t=>t.map(t=>t.id===tg?{...t,body:e}:t)),tN("saved"),tb(null),tv(""),tW({message:"Nota atualizada.",variant:"success"}),setTimeout(()=>tN("idle"),1400),sh("note_edited",{entity_id:O.id})},280)},[tf,tg,O.id]),sP=(0,a.useCallback)(e=>{e.isSystem||(ti(e.body),tl("system"===e.intent?"general":e.intent),tp("all"),tW({message:"Conteúdo duplicado no registro rápido.",variant:"info"}))},[]),sL=(0,a.useCallback)(e=>{let t={id:Math.random().toString(36).substr(2,9),title:e.title,type:e.type,status:"pending",dueDate:`${new Date(e.date).toLocaleDateString("pt-BR")} ${e.time||""}`.trim(),responsibleName:"Eu (Logado)",responsibleId:"u1",opportunityId:e.opportunityId||O.id,clientId:e.clientId,clientName:e.clientName,contactIds:e.contactIds?.length?e.contactIds:void 0,contactNames:e.contactNames?.length?e.contactNames:void 0,createdAt:new Date().toISOString()};aW(e=>[t,...e]),tW({message:"Atividade criada com sucesso",variant:"success"})},[O.id]),sB=(0,a.useCallback)(()=>{ep||(ac("atividades"),aM("task"))},[aM,ep]),s_=(0,a.useCallback)(e=>{let t,a=Number.isNaN((t=new Date(e.startAt)).getTime())?"Data inválida":t.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});si(`Follow-up da visita (${a})`,"follow-up"),ac("atividades")},[si]),sq=(0,a.useCallback)(e=>{aW(t=>t.map(t=>t.id===e?{...t,status:"completed",completedAt:new Date().toISOString()}:t)),tW({message:"Atividade concluída",variant:"success"})},[]),sH=(0,a.useCallback)(()=>{let e="all"===aq?"pending":"pending"===aq?"completed":"all";aH(e);let t="all"===e?"Todos":"pending"===e?"Pendentes":"Concluídas";tW({message:`Filtro de atividades: ${t}`,variant:"info"})},[aq]),sU=(e,t,a)=>{ep||e4(s=>({...s,[e]:{...s[e],[t]:a}}))},sW=sb[ex];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(tM.Dialog,{open:h,onOpenChange:e=>{e||af()},children:(0,t.jsxs)(tM.DialogContent,{className:"flex h-[90vh] !max-h-[90vh] w-[90vw] !max-w-[90vw] flex-col overflow-hidden rounded-[var(--radius-bento-card)] !gap-0 !p-0 bg-zinc-50/50",showCloseButton:!1,children:[(0,t.jsxs)("div",{className:"sticky top-0 z-10 border-b border-zinc-200/50 bg-white/85 backdrop-blur-xl transition-shadow duration-[120ms] shadow-[0_4px_30px_rgba(0,0,0,0.02)]",children:[(0,t.jsxs)("div",{className:"px-5 pt-3 pb-0 md:px-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("nav",{className:"mb-1 flex items-center gap-1 font-body text-[10px] text-zinc-400","aria-label":"Breadcrumb",children:[(0,t.jsx)("span",{children:"Pipes"}),(0,t.jsx)(C.ChevronRight,{className:"h-2.5 w-2.5","aria-hidden":"true"}),(0,t.jsx)("span",{className:"text-zinc-500",children:"Pipeline Comercial"})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-bold tracking-tight text-black sm:text-[22px] leading-tight",children:(0,t.jsx)(sR,{value:X,onSave:Y,className:"font-heading text-xl font-bold tracking-tight sm:text-[22px] leading-tight",readOnly:ep})}),a1>0&&(0,t.jsxs)("div",{className:`inline-flex items-center gap-0.5 rounded-md px-1.5 py-0.5 font-heading text-[10px] font-bold leading-none ${a1>=70?"bg-emerald-50 text-emerald-700 border border-emerald-200/50":a1>=40?"bg-amber-50 text-amber-700 border border-amber-200/50":"bg-red-50 text-red-700 border border-red-200/50"}`,title:`Lead Score: ${a1} (${a1>=70?"Alto":a1>=40?"Medio":"Baixo"})`,children:[(0,t.jsx)(A.TrendingUp,{className:"h-2 w-2","aria-hidden":"true"}),a1]}),(0,t.jsxs)("div",{className:"inline-flex items-center gap-0.5 rounded-md border border-indigo-200 bg-indigo-50 px-1.5 py-0.5 font-heading text-[10px] font-bold leading-none text-indigo-700",title:`Score de Patente: ${aY}`,children:[(0,t.jsx)(S.Shield,{className:"h-2 w-2","aria-hidden":"true"}),aY]}),(0,t.jsxs)("span",{className:`inline-flex items-center gap-0.5 rounded-full px-1.5 py-0.5 font-body text-[10px] font-medium transition-all duration-[140ms] ${sW.color} ${sW.bg}`,children:["won"===ex&&(0,t.jsx)(z.Check,{className:"h-2 w-2","aria-hidden":"true"}),"lost"===ex&&(0,t.jsx)(s.X,{className:"h-2 w-2","aria-hidden":"true"}),sW.label]}),eg&&(0,t.jsxs)("span",{className:"font-body text-[10px] text-zinc-400",children:["via ",eg]})]})]}),(0,t.jsxs)("div",{className:"flex shrink-0 items-center gap-1",children:["open"===ex&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("button",{onClick:()=>tQ(!0),disabled:tJ,className:"group/won inline-flex h-[34px] items-center gap-1 rounded-full border border-emerald-200/80 bg-emerald-50/80 px-3 font-heading text-[11px] font-semibold text-emerald-700 transition-all duration-300 ease-out hover:-translate-y-[1px] hover:border-emerald-500 hover:bg-emerald-600 hover:text-white hover:shadow-[0_4px_12px_rgba(16,185,129,0.2)] active:scale-[0.96] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500/30 disabled:pointer-events-none disabled:opacity-50",children:[tJ?(0,t.jsx)(V.Loader2,{className:"h-3 w-3 animate-spin"}):(0,t.jsx)(z.Check,{className:"h-3 w-3","aria-hidden":"true"}),(0,t.jsx)("span",{className:"max-sm:hidden",children:"Ganho"})]}),(0,t.jsxs)("button",{onClick:()=>tK(!0),disabled:t1,className:"group/lost inline-flex h-[34px] items-center gap-1 rounded-full border border-zinc-200/80 bg-white px-3 font-heading text-[11px] font-semibold text-zinc-500 transition-all duration-300 ease-out hover:-translate-y-[1px] hover:border-red-400 hover:bg-red-500 hover:text-white hover:shadow-[0_4px_12px_rgba(248,113,113,0.2)] active:scale-[0.96] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-400/30 disabled:pointer-events-none disabled:opacity-50",children:[t1?(0,t.jsx)(V.Loader2,{className:"h-3 w-3 animate-spin"}):(0,t.jsx)(s.X,{className:"h-3 w-3","aria-hidden":"true"}),(0,t.jsx)("span",{className:"max-sm:hidden",children:"Perdido"})]})]}),(0,t.jsxs)(eX.DropdownMenu,{children:[(0,t.jsx)(eX.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)("button",{className:"flex h-7 w-7 items-center justify-center rounded-full text-zinc-400 transition-all duration-[140ms] hover:bg-zinc-100 hover:text-zinc-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/30",children:(0,t.jsx)(v.MoreHorizontal,{className:"h-3.5 w-3.5"})})}),(0,t.jsxs)(eX.DropdownMenuContent,{align:"end",className:"rounded-[12px]",children:[(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>{sB()},children:[(0,t.jsx)(o.Calendar,{className:"mr-2 h-4 w-4"}),"Nova atividade"]}),"open"!==ex&&(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>{eh("open"),tW({message:"Oportunidade reaberta",variant:"info"})},children:[(0,t.jsx)(E.RefreshCw,{className:"mr-2 h-4 w-4"}),"Reabrir oportunidade"]}),(0,t.jsx)(eX.DropdownMenuSeparator,{}),(0,t.jsxs)(eX.DropdownMenuItem,{className:"text-status-danger focus:text-status-danger",onClick:()=>t3(!0),children:[(0,t.jsx)(N.Trash2,{className:"mr-2 h-4 w-4"}),"Excluir"]})]})]}),(0,t.jsx)("button",{onClick:af,className:"flex h-7 w-7 items-center justify-center rounded-full text-zinc-400 transition-all duration-[140ms] hover:bg-zinc-100 hover:text-zinc-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/30","aria-label":"Fechar",children:(0,t.jsx)(s.X,{className:"h-3.5 w-3.5"})})]})]}),tU&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(sT,{banner:tU,onDismiss:()=>tW(null)})}),tZ&&"open"===ex&&(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)(sO,{onConfirm:st,onCancel:()=>tK(!1),isLoading:t1})}),(0,t.jsx)(sF,{nomeFantasia:eb,segmento:ef,enderecoFormatado:tH,telefoneEmpresa:eL,emailEmpresa:eO,website:eB,instagramUrl:e$,cardapioUrl:eq,primaryContact:aK,stage:Q,temperature:K,responsibleName:eo,responsibleId:er,suggestedTemperature:a2,onStageChange:a7,onTemperatureChange:ei,onResponsibleChange:(e,t)=>{el(e),ec(t)},onOpenPrimaryContact:()=>ac("contatos"),onCreatePrimaryContact:()=>{ac("contatos"),t6(!0)},teamMembers:sS,isLocked:ep,stageBanner:tG,onStageBannerDismiss:()=>tX(null)})]}),(0,t.jsx)("div",{className:"flex w-full items-end overflow-x-auto px-5 md:px-6 scrollbar-hide",children:[{value:"empresa",label:"Empresa"},{value:"contatos",label:"Contatos"},{value:"visitas",label:"Visitas"},{value:"atividades",label:"Atividades"},{value:"negociacao",label:"Negociação"},{value:"anotacoes",label:"Anotações"},{value:"linha-do-tempo",label:"Linha do Tempo"}].map(e=>{let a=ao===e.value;return(0,t.jsxs)("button",{onClick:()=>ab(e.value),className:(0,ea.cn)("relative whitespace-nowrap px-1 py-3 font-heading text-[11px] font-semibold tracking-wide uppercase transition-colors outline-none mr-6",a?"text-brand":"text-zinc-500 hover:text-zinc-800 focus-visible:ring-2 focus-visible:ring-brand/30"),children:[e.label,a&&(0,t.jsx)(ee.motion.div,{layoutId:"activeDrawerTab",className:"absolute bottom-0 left-0 right-0 h-[3px] rounded-t-full bg-brand",transition:{type:"spring",stiffness:400,damping:30}})]},e.value)})})]}),(0,t.jsx)("div",{className:"flex min-h-0 flex-1",children:(0,t.jsx)("div",{className:"min-h-0 flex-1",children:(0,t.jsx)(tk.ScrollArea,{className:"h-full",children:(0,t.jsx)("div",{className:"p-5 md:px-8 lg:px-10",children:(0,t.jsx)(tj,{value:ao,onValueChange:e=>ab(e),children:(0,t.jsxs)("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-12 gap-6 pb-10",children:[(0,t.jsxs)("div",{className:"md:col-span-12 lg:col-span-7 space-y-4",children:[(0,t.jsxs)(tS,{value:"empresa",className:"mt-0 space-y-4",children:[(0,t.jsx)(s$,{title:"Localização",description:"",icon:D.MapPin,delay:0,successMessage:e6.localizacao,children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"w-[140px] flex-none",children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"CEP"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(eJ.Input,{value:ev,onChange:e=>tq(e.target.value),placeholder:"00000-000",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs transition-all focus:border-brand focus:ring-2 focus:ring-brand/10",readOnly:ep,maxLength:9}),eR&&(0,t.jsx)(V.Loader2,{className:"absolute right-2 top-1/2 h-3 w-3 -translate-y-1/2 animate-spin text-brand"})]}),eE&&(0,t.jsx)("p",{className:"mt-1 font-body text-[10px] text-status-danger",children:eE})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Endereço"}),(0,t.jsx)(eJ.Input,{value:ey,onChange:e=>eN(e.target.value),placeholder:"Logradouro",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ep})]}),(0,t.jsxs)("div",{className:"w-[70px] flex-none",children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Nº"}),(0,t.jsx)(eJ.Input,{value:ew,onChange:e=>eS(e.target.value.replace(/\D/g,"")),placeholder:"123",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ep})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Bairro"}),(0,t.jsx)(eJ.Input,{value:ek,onChange:e=>eM(e.target.value),placeholder:"Bairro",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ep})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Cidade"}),(0,t.jsx)(eJ.Input,{value:eI,onChange:e=>eD(e.target.value),placeholder:"Cidade",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ep})]}),(0,t.jsxs)("div",{className:"w-[70px] flex-none",children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"UF"}),(0,t.jsxs)(tC.Select,{value:eA,onValueChange:eT,disabled:ep,children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-9 rounded-lg border-zinc-200 bg-white px-2 font-body text-xs font-medium focus:ring-brand/10",children:(0,t.jsx)(tC.SelectValue,{placeholder:"UF"})}),(0,t.jsx)(tC.SelectContent,{className:"max-h-[220px]",children:sj.map(e=>(0,t.jsx)(tC.SelectItem,{value:e,className:"font-body text-xs",children:e},e))})]})]})]})]})}),(0,t.jsx)(s$,{title:"Tipo",description:"",icon:d,delay:.06,successMessage:e6.tipo,children:(0,t.jsx)("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-4",children:sf.map(e=>(0,t.jsxs)("button",{disabled:ep,onClick:()=>{var t;return t=e.id,void(!ep&&eW(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]))},className:(0,ea.cn)("group flex flex-col items-center gap-1.5 rounded-[12px] p-2.5 text-center transition-all duration-200",eU.includes(e.id)?"bg-brand/5 border border-brand/20 text-brand shadow-sm":"bg-zinc-50/50 border border-transparent text-zinc-400 hover:bg-zinc-100/80 hover:text-zinc-500",!ep&&"active:scale-[0.96] hover:scale-[1.02]"),children:[(0,t.jsx)("div",{className:(0,ea.cn)("flex h-8 w-8 items-center justify-center rounded-lg transition-all duration-200",eU.includes(e.id)?"bg-brand/10 text-brand":"bg-white text-zinc-300 group-hover:text-zinc-400 shadow-sm"),children:(0,t.jsx)(e.icon,{className:"h-4 w-4"})}),(0,t.jsx)("span",{className:"font-heading text-[9px] font-bold tracking-tight uppercase line-clamp-2",children:e.label})]},e.id))})}),(0,t.jsx)(s$,{title:"Horário e Online",description:"",icon:J.Clock3,delay:.12,successMessage:e6.horario??e6.online,children:(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"space-y-4 rounded-[14px] border border-zinc-100 bg-zinc-50/45 p-3.5",children:[(0,t.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,t.jsx)(e0.Label,{className:"font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Configuração"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:(0,ea.cn)("font-heading text-[10px] font-bold transition-colors","standard"===eG?"text-brand":"text-zinc-300"),children:"PADRÃO"}),(0,t.jsx)(e5.Switch,{checked:"daily"===eG,onCheckedChange:e=>eY(e?"daily":"standard"),className:"scale-75 data-[state=checked]:bg-brand",disabled:ep}),(0,t.jsx)("span",{className:(0,ea.cn)("font-heading text-[10px] font-bold transition-colors","daily"===eG?"text-brand":"text-zinc-300"),children:"DIÁRIO"})]})]}),"standard"===eG?(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[9px] font-bold uppercase text-zinc-400",children:"Abertura"}),(0,t.jsx)(eJ.Input,{type:"time",value:eQ.open,onChange:e=>eZ(t=>({...t,open:e.target.value})),className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",disabled:ep})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"mb-1.5 block font-heading text-[9px] font-bold uppercase text-zinc-400",children:"Fechamento"}),(0,t.jsx)(eJ.Input,{type:"time",value:eQ.close,onChange:e=>eZ(t=>({...t,close:e.target.value})),className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",disabled:ep})]})]}):(0,t.jsx)("div",{className:"space-y-1",children:sv.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(e5.Switch,{checked:e3[e.id].active,onCheckedChange:t=>sU(e.id,"active",t),className:"scale-75 data-[state=checked]:bg-brand",disabled:ep}),(0,t.jsx)("span",{className:"w-8 font-heading text-[10px] font-bold uppercase text-zinc-500",children:e.label.slice(0,3)})]}),e3[e.id].active?(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsx)(eJ.Input,{type:"time",value:e3[e.id].open,onChange:t=>sU(e.id,"open",t.target.value),className:"h-7 w-[60px] rounded-md border-zinc-200 p-1 text-center font-body text-[10px]",disabled:ep}),(0,t.jsx)("span",{className:"text-zinc-300",children:"-"}),(0,t.jsx)(eJ.Input,{type:"time",value:e3[e.id].close,onChange:t=>sU(e.id,"close",t.target.value),className:"h-7 w-[60px] rounded-md border-zinc-200 p-1 text-center font-body text-[10px]",disabled:ep})]}):(0,t.jsx)("span",{className:"font-heading text-[9px] font-bold uppercase text-zinc-300",children:"Fechado"})]},e.id))})]}),(0,t.jsx)("div",{className:"space-y-3 rounded-[14px] border border-zinc-100 bg-zinc-50/45 p-3.5",children:[{id:"site",label:"Site",icon:I,value:eB,setter:eF},{id:"ig",label:"Instagram",icon:F,value:e$,setter:e_},{id:"menu",label:"Cardápio",icon:_,value:eq,setter:eH}].map(e=>(0,t.jsxs)("div",{className:"group/field relative",children:[(0,t.jsx)(e0.Label,{className:"font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:e.label}),(0,t.jsxs)("div",{className:"relative mt-1.5 flex items-center",children:[(0,t.jsx)("div",{className:"absolute left-3 flex items-center gap-1.5 text-zinc-300",children:(0,t.jsx)(e.icon,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(eJ.Input,{value:e.value,onChange:t=>e.setter(t.target.value),placeholder:(e.id,"URL"),className:"h-9 rounded-lg border-zinc-200 pl-9 pr-8 font-body text-xs transition-all focus:border-brand focus:ring-2 focus:ring-brand/10",disabled:ep}),(0,t.jsx)(et.AnimatePresence,{children:e.value&&(0,t.jsx)(ee.motion.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:()=>window.open(e.value.startsWith("http")?e.value:`https://${e.value}`,"_blank"),className:"absolute right-2 h-6 rounded-md bg-zinc-900 px-2 font-heading text-[9px] font-bold text-white shadow-sm transition-all hover:bg-black active:scale-[0.97]",children:"Visitar"})})]})]},e.id))})]})})]}),(0,t.jsxs)(tS,{value:"contatos",className:"mt-0",children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-heading text-sm font-semibold text-black",children:["Contatos (",eu.length,")"]}),(0,t.jsxs)("p",{className:"mt-1 font-body text-[11px] text-zinc-500",children:["Score de Patente do card: ",(0,t.jsx)("span",{className:"font-semibold text-zinc-800",children:aY})," · limite ",1,"-",10," contatos"]})]}),!ep&&(0,t.jsxs)(es.Button,{onClick:()=>{at(null),t6(!0)},disabled:ed.length>=10,className:"rounded-full bg-brand font-heading text-xs text-white hover:bg-brand/90",size:"sm",children:[(0,t.jsx)(y.Plus,{className:"mr-1 h-3.5 w-3.5"})," Adicionar"]})]}),t7&&(0,t.jsx)("div",{className:"mb-3",children:(0,t.jsx)(sT,{banner:t7,onDismiss:()=>t9(null)})}),0===eu.length?(0,t.jsxs)("div",{className:"flex flex-col items-center py-8 text-center",children:[(0,t.jsx)(u.User,{className:"h-8 w-8 text-zinc-200"}),(0,t.jsx)("p",{className:"mt-2 font-body text-sm text-zinc-400",children:"Sem contatos vinculados"}),!ep&&(0,t.jsxs)(es.Button,{size:"sm",variant:"ghost",className:"mt-2 rounded-full font-body text-xs text-brand",onClick:()=>{at(null),t6(!0)},children:[(0,t.jsx)(y.Plus,{className:"mr-1 h-3.5 w-3.5"})," Vincular contato"]})]}):(0,t.jsx)("div",{className:"space-y-2",children:eu.map(e=>an===e.id?(0,t.jsxs)("div",{className:"space-y-3 rounded-[14px] border border-brand/20 bg-brand/5 p-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Nome"}),(0,t.jsx)(eJ.Input,{value:ar.nome,onChange:e=>al({...ar,nome:e.target.value}),className:"mt-1 h-8 rounded-[10px] font-body text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Cargo"}),(0,t.jsxs)(tC.Select,{value:ar.cargo,onValueChange:e=>al({...ar,cargo:e}),children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-8 w-full rounded-[10px] border-zinc-200 font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione o cargo"})}),(0,t.jsx)(tC.SelectContent,{children:tA.RESTAURANT_POSITIONS.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"E-mail"}),(0,t.jsx)(eJ.Input,{type:"email",value:ar.email,onChange:e=>al({...ar,email:e.target.value}),className:"mt-1 h-8 rounded-[10px] font-body text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Telefone"}),(0,t.jsx)(e2.PhoneInput,{value:ar.telefone,onValueChange:e=>al({...ar,telefone:e}),className:"mt-1 h-8 rounded-[10px] font-body text-sm"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Personalidade"}),(0,t.jsx)(tz.Textarea,{value:ar.personalidade,onChange:e=>al({...ar,personalidade:e.target.value}),className:"mt-1 min-h-[60px] rounded-[10px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(es.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-xs",onClick:()=>{ai(null),al({nome:"",email:"",telefone:"",cargo:"",personalidade:""})},children:"Cancelar"}),(0,t.jsx)(es.Button,{size:"sm",className:"rounded-full bg-brand font-heading text-xs text-white hover:bg-brand/90",onClick:ss,children:"Salvar"})]})]},e.id):(0,t.jsx)(sV,{contact:e,patentScore:sw(e.cargo),isPrimary:aK?.id===e.id,onEdit:()=>{ai(e.id),al({nome:e.nome,email:e.email,telefone:e.telefone,cargo:e.cargo,personalidade:e.personalidade??""})},onDelete:()=>(e=>{if(ed.length<=1)return void t9({message:"O card precisa manter pelo menos 1 contato.",variant:"warning"});let t=ed.find(t=>t.id===e),a=ed.filter(t=>t.id!==e);(em(a),t?.isDecisionMaker&&!a.some(e=>e.isDecisionMaker))?t9({message:"Contato removido. Defina outro decisor para manter avanço até Proposta.",variant:"warning"}):t9({message:"Contato removido com sucesso.",variant:"info"})})(e.id),onToggleDecisionMaker:()=>{var t;let a;return t=e.id,void((em(a=ed.map(e=>e.id===t?{...e,isDecisionMaker:!e.isDecisionMaker}:e)),a.some(e=>e.isDecisionMaker))?t9({message:"Decisor atualizado. Regras de avanço para Proposta atendidas.",variant:"success"}):t9({message:"Sem decisor definido. A etapa Proposta ficará bloqueada.",variant:"warning"}))}},e.id))})]}),(0,t.jsxs)(tS,{value:"visitas",className:"mt-0 space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-700",children:"Visitas"}),(0,t.jsx)("p",{className:"mt-0.5 text-xs text-zinc-500",children:"Agenda comercial, resultados e próximos passos."})]}),(0,t.jsxs)(es.Button,{size:"sm",variant:"outline",className:"h-8 gap-1.5 rounded-full text-xs",onClick:()=>aN(!0),disabled:ep,children:[(0,t.jsx)(y.Plus,{className:"h-3.5 w-3.5"}),"Nova Visita"]})]}),(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:[{id:"all",label:"Todas",count:aE.all},{id:"agendada",label:"Agendadas",count:aE.agendada},{id:"realizada",label:"Realizadas",count:aE.realizada},{id:"cancelada",label:"Canceladas",count:aE.cancelada}].map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>aD(e.id),className:(0,ea.cn)("inline-flex h-7 items-center gap-1.5 rounded-full border px-2.5 font-body text-[11px] font-medium transition-all duration-150",aI===e.id?"border-zinc-300 bg-zinc-100 text-zinc-900":"border-zinc-200 bg-white text-zinc-500 hover:border-zinc-300 hover:text-zinc-700"),children:[e.label,(0,t.jsx)("span",{className:"rounded-full bg-zinc-200/80 px-1.5 py-0 text-[10px] font-semibold text-zinc-600",children:e.count})]},e.id))}),0===aL.length&&(0,t.jsxs)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50/80 p-4",children:[(0,t.jsx)("p",{className:"font-heading text-sm font-medium text-zinc-700",children:"Nenhuma visita neste filtro"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Agende uma nova visita para manter o follow-up ativo."}),(0,t.jsxs)(es.Button,{size:"sm",variant:"outline",className:"mt-3 h-8 gap-1.5 rounded-full text-xs",onClick:()=>aN(!0),disabled:ep,children:[(0,t.jsx)(y.Plus,{className:"h-3.5 w-3.5"}),"Nova Visita"]})]}),(0,t.jsx)("div",{className:"space-y-3",children:aL.map(e=>(0,t.jsx)(eK,{visit:e,isExpanded:aA===e.id,isLocked:ep,onToggleDetails:()=>a_(e.id),onStatusChange:aO,onReschedule:aF,onDuplicate:aB,onFollowUp:s_,onDelete:a$},e.id))})]}),(0,t.jsxs)(tS,{value:"atividades",className:"mt-0 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-700",children:"Atividades"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(es.Button,{size:"sm",variant:"outline",className:"h-8 w-8 rounded-full p-0",onClick:sH,title:"Alternar filtro de atividades",children:(0,t.jsx)(B.Filter,{className:"h-3.5 w-3.5"})}),(0,t.jsxs)(es.Button,{size:"sm",variant:"outline",className:"h-8 gap-1.5 rounded-full text-xs",onClick:sB,children:[(0,t.jsx)(y.Plus,{className:"h-3.5 w-3.5"}),"Nova"]})]})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[a0.map(e=>{let a;return(0,t.jsxs)("div",{className:"flex items-start gap-3 rounded-2xl border border-zinc-100 bg-white p-3 transition-all hover:border-zinc-200",children:[(0,t.jsx)("div",{className:(0,ea.cn)("flex h-9 w-9 shrink-0 items-center justify-center rounded-full border","completed"===e.status?"border-zinc-100 bg-zinc-50 text-zinc-400":"border-brand/10 bg-brand/5 text-brand"),children:(a=(e=>{switch(e){case"call":return n.Phone;case"meeting":return x.Users;case"email":return l.Mail;case"whatsapp":return i.MessageCircle;default:return r.Circle}})(e.type),(0,t.jsx)(a,{className:"h-4 w-4"}))}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsx)("p",{className:(0,ea.cn)("font-heading text-sm font-medium","completed"===e.status?"text-zinc-500 line-through":"text-zinc-900"),children:e.title}),(0,t.jsx)("div",{className:"flex gap-1",children:(0,t.jsx)("button",{type:"button",onClick:()=>sq(e.id),disabled:"completed"===e.status,className:"flex h-6 w-6 items-center justify-center rounded-full text-zinc-300 transition-colors hover:bg-zinc-100 hover:text-zinc-600 disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Concluir atividade",children:(0,t.jsx)(k.CheckCircle,{className:"h-4 w-4"})})})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3 text-xs text-zinc-400",children:[(0,t.jsxs)("span",{className:(0,ea.cn)("flex items-center gap-1","overdue"===e.status&&"text-red-500 font-medium"),children:[(0,t.jsx)(p.Clock,{className:"h-3 w-3"}),e.dueDate]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(H,{className:"h-3 w-3"}),e.responsibleName]})]})]})]},e.id)}),0===a0.length&&(0,t.jsx)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50 p-3 text-xs text-zinc-500",children:"Nenhuma atividade para o filtro atual."})]})]}),(0,t.jsx)(tS,{value:"negociacao",className:"mt-0 space-y-4",children:(0,t.jsx)(az,{dealId:O.id,dealTitle:X})}),(0,t.jsxs)(tS,{value:"anotacoes",className:"mt-0 space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-3 rounded-[18px] border border-zinc-200 bg-white p-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Registro rápido"}),(0,t.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Escreva o que aconteceu e registre o próximo passo sem perder o contexto."})]}),(0,t.jsxs)("div",{className:"inline-flex items-center gap-1 rounded-full border border-zinc-200 bg-zinc-50 p-1",children:[(0,t.jsx)("button",{type:"button",onClick:()=>tc("team"),className:(0,ea.cn)("rounded-full px-2.5 py-1 text-[11px] font-medium transition-all","team"===to?"bg-white text-zinc-900 shadow-sm":"text-zinc-500 hover:text-zinc-700"),children:"Time"}),(0,t.jsx)("button",{type:"button",onClick:()=>tc("internal"),className:(0,ea.cn)("rounded-full px-2.5 py-1 text-[11px] font-medium transition-all","internal"===to?"bg-white text-zinc-900 shadow-sm":"text-zinc-500 hover:text-zinc-700"),children:"Interna"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(tz.Textarea,{value:tn,onChange:e=>{tu&&tx(null),tm("idle"),ti(e.target.value)},className:(0,ea.cn)("min-h-[110px] resize-none rounded-[14px] border-zinc-200 text-sm",tu&&"border-red-300 focus-visible:ring-red-200"),placeholder:"Escreva o que aconteceu e qual é o próximo passo..."}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-[11px]",children:[(0,t.jsx)("span",{className:(0,ea.cn)(tu?"text-red-600":"text-zinc-400"),children:tu??`M\xednimo de 10 caracteres.`}),(0,t.jsxs)("span",{className:"text-zinc-400",children:[tn.trim().length,"/",2e3]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("span",{className:"text-[11px] font-medium text-zinc-500",children:"Intenção:"}),(0,t.jsx)("button",{type:"button",onClick:()=>tl("general"),className:(0,ea.cn)("rounded-full border px-2.5 py-1 text-[11px] font-medium transition-all","general"===tr?"border-zinc-300 bg-zinc-900 text-white":"border-zinc-200 bg-zinc-50 text-zinc-500 hover:bg-zinc-100"),children:"Registro"}),sd.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>tl(e.id),className:(0,ea.cn)("rounded-full border px-2.5 py-1 text-[11px] font-medium transition-all",tr===e.id?"border-brand/20 bg-brand/10 text-brand":"border-zinc-200 bg-zinc-50 text-zinc-500 hover:bg-zinc-100"),children:e.label},e.id))]}),(0,t.jsx)(et.AnimatePresence,{initial:!1,children:"proximo_passo"===tr&&(0,t.jsxs)(ee.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:4},transition:{duration:.18,ease:"easeOut"},className:"grid gap-3 rounded-[14px] border border-brand/15 bg-brand/5 p-3 md:grid-cols-2",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Ação"}),(0,t.jsx)(eJ.Input,{value:tP.action,onChange:e=>tV(t=>({...t,action:e.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Confirmar disponibilidade para reunião de proposta"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Data limite"}),(0,t.jsx)(eJ.Input,{type:"date",value:tP.dueDate,onChange:e=>tV(t=>({...t,dueDate:e.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Canal"}),(0,t.jsxs)(tC.Select,{value:tP.channel,onValueChange:e=>tV(t=>({...t,channel:e})),children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsxs)(tC.SelectContent,{children:[(0,t.jsx)(tC.SelectItem,{value:"call",children:"Ligação"}),(0,t.jsx)(tC.SelectItem,{value:"whatsapp",children:"WhatsApp"}),(0,t.jsx)(tC.SelectItem,{value:"email",children:"E-mail"}),(0,t.jsx)(tC.SelectItem,{value:"meeting",children:"Reunião"}),(0,t.jsx)(tC.SelectItem,{value:"visit",children:"Visita"})]})]})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)(e0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Responsável"}),(0,t.jsxs)(tC.Select,{value:tP.ownerId,onValueChange:e=>tV(t=>({...t,ownerId:e})),disabled:ep,children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsx)(tC.SelectContent,{children:sS.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.name},e.id))})]})]})]})}),tB&&(0,t.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-600",children:tB}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-[11px] text-zinc-500",children:["saving"===td&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,t.jsx)(V.Loader2,{className:"h-3 w-3 animate-spin"}),"Salvando nota..."]}),"saved"===td&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-emerald-600",children:[(0,t.jsx)(z.Check,{className:"h-3 w-3"}),"Nota salva agora."]}),"saving"===tL&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,t.jsx)(V.Loader2,{className:"h-3 w-3 animate-spin"}),"Criando próximo passo..."]}),"saved"===tL&&(0,t.jsxs)("span",{className:"inline-flex items-center gap-1 text-emerald-600",children:[(0,t.jsx)(z.Check,{className:"h-3 w-3"}),"Próximo passo criado."]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(es.Button,{size:"sm",variant:"outline",className:"h-8 rounded-full px-3 text-xs",onClick:sN,disabled:ep||"saving"===tL,children:["saving"===tL?(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,t.jsx)(R.ArrowRight,{className:"mr-1.5 h-3.5 w-3.5"}),"Criar próximo passo"]}),(0,t.jsxs)(es.Button,{size:"sm",className:"h-8 rounded-full bg-zinc-900 px-3 text-xs text-white hover:bg-black",onClick:sp,disabled:ep||"saving"===td,children:["saving"===td?(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,t.jsx)(z.Check,{className:"mr-1.5 h-3.5 w-3.5"}),"Salvar nota"]})]})]})]}),(0,t.jsx)(en.Separator,{}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,t.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Histórico"}),(0,t.jsx)("div",{className:"inline-flex items-center gap-1 rounded-full border border-zinc-200 bg-white p-1",children:sm.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>tp(e.id),className:(0,ea.cn)("rounded-full px-2.5 py-1 text-[11px] font-medium transition-all",th===e.id?"bg-zinc-900 text-white":"text-zinc-500 hover:text-zinc-700"),children:e.label},e.id))})]}),0===a3.length?(0,t.jsx)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50 p-4 text-xs text-zinc-500",children:"Nenhuma nota para este filtro."}):(0,t.jsx)("div",{className:"space-y-5",children:a3.map(e=>(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wider text-zinc-400",children:e.dayLabel}),(0,t.jsx)("div",{className:"space-y-3",children:e.items.map(e=>(0,t.jsx)("div",{className:"rounded-[14px] border border-zinc-200 bg-white p-3",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)("span",{className:"font-heading text-xs font-semibold text-zinc-700",children:e.authorName}),(0,t.jsx)("span",{className:"text-[10px] text-zinc-400",children:new Date(e.createdAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,t.jsx)("span",{className:(0,ea.cn)("rounded-full border px-2 py-0.5 text-[10px] font-semibold",su[e.intent].chipClass),children:su[e.intent].label}),(0,t.jsx)("span",{className:"rounded-full border border-zinc-200 bg-zinc-50 px-2 py-0.5 text-[10px] text-zinc-500",children:"internal"===e.visibility?"Interna":"Time"})]}),tg===e.id?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(tz.Textarea,{value:tf,onChange:e=>tv(e.target.value),className:"min-h-[86px] rounded-lg border-zinc-200 text-sm"}),tw&&(0,t.jsx)("p",{className:"text-xs text-red-600",children:tw}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(es.Button,{size:"sm",className:"h-7 rounded-full bg-zinc-900 px-3 text-[11px] text-white hover:bg-black",onClick:sA,disabled:"saving"===ty,children:["saving"===ty&&(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-3 w-3 animate-spin"}),"Salvar edição"]}),(0,t.jsx)(es.Button,{size:"sm",variant:"ghost",className:"h-7 rounded-full px-3 text-[11px]",onClick:()=>{tb(null),tv(""),tR(null)},children:"Cancelar"})]})]}):(0,t.jsx)("p",{className:"font-body text-sm leading-relaxed text-zinc-700",children:e.body})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[sl(e)&&(0,t.jsxs)(es.Button,{size:"sm",variant:"ghost",className:"h-7 rounded-full px-2 text-[11px]",onClick:()=>sD(e),children:[(0,t.jsx)(M.Pencil,{className:"mr-1 h-3 w-3"}),"Editar"]}),!e.isSystem&&(0,t.jsxs)(es.Button,{size:"sm",variant:"ghost",className:"h-7 rounded-full px-2 text-[11px]",onClick:()=>sP(e),children:[(0,t.jsx)(q.Copy,{className:"mr-1 h-3 w-3"}),"Duplicar"]})]})]})},e.id))})]},e.dayLabel))})]})]}),(0,t.jsx)(tS,{value:"linha-do-tempo",className:"mt-0 space-y-4",children:(0,t.jsx)(sE,{events:function(e){let t=sn.getState().getByOpportunity(e),a=sr.getState().getByOpportunity(e),s=[];for(let e of t)s.push({id:e.id,type:"realizada"===e.status?"activity":"created",message:`Visita ${e.type}: ${e.objective??e.location}`,user:e.responsible,date:new Date(e.startAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})});for(let e of a)s.push({id:e.id,type:e.isSystem?"stage-change":"note",message:e.body.slice(0,80)+(e.body.length>80?"...":""),user:e.authorName,date:new Date(e.createdAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})});return s.sort((e,t)=>{let a=new Date(e.date.split(", ").reverse().join("T")||e.date);return new Date(t.date.split(", ").reverse().join("T")||t.date).getTime()-a.getTime()})}(O.id)})})]}),(0,t.jsx)("div",{className:"md:col-span-12 lg:col-span-5 space-y-4",children:(0,t.jsx)(t8,{opportunityId:O.id,currentStage:Q,stages:sg,initialValues:$,isLocked:ep,onStageChange:e=>a8(e),nextStage:aQ,canCreateFields:!1,advanceBlockedReason:ed.length<1?"Adicione pelo menos 1 contato para avançar no funil.":aQ?.id!==so||aX?null:"Defina ao menos 1 decisor na aba Contatos para avançar para Proposta."})})]})})})})})})]})}),(0,t.jsx)(tI.AlertDialog,{open:tY,onOpenChange:tQ,children:(0,t.jsxs)(tI.AlertDialogContent,{className:"rounded-[20px]",children:[(0,t.jsxs)(tI.AlertDialogHeader,{children:[(0,t.jsx)(tI.AlertDialogTitle,{className:"font-heading text-xl",children:"Marcar como ganho?"}),(0,t.jsx)(tI.AlertDialogDescription,{className:"font-body text-sm text-zinc-600",children:"Marcar como ganho encerra a oportunidade. Edicoes sensiveis serao bloqueadas. Voce quer continuar?"})]}),(0,t.jsxs)(tI.AlertDialogFooter,{children:[(0,t.jsx)(tI.AlertDialogCancel,{className:"rounded-full",disabled:tJ,children:"Cancelar"}),(0,t.jsxs)(tI.AlertDialogAction,{onClick:se,disabled:tJ,className:"rounded-full bg-status-success text-white hover:bg-status-success/90",children:[tJ?(0,t.jsx)(V.Loader2,{className:"mr-1.5 h-4 w-4 animate-spin"}):(0,t.jsx)(z.Check,{className:"mr-1.5 h-4 w-4"}),"Sim, marcar como ganho"]})]})]})}),(0,t.jsx)(tI.AlertDialog,{open:t5,onOpenChange:t3,children:(0,t.jsxs)(tI.AlertDialogContent,{className:"rounded-[20px]",children:[(0,t.jsxs)(tI.AlertDialogHeader,{children:[(0,t.jsx)(tI.AlertDialogTitle,{className:"font-heading text-xl",children:"Excluir oportunidade?"}),(0,t.jsx)(tI.AlertDialogDescription,{className:"font-body text-sm text-zinc-600",children:"Esta acao nao pode ser desfeita. Todos os dados desta oportunidade serao removidos permanentemente."})]}),(0,t.jsxs)(tI.AlertDialogFooter,{children:[(0,t.jsx)(tI.AlertDialogCancel,{className:"rounded-full",children:"Cancelar"}),(0,t.jsx)(tI.AlertDialogAction,{onClick:()=>{t3(!1),m()},className:"rounded-full bg-status-danger text-white hover:bg-status-danger/90",children:"Sim, excluir"})]})]})}),(0,t.jsx)(tM.Dialog,{open:t4,onOpenChange:e=>{t6(e),e||(at(null),as({nome:"",email:"",telefone:"",cargo:"",personalidade:""}))},children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-3xl gap-0 overflow-hidden rounded-[20px] p-0",children:[(0,t.jsxs)("div",{className:"border-b border-zinc-100 px-5 py-4",children:[(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-lg font-semibold text-zinc-900",children:"Adicionar contato"}),(0,t.jsx)(tM.DialogDescription,{className:"mt-1 text-sm text-zinc-500",children:"Cadastre um novo contato para este card. Nome e cargo são obrigatórios."})]}),(0,t.jsxs)("div",{className:"space-y-4 px-5 py-4",children:[ae&&(0,t.jsx)(sT,{banner:{message:ae,variant:"warning"},onDismiss:()=>at(null)}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Nome"}),(0,t.jsx)(eJ.Input,{value:aa.nome,onChange:e=>as({...aa,nome:e.target.value}),className:"mt-1 h-9 rounded-[10px] font-body text-sm",placeholder:"Nome"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Cargo"}),(0,t.jsxs)(tC.Select,{value:aa.cargo,onValueChange:e=>as({...aa,cargo:e}),children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 w-full rounded-[10px] border-zinc-200 font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione o cargo"})}),(0,t.jsx)(tC.SelectContent,{children:tA.RESTAURANT_POSITIONS.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"E-mail"}),(0,t.jsx)(eJ.Input,{type:"email",value:aa.email,onChange:e=>as({...aa,email:e.target.value}),className:"mt-1 h-9 rounded-[10px] font-body text-sm",placeholder:"email@empresa.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Telefone"}),(0,t.jsx)(e2.PhoneInput,{value:aa.telefone,onValueChange:e=>as({...aa,telefone:e}),className:"mt-1 h-9 rounded-[10px] font-body text-sm"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Personalidade"}),(0,t.jsx)(tz.Textarea,{value:aa.personalidade,onChange:e=>as({...aa,personalidade:e.target.value}),className:"mt-1 min-h-[86px] rounded-[10px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]})]}),(0,t.jsxs)(tM.DialogFooter,{className:"border-t border-zinc-100 bg-zinc-50/50 px-5 py-3 sm:justify-end",children:[(0,t.jsx)(es.Button,{variant:"ghost",className:"rounded-full font-heading text-xs",onClick:()=>{t6(!1),at(null),as({nome:"",email:"",telefone:"",cargo:"",personalidade:""})},children:"Cancelar"}),(0,t.jsx)(es.Button,{className:"rounded-full bg-brand font-heading text-xs text-white hover:bg-brand/90",onClick:()=>{if(ed.length>=10){let e=`Limite atingido: no m\xe1ximo 10 contatos por card.`;t9({message:e,variant:"warning"}),at(e);return}aa.nome.trim()?aa.cargo?(em([...ed,{id:`c${Date.now()}`,clientId:L?.clientId??"1",...aa,isDecisionMaker:!1}]),as({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),t6(!1),at(null),t9({message:"Contato adicionado. O score de patente do card foi recalculado.",variant:"success"})):at("Selecione o cargo do contato para calcular o score de patente."):at("Informe o nome do contato para continuar.")},children:"Salvar contato"})]})]})}),(0,t.jsx)(aZ,{isOpen:ay,onClose:()=>aN(!1),onSave:e=>{if(ep)return;let t=e.type,a=e.date&&e.time?new Date(`${e.date}T${e.time}:00`):new Date,s="presencial"===t?e.location||"Local a confirmar":"remoto"===t?sC[e.platform??"outro"]??"Reunião remota":e.typeDescription||"Encontro comercial",n="u1"===e.responsibleId?"Eu (Logado)":"u2"===e.responsibleId?"Ana Costa":"u3"===e.responsibleId?"Carlos Mendes":"Responsável do time",i="realizada"===e.status&&e.result?`${e.outcome?`${sz[e.outcome]}: `:""}${e.result}`:e.result||void 0,r={id:`visit-${Date.now()}`,type:t,location:s,status:e.status,startAt:Number.isNaN(a.getTime())?new Date().toISOString():a.toISOString(),responsible:n,objective:e.objective||void 0,result:i,outcome:e.outcome||void 0,durationMinutes:Number(e.duration||60),link:e.link||void 0,platform:e.platform||void 0,cancellationReason:e.cancellationReason||void 0,accessSearch:e.accessSearch||void 0,details:e.details||void 0,createdAt:new Date().toISOString()};aP(e=>[r,...e]),aD(r.status),aT(r.id),tW({message:"Visita salva com sucesso",variant:"success"})},dealId:O.id,contacts:ed,onAddContact:e=>{if(ed.length>=10)return void t9({message:`Limite atingido: no m\xe1ximo 10 contatos por card.`,variant:"warning"});let t={id:`c${Date.now()}`,clientId:L?.clientId??"1",nome:e.nome||"Sem Nome",email:e.email||"",telefone:e.telefone||"",cargo:e.cargo||"operacional",personalidade:"",isDecisionMaker:!1};em(e=>[...e,t]),t9({message:"Contato criado a partir de Visitas.",variant:"success"})}}),(0,t.jsx)(sa,{isOpen:aw,onClose:()=>aS(!1),onSave:sL,dealId:O.id,initialType:aC,initialClientId:L?.clientId,initialClientName:O.clientName,initialContactIds:aK?.id?[aK.id]:void 0,initialContactNames:aK?.nome?[aK.nome]:void 0,initialOpportunityId:O.id,initialOpportunityTitle:O.title,lockClient:!!L?.clientId,requireClient:!!L?.clientId}),(0,t.jsx)(tM.Dialog,{open:ax,onOpenChange:e=>{e||aj()},children:(0,t.jsxs)(tM.DialogContent,{className:"sm:max-w-md p-6",children:[(0,t.jsxs)(tM.DialogHeader,{children:[(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-lg font-bold",children:"Alterações não salvas"}),(0,t.jsx)(tM.DialogDescription,{className:"font-body text-sm text-zinc-500 mt-2",children:"Você tem alterações não salvas. Quer descartar as alterações e sair?"})]}),(0,t.jsxs)(tM.DialogFooter,{className:"mt-6 flex sm:justify-end gap-3",children:[(0,t.jsx)(es.Button,{variant:"outline",onClick:aj,children:"Cancelar"}),(0,t.jsx)(es.Button,{className:"bg-red-600 hover:bg-red-700 text-white",onClick:av,children:"Sair sem salvar"})]})]})})]})}var sq=e.i(90597);let sH=(0,c.default)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]),sU=(0,c.default)("thumbs-up",[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]]);var sW=e.i(99753);let sG={good:{label:"Saudavel",color:"text-status-success",bgColor:"bg-status-success-light",icon:(0,t.jsx)(sq.Heart,{className:"h-4 w-4 fill-current text-status-success"}),numericScore:85},warning:{label:"Atencao",color:"text-status-warning",bgColor:"bg-status-warning-light",icon:(0,t.jsx)(P.AlertTriangle,{className:"h-4 w-4 text-status-warning"}),numericScore:55},critical:{label:"Critico",color:"text-status-danger",bgColor:"bg-status-danger-light",icon:(0,t.jsx)(an.XCircle,{className:"h-4 w-4 text-status-danger"}),numericScore:20}},sX=[{id:"onboarding",label:"Onboarding"},{id:"implantacao",label:"Implantacao"},{id:"acompanhamento",label:"Acompanhamento"},{id:"retencao",label:"Retencao"},{id:"churn",label:"Churn"}],sY={id:"1",companyName:"Restaurante Panoramico",cnpj:"12.345.678/0001-00",razaoSocial:"Restaurante Panoramico Ltda ME",endereco:"Av. Paulista, 1000 - Bela Vista, Sao Paulo - SP",telefoneEmpresa:"(11) 3456-7890",emailEmpresa:"contato@panoramico.com",stage:"acompanhamento",healthScore:"good",monthlyRevenue:2500,contractStart:"2025-06-01",contractEnd:"2026-06-01",responsibleId:"u1",responsibleName:"Maria Silva",tags:["food-service","restaurante","premium"],lastInteraction:"2026-02-03",groupName:"Grupo Panoramico",notes:"Cliente com excelente engajamento. Acompanhar renovacao do contrato em junho."};function sQ(e){return tA.RESTAURANT_POSITIONS.find(t=>t.value===e)?.patentScore??0}let sZ=sl.mockUsers.filter(e=>e.isActive).map(e=>({id:e.id,name:e.name,avatar:""})),sK=[{month:"Set",value:1800},{month:"Out",value:2e3},{month:"Nov",value:2200},{month:"Dez",value:2300},{month:"Jan",value:2500},{month:"Fev",value:2500}],sJ=["Preco muito alto","Nao utiliza o produto","Mudou para concorrente","Empresa fechou","Insatisfacao com suporte","Falta de funcionalidades","Outro"];function s0(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(e)}function s1({icon:e,label:s,value:n,onSave:i,type:r="text"}){let[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(n),m=(0,a.useRef)(null);function u(){o(!1),c!==n&&i(c)}return(0,a.useEffect)(()=>{l&&m.current&&(m.current.focus(),m.current.select())},[l]),(0,t.jsxs)("div",{className:"flex items-center gap-3 rounded-[15px] border border-zinc-100 p-3 transition-colors hover:border-zinc-200",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:e}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-body text-xs text-zinc-500",children:s}),l?(0,t.jsx)(eJ.Input,{ref:m,type:r,value:c,onChange:e=>d(e.target.value),onBlur:u,onKeyDown:e=>{"Enter"===e.key&&u(),"Escape"===e.key&&(d(n),o(!1))},className:"mt-0.5 h-7 rounded-[10px] border-zinc-200 font-body text-sm"}):(0,t.jsx)("p",{onClick:()=>{d(n),o(!0)},className:"mt-0.5 cursor-pointer rounded-lg px-1 py-0.5 font-body text-sm font-medium text-black transition-colors hover:bg-zinc-50",title:"Clique para editar",children:n||"--"})]}),!l&&(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0 text-zinc-300 hover:text-zinc-500",onClick:()=>{d(n),o(!0)},children:(0,t.jsx)(M.Pencil,{className:"h-3.5 w-3.5"})})]})}function s2({currentStage:e,onStageChange:a}){let s=sX.findIndex(t=>t.id===e);return(0,t.jsx)("div",{className:"flex items-center gap-1",children:sX.map((n,i)=>{let r=n.id===e,l=i<s,o="churn"===n.id;return(0,t.jsxs)("button",{onClick:()=>a(n.id),className:`flex items-center gap-1 rounded-full px-3 py-1.5 font-body text-xs font-medium transition-all ${r?o?"bg-status-danger text-white shadow-sm":"bg-brand text-white shadow-sm":l?"bg-brand/10 text-brand":"bg-zinc-100 text-zinc-400 hover:bg-zinc-200 hover:text-zinc-600"}`,children:[l&&(0,t.jsx)(z.Check,{className:"h-3 w-3"}),n.label]},n.id)})})}function s5({currentId:e,currentName:a,teamMembers:s,onReassign:n}){let i=a.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase();return(0,t.jsxs)(eX.DropdownMenu,{children:[(0,t.jsx)(eX.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)("button",{className:"flex items-center gap-2 rounded-full px-2 py-1 transition-colors hover:bg-zinc-100",children:[(0,t.jsx)("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-brand text-xs font-bold text-white",children:i}),(0,t.jsx)("span",{className:"font-body text-sm font-medium text-black",children:a}),(0,t.jsx)(M.Pencil,{className:"h-3 w-3 text-zinc-400"})]})}),(0,t.jsx)(eX.DropdownMenuContent,{align:"start",className:"rounded-[15px]",children:s.map(a=>(0,t.jsxs)(eX.DropdownMenuItem,{onClick:()=>n(a.id,a.name),className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-zinc-200 text-[10px] font-bold text-zinc-600",children:a.name.split(" ").map(e=>e[0]).join("").slice(0,2).toUpperCase()}),(0,t.jsx)("span",{className:"font-body text-sm",children:a.name}),a.id===e&&(0,t.jsx)(z.Check,{className:"ml-auto h-4 w-4 text-brand"})]},a.id))})]})}function s3({contact:e,onEdit:a,onDelete:s,onToggleDecisionMaker:i}){var r;return(0,t.jsxs)("div",{className:"group flex items-stretch rounded-[15px] border border-zinc-200",children:[(0,t.jsx)("button",{type:"button",onClick:i,className:`flex w-10 shrink-0 items-center justify-center rounded-l-[15px] border-r transition-colors ${e.isDecisionMaker?"border-brand/20 bg-brand/10 text-brand":"border-zinc-200 bg-zinc-50/50 text-zinc-300 hover:bg-zinc-100 hover:text-zinc-400"}`,"aria-label":e.isDecisionMaker?"Remover como decisor":"Marcar como decisor",title:e.isDecisionMaker?"Decisor (clique para remover)":"Marcar como decisor",children:(0,t.jsx)(S.Shield,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex flex-1 items-start justify-between p-4",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-zinc-100",children:(0,t.jsx)(u.User,{className:"h-5 w-5 text-zinc-500"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"font-heading text-sm font-semibold text-black",children:e.nome}),e.isDecisionMaker&&(0,t.jsxs)(eG.Badge,{className:"gap-1 rounded-[10px] bg-brand/10 text-brand font-body text-[10px]",children:[(0,t.jsx)(S.Shield,{className:"h-3 w-3"}),"Decisor"]})]}),(0,t.jsx)("p",{className:"font-body text-xs text-zinc-500",children:(r=e.cargo,tA.RESTAURANT_POSITIONS.find(e=>e.value===r)?.label??r)}),(0,t.jsxs)("div",{className:"mt-1.5 flex items-center gap-3",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1 font-body text-xs text-zinc-500",children:[(0,t.jsx)(l.Mail,{className:"h-3 w-3"}),e.email]}),(0,t.jsxs)("span",{className:"flex items-center gap-1 font-body text-xs text-zinc-500",children:[(0,t.jsx)(n.Phone,{className:"h-3 w-3"}),e.telefone]})]}),e.personalidade&&(0,t.jsxs)("p",{className:"mt-1.5 font-body text-xs italic text-zinc-400",children:["“",e.personalidade,"”"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-400 hover:text-zinc-600",onClick:a,children:(0,t.jsx)(M.Pencil,{className:"h-3.5 w-3.5"})}),(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-400 hover:text-status-danger",onClick:s,children:(0,t.jsx)(N.Trash2,{className:"h-3.5 w-3.5"})})]})]})]})}function s4({data:e}){let a=Math.max(...e.map(e=>e.value));return(0,t.jsxs)("div",{className:"rounded-[15px] border border-zinc-100 p-4",children:[(0,t.jsx)("h4",{className:"mb-3 font-heading text-sm font-semibold text-black",children:"MRR - Ultimos 6 Meses"}),(0,t.jsx)("div",{className:"flex items-end gap-2",style:{height:120},children:e.map((s,n)=>{let i=s.value/a*100,r=n===e.length-1;return(0,t.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1",children:[(0,t.jsx)("span",{className:"font-body text-[10px] font-medium text-zinc-500",children:s0(s.value)}),(0,t.jsx)("div",{className:`w-full rounded-t-lg transition-all ${r?"bg-brand":"bg-brand/20"}`,style:{height:`${i}%`,minHeight:8}}),(0,t.jsx)("span",{className:"font-body text-xs text-zinc-400",children:s.month})]},s.month)})})]})}function s6({icon:e,label:a,value:s,suffix:n,color:i="text-black"}){return(0,t.jsxs)("div",{className:"flex items-center gap-3 rounded-[15px] border border-zinc-100 p-4",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:e}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-body text-xs text-zinc-500",children:a}),(0,t.jsxs)("p",{className:`font-heading text-lg font-bold ${i}`,children:[s,n&&(0,t.jsx)("span",{className:"ml-0.5 font-body text-xs font-normal text-zinc-400",children:n})]})]})]})}function s7({open:e,onClose:s,onConfirm:n}){let[i,r]=(0,a.useState)(""),[l,o]=(0,a.useState)("");return(0,t.jsx)(tM.Dialog,{open:e,onOpenChange:s,children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-[480px] rounded-[20px] p-8",children:[(0,t.jsx)(tM.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-status-danger-light",children:(0,t.jsx)(an.XCircle,{className:"h-5 w-5 text-status-danger"})}),(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Registrar Churn"})]})}),(0,t.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Motivo do Churn"}),(0,t.jsxs)(tC.Select,{value:i,onValueChange:r,children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione o motivo"})}),(0,t.jsx)(tC.SelectContent,{className:"rounded-[15px]",children:sJ.map(e=>(0,t.jsx)(tC.SelectItem,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Observacoes"}),(0,t.jsx)(tz.Textarea,{value:l,onChange:e=>o(e.target.value),className:"min-h-[100px] rounded-[15px] font-body text-sm",placeholder:"Descreva os detalhes do churn..."})]})]}),(0,t.jsxs)(tM.DialogFooter,{className:"mt-6",children:[(0,t.jsx)(es.Button,{variant:"secondary",onClick:s,className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,t.jsx)(es.Button,{onClick:function(){n(i,l),r(""),o(""),s()},disabled:!i,className:"rounded-full bg-status-danger font-heading text-sm text-white hover:bg-status-danger/90",children:"Registrar Churn"})]})]})})}function s8(){let e,{drawerType:i,drawerData:r,closeDrawer:c,openModal:h}=(0,tD.useUIStore)(),g=r?.id,b=(0,a7.useClientStore)(e=>e.clients),f=(0,a.useMemo)(()=>b.find(e=>e.id===g),[b,g]),N=(0,a.useMemo)(()=>f?{...sY,id:f.id,companyName:f.companyName,cnpj:f.cnpj,razaoSocial:f.companyName,telefoneEmpresa:f.contactPhone,emailEmpresa:f.contactEmail,stage:f.stage,healthScore:f.healthScore,monthlyRevenue:f.monthlyRevenue,contractStart:f.contractStart,contractEnd:f.contractEnd,responsibleId:f.responsibleId,responsibleName:f.responsibleName,tags:f.tags,lastInteraction:f.lastInteraction,notes:""}:sY,[f]),w=(0,tA.calculateHealthScore)(N),S={...sG[w.category],numericScore:w.numericScore},[C,z]=(0,a.useState)(N.stage),[k,M]=(0,a.useState)(N.responsibleId),[I,P]=(0,a.useState)(N.responsibleName),[E,V]=(0,a.useState)(N.notes),[L,B]=(0,a.useState)(()=>[...N.tags]),[F,$]=(0,a.useState)(""),[_,q]=(0,a.useState)(()=>{let e=a9.getState().getByClient(N.id);return e.length>0?e:[]}),H=(0,a.useMemo)(()=>[..._].sort((e,t)=>sQ(t.cargo)-sQ(e.cargo)),[_]),[U,W]=(0,a.useState)(!1),[G,X]=(0,a.useState)(N.cnpj),[Y,Q]=(0,a.useState)(N.razaoSocial),[Z,K]=(0,a.useState)(N.endereco),[J,ee]=(0,a.useState)(N.telefoneEmpresa),[et,ea]=(0,a.useState)(N.emailEmpresa),[ei,er]=(0,a.useState)(!1),[el,eo]=(0,a.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),[ec,ed]=(0,a.useState)(null),[em,eu]=(0,a.useState)(null),[ex,eh]=(0,a.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""});function ep(){F.trim()&&!L.includes(F.trim().toLowerCase())&&(B([...L,F.trim().toLowerCase()]),$(""))}function eg(){em&&ex.nome.trim()&&(q(_.map(e=>e.id===em?{...e,...ex}:e)),eu(null),eh({nome:"",email:"",telefone:"",cargo:"",personalidade:""}))}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(aJ.Sheet,{open:"client-card"===i,onOpenChange:()=>c(),children:(0,t.jsxs)(aJ.SheetContent,{side:"right",className:"w-full overflow-y-auto border-l border-zinc-200 p-0 sm:w-[720px] sm:max-w-[720px]",showCloseButton:!1,children:[(0,t.jsxs)(aJ.SheetHeader,{className:"sticky top-0 z-10 border-b border-zinc-200 bg-white px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(aJ.SheetTitle,{className:"font-heading text-xl font-semibold text-black",children:N.companyName}),(0,t.jsxs)("div",{className:`inline-flex items-center gap-1.5 rounded-[10px] px-3 py-1.5 font-heading text-sm font-bold ${S.bgColor} ${S.color}`,children:[S.icon,S.label,(0,t.jsxs)("span",{className:"ml-1 text-xs font-normal opacity-70",children:["(",S.numericScore,")"]})]}),N.groupName&&(0,t.jsxs)(eG.Badge,{className:"gap-1 rounded-[10px] bg-zinc-100 text-zinc-600 font-body text-xs",children:[(0,t.jsx)(x.Users,{className:"h-3 w-3"}),N.groupName]})]}),(0,t.jsxs)("p",{className:"mt-0.5 font-body text-sm text-zinc-500",children:["CNPJ: ",N.cnpj]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(es.Button,{onClick:()=>W(!0),variant:"destructive",className:"rounded-full font-heading text-sm",children:"Registrar Churn"}),(0,t.jsxs)(eX.DropdownMenu,{children:[(0,t.jsx)(eX.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"text-zinc-400",children:(0,t.jsx)(v.MoreHorizontal,{className:"h-5 w-5"})})}),(0,t.jsxs)(eX.DropdownMenuContent,{align:"end",className:"rounded-[15px]",children:[(0,t.jsx)(eX.DropdownMenuItem,{onClick:()=>h("new-activity"),children:"Nova atividade"}),(0,t.jsx)(eX.DropdownMenuItem,{onClick:()=>h("new-activity"),children:"Registrar interacao"}),(0,t.jsx)(eX.DropdownMenuSeparator,{}),(0,t.jsx)(eX.DropdownMenuItem,{className:"text-status-danger",onClick:()=>h("confirm-deactivate"),children:"Desativar cliente"})]})]}),(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"text-zinc-400",onClick:()=>c(),children:(0,t.jsx)(s.X,{className:"h-5 w-5"})})]})]}),(0,t.jsx)("div",{className:"mt-3 overflow-x-auto",children:(0,t.jsx)(s2,{currentStage:C,onStageChange:z})}),(0,t.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.DollarSign,{className:"h-4 w-4 text-zinc-400"}),(0,t.jsxs)("span",{className:"font-body text-sm text-zinc-600",children:["MRR: ",(0,t.jsx)("strong",{className:"text-black",children:s0(N.monthlyRevenue)})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(o.Calendar,{className:"h-4 w-4 text-zinc-400"}),(0,t.jsxs)("span",{className:"font-body text-sm text-zinc-600",children:["Contrato: ",(0,t.jsx)("strong",{className:"text-black",children:new Date(N.contractStart).toLocaleDateString("pt-BR")})]})]})]}),(0,t.jsx)(s5,{currentId:k,currentName:I,teamMembers:sZ,onReassign:(e,t)=>{M(e),P(t)}})]})]}),(0,t.jsxs)("div",{className:"p-6",children:[ec&&(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)(sW.InlineFeedback,{type:ec.type,message:ec.message,compact:!0,onClose:()=>ed(null)})}),(0,t.jsxs)(tj,{defaultValue:"resumo",children:[(0,t.jsx)(tN,{className:"w-full border-b border-zinc-200 bg-transparent p-0",children:[{value:"resumo",label:"Resumo"},{value:"empresa",label:"Empresa"},{value:"contatos",label:"Contatos"},{value:"metricas",label:"Metricas"},{value:"tags",label:"Tags"},{value:"historico",label:"Historico"}].map(e=>(0,t.jsx)(tw,{value:e.value,className:"rounded-none border-b-2 border-transparent px-4 py-2.5 font-body text-sm data-[state=active]:border-brand data-[state=active]:text-brand",children:e.label},e.value))}),(0,t.jsxs)(tS,{value:"resumo",className:"mt-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(s9,{icon:(0,t.jsx)(m.DollarSign,{className:"h-4 w-4"}),label:"Receita Mensal",children:(0,t.jsxs)("span",{className:"font-body text-sm font-medium text-black",children:[s0(N.monthlyRevenue),"/mes"]})}),(0,t.jsx)(s9,{icon:(0,t.jsx)(u.User,{className:"h-4 w-4"}),label:"Responsavel",children:(0,t.jsx)("span",{className:"font-body text-sm font-medium text-black",children:I})}),(0,t.jsx)(s9,{icon:(0,t.jsx)(o.Calendar,{className:"h-4 w-4"}),label:"Inicio do Contrato",children:(0,t.jsx)("span",{className:"font-body text-sm font-medium text-black",children:new Date(N.contractStart).toLocaleDateString("pt-BR")})}),(0,t.jsx)(s9,{icon:(0,t.jsx)(p.Clock,{className:"h-4 w-4"}),label:"Ultima Interacao",children:(0,t.jsx)("span",{className:"font-body text-sm font-medium text-black",children:N.lastInteraction?new Date(N.lastInteraction).toLocaleDateString("pt-BR"):"--"})})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[(0,t.jsx)(d,{className:"h-4 w-4 text-zinc-400"}),L.map(e=>(0,t.jsx)(eG.Badge,{variant:"outline",className:"rounded-[10px] font-body text-xs",children:e},e))]}),(0,t.jsx)(en.Separator,{className:"my-6"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"mb-3 font-heading text-base font-semibold text-black",children:"Anotacoes"}),(0,t.jsx)(tz.Textarea,{value:E,onChange:e=>V(e.target.value),className:"min-h-[100px] rounded-[15px] font-body text-sm",placeholder:"Adicione anotacoes sobre este cliente..."})]})]}),(0,t.jsx)(tS,{value:"empresa",className:"mt-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(s1,{icon:(0,t.jsx)(j.Building2,{className:"h-4 w-4"}),label:"CNPJ",value:G,onSave:X}),(0,t.jsx)(s1,{icon:(0,t.jsx)(T.FileText,{className:"h-4 w-4"}),label:"Razao Social",value:Y,onSave:Q}),(0,t.jsx)(s1,{icon:(0,t.jsx)(D.MapPin,{className:"h-4 w-4"}),label:"Endereco",value:Z,onSave:K}),(0,t.jsx)(s1,{icon:(0,t.jsx)(n.Phone,{className:"h-4 w-4"}),label:"Telefone",value:J,onSave:ee}),(0,t.jsx)(s1,{icon:(0,t.jsx)(l.Mail,{className:"h-4 w-4"}),label:"E-mail",value:et,onSave:ea})]})}),(0,t.jsxs)(tS,{value:"contatos",className:"mt-6",children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsxs)("h3",{className:"font-heading text-base font-semibold text-black",children:["Contatos (",H.length,")"]}),(0,t.jsxs)(es.Button,{onClick:()=>er(!0),className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",size:"sm",children:[(0,t.jsx)(y.Plus,{className:"mr-1.5 h-4 w-4"}),"Adicionar"]})]}),ei&&(0,t.jsxs)("div",{className:"mb-4 space-y-3 rounded-[15px] border border-zinc-200 p-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Nome"}),(0,t.jsx)(eJ.Input,{value:el.nome,onChange:e=>eo({...el,nome:e.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm",placeholder:"Nome do contato"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Cargo"}),(0,t.jsxs)(tC.Select,{value:el.cargo,onValueChange:e=>eo({...el,cargo:e}),children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 w-full rounded-[15px] border-zinc-200 font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione o cargo"})}),(0,t.jsx)(tC.SelectContent,{children:tA.RESTAURANT_POSITIONS.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"E-mail"}),(0,t.jsx)(eJ.Input,{type:"email",value:el.email,onChange:e=>eo({...el,email:e.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm",placeholder:"email@empresa.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Telefone"}),(0,t.jsx)(e2.PhoneInput,{value:el.telefone,onValueChange:e=>eo({...el,telefone:e}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Personalidade"}),(0,t.jsx)(tz.Textarea,{value:el.personalidade,onChange:e=>eo({...el,personalidade:e.target.value}),className:"mt-1 min-h-[60px] rounded-[15px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(es.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-sm",onClick:()=>er(!1),children:"Cancelar"}),(0,t.jsx)(es.Button,{size:"sm",className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",onClick:function(){el.nome.trim()&&(q([..._,{id:`c${Date.now()}`,clientId:"client-mock",...el,isDecisionMaker:!1}]),eo({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),er(!1))},children:"Salvar"})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:H.map(e=>em===e.id?(0,t.jsxs)("div",{className:"space-y-3 rounded-[15px] border border-brand/30 bg-brand-light/10 p-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Nome"}),(0,t.jsx)(eJ.Input,{value:ex.nome,onChange:e=>eh({...ex,nome:e.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Cargo"}),(0,t.jsxs)(tC.Select,{value:ex.cargo,onValueChange:e=>eh({...ex,cargo:e}),children:[(0,t.jsx)(tC.SelectTrigger,{className:"mt-1 h-9 w-full rounded-[15px] border-zinc-200 font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione o cargo"})}),(0,t.jsx)(tC.SelectContent,{children:tA.RESTAURANT_POSITIONS.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.value,children:e.label},e.value))})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"E-mail"}),(0,t.jsx)(eJ.Input,{type:"email",value:ex.email,onChange:e=>eh({...ex,email:e.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Telefone"}),(0,t.jsx)(e2.PhoneInput,{value:ex.telefone,onValueChange:e=>eh({...ex,telefone:e}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(e0.Label,{className:"font-body text-xs text-zinc-500",children:"Personalidade"}),(0,t.jsx)(tz.Textarea,{value:ex.personalidade,onChange:e=>eh({...ex,personalidade:e.target.value}),className:"mt-1 min-h-[60px] rounded-[15px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(es.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-sm",onClick:()=>{eu(null),eh({nome:"",email:"",telefone:"",cargo:"",personalidade:""})},children:"Cancelar"}),(0,t.jsx)(es.Button,{size:"sm",className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",onClick:eg,children:"Salvar"})]})]},e.id):(0,t.jsx)(s3,{contact:e,onEdit:()=>{eu(e.id),eh({nome:e.nome,email:e.email,telefone:e.telefone,cargo:e.cargo,personalidade:e.personalidade??""})},onDelete:()=>{var t;return t=e.id,void q(_.filter(e=>e.id!==t))},onToggleDecisionMaker:()=>{var t;return t=e.id,void q(_.map(e=>e.id===t?{...e,isDecisionMaker:!e.isDecisionMaker}:e))}},e.id))})]}),(0,t.jsx)(tS,{value:"metricas",className:"mt-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)(s4,{data:sK}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(s6,{icon:(0,t.jsx)(O.Activity,{className:"h-5 w-5"}),label:"Score de Uso",value:82,suffix:"/100",color:"text-status-success"}),(0,t.jsx)(s6,{icon:(0,t.jsx)(sH,{className:"h-5 w-5"}),label:"Dias Desde Ultimo Login",value:2,suffix:"dias",color:"text-status-success"}),(0,t.jsx)(s6,{icon:(0,t.jsx)(sU,{className:"h-5 w-5"}),label:"NPS Score",value:9,suffix:"/10",color:"text-status-success"}),(0,t.jsx)(s6,{icon:(0,t.jsx)(A.TrendingUp,{className:"h-5 w-5"}),label:"Crescimento MRR",value:"+39%",color:"text-status-success"})]})]})}),(0,t.jsx)(tS,{value:"tags",className:"mt-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eJ.Input,{value:F,onChange:e=>$(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),ep())},placeholder:"Digite uma nova tag...",className:"h-9 flex-1 rounded-[15px] font-body text-sm"}),(0,t.jsxs)(es.Button,{onClick:ep,className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",size:"sm",children:[(0,t.jsx)(y.Plus,{className:"mr-1 h-4 w-4"}),"Adicionar"]})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:L.map(e=>(0,t.jsxs)(eG.Badge,{variant:"outline",className:"gap-1.5 rounded-[10px] py-1.5 pr-1.5 font-body text-sm",children:[e,(0,t.jsx)("button",{onClick:()=>{B(L.filter(t=>t!==e))},className:"rounded-full p-0.5 transition-colors hover:bg-zinc-200",children:(0,t.jsx)(s.X,{className:"h-3 w-3 text-zinc-400"})})]},e))}),0===L.length&&(0,t.jsx)("p",{className:"py-8 text-center font-body text-sm text-zinc-400",children:"Nenhuma tag adicionada"})]})}),(0,t.jsx)(tS,{value:"historico",className:"mt-6",children:(0,t.jsx)("div",{className:"relative space-y-0",children:(e=function(e){let t=sn.getState().getByClient(e),a=[];for(let e of t)a.push({id:e.id,type:"realizada"===e.status?"activity":"created",message:`Visita ${e.type}: ${e.objective??e.location}`,user:e.responsible,date:new Date(e.startAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})});return a.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())}(N.id)).map((a,s)=>(0,t.jsxs)("div",{className:"relative flex gap-4 pb-6",children:[s<e.length-1&&(0,t.jsx)("div",{className:"absolute left-[15px] top-8 h-full w-px bg-zinc-200"}),(0,t.jsx)("div",{className:"relative z-10 flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:function(e){switch(e){case"created":return(0,t.jsx)(y.Plus,{className:"h-3.5 w-3.5"});case"activity":return(0,t.jsx)(o.Calendar,{className:"h-3.5 w-3.5"});case"stage-change":return(0,t.jsx)(R.ArrowRight,{className:"h-3.5 w-3.5"});case"note":return(0,t.jsx)(T.FileText,{className:"h-3.5 w-3.5"});case"tag-added":return(0,t.jsx)(d,{className:"h-3.5 w-3.5"});case"value-change":return(0,t.jsx)(m.DollarSign,{className:"h-3.5 w-3.5"});case"health-change":return(0,t.jsx)(sq.Heart,{className:"h-3.5 w-3.5"});default:return(0,t.jsx)(p.Clock,{className:"h-3.5 w-3.5"})}}(a.type)}),(0,t.jsxs)("div",{className:"flex-1 pt-0.5",children:[(0,t.jsx)("p",{className:"font-body text-sm text-black",children:a.message}),(0,t.jsxs)("p",{className:"font-body text-xs text-zinc-400",children:[a.user," -- ",a.date]})]})]},a.id))})})]})]})]})}),(0,t.jsx)(s7,{open:U,onClose:()=>W(!1),onConfirm:(e,t)=>{z("churn"),ed({type:"success",message:`Churn registrado! Motivo: ${e}.${t?` Observacoes: ${t}.`:""} O cliente foi marcado como churn.`})}})]})}function s9({icon:e,label:a,children:s}){return(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:e}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-body text-xs text-zinc-500",children:a}),s]})]})}var ne=e.i(17923);let nt=(0,c.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),na=(0,c.default)("bookmark",[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]]);var ns=e.i(27735),nn=e.i(57428);function ni(e){return`flow-saved-filters-${e}`}function nr(e,t){try{localStorage.setItem(ni(e),JSON.stringify(t))}catch{}}function nl(e,t){try{localStorage.setItem(`flow-active-filters-count-${e}`,String(t))}catch{}}let no=[{id:"user-3",name:"Lucas Oliveira"},{id:"user-4",name:"Juliana Costa"},{id:"user-5",name:"Fernanda Lima"},{id:"user-6",name:"Marcos Pereira"},{id:"user-7",name:"Carolina Santos"}],nc=[{id:"lead-in",label:"Lead-In"},{id:"contato-feito",label:"Contato Feito"},{id:"reuniao-agendada",label:"Reuniao Agendada"},{id:"proposta-enviada",label:"Proposta Enviada"},{id:"negociacao",label:"Negociacao"},{id:"fechamento",label:"Fechamento"}],nd=[{id:"onboarding",label:"Onboarding"},{id:"implantacao",label:"Implantacao"},{id:"acompanhamento",label:"Acompanhamento"},{id:"retencao",label:"Retencao"},{id:"churn",label:"Churn"}],nm=[{id:"hot",label:"Quente",icon:(0,t.jsx)(g.Flame,{className:"h-3.5 w-3.5 text-status-danger"})},{id:"warm",label:"Morna",icon:(0,t.jsx)(b.Thermometer,{className:"h-3.5 w-3.5 text-status-warning"})},{id:"cold",label:"Fria",icon:(0,t.jsx)(f.Snowflake,{className:"h-3.5 w-3.5 text-status-info"})}],nu=["food-service","restaurante","premium","varejo","saude","tecnologia","educacao","industria"],nx=[{id:"call",label:"Ligacao"},{id:"email",label:"E-mail"},{id:"meeting",label:"Reuniao"},{id:"task",label:"Tarefa"},{id:"follow-up",label:"Follow-up"},{id:"whatsapp",label:"WhatsApp"}],nh=[{id:"pending",label:"Pendente"},{id:"completed",label:"Concluida"},{id:"overdue",label:"Atrasada"},{id:"cancelled",label:"Cancelada"}],np=[{id:"good",label:"Saudavel",icon:(0,t.jsx)(sq.Heart,{className:"h-3.5 w-3.5 text-status-success"})},{id:"warning",label:"Atencao",icon:(0,t.jsx)(sq.Heart,{className:"h-3.5 w-3.5 text-status-warning"})},{id:"critical",label:"Critico",icon:(0,t.jsx)(sq.Heart,{className:"h-3.5 w-3.5 text-status-danger"})}],ng=[{id:"projected",label:"Projetado"},{id:"confirmed",label:"Confirmado"},{id:"paid",label:"Pago"},{id:"contested",label:"Contestado"}],nb=[{id:"this-month",label:"Este mes"},{id:"last-month",label:"Mes passado"},{id:"this-quarter",label:"Este trimestre"},{id:"last-quarter",label:"Trimestre passado"},{id:"this-year",label:"Este ano"}];function nf({label:e,options:a,selected:s,onChange:n,icon:i}){return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[i&&(0,t.jsx)("span",{className:"text-zinc-400",children:i}),(0,t.jsx)(e0.Label,{className:"font-heading text-sm font-semibold text-black",children:e}),s.length>0&&(0,t.jsx)(eG.Badge,{className:"rounded-[10px] bg-brand px-1.5 py-0 font-body text-[10px] text-white",children:s.length})]}),(0,t.jsx)("div",{className:"space-y-2",children:a.map(e=>(0,t.jsxs)("label",{className:"flex cursor-pointer items-center gap-2.5 rounded-lg px-2 py-1.5 transition-colors hover:bg-zinc-50",children:[(0,t.jsx)(nn.Checkbox,{checked:s.includes(e.id),onCheckedChange:()=>{var t;return t=e.id,void(s.includes(t)?n(s.filter(e=>e!==t)):n([...s,t]))},className:"rounded-checkbox"}),e.icon&&(0,t.jsx)("span",{children:e.icon}),(0,t.jsx)("span",{className:"font-body text-sm text-zinc-700",children:e.label})]},e.id))})]})}function nv({label:e,icon:a,minValue:s,maxValue:n,onMinChange:i,onMaxChange:r,placeholder:l,type:o="text"}){return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[a&&(0,t.jsx)("span",{className:"text-zinc-400",children:a}),(0,t.jsx)(e0.Label,{className:"font-heading text-sm font-semibold text-black",children:e})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eJ.Input,{type:o,value:s,onChange:e=>i(e.target.value),placeholder:l?.min||"Min",className:"h-9 rounded-[15px] font-body text-sm"}),(0,t.jsx)("span",{className:"font-body text-xs text-zinc-400",children:"ate"}),(0,t.jsx)(eJ.Input,{type:o,value:n,onChange:e=>r(e.target.value),placeholder:l?.max||"Max",className:"h-9 rounded-[15px] font-body text-sm"})]})]})}function nj({filters:e,setFilters:a}){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(nf,{label:"Responsavel",icon:(0,t.jsx)(u.User,{className:"h-4 w-4"}),options:no.map(e=>({id:e.id,label:e.name})),selected:e.responsible,onChange:e=>a(t=>({...t,responsible:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Estagio",icon:(0,t.jsx)(ne.BarChart3,{className:"h-4 w-4"}),options:nc,selected:e.stage,onChange:e=>a(t=>({...t,stage:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Temperatura",icon:(0,t.jsx)(g.Flame,{className:"h-4 w-4"}),options:nm,selected:e.temperature,onChange:e=>a(t=>({...t,temperature:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Tags",icon:(0,t.jsx)(d,{className:"h-4 w-4"}),options:nu.map(e=>({id:e,label:e})),selected:e.tags,onChange:e=>a(t=>({...t,tags:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-zinc-400",children:(0,t.jsx)(P.AlertTriangle,{className:"h-4 w-4"})}),(0,t.jsx)(e0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Alertas"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"flex cursor-pointer items-center gap-2.5 rounded-lg px-2 py-1.5 transition-colors hover:bg-zinc-50",children:[(0,t.jsx)(nn.Checkbox,{checked:e.overdue,onCheckedChange:e=>a(t=>({...t,overdue:!!e})),className:"rounded-checkbox"}),(0,t.jsx)(g.Flame,{className:"h-3.5 w-3.5 text-status-danger"}),(0,t.jsx)("span",{className:"font-body text-sm text-zinc-700",children:"Somente Estourados"})]}),(0,t.jsxs)("label",{className:"flex cursor-pointer items-center gap-2.5 rounded-lg px-2 py-1.5 transition-colors hover:bg-zinc-50",children:[(0,t.jsx)(nn.Checkbox,{checked:e.stale,onCheckedChange:e=>a(t=>({...t,stale:!!e})),className:"rounded-checkbox"}),(0,t.jsx)(ns.TimerReset,{className:"h-3.5 w-3.5 text-status-warning"}),(0,t.jsx)("span",{className:"font-body text-sm text-zinc-700",children:"Somente Sem Atividade"})]})]})]}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nv,{label:"Periodo",icon:(0,t.jsx)(o.Calendar,{className:"h-4 w-4"}),minValue:e.dateStart,maxValue:e.dateEnd,onMinChange:e=>a(t=>({...t,dateStart:e})),onMaxChange:e=>a(t=>({...t,dateEnd:e})),placeholder:{min:"Data inicio",max:"Data fim"},type:"date"}),(0,t.jsx)(en.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-zinc-400",children:(0,t.jsx)(m.DollarSign,{className:"h-4 w-4"})}),(0,t.jsx)(e0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Faixa de Valor"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(e2.CurrencyInput,{value:e.valueMin?Number(e.valueMin):void 0,onValueChange:e=>a(t=>({...t,valueMin:e>0?String(e):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Min"}),(0,t.jsx)("span",{className:"font-body text-xs text-zinc-400",children:"ate"}),(0,t.jsx)(e2.CurrencyInput,{value:e.valueMax?Number(e.valueMax):void 0,onValueChange:e=>a(t=>({...t,valueMax:e>0?String(e):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Max"})]})]})]})}function ny({filters:e,setFilters:a}){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(nf,{label:"Responsavel",icon:(0,t.jsx)(u.User,{className:"h-4 w-4"}),options:no.map(e=>({id:e.id,label:e.name})),selected:e.responsible,onChange:e=>a(t=>({...t,responsible:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Estagio",icon:(0,t.jsx)(ne.BarChart3,{className:"h-4 w-4"}),options:nd,selected:e.stage,onChange:e=>a(t=>({...t,stage:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Health Score",icon:(0,t.jsx)(sq.Heart,{className:"h-4 w-4"}),options:np,selected:e.healthScore,onChange:e=>a(t=>({...t,healthScore:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-zinc-400",children:(0,t.jsx)(m.DollarSign,{className:"h-4 w-4"})}),(0,t.jsx)(e0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Faixa de MRR"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(e2.CurrencyInput,{value:e.mrrMin?Number(e.mrrMin):void 0,onValueChange:e=>a(t=>({...t,mrrMin:e>0?String(e):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Min"}),(0,t.jsx)("span",{className:"font-body text-xs text-zinc-400",children:"ate"}),(0,t.jsx)(e2.CurrencyInput,{value:e.mrrMax?Number(e.mrrMax):void 0,onValueChange:e=>a(t=>({...t,mrrMax:e>0?String(e):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Max"})]})]}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nv,{label:"Ultima Interacao",icon:(0,t.jsx)(o.Calendar,{className:"h-4 w-4"}),minValue:e.lastInteractionStart,maxValue:e.lastInteractionEnd,onMinChange:e=>a(t=>({...t,lastInteractionStart:e})),onMaxChange:e=>a(t=>({...t,lastInteractionEnd:e})),placeholder:{min:"Data inicio",max:"Data fim"},type:"date"})]})}function nN({filters:e,setFilters:a}){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(nf,{label:"Tipo",icon:(0,t.jsx)(O.Activity,{className:"h-4 w-4"}),options:nx,selected:e.type,onChange:e=>a(t=>({...t,type:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Responsavel",icon:(0,t.jsx)(u.User,{className:"h-4 w-4"}),options:no.map(e=>({id:e.id,label:e.name})),selected:e.responsible,onChange:e=>a(t=>({...t,responsible:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Status",icon:(0,t.jsx)(tZ.CheckSquare,{className:"h-4 w-4"}),options:nh,selected:e.status,onChange:e=>a(t=>({...t,status:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nv,{label:"Periodo",icon:(0,t.jsx)(o.Calendar,{className:"h-4 w-4"}),minValue:e.dateStart,maxValue:e.dateEnd,onMinChange:e=>a(t=>({...t,dateStart:e})),onMaxChange:e=>a(t=>({...t,dateEnd:e})),placeholder:{min:"Data inicio",max:"Data fim"},type:"date"})]})}function nw({filters:e,setFilters:a}){return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)(nf,{label:"Vendedor",icon:(0,t.jsx)(u.User,{className:"h-4 w-4"}),options:no.map(e=>({id:e.id,label:e.name})),selected:e.seller,onChange:e=>a(t=>({...t,seller:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Status",icon:(0,t.jsx)(tZ.CheckSquare,{className:"h-4 w-4"}),options:ng,selected:e.status,onChange:e=>a(t=>({...t,status:e}))}),(0,t.jsx)(en.Separator,{}),(0,t.jsx)(nf,{label:"Periodo",icon:(0,t.jsx)(o.Calendar,{className:"h-4 w-4"}),options:nb,selected:e.period,onChange:e=>a(t=>({...t,period:e}))})]})}let nS={responsible:[],stage:[],temperature:[],tags:[],dateStart:"",dateEnd:"",valueMin:"",valueMax:"",overdue:!1,stale:!1},nC={responsible:[],stage:[],healthScore:[],mrrMin:"",mrrMax:"",lastInteractionStart:"",lastInteractionEnd:""},nz={type:[],responsible:[],status:[],dateStart:"",dateEnd:""},nk={seller:[],status:[],period:[]},nM={pipes:"Pipeline",clients:"Clientes",activities:"Atividades",finance:"Financeiro"};function nI({savedFilters:e,onApply:n,onRemove:i,onSave:r,canSave:l}){let[o,c]=(0,a.useState)(""),[d,m]=(0,a.useState)(!1);function u(){let e=o.trim();e&&(r(e),c(""),m(!1))}return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-zinc-400",children:(0,t.jsx)(na,{className:"h-4 w-4"})}),(0,t.jsx)(e0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Filtros Salvos"}),e.length>0&&(0,t.jsx)(eG.Badge,{className:"rounded-[10px] bg-zinc-100 px-1.5 py-0 font-body text-[10px] text-zinc-600",children:e.length})]}),e.length>0&&(0,t.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:e.map(e=>(0,t.jsxs)("div",{className:"group flex items-center gap-1.5 rounded-[10px] border border-zinc-200 bg-zinc-50 px-3 py-1.5 transition-colors hover:border-brand hover:bg-brand-light",children:[(0,t.jsx)("button",{type:"button",className:"font-body text-sm text-zinc-700 group-hover:text-brand",onClick:()=>n(e),children:e.name}),(0,t.jsx)("button",{type:"button",className:"ml-0.5 text-zinc-400 transition-colors hover:text-status-danger",onClick:t=>{t.stopPropagation(),i(e.id)},children:(0,t.jsx)(s.X,{className:"h-3 w-3"})})]},e.id))}),0===e.length&&!d&&(0,t.jsx)("p",{className:"mb-3 font-body text-xs text-zinc-400",children:"Nenhum filtro salvo ainda."}),d?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eJ.Input,{value:o,onChange:e=>c(e.target.value),placeholder:"Nome do filtro",className:"h-8 flex-1 rounded-[15px] font-body text-sm",onKeyDown:e=>{"Enter"===e.key&&u(),"Escape"===e.key&&(m(!1),c(""))},autoFocus:!0}),(0,t.jsxs)(es.Button,{variant:"outline",size:"sm",className:"h-8 rounded-full font-heading text-xs",onClick:u,disabled:!o.trim(),children:[(0,t.jsx)(nt,{className:"mr-1 h-3 w-3"}),"Salvar"]}),(0,t.jsx)(es.Button,{variant:"ghost",size:"sm",className:"h-8 rounded-full font-heading text-xs text-zinc-400",onClick:()=>{m(!1),c("")},children:(0,t.jsx)(s.X,{className:"h-3 w-3"})})]}):(0,t.jsxs)(es.Button,{variant:"outline",size:"sm",className:"h-8 rounded-full border-dashed border-zinc-300 font-heading text-xs text-zinc-500 hover:border-brand hover:text-brand",onClick:()=>m(!0),disabled:!l,title:l?void 0:"Maximo de 10 filtros salvos",children:[(0,t.jsx)(nt,{className:"mr-1.5 h-3 w-3"}),"Salvar filtro atual"]})]})}function nD({context:e,onApplyFilters:n}){let{drawerType:i,closeDrawer:r}=(0,tD.useUIStore)(),[l,o]=(0,a.useState)(nS),[c,d]=(0,a.useState)(nC),[m,u]=(0,a.useState)(nz),[x,h]=(0,a.useState)(nk),[p,g]=(0,a.useState)([]);(0,a.useEffect)(()=>{g(function(e){try{let t=localStorage.getItem(ni(e));if(!t)return[];return JSON.parse(t)}catch{return[]}}(e))},[e]);let b=(0,a.useCallback)(()=>{switch(e){case"pipes":return l;case"clients":return c;case"activities":return m;case"finance":return x}},[e,l,c,m,x]),f=(0,a.useMemo)(()=>{switch(e){case"pipes":return l.responsible.length+l.stage.length+l.temperature.length+l.tags.length+ +!!l.dateStart+ +!!l.dateEnd+ +!!l.valueMin+ +!!l.valueMax+ +!!l.overdue+ +!!l.stale;case"clients":return c.responsible.length+c.stage.length+c.healthScore.length+ +!!c.mrrMin+ +!!c.mrrMax+ +!!c.lastInteractionStart+ +!!c.lastInteractionEnd;case"activities":return m.type.length+m.responsible.length+m.status.length+ +!!m.dateStart+ +!!m.dateEnd;case"finance":return x.seller.length+x.status.length+x.period.length;default:return 0}},[e,l,c,m,x]),v=(0,a.useCallback)(()=>{switch(e){case"pipes":o(nS);break;case"clients":d(nC);break;case"activities":u(nz);break;case"finance":h(nk)}},[e]);return(0,a.useEffect)(()=>{let t=t=>{t.detail?.context===e&&(v(),nl(e,0))},a=t=>{t.detail?.context===e&&t.detail.filters&&("pipes"===e?o(t.detail.filters):"clients"===e?d(t.detail.filters):"activities"===e?u(t.detail.filters):"finance"===e&&h(t.detail.filters))};return window.addEventListener("flow:filters-clear",t),window.addEventListener("flow:filters-update",a),()=>{window.removeEventListener("flow:filters-clear",t),window.removeEventListener("flow:filters-update",a)}},[e,v]),(0,t.jsx)(aJ.Sheet,{open:"filters"===i,onOpenChange:()=>r(),children:(0,t.jsxs)(aJ.SheetContent,{side:"right",className:"flex w-[400px] max-w-full flex-col overflow-hidden border-l border-zinc-200 p-0 sm:max-w-[400px]",showCloseButton:!1,children:[(0,t.jsxs)(aJ.SheetHeader,{className:"flex flex-row items-center justify-between border-b border-zinc-200 px-6 py-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-brand-light",children:(0,t.jsx)(B.Filter,{className:"h-4 w-4 text-brand"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(aJ.SheetTitle,{className:"font-heading text-lg font-semibold text-black",children:"Filtros"}),(0,t.jsx)("p",{className:"font-body text-xs text-zinc-500",children:nM[e]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[f>0&&(0,t.jsxs)(eG.Badge,{className:"rounded-[10px] bg-brand px-2 py-0.5 font-body text-xs text-white",children:[f," ativo",1!==f?"s":""]}),(0,t.jsx)(es.Button,{variant:"ghost",size:"icon",className:"text-zinc-400",onClick:()=>r(),children:(0,t.jsx)(s.X,{className:"h-5 w-5"})})]})]}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-5",children:[(0,t.jsx)(nI,{savedFilters:p,onApply:function(t){switch(e){case"pipes":o(t.filters);break;case"clients":d(t.filters);break;case"activities":u(t.filters);break;case"finance":h(t.filters)}},onRemove:function(t){let a=p.filter(e=>e.id!==t);g(a),nr(e,a)},onSave:function(t){let a=[...p,{id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:t,filters:b()}].slice(-10);g(a),nr(e,a)},canSave:p.length<10}),(0,t.jsx)(en.Separator,{className:"my-5"}),"pipes"===e&&(0,t.jsx)(nj,{filters:l,setFilters:o}),"clients"===e&&(0,t.jsx)(ny,{filters:c,setFilters:d}),"activities"===e&&(0,t.jsx)(nN,{filters:m,setFilters:u}),"finance"===e&&(0,t.jsx)(nw,{filters:x,setFilters:h})]}),(0,t.jsx)(aJ.SheetFooter,{className:"border-t border-zinc-200 px-6 py-4",children:(0,t.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,t.jsx)(es.Button,{variant:"ghost",onClick:v,className:"font-heading text-sm text-zinc-500 hover:text-zinc-700",children:"Limpar"}),(0,t.jsxs)(es.Button,{onClick:function(){let t=b();n&&n(t),nl(e,f),window.dispatchEvent(new CustomEvent("flow:filters-applied",{detail:{context:e,count:f,filters:t}})),r()},className:"rounded-full bg-brand px-6 font-heading text-sm text-white hover:bg-brand/90",children:["Aplicar Filtros",f>0&&(0,t.jsx)(eG.Badge,{className:"ml-2 rounded-full bg-white/20 px-1.5 py-0 font-body text-[10px] text-white",children:f})]})]})})]})})}var nA=e.i(14837);let nT=(0,tF.create)()((0,t$.devtools)((e,t)=>({notifications:nA.mockNotifications,addNotification:t=>e(e=>({notifications:[{...t,id:`notif-${Date.now()}`,createdAt:new Date().toISOString(),isRead:!1},...e.notifications]})),markAsRead:t=>e(e=>({notifications:e.notifications.map(e=>e.id===t?{...e,isRead:!0}:e)})),markAllAsRead:()=>e(e=>({notifications:e.notifications.map(e=>({...e,isRead:!0}))})),deleteNotification:t=>e(e=>({notifications:e.notifications.filter(e=>e.id!==t)})),getUnread:()=>t().notifications.filter(e=>!e.isRead),getUnreadCount:()=>t().notifications.filter(e=>!e.isRead).length}),{name:"notification-store"}));var nR=e.i(1106);let nP=["lead-in","contato-feito","reuniao-agendada","proposta-enviada","negociacao","fechamento"];function nE(){let{drawerType:e,drawerData:s,closeDrawer:n}=(0,tD.useUIStore)(),{addOpportunity:i}=(0,aV.useOpportunityStore)(),{addNotification:r}=nT(),[l,o]=(0,a.useState)(!1),[c,d]=(0,a.useState)(null),m="new-opportunity"===e,u=nP.includes(s?.initialStage)?s?.initialStage:"lead-in",x="string"==typeof s?.source?s.source:"",h=sl.mockUsers.filter(e=>e.isActive&&"leitura"!==e.role),p=h.reduce((e,t)=>(e[t.id]=t.name,e),{}),{register:g,handleSubmit:b,setValue:f,watch:v,reset:j,formState:{errors:y}}=(0,aL.useForm)({resolver:(0,aO.zodResolver)(nR.newOpportunitySchema),defaultValues:{temperature:"warm",tags:[],source:x}}),N=v("source");async function w(e){o(!0);try{i({title:e.title,clientName:e.clientName,value:e.value,monthlyValue:e.monthlyValue||0,stage:u,temperature:e.temperature||"warm",responsibleId:e.responsibleId,responsibleName:p[e.responsibleId]||"Não atribuído",tags:e.tags||[],source:e.source,notes:e.notes}),r({type:"system",title:"Nova oportunidade criada",message:`"${e.title}" (${(0,tA.formatCurrencyBRL)(e.value)}) foi adicionada ao pipeline.`,link:"/pipes"}),d({type:"success",message:"Oportunidade criada com sucesso!"}),setTimeout(()=>{d(null),j({temperature:"warm",tags:[],source:x}),n()},1500)}catch{d({type:"error",message:"Erro ao criar oportunidade. Tente novamente."})}finally{o(!1)}}return(0,a.useEffect)(()=>{m&&j({temperature:"warm",tags:[],source:x})},[x,m,j]),(0,t.jsx)(tM.Dialog,{open:m,onOpenChange:()=>{d(null),j({temperature:"warm",tags:[],source:x}),n()},children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-[480px] rounded-[20px] p-8",children:[(0,t.jsx)(tM.DialogHeader,{children:(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Nova Oportunidade"})}),(0,t.jsxs)("form",{onSubmit:b(w),className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Título"}),(0,t.jsx)(eJ.Input,{placeholder:"Nome da oportunidade",className:"h-10 rounded-[15px] font-body text-sm",...g("title")}),y.title&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:y.title.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Cliente"}),(0,t.jsx)(eJ.Input,{placeholder:"Nome do cliente",className:"h-10 rounded-[15px] font-body text-sm",...g("clientName")}),y.clientName&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:y.clientName.message})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor Total (R$)"}),(0,t.jsx)(e2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:e=>f("value",e)}),y.value&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:y.value.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor Mensal (R$)"}),(0,t.jsx)(e2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:e=>f("monthlyValue",e)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Temperatura"}),(0,t.jsxs)(tC.Select,{defaultValue:"warm",onValueChange:e=>f("temperature",e),children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{})}),(0,t.jsxs)(tC.SelectContent,{className:"rounded-[15px]",children:[(0,t.jsx)(tC.SelectItem,{value:"hot",children:"Quente"}),(0,t.jsx)(tC.SelectItem,{value:"warm",children:"Morna"}),(0,t.jsx)(tC.SelectItem,{value:"cold",children:"Fria"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Origem"}),(0,t.jsxs)(tC.Select,{value:N||void 0,onValueChange:e=>f("source",e),children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:x||"Selecione"})}),(0,t.jsxs)(tC.SelectContent,{className:"rounded-[15px]",children:[(0,t.jsx)(tC.SelectItem,{value:"indicacao",children:"Indicação"}),(0,t.jsx)(tC.SelectItem,{value:"site",children:"Site"}),(0,t.jsx)(tC.SelectItem,{value:"rede-social",children:"Rede Social"}),(0,t.jsx)(tC.SelectItem,{value:"cold-call",children:"Cold Call"}),(0,t.jsx)(tC.SelectItem,{value:"evento",children:"Evento"}),(0,t.jsx)(tC.SelectItem,{value:"outro",children:"Outro"})]})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Responsável"}),(0,t.jsxs)(tC.Select,{onValueChange:e=>f("responsibleId",e),children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione um responsável"})}),(0,t.jsx)(tC.SelectContent,{className:"rounded-[15px]",children:h.map(e=>(0,t.jsx)(tC.SelectItem,{value:e.id,children:e.name},e.id))})]}),y.responsibleId&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:y.responsibleId.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Observações"}),(0,t.jsx)(tz.Textarea,{placeholder:"Notas sobre a oportunidade...",className:"rounded-[15px] font-body text-sm",rows:3,...g("notes")})]}),c&&(0,t.jsx)(sW.InlineFeedback,{type:c.type,message:c.message,onClose:()=>d(null)}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)(es.Button,{type:"button",variant:"secondary",onClick:()=>{j(),n()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,t.jsxs)(es.Button,{type:"submit",disabled:l,className:"rounded-full bg-black font-heading text-sm text-white hover:bg-zinc-800",children:[l?(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Criar oportunidade"]})]})]})]})})}var nV=e.i(64030);function nL(){let{modalType:e,modalData:s,closeModal:n}=(0,tD.useUIStore)(),{winOpportunity:i,getById:r}=(0,aV.useOpportunityStore)(),{addClient:l}=(0,a7.useClientStore)(),{addNotification:o}=nT(),[c,d]=(0,a.useState)(!1),[m,u]=(0,a.useState)(null),x=s?.opportunityId,{register:h,handleSubmit:p,reset:g,setValue:b,formState:{errors:f}}=(0,aL.useForm)({resolver:(0,aO.zodResolver)(nR.winOpportunitySchema)});async function v(e){d(!0);try{(0,tA.calculateProjectedCommission)(e.contractValue);let t=x?r(x):null;x&&i(x),t&&l({companyName:t.clientName,cnpj:"",contactName:t.clientName,contactEmail:"",contactPhone:"",stage:"onboarding",healthScore:"good",monthlyRevenue:e.monthlyValue,contractStart:e.contractStart,contractEnd:void 0,responsibleId:t.responsibleId,responsibleName:t.responsibleName,tags:t.tags||[],lastInteraction:new Date().toISOString().split("T")[0]}),o({type:"opportunity-won",title:"Oportunidade ganha!",message:`"${t?.title||"Oportunidade"}" foi marcada como ganha! Contrato: ${(0,tA.formatCurrencyBRL)(e.contractValue)}. Cliente criado no pipeline de CS.`,link:"/clients"}),u({type:"success",message:"Oportunidade marcada como Ganha!"}),setTimeout(()=>{u(null),g(),n()},1500)}catch{u({type:"error",message:"Erro ao registrar ganho. Tente novamente."})}finally{d(!1)}}return(0,t.jsx)(tM.Dialog,{open:"win-opportunity"===e,onOpenChange:()=>{u(null),g(),n()},children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-[480px] rounded-[20px] p-8",children:[(0,t.jsx)(tM.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-status-success-light",children:(0,t.jsx)(nV.Trophy,{className:"h-5 w-5 text-status-success"})}),(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Marcar como Ganho"})]})}),(0,t.jsxs)("form",{onSubmit:p(v),className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor do Contrato (R$)"}),(0,t.jsx)(e2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:e=>b("contractValue",e)}),f.contractValue&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:f.contractValue.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor Mensal (R$)"}),(0,t.jsx)(e2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:e=>b("monthlyValue",e)}),f.monthlyValue&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:f.monthlyValue.message})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Início do Contrato"}),(0,t.jsx)(eJ.Input,{type:"date",className:"h-10 rounded-[15px] font-body text-sm",...h("contractStart")}),f.contractStart&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:f.contractStart.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Prazo (meses)"}),(0,t.jsx)(e2.IntegerInput,{className:"h-10 rounded-[15px] font-body text-sm",placeholder:"12",onValueChange:e=>b("contractMonths",e)}),f.contractMonths&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:f.contractMonths.message})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(e0.Label,{className:"font-body text-sm text-zinc-600",children:["Observações ",(0,t.jsx)("span",{className:"text-zinc-400",children:"(opcional)"})]}),(0,t.jsx)(tz.Textarea,{placeholder:"Detalhes do fechamento...",className:"rounded-[15px] font-body text-sm",rows:3,...h("notes")})]}),m&&(0,t.jsx)(sW.InlineFeedback,{type:m.type,message:m.message,onClose:()=>u(null)}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)(es.Button,{type:"button",variant:"secondary",onClick:()=>{g(),n()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,t.jsxs)(es.Button,{type:"submit",disabled:c,className:"rounded-full bg-status-success font-heading text-sm text-white hover:bg-status-success/90",children:[c?(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirmar Ganho"]})]})]})]})})}let nO={preco:"Preço",concorrente:"Concorrente",timing:"Timing","sem-budget":"Sem budget","sem-necessidade":"Sem necessidade","sem-resposta":"Sem resposta",outro:"Outro"};function nB(){let{modalType:e,modalData:s,closeModal:n}=(0,tD.useUIStore)(),{loseOpportunity:i,getById:r}=(0,aV.useOpportunityStore)(),{addNotification:l}=nT(),[o,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null),u=s?.opportunityId,{register:x,handleSubmit:h,setValue:p,reset:g,formState:{errors:b}}=(0,aL.useForm)({resolver:(0,aO.zodResolver)(nR.loseOpportunitySchema)});async function f(e){c(!0);try{if(u){let t=r(u);i(u,e.reason,e.competitor,e.notes),l({type:"opportunity-lost",title:"Oportunidade perdida",message:`A oportunidade "${t?.title||"Sem título"}" foi marcada como perdida. Motivo: ${nO[e.reason]||e.reason}.`,link:"/pipes"})}m({type:"success",message:"Oportunidade marcada como Perdida."}),setTimeout(()=>{m(null),g(),n()},1500)}catch{m({type:"error",message:"Erro ao registrar perda. Tente novamente."})}finally{c(!1)}}return(0,t.jsx)(tM.Dialog,{open:"lose-opportunity"===e,onOpenChange:()=>{m(null),g(),n()},children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-[440px] rounded-[20px] p-8",children:[(0,t.jsx)(tM.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-status-danger-light",children:(0,t.jsx)(an.XCircle,{className:"h-5 w-5 text-status-danger"})}),(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Marcar como Perdido"})]})}),(0,t.jsxs)("form",{onSubmit:h(f),className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Motivo da perda"}),(0,t.jsxs)(tC.Select,{onValueChange:e=>p("reason",e),children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione o motivo"})}),(0,t.jsxs)(tC.SelectContent,{className:"rounded-[15px]",children:[(0,t.jsx)(tC.SelectItem,{value:"preco",children:"Preço"}),(0,t.jsx)(tC.SelectItem,{value:"concorrente",children:"Concorrente"}),(0,t.jsx)(tC.SelectItem,{value:"timing",children:"Timing"}),(0,t.jsx)(tC.SelectItem,{value:"sem-budget",children:"Sem budget"}),(0,t.jsx)(tC.SelectItem,{value:"sem-necessidade",children:"Sem necessidade"}),(0,t.jsx)(tC.SelectItem,{value:"sem-resposta",children:"Sem resposta"}),(0,t.jsx)(tC.SelectItem,{value:"outro",children:"Outro"})]})]}),b.reason&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:b.reason.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(e0.Label,{className:"font-body text-sm text-zinc-600",children:["Concorrente ",(0,t.jsx)("span",{className:"text-zinc-400",children:"(opcional)"})]}),(0,t.jsx)(eJ.Input,{placeholder:"Nome do concorrente",className:"h-10 rounded-[15px] font-body text-sm",...x("competitor")})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)(e0.Label,{className:"font-body text-sm text-zinc-600",children:["Observações ",(0,t.jsx)("span",{className:"text-zinc-400",children:"(opcional)"})]}),(0,t.jsx)(tz.Textarea,{placeholder:"Detalhes sobre a perda...",className:"rounded-[15px] font-body text-sm",rows:3,...x("notes")})]}),d&&(0,t.jsx)(sW.InlineFeedback,{type:d.type,message:d.message,onClose:()=>m(null)}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)(es.Button,{type:"button",variant:"secondary",onClick:()=>{g(),n()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,t.jsxs)(es.Button,{type:"submit",disabled:o,variant:"destructive",className:"rounded-full font-heading text-sm",children:[o?(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirmar Perda"]})]})]})]})})}let nF=(0,c.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var n$=e.i(10849);let n_={1:"Matriz",2:"Filial SP"};function nq(){let{modalType:e,closeModal:s}=(0,tD.useUIStore)(),{addUser:n}=(0,n$.useUserStore)(),[i,r]=(0,a.useState)(!1),[l,o]=(0,a.useState)(null),{register:c,handleSubmit:d,setValue:m,reset:u,formState:{errors:x}}=(0,aL.useForm)({resolver:(0,aO.zodResolver)(nR.inviteUserSchema)});async function h(e){r(!0);try{n({name:e.email.split("@")[0],email:e.email,role:e.role,isActive:!0,unitId:`unit-${e.unitId}`,unitName:n_[e.unitId]||"Matriz"}),o({type:"success",message:"Convite enviado com sucesso!"}),setTimeout(()=>{o(null),u(),s()},1500)}catch{o({type:"error",message:"Erro ao enviar convite. Tente novamente."})}finally{r(!1)}}return(0,t.jsx)(tM.Dialog,{open:"invite-user"===e,onOpenChange:()=>{o(null),u(),s()},children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-[440px] rounded-[20px] p-8",children:[(0,t.jsx)(tM.DialogHeader,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-brand-light",children:(0,t.jsx)(nF,{className:"h-5 w-5 text-brand"})}),(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Convidar Usuário"})]})}),(0,t.jsxs)("form",{onSubmit:d(h),className:"mt-4 space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"E-mail"}),(0,t.jsx)(eJ.Input,{type:"email",placeholder:"email@empresa.com",className:"h-10 rounded-[15px] font-body text-sm",...c("email")}),x.email&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:x.email.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Papel"}),(0,t.jsxs)(tC.Select,{onValueChange:e=>m("role",e),children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione o papel"})}),(0,t.jsxs)(tC.SelectContent,{className:"rounded-[15px]",children:[(0,t.jsx)(tC.SelectItem,{value:"admin",children:"Admin"}),(0,t.jsx)(tC.SelectItem,{value:"comercial",children:"Comercial"}),(0,t.jsx)(tC.SelectItem,{value:"cs",children:"CS (Customer Success)"}),(0,t.jsx)(tC.SelectItem,{value:"leitura",children:"Somente Leitura"})]})]}),x.role&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:x.role.message})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(e0.Label,{className:"font-body text-sm text-zinc-600",children:"Unidade"}),(0,t.jsxs)(tC.Select,{onValueChange:e=>m("unitId",e),children:[(0,t.jsx)(tC.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,t.jsx)(tC.SelectValue,{placeholder:"Selecione a unidade"})}),(0,t.jsxs)(tC.SelectContent,{className:"rounded-[15px]",children:[(0,t.jsx)(tC.SelectItem,{value:"1",children:"Matriz"}),(0,t.jsx)(tC.SelectItem,{value:"2",children:"Filial SP"})]})]}),x.unitId&&(0,t.jsx)("p",{className:"text-xs text-status-danger",children:x.unitId.message})]}),l&&(0,t.jsx)(sW.InlineFeedback,{type:l.type,message:l.message,onClose:()=>o(null)}),(0,t.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,t.jsx)(es.Button,{type:"button",variant:"secondary",onClick:()=>{u(),s()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,t.jsxs)(es.Button,{type:"submit",disabled:i,className:"rounded-full bg-black font-heading text-sm text-white hover:bg-zinc-800",children:[i?(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Enviar convite"]})]})]})]})})}function nH(){let{modalType:e,modalData:s,closeModal:n}=(0,tD.useUIStore)(),[i,r]=(0,a.useState)(!1),[l,o]=(0,a.useState)(null),c=s?.description||"Esta ação não pode ser desfeita. O item será removido permanentemente.";return(0,t.jsx)(tM.Dialog,{open:"confirm-delete"===e,onOpenChange:()=>{o(null),n()},children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-[400px] rounded-[20px] p-8",children:[(0,t.jsxs)(tM.DialogHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-red-50",children:(0,t.jsx)(P.AlertTriangle,{className:"h-5 w-5 text-status-danger"})}),(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Tem certeza?"})]}),(0,t.jsx)(tM.DialogDescription,{className:"mt-3 font-body text-sm text-zinc-500",children:c})]}),l&&(0,t.jsx)(sW.InlineFeedback,{type:l.type,message:l.message,onClose:()=>o(null)}),(0,t.jsxs)(tM.DialogFooter,{className:"mt-4",children:[(0,t.jsx)(es.Button,{type:"button",variant:"secondary",onClick:()=>n(),disabled:i,className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,t.jsxs)(es.Button,{type:"button",onClick:async()=>{r(!0);try{s?.onConfirm&&"function"==typeof s.onConfirm&&await Promise.resolve(s.onConfirm()),n()}catch{o({type:"error",message:"Erro ao excluir. Tente novamente."})}finally{r(!1)}},disabled:i,className:"rounded-full bg-status-danger font-heading text-sm text-white hover:bg-red-700",children:[i&&(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),i?"Excluindo...":"Excluir"]})]})]})})}function nU(){let{modalType:e,modalData:s,closeModal:n}=(0,tD.useUIStore)(),[i,r]=(0,a.useState)(!1),[l,o]=(0,a.useState)(null),c=s?.description||"O usuário perderá acesso ao sistema. Você poderá reativá-lo posteriormente.";return(0,t.jsx)(tM.Dialog,{open:"confirm-deactivate"===e,onOpenChange:()=>{o(null),n()},children:(0,t.jsxs)(tM.DialogContent,{className:"max-w-[400px] rounded-[20px] p-8",children:[(0,t.jsxs)(tM.DialogHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-amber-50",children:(0,t.jsx)(P.AlertTriangle,{className:"h-5 w-5 text-status-warning"})}),(0,t.jsx)(tM.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Desativar usuário?"})]}),(0,t.jsx)(tM.DialogDescription,{className:"mt-3 font-body text-sm text-zinc-500",children:c})]}),l&&(0,t.jsx)(sW.InlineFeedback,{type:l.type,message:l.message,onClose:()=>o(null)}),(0,t.jsxs)(tM.DialogFooter,{className:"mt-4",children:[(0,t.jsx)(es.Button,{type:"button",variant:"secondary",onClick:()=>n(),disabled:i,className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,t.jsxs)(es.Button,{type:"button",onClick:async()=>{r(!0);try{s?.onConfirm&&"function"==typeof s.onConfirm&&await Promise.resolve(s.onConfirm()),n()}catch{o({type:"error",message:"Erro ao desativar. Tente novamente."})}finally{r(!1)}},disabled:i,className:"rounded-full bg-status-warning font-heading text-sm text-white hover:bg-amber-600",children:[i&&(0,t.jsx)(V.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),i?"Desativando...":"Desativar"]})]})]})})}var nW=e.i(31288),nG=e.i(82943);function nX(){let{modalData:e,drawerData:a,drawerType:s,closeDrawer:n}=(0,tD.useUIStore)(),{addActivity:i}=(0,nW.useActivityStore)(),{user:r}=(0,nG.useAuthStore)(),l=`lead-${String(e?.id??"default")}`,o=`client-${String(a?.id??"default")}`;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s8,{},o),(0,t.jsx)(nD,{context:"pipes"}),(0,t.jsx)(s_,{},l),(0,t.jsx)(nE,{}),(0,t.jsx)(sa,{isOpen:"new-activity"===s,onClose:n,onSave:e=>{if(!r?.id)throw Error("Usuário não autenticado para criar atividade.");i({title:e.title,type:e.type,status:"pending",description:e.description||"",dueDate:e.date,dueTime:e.time,responsibleId:r.id,responsibleName:r.name,opportunityId:e.opportunityId||void 0,opportunityTitle:e.opportunityTitle||void 0,clientId:e.clientId||void 0,clientName:e.clientName||void 0,contactIds:e.contactIds?.length?e.contactIds:void 0,contactNames:e.contactNames?.length?e.contactNames:void 0})},initialType:a?.type||void 0,initialClientId:"string"==typeof a?.clientId?a.clientId:void 0,initialClientName:"string"==typeof a?.clientName?a.clientName:void 0,initialContactIds:Array.isArray(a?.contactIds)?a.contactIds:void 0,initialContactNames:Array.isArray(a?.contactNames)?a.contactNames:void 0,initialOpportunityId:"string"==typeof a?.opportunityId?a.opportunityId:void 0,initialOpportunityTitle:"string"==typeof a?.opportunityTitle?a.opportunityTitle:void 0,lockClient:a?.lockClient===!0,requireClient:a?.requireClient===!0}),(0,t.jsx)(nL,{}),(0,t.jsx)(nB,{}),(0,t.jsx)(nq,{}),(0,t.jsx)(nH,{}),(0,t.jsx)(nU,{})]})}e.s(["GlobalDrawers",()=>nX],67892)},54231,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),n=e.i(60289),i=e.i(51804),r=e.i(85396),l=e.i(61911),o=e.i(12426),c=e.i(39616),d=e.i(84614),m=e.i(20278),u=e.i(17923),x=e.i(81418),h=e.i(7486),p=e.i(49685),g=e.i(17056),b=e.i(87486),f=e.i(32171),v=e.i(82943),j=e.i(80663);let y=[{type:"opportunity",name:"Restaurante Bela Vista",razaoSocial:"Restaurante Bela Vista Ltda ME",cnpj:"12.345.678/0001-00",phone:"(11) 99999-1234",email:"contato@belavista.com",contact:"João Silva",city:"São Paulo",stage:"Contato Feito",responsible:"Maria Silva"},{type:"opportunity",name:"Pizzaria Don Corleone",razaoSocial:"Don Corleone Alimentos Ltda",cnpj:"23.456.789/0001-11",phone:"(11) 98765-4321",email:"contato@doncorleone.com",contact:"Pedro Oliveira",city:"São Paulo",stage:"Proposta Enviada",responsible:"Pedro Santos"},{type:"opportunity",name:"Bistrô La Maison",razaoSocial:"La Maison Gastronomia Ltda",cnpj:"34.567.890/0001-22",phone:"(21) 97654-3210",email:"contato@lamaison.com",contact:"Ana Costa",city:"Rio de Janeiro",stage:"Negociação",responsible:"Maria Silva"},{type:"opportunity",name:"Churrascaria Fogo de Chão",razaoSocial:"Fogo de Chão Restaurantes SA",cnpj:"45.678.901/0001-33",phone:"(11) 96543-2109",email:"contato@fogodechao.com",contact:"Carlos Santos",city:"São Paulo",stage:"Lead-In",responsible:"Julia Fernandes"},{type:"opportunity",name:"Sushi Yamamoto",razaoSocial:"Yamamoto Culinária Japonesa Ltda",cnpj:"56.789.012/0001-44",phone:"(11) 95432-1098",email:"contato@sushiyamamoto.com",contact:"Yuki Yamamoto",city:"São Paulo",stage:"Reunião Agendada",responsible:"Rafael Costa"},{type:"opportunity",name:"Café Colonial Oma",razaoSocial:"Oma Café Colonial Eireli",cnpj:"67.890.123/0001-55",phone:"(41) 94321-0987",email:"contato@cafeoma.com",contact:"Klaus Schmidt",city:"Curitiba",stage:"Qualificação",responsible:"Maria Silva"},{type:"opportunity",name:"Cantina Famiglia Mancini",razaoSocial:"Famiglia Mancini Restaurante Ltda",cnpj:"11.222.333/0001-66",phone:"(11) 93210-9876",email:"contato@famigliamancini.com",contact:"Marco Mancini",city:"São Paulo",stage:"Contato Feito",responsible:"Pedro Santos"},{type:"opportunity",name:"Doceria Amor aos Pedaços",razaoSocial:"Amor aos Pedaços Doces Ltda",cnpj:"22.333.444/0001-77",phone:"(11) 92109-8765",email:"contato@amorpedacos.com",contact:"Lucia Ferreira",city:"São Paulo",stage:"Proposta Enviada",responsible:"Julia Fernandes"},{type:"client",name:"Restaurante Panorâmico",razaoSocial:"Restaurante Panorâmico Ltda ME",cnpj:"78.901.234/0001-66",phone:"(11) 3456-7890",email:"contato@panoramico.com",contact:"Ana Costa",city:"São Paulo",healthScore:"Saudável",responsible:"Maria Silva"},{type:"client",name:"Hotel Fazenda Serra Azul",razaoSocial:"Serra Azul Hotelaria Ltda",cnpj:"89.012.345/0001-77",phone:"(35) 3456-7891",email:"contato@serraazul.com",contact:"Fernando Lima",city:"Monte Verde",healthScore:"Atenção",responsible:"Pedro Santos"},{type:"client",name:"Padaria Pão de Ouro",razaoSocial:"Pão de Ouro Panificação Ltda",cnpj:"90.123.456/0001-88",phone:"(11) 2345-6789",email:"contato@paodeouro.com",contact:"Rosa Mendes",city:"São Paulo",healthScore:"Saudável",responsible:"Julia Fernandes"},{type:"client",name:"Bar do Zé",razaoSocial:"José da Silva Bebidas ME",cnpj:"01.234.567/0001-99",phone:"(21) 1234-5678",email:"contato@bardoze.com",contact:"José da Silva",city:"Rio de Janeiro",healthScore:"Crítico",responsible:"Rafael Costa"},{type:"client",name:"Confeitaria Colombo",razaoSocial:"Confeitaria Colombo SA",cnpj:"33.444.555/0001-00",phone:"(21) 2345-9876",email:"contato@colombo.com",contact:"Helena Oliveira",city:"Rio de Janeiro",healthScore:"Saudável",responsible:"Maria Silva"},{type:"client",name:"Empório Santa Maria",razaoSocial:"Empório Santa Maria Alimentos Ltda",cnpj:"44.555.666/0001-11",phone:"(11) 3456-1234",email:"contato@emporiosantamaria.com",contact:"Roberto Almeida",city:"São Paulo",healthScore:"Atenção",responsible:"Rafael Costa"}],N=[{path:"/dashboard",label:"Dashboard",icon:n.LayoutDashboard},{path:"/activities",label:"Atividades",icon:i.CalendarCheck},{path:"/pipes",label:"Pipeline de Vendas",icon:r.Kanban},{path:"/clients",label:"Clientes",icon:l.Users}],w=[{path:"/reports",label:"Relatórios",icon:u.BarChart3},{path:"/audit",label:"Auditoria",icon:x.ShieldCheck},{path:"/settings/general",label:"Configurações",icon:c.Settings},{path:"/settings/users",label:"Gestão de Usuários",icon:d.User},{path:"/settings/profile",label:"Meu Perfil",icon:d.User}];function S(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function C(e,t){let a=S(t);return S(e.name).includes(a)||S(e.razaoSocial).includes(a)||S(e.cnpj).includes(a)||S(e.phone).includes(a)||S(e.email).includes(a)||S(e.contact).includes(a)||S(e.city).includes(a)}function z(){let{isSearchOpen:e,setSearchOpen:n,openDrawer:i,openModal:r}=(0,f.useUIStore)(),{user:l,permissions:c}=(0,v.useAuthStore)(),d=(0,s.useRouter)(),[u,x]=(0,a.useState)(""),S=function(e,t){let[s,n]=(0,a.useState)(e);return(0,a.useEffect)(()=>{let t=setTimeout(()=>n(e),300);return()=>clearTimeout(t)},[e,300]),s}(u,0),z=(0,a.useRef)(null);(0,a.useEffect)(()=>{e||(0,a.startTransition)(()=>{x("")})},[e]),(0,a.useEffect)(()=>{function e(e){(e.metaKey||e.ctrlKey)&&"k"===e.key&&(e.preventDefault(),n(!f.useUIStore.getState().isSearchOpen))}return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[n]);let k=S.trim().length>=2,M=(0,a.useMemo)(()=>{let e=l?.name?.trim();return e&&y.some(t=>t.responsible===e)?e:"Maria Silva"},[l?.name]),I=!c?.canViewAllUnits,D=(0,a.useMemo)(()=>I?y.filter(e=>e.responsible===M):y,[M,I]),A=!!l?.role&&(0,j.canAccessIntelligence)(l.role),T=(0,a.useMemo)(()=>{let e=[...N];return c?.canViewFinance&&e.push({path:"/finance",label:"Financeiro",icon:o.DollarSign}),c?.canManageGoals&&e.push({path:"/goals",label:"Metas",icon:m.Target}),A&&e.push({path:"/intelligence",label:"Menux Intelligence",icon:p.Handshake}),c?.canViewReports&&e.push(...w.filter(e=>e.path.startsWith("/reports"))),c?.canManageSettings&&e.push(...w.filter(e=>e.path.startsWith("/settings"))),c?.canViewAllUnits&&e.push(...w.filter(e=>e.path.startsWith("/audit"))),e},[A,c?.canManageSettings,c?.canManageGoals,c?.canViewFinance,c?.canViewAllUnits,c?.canViewReports]),R=(0,a.useMemo)(()=>k?D.filter(e=>"opportunity"===e.type&&C(e,S)).slice(0,5):[],[S,k,D]),P=(0,a.useMemo)(()=>k?D.filter(e=>"client"===e.type&&C(e,S)).slice(0,5):[],[S,k,D]),E=R.length>0||P.length>0,V=k&&!E,L=(0,a.useCallback)(e=>{d.push(e),n(!1)},[d,n]),O=(0,a.useCallback)(e=>{r("lead-card",{name:e.name,razaoSocial:e.razaoSocial,cnpj:e.cnpj,phone:e.phone,email:e.email,contact:e.contact,city:e.city,stage:e.stage,responsible:e.responsible}),n(!1)},[r,n]),B=(0,a.useCallback)(e=>{i("client-card",{name:e.name,razaoSocial:e.razaoSocial,cnpj:e.cnpj,phone:e.phone,email:e.email,contact:e.contact,city:e.city,healthScore:e.healthScore,responsible:e.responsible}),n(!1)},[i,n]),F=e=>`${e.type}-${e.cnpj}-${e.name}`;return(0,t.jsxs)(g.CommandDialog,{open:e,onOpenChange:e=>{n(e),e||x("")},title:"Busca Global",description:"Busque por páginas, oportunidades e clientes",showCloseButton:!1,children:[(0,t.jsx)(g.CommandInput,{ref:z,placeholder:"Buscar páginas, oportunidades, clientes...",className:"font-body",value:u,onValueChange:x}),(0,t.jsxs)(g.CommandList,{className:"max-h-[420px]",children:[V&&(0,t.jsx)("div",{className:"py-8 text-center",children:(0,t.jsxs)("p",{className:"font-body text-sm text-zinc-500",children:["Nenhum resultado para"," ",(0,t.jsxs)("span",{className:"font-medium text-zinc-700 dark:text-zinc-300",children:["“",S,"”"]})]})}),R.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.CommandGroup,{heading:(0,t.jsx)("span",{className:"font-heading text-xs font-semibold uppercase tracking-wider text-brand",children:"Oportunidades"}),children:R.map(e=>(0,t.jsxs)(g.CommandItem,{value:F(e),onSelect:()=>O(e),className:"flex items-center gap-3 rounded-[10px] px-3 py-2.5",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-[10px] bg-amber-100 dark:bg-amber-900/40",children:(0,t.jsx)(p.Handshake,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-0.5",children:[(0,t.jsx)("span",{className:"font-body text-sm font-medium truncate",children:e.name}),(0,t.jsxs)("span",{className:"font-body text-xs text-muted-foreground truncate",children:[e.contact," · ",e.city]})]}),(0,t.jsx)(b.Badge,{variant:"secondary",className:"rounded-[10px] text-[10px] font-body shrink-0",children:e.stage})]},F(e)))}),(0,t.jsx)(g.CommandSeparator,{})]}),P.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.CommandGroup,{heading:(0,t.jsx)("span",{className:"font-heading text-xs font-semibold uppercase tracking-wider text-brand",children:"Clientes"}),children:P.map(e=>(0,t.jsxs)(g.CommandItem,{value:F(e),onSelect:()=>B(e),className:"flex items-center gap-3 rounded-[10px] px-3 py-2.5",children:[(0,t.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-[10px] bg-blue-100 dark:bg-blue-900/40",children:(0,t.jsx)(h.Building2,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-0.5",children:[(0,t.jsx)("span",{className:"font-body text-sm font-medium truncate",children:e.name}),(0,t.jsxs)("span",{className:"font-body text-xs text-muted-foreground truncate",children:[e.contact," · ",e.city]})]}),(0,t.jsx)(b.Badge,{variant:"secondary",className:`rounded-[10px] text-[10px] font-body shrink-0 border-0 ${function(e){switch(e){case"Saudável":return"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-400";case"Atenção":return"bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-400";case"Crítico":return"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400";default:return""}}(e.healthScore)}`,children:e.healthScore})]},F(e)))}),(0,t.jsx)(g.CommandSeparator,{})]}),(0,t.jsx)(g.CommandGroup,{heading:(0,t.jsx)("span",{className:"font-heading text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:"Páginas"}),children:T.map(e=>{let a=e.icon;return(0,t.jsxs)(g.CommandItem,{value:`page-${e.label}`,onSelect:()=>L(e.path),className:"rounded-[10px] px-3 py-2",children:[(0,t.jsx)(a,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{className:"font-body",children:e.label})]},e.path)})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between border-t px-3 py-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 font-body text-[11px] text-muted-foreground",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"↑↓"}),"navegar"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"↵"}),"selecionar"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"esc"}),"fechar"]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 font-body text-[11px] text-muted-foreground",children:[(0,t.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"⌘K"}),"busca rápida"]})]})]})}e.s(["GlobalSearch",()=>z])},92275,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),n=e.i(22016),i=e.i(60289),r=e.i(51804),l=e.i(85396),o=e.i(61911),c=e.i(41071),d=e.i(12426),m=e.i(39616),u=e.i(83086),x=e.i(92270),h=e.i(80376),p=e.i(75157),g=e.i(82943),b=e.i(80663);let f=[{label:"Dashboard",href:"/dashboard",icon:i.LayoutDashboard},{label:"Atividades",href:"/activities",icon:r.CalendarCheck},{label:"Pipeline",href:"/pipes",icon:l.Kanban},{label:"Clientes",href:"/clients",icon:o.Users}],v=[{label:"Financeiro",href:"/finance",icon:d.DollarSign}];function j(){let e=(0,s.usePathname)(),i=(0,s.useRouter)(),r=(0,g.useAuthStore)(e=>e.permissions),l=(0,g.useAuthStore)(e=>e.user),o=(0,g.useAuthStore)(e=>e.logout),[d,j]=(0,a.useState)(!1),y=e.startsWith("/intelligence"),N=!!l?.role&&(0,b.canAccessIntelligence)(l.role),w=(0,a.useMemo)(()=>{let e=r?.canViewFinance?[...v]:v.filter(e=>"/finance"!==e.href);return r?.canManageSettings&&e.splice(1,0,{label:"Configurações",href:"/settings/general",matchPrefix:"/settings",icon:m.Settings}),N&&e.push({label:"Menux Intelligence",href:"/intelligence",icon:u.Sparkles}),e},[N,r?.canManageSettings,r?.canViewFinance]),S=t=>{let a=t.matchPrefix??t.href;return e.startsWith(a)},C=w.some(e=>S(e));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("nav",{className:"premium-grain fixed bottom-0 left-0 right-0 z-50 h-16 border-t border-zinc-200/75 bg-white/90 backdrop-blur-xl md:hidden",children:[(0,t.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-px bg-linear-to-r from-transparent via-brand/35 to-transparent"}),(0,t.jsxs)("div",{className:"flex items-center justify-around h-full px-2",children:[f.map(e=>{let a=e.icon,s=S(e);return(0,t.jsxs)(n.default,{href:e.href,className:(0,p.cn)("premium-shine flex h-full flex-1 flex-col items-center justify-center gap-1 rounded-xl transition-colors",s?"bg-brand/10 text-brand-strong":"text-zinc-400 hover:text-zinc-600"),children:[(0,t.jsx)(a,{className:"size-5"}),(0,t.jsx)("span",{className:"text-[10px] font-heading font-medium",children:e.label})]},e.href)}),(0,t.jsxs)("button",{type:"button",onClick:()=>j(!0),className:(0,p.cn)("premium-shine flex h-full flex-1 flex-col items-center justify-center gap-1 rounded-xl transition-colors",y?"menux-intelligence-btn-soft text-slate-100":C?"bg-brand/10 text-brand-strong":"text-zinc-400 hover:text-zinc-600"),children:[(0,t.jsx)(c.MoreHorizontal,{className:"size-5"}),(0,t.jsx)("span",{className:"text-[10px] font-heading font-medium",children:"Mais"})]})]})]}),(0,t.jsx)(h.Sheet,{open:d,onOpenChange:j,children:(0,t.jsxs)(h.SheetContent,{side:"bottom",className:"rounded-t-[15px] premium-panel",children:[(0,t.jsx)(h.SheetHeader,{children:(0,t.jsx)(h.SheetTitle,{className:"font-heading",children:"Mais opções"})}),(0,t.jsxs)("div",{className:"flex flex-col gap-1 py-2",children:[w.map(e=>{let a=e.icon,s=S(e),i="/intelligence"===e.href;return(0,t.jsxs)(n.default,{href:e.href,onClick:()=>j(!1),className:(0,p.cn)("flex items-center gap-3 px-4 py-3 rounded-[10px] transition-colors",i&&(s?"menux-intelligence-btn":"menux-intelligence-btn-soft"),!i&&(s?"bg-brand/10 text-brand":"text-zinc-700 hover:bg-zinc-100")),children:[(0,t.jsx)(a,{className:(0,p.cn)("size-5",i&&"text-cyan-100")}),(0,t.jsx)("span",{className:"font-body text-sm font-medium",children:e.label})]},e.href)}),(0,t.jsx)("div",{className:"h-px bg-zinc-200 my-2"}),(0,t.jsxs)("button",{type:"button",className:"flex items-center gap-3 px-4 py-3 rounded-[10px] text-status-danger hover:bg-status-danger-light transition-colors",onClick:()=>{o(),j(!1),i.replace("/login")},children:[(0,t.jsx)(x.LogOut,{className:"size-5"}),(0,t.jsx)("span",{className:"font-body text-sm font-medium",children:"Sair"})]})]})]})})]})}e.s(["MobileBottomNav",()=>j])},670,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(84632),n=e.i(82943),i=e.i(80663),r=e.i(27438),l=e.i(18566),o=e.i(46932),c=e.i(88653),d=e.i(83086),m=e.i(45060);function u(){let e=(0,l.useRouter)(),r=(0,l.usePathname)(),{proactiveSuggestions:u}=(0,s.useIntelligenceStore)(),x=(0,n.useAuthStore)(e=>e.user),h=!!x?.role&&(0,i.canAccessIntelligence)(x.role),p=(0,a.useCallback)(t=>{h&&(t.ctrlKey||t.metaKey)&&"i"===t.key&&(t.preventDefault(),e.push("/intelligence"))},[h,e]);if((0,a.useEffect)(()=>(window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)),[p]),!h)return null;let g=u.filter(e=>!e.dismissed),b=g.length>0,f=g.some(e=>"high"===e.priority);return"/intelligence"===r?null:(0,t.jsx)(c.AnimatePresence,{children:(0,t.jsxs)(o.motion.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:300,damping:25},className:"fixed bottom-6 right-6 z-50 md:block",children:[(0,t.jsxs)("button",{onClick:()=>e.push("/intelligence"),className:(0,m.cn)("group relative flex h-14 w-14 items-center justify-center rounded-full border border-white/18 bg-slate-950/94 text-cyan-100 shadow-[0_18px_34px_-18px_rgba(2,6,23,0.9)] transition-all hover:scale-105 hover:border-cyan-300/40 hover:shadow-[0_22px_36px_-16px_rgba(34,211,238,0.34)] active:scale-95","focus:outline-none focus:ring-2 focus:ring-cyan-300/40 focus:ring-offset-2"),"aria-label":"Abrir Menux Intelligence",title:"Menux Intelligence",children:[(0,t.jsx)("span",{className:"absolute inset-0 animate-ping rounded-full bg-cyan-400 opacity-15"}),(0,t.jsx)(d.Sparkles,{className:"relative z-10 h-5 w-5 transition-transform group-hover:rotate-12"}),b&&(0,t.jsxs)(o.motion.span,{initial:{scale:0},animate:{scale:1},className:(0,m.cn)("absolute -right-1 -top-1 z-20 flex items-center justify-center rounded-full text-[10px] font-bold text-white","ring-2 ring-white",g.length>9?"h-5 w-5":"h-4.5 w-4.5 min-w-[18px]",f?"bg-red-500":"bg-blue-500"),children:[f&&(0,t.jsx)("span",{className:"absolute inset-0 rounded-full bg-red-500 animate-ping opacity-75"}),g.length>99?"99+":g.length]})]}),(0,t.jsx)("div",{className:"pointer-events-none absolute -left-[140px] top-1/2 -translate-y-1/2 opacity-0 transition-opacity group-hover:opacity-100",children:(0,t.jsx)("div",{className:"rounded-lg bg-slate-900 px-3 py-1.5 text-xs font-medium text-white shadow-lg whitespace-nowrap",children:"Menux Intelligence"})})]})})}function x(){let e=(0,n.useAuthStore)(e=>e.user),l=!!e?.role&&(0,i.canAccessIntelligence)(e.role);return((0,r.useProactiveEngine)(),(0,a.useEffect)(()=>{let e=setInterval(()=>{let{rateLimitResetAt:e,resetRateLimit:t}=s.useIntelligenceStore.getState();e&&new Date(e)<=new Date&&t()},6e4);return()=>clearInterval(e)},[]),l)?(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(u,{})}):null}e.s(["IntelligenceProvider",()=>x],670)},7714,e=>{"use strict";var t=e.i(43476),a=e.i(88653),s=e.i(46932),n=e.i(18566),i=e.i(30747);function r({children:e}){let r=(0,n.usePathname)();return(0,t.jsx)(a.AnimatePresence,{mode:"wait",initial:!1,children:(0,t.jsx)(s.motion.div,{variants:i.pageSlideFade,initial:"hidden",animate:"show",exit:"exit",className:"h-full",children:e},r)})}e.s(["RouteTransition",()=>r])},74503,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(78894),n=e.i(67240),i=e.i(19455);function r({error:e,onRetry:a}){return(0,t.jsxs)("div",{className:"flex min-h-[200px] flex-col items-center justify-center gap-4 rounded-xl border border-zinc-200 bg-white p-6 text-center",children:[(0,t.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-red-50",children:(0,t.jsx)(s.AlertTriangle,{className:"h-6 w-6 text-red-500"})}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Algo deu errado"}),(0,t.jsx)("p",{className:"max-w-sm font-body text-xs text-zinc-500",children:e?.message||"Ocorreu um erro inesperado. Tente novamente."})]}),a&&(0,t.jsxs)(i.Button,{variant:"outline",size:"sm",onClick:a,className:"gap-1.5",children:[(0,t.jsx)(n.RotateCcw,{className:"h-3.5 w-3.5"}),"Tentar novamente"]})]})}class l extends a.default.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error(`[ErrorBoundary${this.props.name?`: ${this.props.name}`:""}]`,e,t),this.props.onError?.(e,t)}handleReset=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,t.jsx)(r,{error:this.state.error,onRetry:this.handleReset}):this.props.children}}e.s(["ErrorBoundary",()=>l],74503)}]);