(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,88015,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(88653),l=e.i(46932),i=e.i(75254);let n=(0,i.default)("message-square-text",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7 11h10",key:"1twpyw"}],["path",{d:"M7 15h6",key:"d9of3u"}],["path",{d:"M7 7h8",key:"af5zfr"}]]);var r=e.i(83086),o=e.i(61911),c=e.i(37727),d=e.i(45060),m=e.i(27516),x=e.i(7233);let h=(0,i.default)("command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);var u=e.i(39616),p=e.i(20278),g=e.i(55436),b=e.i(86311),f=e.i(39312),j=e.i(71689),w=e.i(19455),N=e.i(18566),y=e.i(84632),v=e.i(46798),k=e.i(30747);let C=[{id:"focus",label:"Foco Cliente",icon:(0,t.jsx)(p.Target,{className:"h-4 w-4"})},{id:"audit",label:"Auditoria",icon:(0,t.jsx)(g.Search,{className:"h-4 w-4"})},{id:"reply",label:"Responder",icon:(0,t.jsx)(b.MessageSquare,{className:"h-4 w-4"})},{id:"proposal",label:"Proposta",icon:(0,t.jsx)(r.Sparkles,{className:"h-4 w-4"})}];function S(){let e=(0,N.useRouter)(),{menuxIntelligenceMode:s,setMenuxIntelligenceMode:a,toggleHistory:i,startNewConversation:n,remainingQueries:r}=(0,y.useIntelligenceStore)();return(0,t.jsxs)(l.motion.header,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},transition:k.transition.panel,className:"sticky top-0 z-[100] flex flex-col border-b border-white/12 bg-slate-950/35 px-6 py-3 backdrop-blur-xl",children:[(0,t.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:bg-white/8 hover:text-slate-200 md:hidden",onClick:()=>e.back(),children:(0,t.jsx)(j.ArrowLeft,{className:"h-4 w-4"})}),(0,t.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-cyan-500/80 to-blue-500/85 text-white shadow-sm ring-1 ring-white/20",children:(0,t.jsx)(f.Zap,{className:"premium-float h-5 w-5 fill-white text-white"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"font-heading text-lg font-bold text-slate-100 leading-tight",children:"Menux Intelligence"}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,t.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,t.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-75"}),(0,t.jsx)("span",{className:"premium-glow-dot relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),(0,t.jsxs)("span",{className:"font-body text-xs font-medium text-emerald-300",children:["Online Â· ",r," consultas"]})]})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(v.TooltipProvider,{children:[(0,t.jsxs)(v.Tooltip,{children:[(0,t.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:i,children:(0,t.jsx)(m.History,{className:"h-4 w-4"})})}),(0,t.jsx)(v.TooltipContent,{children:"Historico"})]}),(0,t.jsxs)(v.Tooltip,{children:[(0,t.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:n,children:(0,t.jsx)(x.Plus,{className:"h-4 w-4"})})}),(0,t.jsx)(v.TooltipContent,{children:"Nova Conversa"})]}),(0,t.jsx)("div",{className:"ml-2 h-4 w-px bg-white/15"}),(0,t.jsxs)(v.Tooltip,{children:[(0,t.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"ml-2 h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:()=>{y.useIntelligenceStore.getState().executeSlashCommand("/ajuda")},children:(0,t.jsx)(h,{className:"h-4 w-4"})})}),(0,t.jsx)(v.TooltipContent,{children:"Ver Comandos"})]}),(0,t.jsxs)(v.Tooltip,{children:[(0,t.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:()=>{y.useIntelligenceStore.getState().openSettings()},children:(0,t.jsx)(u.Settings,{className:"h-4 w-4"})})}),(0,t.jsx)(v.TooltipContent,{children:"ConfiguraÃ§Ãµes"})]})]})})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:C.map(e=>(0,t.jsx)(T,{active:s===e.id,onClick:()=>a(e.id),label:e.label,icon:e.icon},e.id))})]})}function T({active:e,onClick:s,label:a,icon:i}){return(0,t.jsxs)("button",{onClick:s,className:(0,d.cn)("group relative flex items-center gap-2 rounded-full border px-4 py-1.5 text-sm font-medium transition-all duration-200 ease-out",e?"border-cyan-300/30 bg-white/10 text-slate-50 shadow-sm":"border-transparent text-slate-300 hover:bg-white/7 hover:text-slate-100"),children:[e&&(0,t.jsx)(l.motion.span,{layoutId:"menux-intelligence-mode-pill",className:"absolute inset-0 rounded-full bg-cyan-400/16",transition:k.transition.quick}),(0,t.jsx)("span",{className:(0,d.cn)("relative z-10 transition-colors",e?"text-cyan-200":"text-slate-400 group-hover:text-slate-200"),children:i}),(0,t.jsx)("span",{className:"relative z-10",children:a})]})}var I=e.i(3116),A=e.i(93479),M=e.i(87486),L=e.i(75378),$=e.i(82943);let D={"lead-in":"Lead In","contato-feito":"Contato Feito","reuniao-agendada":"Reuniao Agendada","proposta-enviada":"Proposta Enviada",negociacao:"Negociacao",fechamento:"Fechamento"};function E(){let[e,a]=(0,s.useState)(""),[i,n]=(0,s.useState)(!1),{contextCard:r,selectClient:m,setContextCard:x,openClientPicker:h}=(0,y.useIntelligenceStore)(),{opportunities:u}=(0,L.useOpportunityStore)(),p=(0,$.useAuthStore)(e=>e.user),b=(0,s.useMemo)(()=>u.filter(e=>p?.role!=="comercial"&&p?.role!=="cs"||e.responsibleId===p.id).map(e=>({id:e.id,entityId:e.id,entityType:"opportunity",companyName:e.clientName??e.title,segment:e.tags?.[0],stage:e.stage,stageLabel:D[e.stage]??e.stage,temperature:e.temperature,lastContact:e.updatedAt,value:e.monthlyValue,tags:e.tags})),[u,p]),f=(0,s.useMemo)(()=>b.filter(e=>"hot"===e.temperature).slice(0,5),[b]),j=(0,s.useMemo)(()=>[...b].sort((e,t)=>{let s=e.lastContact?new Date(e.lastContact).getTime():0;return(t.lastContact?new Date(t.lastContact).getTime():0)-s}).slice(0,8),[b]),N=(0,s.useMemo)(()=>{if(!e.trim())return null;let t=e.toLowerCase();return b.filter(e=>e.companyName.toLowerCase().includes(t)||e.segment?.toLowerCase().includes(t)||e.tags?.some(e=>e.toLowerCase().includes(t)))},[b,e]),v=e=>{m(e)},k=e=>{let t=e.split(" ");return t.length>1?`${t[0][0]}${t[1][0]}`.toUpperCase():e.slice(0,2).toUpperCase()},C=e=>{let t=["bg-blue-400/18 text-blue-100","bg-emerald-400/18 text-emerald-100","bg-amber-400/18 text-amber-100","bg-indigo-400/18 text-indigo-100","bg-rose-400/18 text-rose-100","bg-cyan-400/18 text-cyan-100"];return t[e%t.length]};return(0,t.jsxs)("div",{className:"flex h-full flex-col bg-transparent text-slate-200",children:[(0,t.jsx)("div",{className:(0,d.cn)("sticky top-0 z-10 shrink-0 border-b border-white/10 bg-slate-950/36 p-4 backdrop-blur-sm transition-shadow duration-120 ease-out",i&&"shadow-[0_14px_22px_-18px_rgba(2,6,23,0.9)]"),children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(g.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,t.jsx)(A.Input,{placeholder:"Buscar cliente, deal ou tag...",value:e,onChange:e=>a(e.target.value),className:"h-10 rounded-xl border-white/16 bg-slate-900/55 pl-9 font-body text-sm text-slate-100 placeholder:text-slate-400 transition-all focus:bg-slate-900/70"}),e&&(0,t.jsx)("button",{onClick:()=>a(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-100",children:(0,t.jsx)(c.X,{className:"h-3.5 w-3.5"})})]})}),(0,t.jsx)("div",{className:"min-h-0 flex-1 overflow-y-auto",onScroll:e=>{n(e.currentTarget.scrollTop>6)},children:(0,t.jsxs)("div",{className:"flex flex-col p-2 gap-6 pb-20",children:[r&&(0,t.jsxs)(l.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"mx-2 mt-2 rounded-xl border border-cyan-300/22 bg-cyan-400/12 p-4 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-cyan-500/70 text-sm font-bold text-white",children:k(r.cardName)}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-heading font-semibold text-slate-100 leading-tight",children:r.cardName}),(0,t.jsxs)("p",{className:"flex items-center gap-1 text-xs text-slate-300",children:[z(r.temperature),r.stageLabel,r.leadScore?` \xb7 ${r.leadScore} pts`:""]})]})]}),(0,t.jsx)(w.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 -mr-2 text-slate-400 hover:text-slate-100",onClick:()=>x(null),children:(0,t.jsx)(c.X,{className:"h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,t.jsxs)("div",{className:"rounded-lg border border-white/14 bg-slate-950/42 p-2",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase font-semibold text-slate-400",children:"Fase"}),(0,t.jsx)("p",{className:"text-xs font-medium text-slate-200",children:r.stageLabel})]}),(0,t.jsxs)("div",{className:"rounded-lg border border-white/14 bg-slate-950/42 p-2",children:[(0,t.jsx)("span",{className:"text-[10px] uppercase font-semibold text-slate-400",children:"Tags"}),(0,t.jsx)("p",{className:"text-xs font-medium text-slate-200",children:r.tags.length>0?r.tags.join(", "):"â€”"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(w.Button,{size:"sm",variant:"outline",className:"h-8 flex-1 border-white/14 bg-white/6 text-xs text-slate-100 hover:bg-white/10",onClick:()=>{y.useIntelligenceStore.getState().executeSlashCommand("/briefing")},children:"ðŸ“‹ Briefing"}),(0,t.jsx)(w.Button,{size:"sm",variant:"outline",className:"h-8 flex-1 border-white/14 bg-white/6 text-xs text-slate-100 hover:bg-white/10",onClick:()=>{y.useIntelligenceStore.getState().executeSlashCommand("/analise")},children:"ðŸ” Analisar"})]})]}),null!==N?(0,t.jsxs)("div",{className:"px-2",children:[(0,t.jsxs)("h4",{className:"font-heading text-xs uppercase tracking-wider text-slate-400 font-semibold mb-2 px-2",children:["Resultados (",N.length,")"]}),N.length>0?(0,t.jsx)("div",{className:"space-y-1",children:N.map((e,s)=>(0,t.jsx)(q,{item:e,initials:k(e.companyName),color:C(s),isSelected:r?.cardId===e.entityId,onClick:()=>v(e)},e.id))}):(0,t.jsxs)("p",{className:"text-xs text-slate-400 px-2",children:["Nenhum resultado para â€œ",e,"â€"]})]}):(0,t.jsxs)(t.Fragment,{children:[f.length>0&&(0,t.jsxs)("div",{className:"px-2",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2 px-2",children:[(0,t.jsx)("h4",{className:"font-heading text-xs uppercase tracking-wider text-slate-400 font-semibold",children:"Prioridades"}),(0,t.jsx)(M.Badge,{variant:"secondary",className:"text-[10px] h-4 px-1",children:f.length})]}),(0,t.jsx)("div",{className:"space-y-1",children:f.map(e=>(0,t.jsxs)(l.motion.button,{onClick:()=>v(e),whileHover:{y:-1,scale:1.005},whileTap:{y:0,scale:.992},className:(0,d.cn)("w-full text-left flex items-start gap-3 p-2.5 rounded-lg transition-all group",r?.cardId===e.entityId?"border-brand/20 bg-brand/10 shadow-sm ring-1 ring-brand/20":"border border-transparent hover:bg-white/6"),children:[(0,t.jsx)("div",{className:"mt-0.5 h-2 w-2 shrink-0 rounded-full bg-amber-400 shadow-amber-300/40"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"mb-1 text-sm leading-none font-medium text-slate-100 group-hover:text-cyan-200",children:e.companyName}),(0,t.jsx)("p",{className:"line-clamp-1 text-xs text-slate-400",children:e.stageLabel}),e.lastContact&&(0,t.jsxs)("div",{className:"mt-1.5 flex items-center gap-1 text-[10px] text-slate-400",children:[(0,t.jsx)(I.Clock,{className:"h-3 w-3"}),function(e){if(!e)return"â€”";let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/864e5);return 0===s?"hoje":1===s?"ha 1 dia":s<7?`ha ${s} dias`:s<30?`ha ${Math.floor(s/7)} semana(s)`:`ha ${Math.floor(s/30)} mes(es)`}(e.lastContact)]})]})]},e.id))})]}),j.length>0&&(0,t.jsxs)("div",{className:"px-2",children:[(0,t.jsx)("h4",{className:"font-heading text-xs uppercase tracking-wider text-slate-400 font-semibold mb-2 px-2",children:"Recentes"}),(0,t.jsx)("div",{className:"space-y-1",children:j.map((e,s)=>(0,t.jsx)(q,{item:e,initials:k(e.companyName),color:C(s),isSelected:r?.cardId===e.entityId,onClick:()=>v(e)},e.id))})]}),0===b.length&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,t.jsx)(o.Users,{className:"mb-3 h-8 w-8 text-slate-500"}),(0,t.jsx)("p",{className:"mb-2 text-sm text-slate-300",children:"Nenhum cliente encontrado"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Seus leads e oportunidades aparecerÃ£o aqui automaticamente."})]}),b.length>0&&(0,t.jsx)("div",{className:"px-2",children:(0,t.jsxs)("button",{onClick:h,className:"flex w-full items-center gap-2 p-2 text-xs font-medium text-cyan-200 transition-colors hover:text-cyan-100",children:[(0,t.jsx)(o.Users,{className:"h-3.5 w-3.5"}),"Ver todos os clientes (",b.length,")"]})})]})]})})]})}function q({item:e,initials:s,color:a,isSelected:i,onClick:n}){return(0,t.jsxs)(l.motion.button,{onClick:n,whileHover:{y:-1,scale:1.008},whileTap:{y:0,scale:.992},className:(0,d.cn)("w-full text-left flex items-center gap-3 p-2 rounded-lg transition-all group",i?"border-brand/20 bg-brand/10 shadow-sm ring-1 ring-brand/20":"border border-transparent hover:bg-white/6"),children:[(0,t.jsx)("div",{className:(0,d.cn)("h-8 w-8 rounded-full flex items-center justify-center font-bold text-xs shrink-0",a),children:s}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"truncate text-sm font-medium text-slate-100 group-hover:text-cyan-200",children:e.companyName}),(0,t.jsxs)("p",{className:"flex items-center gap-1 truncate text-xs text-slate-400",children:[z(e.temperature)," ",e.stageLabel]})]})]})}function z(e){return"hot"===e?"ðŸ”¥":"warm"===e?"ðŸŒ¡ï¸":"â„ï¸"}var W=e.i(14764),B=e.i(78894);let P=(0,i.default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);var R=e.i(25652),F=e.i(74886),V=e.i(43531),H=e.i(87316),U=e.i(78583),O=e.i(16715),_=e.i(86536),X=e.i(63488),G=e.i(43432),K=e.i(32171);function Q({badge:e}){let s="hot"===e.temperature?"ðŸ”¥":"warm"===e.temperature?"ðŸŒ¡ï¸":"â„ï¸",a="hot"===e.temperature?"Quente":"warm"===e.temperature?"Morno":"Frio";return(0,t.jsxs)("div",{className:"mb-2 inline-flex items-center gap-1.5 rounded-full border border-white/14 bg-white/8 px-2.5 py-1 text-[11px] font-medium text-slate-300",children:[(0,t.jsx)("span",{children:"ðŸ“‹"}),(0,t.jsxs)("span",{children:["Baseado no card: ",(0,t.jsx)("strong",{children:e.cardName})," (",e.stage," Â·"," ",s," ",a,")"]})]})}function Z({block:e}){let[a,l]=(0,s.useState)(!1),[i,n]=(0,s.useState)(!1),[r,o]=(0,s.useState)(e.content),[m,x]=(0,s.useState)(!1),h=r.length,u=!!e.charLimit&&h>e.charLimit,p="whatsapp"===e.channel?(0,t.jsx)(b.MessageSquare,{className:"h-3.5 w-3.5"}):"email"===e.channel?(0,t.jsx)(X.Mail,{className:"h-3.5 w-3.5"}):"call"===e.channel?(0,t.jsx)(G.Phone,{className:"h-3.5 w-3.5"}):null,g=(0,s.useCallback)(async()=>{try{await navigator.clipboard.writeText(r),l(!0),setTimeout(()=>l(!1),2e3)}catch{n(!0),setTimeout(()=>n(!1),2e3)}},[r]);return(0,t.jsxs)("div",{className:"mt-2 overflow-hidden rounded-xl border border-white/14 bg-slate-900/58 shadow-lg shadow-black/25",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-3 py-1.5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-[11px] font-medium text-slate-300",children:[p,(0,t.jsx)("span",{children:e.label??"Mensagem"})]}),(0,t.jsx)("button",{onClick:g,className:(0,d.cn)("flex items-center gap-1 rounded-lg px-2 py-0.5 text-[11px] font-medium transition-all duration-[120ms]",a?"bg-emerald-500/20 text-emerald-100":i?"bg-red-500/20 text-red-100":"text-slate-300 hover:bg-white/9"),children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(V.Check,{className:"h-3 w-3"}),"Copiado"]}):i?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c.X,{className:"h-3 w-3"}),"Erro"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(F.Copy,{className:"h-3 w-3"}),"Copiar"]})})]}),(0,t.jsx)("div",{className:"p-3",children:m?(0,t.jsx)("textarea",{value:r,onChange:e=>o(e.target.value),onBlur:()=>x(!1),className:"w-full resize-none rounded border-none bg-transparent font-body text-sm text-slate-200 outline-none",rows:Math.min(r.split("\n").length+1,8),autoFocus:!0}):(0,t.jsx)("p",{onClick:()=>x(!0),className:"cursor-text whitespace-pre-wrap font-body text-sm leading-relaxed text-slate-200",children:r})}),e.charLimit&&(0,t.jsx)("div",{className:"border-t border-white/10 px-3 py-1",children:(0,t.jsxs)("p",{className:(0,d.cn)("text-right text-[10px] font-medium",u?"text-red-200":"text-slate-400"),children:[h,"/",e.charLimit," caracteres"]})})]})}function J({action:e,messageId:s}){let{markActionExecuted:a,openClientPicker:l,contextCard:i}=(0,y.useIntelligenceStore)(),{openDrawer:n,openModal:r}=(0,K.useUIStore)(),o={calendar:(0,t.jsx)(H.Calendar,{className:"h-3.5 w-3.5"}),"file-text":(0,t.jsx)(U.FileText,{className:"h-3.5 w-3.5"}),"refresh-cw":(0,t.jsx)(O.RefreshCw,{className:"h-3.5 w-3.5"}),eye:(0,t.jsx)(_.Eye,{className:"h-3.5 w-3.5"}),users:(0,t.jsx)(b.MessageSquare,{className:"h-3.5 w-3.5"})};return(0,t.jsxs)(w.Button,{variant:"open-card"===e.type?"ghost":"secondary",size:"sm",onClick:()=>{if(e.executed)return;let t=!1;if(e.payload?.action==="open-client-picker")l(),t=!0;else{let s=e.payload??{};switch(e.type){case"create-activity":var o;n("new-activity",{...s,type:"followup"===(o=s.type)||"follow-up"===o?"follow-up":"call"===o||"email"===o||"meeting"===o||"visit"===o||"task"===o||"whatsapp"===o?o:"task",fromIntelligence:!0}),t=!0;break;case"schedule-followup":n("new-activity",{...s,type:"follow-up",fromIntelligence:!0}),t=!0;break;case"save-note":{let e=("string"==typeof s.cardId?s.cardId:i?.cardId)??null,a="string"==typeof s.noteText?s.noteText:void 0,o="client"===s.entityType?"client":i?.entityType??"opportunity";if(!e){l(),t=!0;break}if("client"===o){n("client-card",{id:e,initialTab:"notes",prefillNote:a,fromIntelligence:!0}),t=!0;break}r("lead-card",{id:e,initialTab:"anotacoes",prefillNote:a,fromIntelligence:!0}),t=!0;break}case"open-card":{let e=("string"==typeof s.cardId?s.cardId:i?.cardId)??null,a="client"===s.entityType?"client":i?.entityType??"opportunity";if(!e){l(),t=!0;break}"client"===a?n("client-card",{id:e}):r("lead-card",{id:e}),t=!0}}}t&&a(s,e.id)},disabled:e.executed,className:(0,d.cn)("h-7 gap-1.5 rounded-lg text-xs transition-all duration-[120ms]",e.executed&&"opacity-50",!e.executed&&"hover:translate-y-[-1px] hover:shadow-sm"),children:[e.executed?(0,t.jsx)(V.Check,{className:"h-3.5 w-3.5 text-green-500"}):o[e.icon]??null,e.label]})}let Y=(0,s.memo)(function({message:e,isReadOnly:s=!1,isGrouped:a=!1,isLastInGroup:i=!0}){let n="user"===e.role;return(0,t.jsx)(l.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.14,ease:[0,0,.2,1]},className:(0,d.cn)("flex w-full",n?"justify-end":"justify-start",a?"mt-0.5":"mt-2"),children:(0,t.jsxs)("div",{className:(0,d.cn)("px-3.5 py-2.5",n?(0,d.cn)("max-w-[80%]","bg-gradient-to-br from-cyan-600 to-blue-700 text-white","shadow-lg shadow-cyan-900/30","rounded-[18px] rounded-tr-[6px]"):(0,d.cn)("max-w-[90%]","border border-white/12 bg-slate-900/58 text-slate-200","shadow-lg shadow-black/25","rounded-[18px] rounded-tl-[6px]")),children:[!n&&e.contextBadge&&(0,t.jsx)(Q,{badge:e.contextBadge}),(0,t.jsx)("div",{className:(0,d.cn)("font-body text-[13px] leading-relaxed",n?"[&_strong]:font-semibold":"[&_strong]:font-semibold [&_code]:text-cyan-200"),children:n?e.content:function(e){let s=e.split("\n"),a=[],l=!1,i=[],n=0,r=(e,s)=>e.split(/(\*\*\*[^*]+\*\*\*|\*\*[^*]+\*\*|\*[^*]+\*|`[^`]+`|\[[^\]]+\]\([^)]+\))/g).map((e,a)=>{if(e.startsWith("***")&&e.endsWith("***"))return(0,t.jsx)("strong",{className:"italic",children:e.slice(3,-3)},`${s}-${a}`);if(e.startsWith("**")&&e.endsWith("**"))return(0,t.jsx)("strong",{children:e.slice(2,-2)},`${s}-${a}`);if(e.startsWith("*")&&e.endsWith("*"))return(0,t.jsx)("em",{children:e.slice(1,-1)},`${s}-${a}`);if(e.startsWith("`")&&e.endsWith("`"))return(0,t.jsx)("code",{className:"rounded border border-white/10 bg-white/8 px-1 py-0.5 font-mono text-[11px] text-cyan-200",children:e.slice(1,-1)},`${s}-${a}`);let l=e.match(/^\[([^\]]+)\]\(([^)]+)\)$/);return l?(0,t.jsx)("a",{href:l[2],target:"_blank",rel:"noopener noreferrer",className:"font-medium text-cyan-200 underline underline-offset-2 hover:text-cyan-100",children:l[1]},`${s}-${a}`):e});for(let e=0;e<s.length;e++){let o=s[e],c=o.trim();if(c.startsWith("|")&&c.endsWith("|")){if(l||(l=!0,i=[]),/^\|[\s\-:|]+\|$/.test(c))continue;let e=c.split("|").slice(1,-1).map(e=>e.trim());i.push(e);continue}if(l){l=!1;let[e,...s]=i;a.push((0,t.jsx)("div",{className:"my-2 overflow-x-auto rounded-xl border border-white/12 shadow-lg shadow-black/20",children:(0,t.jsxs)("table",{className:"w-full text-xs",children:[e&&(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{className:"border-b border-white/12 bg-white/8",children:e.map((e,s)=>(0,t.jsx)("th",{className:"px-2.5 py-1.5 text-left font-semibold text-slate-200",children:r(e,`th-${n}-${s}`)},s))})}),(0,t.jsx)("tbody",{children:s.map((e,s)=>(0,t.jsx)("tr",{className:"border-b border-white/8 last:border-0",children:e.map((e,a)=>(0,t.jsx)("td",{className:"px-2.5 py-1.5 text-slate-300",children:r(e,`td-${n}-${s}-${a}`)},a))},s))})]})},`table-${n++}`)),i=[]}if(c.startsWith("### "))a.push((0,t.jsx)("h4",{className:"mb-1 mt-3 font-heading text-xs font-bold text-slate-100",children:r(c.slice(4),`h4i-${e}`)},`h4-${e}`));else if(c.startsWith("## "))a.push((0,t.jsx)("h3",{className:"mb-1 mt-3 font-heading text-sm font-bold text-slate-100",children:r(c.slice(3),`h3i-${e}`)},`h3-${e}`));else if(c.startsWith("# "))a.push((0,t.jsx)("h2",{className:"mb-1.5 mt-3 font-heading text-sm font-bold text-slate-50",children:r(c.slice(2),`h2i-${e}`)},`h2-${e}`));else if(c.startsWith("- ")||c.startsWith("â€¢ ")){let s=o.search(/\S/);a.push((0,t.jsxs)("div",{className:"flex gap-1.5",style:{paddingLeft:`${Math.max(0,4*s)}px`},children:[(0,t.jsx)("span",{className:"mt-1 shrink-0 text-slate-500",children:"â€¢"}),(0,t.jsx)("span",{children:r(c.slice(2),`lii-${e}`)})]},`li-${e}`))}else if(/^\d+\.\s/.test(c)){let s=c.match(/^(\d+)\.\s(.*)$/);s&&a.push((0,t.jsxs)("div",{className:"flex gap-1.5",children:[(0,t.jsxs)("span",{className:"shrink-0 font-medium text-slate-400",children:[s[1],"."]}),(0,t.jsx)("span",{children:r(s[2],`oli-${e}`)})]},`ol-${e}`))}else"---"===c||"***"===c?a.push((0,t.jsx)("hr",{className:"my-2 border-white/12"},`hr-${e}`)):""===c?a.push((0,t.jsx)("div",{className:"h-1.5"},`br-${e}`)):a.push((0,t.jsx)("p",{children:r(c,`pi-${e}`)},`p-${e}`))}if(l&&i.length>0){let[e,...s]=i;a.push((0,t.jsx)("div",{className:"my-2 overflow-x-auto rounded-xl border border-white/12 shadow-lg shadow-black/20",children:(0,t.jsxs)("table",{className:"w-full text-xs",children:[e&&(0,t.jsx)("thead",{children:(0,t.jsx)("tr",{className:"border-b border-white/12 bg-white/8",children:e.map((e,s)=>(0,t.jsx)("th",{className:"px-2.5 py-1.5 text-left font-semibold text-slate-200",children:r(e,`thf-${s}`)},s))})}),(0,t.jsx)("tbody",{children:s.map((e,s)=>(0,t.jsx)("tr",{className:"border-b border-white/8 last:border-0",children:e.map((e,a)=>(0,t.jsx)("td",{className:"px-2.5 py-1.5 text-slate-300",children:r(e,`tdf-${s}-${a}`)},a))},s))})]})},"table-final"))}return a}(e.content)}),!n&&e.copyableBlocks&&e.copyableBlocks.length>0&&(0,t.jsx)("div",{className:"mt-2 space-y-2",children:e.copyableBlocks.map(e=>(0,t.jsx)(Z,{block:e},e.id))}),!n&&!s&&e.suggestedActions&&e.suggestedActions.length>0&&(0,t.jsx)("div",{className:"mt-2.5 flex flex-wrap gap-1.5",children:e.suggestedActions.map(s=>(0,t.jsx)(J,{action:s,messageId:e.id},s.id))}),i&&(0,t.jsx)("p",{className:(0,d.cn)("mt-1 text-[10px]",n?"text-cyan-100/90":"text-slate-400"),children:new Date(e.timestamp).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})})});var ee=e.i(19600);function et({inputText:e,isVisible:i,onSelect:n,onClose:r}){let o=(0,$.useAuthStore)(e=>e.user),{contextCard:c}=(0,y.useIntelligenceStore)(),[m,x]=(0,s.useState)(0),h=(0,s.useRef)(null),u=o?.role??"comercial",p=!!c,g=(0,s.useMemo)(()=>(0,ee.getAvailableCommands)(u),[u]),b=(0,s.useMemo)(()=>(0,ee.filterCommands)(g,e),[g,e]);(0,s.useEffect)(()=>{(0,s.startTransition)(()=>{x(0)})},[e]);let f=(0,s.useCallback)(e=>{if(i&&0!==b.length)switch(e.key){case"ArrowDown":e.preventDefault(),x(e=>e<b.length-1?e+1:0);break;case"ArrowUp":e.preventDefault(),x(e=>e>0?e-1:b.length-1);break;case"Enter":case"Tab":e.preventDefault(),b[m]&&n(b[m]);break;case"Escape":e.preventDefault(),r()}},[i,b,m,n,r]);return((0,s.useEffect)(()=>(window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)),[f]),(0,s.useEffect)(()=>{if(h.current){let e=h.current.querySelector(`[data-index="${m}"]`);e?.scrollIntoView({block:"nearest"})}},[m]),i&&0!==b.length)?(0,t.jsx)(a.AnimatePresence,{children:(0,t.jsxs)(l.motion.div,{ref:h,initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.15},className:(0,d.cn)("absolute bottom-full left-0 right-0 mb-2 max-h-[320px] overflow-y-auto","rounded-xl border border-white/14 bg-slate-950/96 shadow-2xl shadow-black/35 backdrop-blur-xl"),children:[(0,t.jsx)("div",{className:"sticky top-0 border-b border-white/10 bg-slate-950/92 px-3 py-2 backdrop-blur-sm",children:(0,t.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-slate-400",children:"Comandos rÃ¡pidos"})}),(0,t.jsx)("div",{className:"p-1",children:b.map((e,s)=>{let a=e.requiresCard&&!p;return(0,t.jsxs)("button",{"data-index":s,onClick:()=>{a||n(e)},onMouseEnter:()=>x(s),className:(0,d.cn)("flex w-full items-center gap-3 rounded-lg px-3 py-2 text-left transition-colors",s===m?"bg-white/10":"hover:bg-white/7",a&&"opacity-50 cursor-not-allowed"),disabled:a,title:a?"Requer card aberto":`${e.command} â€” ${e.description}`,children:[(0,t.jsx)("span",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg border border-white/10 bg-white/8 text-base",children:e.icon}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"font-body text-sm font-medium text-slate-100",children:e.label}),(0,t.jsx)("code",{className:"rounded border border-white/10 bg-white/8 px-1.5 py-0.5 font-mono text-[10px] text-slate-300",children:e.command})]}),(0,t.jsx)("p",{className:"truncate text-[11px] text-slate-400",children:e.description})]}),e.requiresCard&&(0,t.jsx)("span",{className:(0,d.cn)("shrink-0 rounded-full px-1.5 py-0.5 text-[9px] font-medium",p?"bg-emerald-500/18 text-emerald-100":"bg-amber-500/18 text-amber-100"),children:p?"âœ… Card":"âš ï¸ Requer card"})]},e.command)})})]})}):null}var es=e.i(59684);function ea(){let{history:e,isHistoryOpen:i,toggleHistory:n,loadConversation:r}=(0,y.useIntelligenceStore)(),[o,d]=(0,s.useState)(""),m=(0,s.useMemo)(()=>{if(!o.trim())return e;let t=o.toLowerCase();return e.filter(e=>e.preview.toLowerCase().includes(t)||e.relatedCardName?.toLowerCase().includes(t)||e.messages.some(e=>e.content.toLowerCase().includes(t)))},[e,o]);return(0,t.jsx)(a.AnimatePresence,{children:i&&(0,t.jsxs)(l.motion.div,{initial:{opacity:0,x:-16},animate:{opacity:1,x:0},exit:{opacity:0,x:-16},transition:{duration:.2},className:"absolute inset-0 z-20 flex flex-col border-r border-white/12 bg-slate-950/94 backdrop-blur-xl",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 border-b border-white/10 px-4 py-3",children:[(0,t.jsx)("button",{onClick:n,className:"flex h-7 w-7 items-center justify-center rounded-lg text-slate-400 transition-colors hover:bg-white/8 hover:text-slate-100",children:(0,t.jsx)(j.ArrowLeft,{className:"h-4 w-4"})}),(0,t.jsx)(I.Clock,{className:"h-4 w-4 text-slate-400"}),(0,t.jsx)("h3",{className:"flex-1 font-heading text-sm font-semibold text-slate-100",children:"HistÃ³rico de conversas"}),(0,t.jsx)("button",{onClick:n,className:"flex h-7 w-7 items-center justify-center rounded-lg text-slate-400 transition-colors hover:bg-white/8 hover:text-slate-100",children:(0,t.jsx)(c.X,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"px-4 py-2",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(g.Search,{className:"absolute left-3 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),(0,t.jsx)(A.Input,{placeholder:"Buscar no histÃ³rico...",value:o,onChange:e=>d(e.target.value),className:"h-8 border-white/16 bg-white/7 pl-8 text-xs text-slate-100 placeholder:text-slate-400"})]})}),(0,t.jsx)(es.ScrollArea,{className:"flex-1",children:(0,t.jsx)("div",{className:"p-2",children:m.length>0?m.map(e=>{let s,a;return(0,t.jsxs)("button",{onClick:()=>r(e.id),className:"flex w-full flex-col gap-1 rounded-xl border border-transparent px-3 py-2.5 text-left transition-colors hover:border-white/12 hover:bg-white/7",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.MessageSquare,{className:"h-3.5 w-3.5 shrink-0 text-slate-400"}),(0,t.jsx)("span",{className:"truncate text-xs font-medium text-slate-100",children:e.preview||"Conversa sem preview"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 pl-5",children:[(0,t.jsx)("span",{className:"text-[10px] text-slate-400",children:(s=new Date(e.createdAt),0===(a=Math.floor((new Date().getTime()-s.getTime())/864e5))?"Hoje":1===a?"Ontem":a<7?`${a} dias atr\xe1s`:s.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}))}),e.relatedCardName&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-[10px] text-slate-500",children:"Â·"}),(0,t.jsx)("span",{className:"text-[10px] text-cyan-200",children:e.relatedCardName})]}),(0,t.jsx)("span",{className:"text-[10px] text-slate-500",children:"Â·"}),(0,t.jsxs)("span",{className:"text-[10px] text-slate-400",children:[e.messageCount," msgs"]})]})]},e.id)}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(I.Clock,{className:"mb-2 h-6 w-6 text-slate-500"}),(0,t.jsx)("p",{className:"text-center text-xs text-slate-400",children:o?"Nenhuma conversa encontrada.":"Sem conversas anteriores. Inicie uma conversa com a Menux Intelligence!"})]})})})]})})}var el=e.i(76639),ei=e.i(34288);function en({temp:e}){let s={hot:{emoji:"ðŸ”¥",label:"Quente",cls:"bg-red-500/18 text-red-100"},warm:{emoji:"ðŸŒ¡ï¸",label:"Morno",cls:"bg-amber-500/18 text-amber-100"},cold:{emoji:"â„ï¸",label:"Frio",cls:"bg-cyan-500/18 text-cyan-100"}}[e];return(0,t.jsxs)("span",{className:(0,d.cn)("inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-medium",s.cls),children:[s.emoji," ",s.label]})}function er({label:e}){return(0,t.jsx)("span",{className:"inline-flex items-center rounded-full bg-indigo-500/18 px-2 py-0.5 text-[10px] font-medium text-indigo-100",children:e})}let eo={"lead-in":"Lead In","contato-feito":"Contato Feito","reuniao-agendada":"ReuniÃ£o Agendada","proposta-enviada":"Proposta Enviada",negociacao:"NegociaÃ§Ã£o",fechamento:"Fechamento"};function ec(){let{isClientPickerOpen:e,closeClientPicker:a,clientPickerSearch:l,setClientPickerSearch:i,clientPickerFilters:n,setClientPickerFilters:r,selectClient:m}=(0,y.useIntelligenceStore)(),{opportunities:x}=(0,L.useOpportunityStore)(),h=(0,$.useAuthStore)(e=>e.user),[u,p]=(0,s.useState)(l);(0,s.useEffect)(()=>{let e=setTimeout(()=>p(l),300);return()=>clearTimeout(e)},[l]);let b=(0,s.useMemo)(()=>x.filter(e=>h?.role!=="comercial"&&h?.role!=="cs"||e.responsibleId===h.id).map(e=>({id:e.id,entityId:e.id,entityType:"opportunity",companyName:e.clientName??e.title,segment:e.tags?.[0],stage:e.stage,stageLabel:eo[e.stage]??e.stage,temperature:e.temperature,lastContact:e.updatedAt,value:e.monthlyValue,tags:e.tags})),[x,h]),f=(0,s.useMemo)(()=>{let e=b;if(u.trim()){let t=u.toLowerCase();e=e.filter(e=>e.companyName.toLowerCase().includes(t)||e.segment?.toLowerCase().includes(t)||e.tags?.some(e=>e.toLowerCase().includes(t)))}return n.temperature?.length&&(e=e.filter(e=>n.temperature.includes(e.temperature))),e.sort((e,t)=>{let s={hot:0,warm:1,cold:2},a=s[e.temperature]-s[t.temperature];return 0!==a?a:e.lastContact&&t.lastContact?new Date(t.lastContact).getTime()-new Date(e.lastContact).getTime():e.companyName.localeCompare(t.companyName)}),e},[b,u,n]),j=(0,s.useCallback)(e=>{let t=n.temperature??[],s=t.includes(e)?t.filter(t=>t!==e):[...t,e];r({...n,temperature:s.length?s:void 0})},[n,r]),w=(0,s.useCallback)(()=>{i(""),r({})},[i,r]);return(0,t.jsx)(el.Dialog,{open:e,onOpenChange:e=>!e&&a(),children:(0,t.jsxs)(el.DialogContent,{className:"max-w-[520px] gap-0 border-white/14 bg-slate-950/92 p-0 text-slate-100 shadow-2xl shadow-black/40 backdrop-blur-xl sm:max-w-[520px]",children:[(0,t.jsx)(el.DialogHeader,{className:"border-b border-white/10 px-5 py-4",children:(0,t.jsxs)(el.DialogTitle,{className:"flex items-center gap-2 font-heading text-base text-slate-100",children:[(0,t.jsx)(o.Users,{className:"h-4.5 w-4.5 text-cyan-200"}),"Selecionar cliente"]})}),(0,t.jsx)("div",{className:"border-b border-white/10 px-5 py-3",children:(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(g.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,t.jsx)(A.Input,{placeholder:"Buscar por nome, segmento ou tag...",value:l,onChange:e=>i(e.target.value),className:"border-white/16 bg-white/7 pl-9 text-sm text-slate-100 placeholder:text-slate-400",autoFocus:!0}),l&&(0,t.jsx)("button",{onClick:()=>i(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-100",children:(0,t.jsx)(c.X,{className:"h-3.5 w-3.5"})})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 border-b border-white/10 px-5 py-2.5",children:[["hot","warm","cold"].map(e=>{let s=n.temperature?.includes(e),a="hot"===e?"ðŸ”¥":"warm"===e?"ðŸŒ¡ï¸":"â„ï¸",l="hot"===e?"Quente":"warm"===e?"Morno":"Frio";return(0,t.jsxs)("button",{onClick:()=>j(e),className:(0,d.cn)("inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors",s?"bg-cyan-500/20 text-cyan-100 ring-1 ring-cyan-300/35":"bg-white/8 text-slate-300 hover:bg-white/12"),children:[a," ",l]},e)}),(n.temperature?.length||l)&&(0,t.jsx)("button",{onClick:w,className:"ml-auto text-[11px] font-medium text-cyan-200 hover:text-cyan-100",children:"Limpar filtros"})]}),(0,t.jsx)(es.ScrollArea,{className:"max-h-[70vh]",children:(0,t.jsx)("div",{className:"p-2",children:f.length>0?f.map(e=>(0,t.jsxs)("button",{onClick:()=>m(e),className:"flex w-full items-start gap-3 rounded-xl border border-transparent px-3 py-3 text-left transition-colors hover:border-white/12 hover:bg-white/7",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"truncate font-body text-sm font-semibold text-slate-100",children:e.companyName}),e.segment&&(0,t.jsx)("span",{className:"shrink-0 text-[11px] text-slate-400",children:e.segment})]}),(0,t.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-1.5",children:[(0,t.jsx)(er,{label:e.stageLabel}),(0,t.jsx)(en,{temp:e.temperature}),e.lastContact&&(0,t.jsxs)("span",{className:"text-[10px] text-slate-400",children:["Ãšltimo contato: ",function(e){if(!e)return"â€”";let t=new Date(e),s=Math.floor((new Date().getTime()-t.getTime())/864e5);return 0===s?"hoje":1===s?"hÃ¡ 1 dia":s<7?`h\xe1 ${s} dias`:s<30?`h\xe1 ${Math.floor(s/7)} semana(s)`:`h\xe1 ${Math.floor(s/30)} m\xeas(es)`}(e.lastContact)]})]})]}),e.value&&e.value>0&&(0,t.jsxs)("div",{className:"shrink-0 text-right",children:[(0,t.jsx)("p",{className:"text-xs font-semibold text-slate-200",children:(0,ei.formatCurrencyBRL)(e.value)}),(0,t.jsx)("p",{className:"text-[10px] text-slate-400",children:"/mÃªs"})]})]},e.id)):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,t.jsx)(o.Users,{className:"mb-3 h-8 w-8 text-slate-500"}),(0,t.jsx)("p",{className:"font-body text-sm text-slate-400",children:l?`Nenhum cliente encontrado para "${l}". Tente outro nome ou limpe os filtros.`:"VocÃª ainda nÃ£o tem clientes neste pipe. Pode me fazer perguntas gerais ou consultar a base Menux."}),l&&(0,t.jsx)("button",{onClick:w,className:"mt-2 text-sm font-medium text-cyan-200 hover:text-cyan-100",children:"Limpar filtros"})]})})}),(0,t.jsx)("div",{className:"border-t border-white/10 px-5 py-2.5",children:(0,t.jsxs)("p",{className:"text-[11px] text-slate-400",children:["Mostrando ",f.length," de ",b.length," clientes"]})})]})})}var ed=e.i(67489),em=e.i(99375);let ex=[{value:"formal",label:"Formal"},{value:"neutral",label:"Neutro"},{value:"casual",label:"Casual"}],eh=[{value:5,label:"A cada 5 minutos"},{value:15,label:"A cada 15 minutos"},{value:30,label:"A cada 30 minutos"}];function eu(){let{isSettingsOpen:e,closeSettings:s,aiTone:a,setAiTone:l,proactiveFrequency:i,setProactiveFrequency:n,proactiveNotifications:r,setProactiveNotifications:o}=(0,y.useIntelligenceStore)();return(0,t.jsx)(el.Dialog,{open:e,onOpenChange:e=>!e&&s(),children:(0,t.jsxs)(el.DialogContent,{className:"border-white/12 bg-slate-950 text-slate-100 sm:max-w-md",children:[(0,t.jsx)(el.DialogHeader,{children:(0,t.jsx)(el.DialogTitle,{className:"font-heading text-lg",children:"ConfiguraÃ§Ãµes da Intelligence"})}),(0,t.jsxs)("div",{className:"space-y-6 py-2",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-200",children:"Tom da IA"}),(0,t.jsxs)(ed.Select,{value:a,onValueChange:e=>l(e),children:[(0,t.jsx)(ed.SelectTrigger,{className:"border-white/12 bg-white/7",children:(0,t.jsx)(ed.SelectValue,{})}),(0,t.jsx)(ed.SelectContent,{className:"border-white/12 bg-slate-900",children:ex.map(e=>(0,t.jsx)(ed.SelectItem,{value:e.value,children:e.label},e.value))})]}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Define o estilo de comunicaÃ§Ã£o nas respostas."})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-200",children:"FrequÃªncia de sugestÃµes"}),(0,t.jsxs)(ed.Select,{value:String(i),onValueChange:e=>n(Number(e)),children:[(0,t.jsx)(ed.SelectTrigger,{className:"border-white/12 bg-white/7",children:(0,t.jsx)(ed.SelectValue,{})}),(0,t.jsx)(ed.SelectContent,{className:"border-white/12 bg-slate-900",children:eh.map(e=>(0,t.jsx)(ed.SelectItem,{value:String(e.value),children:e.label},e.value))})]}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Com que frequÃªncia o motor proativo verifica novas oportunidades."})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)("label",{className:"text-sm font-medium text-slate-200",children:"NotificaÃ§Ãµes proativas"}),(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"Receber alertas sobre oportunidades e riscos."})]}),(0,t.jsx)(em.Switch,{checked:r,onCheckedChange:o})]})]})]})})}var ep=e.i(48549);function eg(){let[e,i]=(0,s.useState)(""),[n,o]=(0,s.useState)(!1),[c,m]=(0,s.useState)(null),x=(0,s.useRef)(null),u=(0,s.useRef)(null),[p,g]=(0,s.useState)(!0),{messages:b,isTyping:f,greetingSent:j,contextCard:N,remainingQueries:v,viewingHistoryConversation:k,sendMessage:C,executeSlashCommand:S,open:T}=(0,y.useIntelligenceStore)();(0,s.useEffect)(()=>{j||T()},[j,T]);let I=(0,s.useCallback)((e="smooth")=>{let t=x.current;t&&t.scrollTo({top:t.scrollHeight,behavior:e})},[]),A=(0,s.useCallback)(()=>{let e=x.current;e&&g(e.scrollHeight-e.scrollTop-e.clientHeight<=36)},[]);(0,s.useEffect)(()=>{if(!p)return;let e=requestAnimationFrame(()=>I("smooth"));return()=>cancelAnimationFrame(e)},[b,f,p,I]);let M=k?k.messages:b,L=!!k,$=!p&&M.length>0;(0,s.useEffect)(()=>{A()},[M.length,A]),(0,s.useEffect)(()=>{(0,s.startTransition)(()=>{e.startsWith("/")&&!c?o(!0):e.startsWith("/")||o(!1)})},[e,c]);let D=(0,s.useCallback)(async()=>{if(!e.trim()||L)return;let t=e.trim();if(i(""),o(!1),c)await S(c.command,t),m(null);else if(t.startsWith("/")){let e=t.split(" ")[0],s=t.slice(e.length).trim();await S(e,s||void 0)}else await C(t)},[e,c,L,C,S]),E=(0,s.useCallback)(e=>{o(!1),e.requiresInput?(m(e),i(""),u.current?.focus()):(i(""),S(e.command))},[S]),q=(0,s.useMemo)(()=>M.map((e,t)=>{let s=M[t-1],a=M[t+1],l=s?.role===e.role,i=!a||a.role!==e.role;return{message:e,isGrouped:l,isLastInGroup:i}}),[M]),z=c?c.inputPlaceholder??"Digite o complemento...":N?`Pergunte sobre ${N.cardName}...`:"Digite uma mensagem ou /comando...";return(0,t.jsxs)("div",{className:"relative flex h-full flex-col bg-transparent",children:[(0,t.jsx)(ea,{}),(0,t.jsx)(ec,{}),(0,t.jsx)(eu,{}),(0,t.jsx)(a.AnimatePresence,{children:L&&(0,t.jsxs)(l.motion.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"flex items-center justify-between border-b border-amber-300/25 bg-amber-500/12 px-4 py-2 backdrop-blur-sm",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-amber-200",children:"Visualizando conversa do historico (somente leitura)"}),(0,t.jsx)("button",{onClick:()=>y.useIntelligenceStore.getState().exitHistoryView(),className:"text-xs font-semibold text-amber-100 underline hover:text-amber-50",children:"Voltar para conversa ativa"})]})}),(0,t.jsx)(eb,{}),(0,t.jsx)("div",{ref:x,onScroll:A,className:"flex-1 overflow-y-auto p-4",children:(0,t.jsxs)("div",{className:"flex flex-col pb-4 max-w-3xl mx-auto w-full",children:[(0,t.jsx)("div",{className:"flex justify-center my-4",children:(0,t.jsx)("span",{className:"rounded-full border border-white/18 bg-white/8 px-3 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-300 shadow-sm",children:new Date().toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"short"})})}),q.map(({message:e,isGrouped:s,isLastInGroup:a})=>(0,t.jsx)(Y,{message:e,isReadOnly:L,isGrouped:s,isLastInGroup:a},e.id)),f&&(0,t.jsxs)("div",{className:"flex gap-3 mt-2",children:[(0,t.jsx)("div",{className:"mt-1 flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-cyan-500/80 to-blue-500/85 text-white shadow-sm ring-2 ring-white/20",children:(0,t.jsx)(r.Sparkles,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex h-10 items-center gap-1.5 rounded-2xl rounded-tl-sm border border-white/12 bg-slate-900/55 px-4 shadow-sm",children:[(0,t.jsx)("span",{className:"premium-glow-dot h-2 w-2 animate-bounce rounded-full bg-slate-300 [animation-delay:-0.3s]"}),(0,t.jsx)("span",{className:"premium-glow-dot h-2 w-2 animate-bounce rounded-full bg-slate-300 [animation-delay:-0.15s]"}),(0,t.jsx)("span",{className:"premium-glow-dot h-2 w-2 animate-bounce rounded-full bg-slate-300"})]})]}),0===M.length&&!f&&(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,t.jsx)("div",{className:"mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-cyan-500/80 to-blue-500/85 text-white shadow-lg",children:(0,t.jsx)(r.Sparkles,{className:"h-8 w-8"})}),(0,t.jsx)("h3",{className:"mb-1 font-heading text-lg font-bold text-slate-100",children:"Menux Intelligence"}),(0,t.jsxs)("p",{className:"max-w-sm text-sm text-slate-300",children:["Seu assistente de vendas inteligente. FaÃ§a perguntas, use comandos com ",(0,t.jsx)("kbd",{className:"rounded border border-white/18 bg-white/8 px-1 text-xs text-slate-100",children:"/"})," ou selecione um cliente para comecar."]})]})]})}),(0,t.jsx)(a.AnimatePresence,{children:$&&(0,t.jsx)(l.motion.button,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.18,ease:"easeOut"},onClick:()=>{I("smooth"),g(!0)},className:"absolute bottom-[104px] right-6 z-20 rounded-full border border-cyan-300/25 bg-slate-950/92 px-3 py-1.5 text-xs font-medium text-cyan-100 shadow-lg shadow-black/35 transition-colors hover:bg-slate-900",children:"Nova mensagem"})}),!L&&(0,t.jsx)(l.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.28,ease:[.22,.61,.36,1]},className:"border-t border-white/10 bg-slate-950/28 p-4 pt-2 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"max-w-3xl mx-auto relative",children:[(0,t.jsx)(et,{inputText:e,isVisible:n,onSelect:E,onClose:()=>{o(!1),i("")}}),c&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2 px-2",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5 rounded-full border border-cyan-300/30 bg-cyan-300/14 px-3 py-1 text-xs font-medium text-cyan-100",children:[(0,t.jsx)(h,{className:"h-3 w-3"}),c.command]}),(0,t.jsx)("button",{onClick:()=>{m(null),i(""),o(!1)},className:"text-[10px] text-slate-400 hover:text-slate-100",children:"Cancelar"})]}),N&&!c&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2 px-2",children:[(0,t.jsxs)("span",{className:"inline-flex items-center gap-1.5 rounded-full border border-emerald-300/25 bg-emerald-400/14 px-3 py-1 text-xs font-medium text-emerald-100",children:["hot"===N.temperature?"ðŸ”¥":"warm"===N.temperature?"ðŸŒ¡ï¸":"â„ï¸",N.cardName," Â· ",N.stageLabel]}),(0,t.jsx)("button",{onClick:()=>y.useIntelligenceStore.getState().setContextCard(null),className:"text-[10px] text-slate-400 hover:text-slate-100",children:"Remover"})]}),(0,t.jsxs)("div",{className:(0,d.cn)("relative flex items-end gap-2 rounded-[26px] border border-white/12 bg-slate-900/58 p-2 shadow-xl shadow-black/35 transition-all duration-200","focus-within:border-cyan-300/35 focus-within:ring-2 focus-within:ring-cyan-300/20"),children:[(0,t.jsx)("div",{className:"flex-1 py-3 min-h-[44px]",children:(0,t.jsx)("input",{ref:u,type:"text",value:e,onChange:e=>{let t=e.target.value;i(t),c||o(t.startsWith("/"))},onKeyDown:e=>{"Enter"===e.key&&!e.shiftKey&&(e.preventDefault(),n||D()),"Escape"===e.key&&c&&(m(null),i(""))},placeholder:z,maxLength:ep.INTELLIGENCE_LIMITS.MAX_USER_MESSAGE_LENGTH,className:"w-full border-none bg-transparent pl-2 text-sm font-medium text-slate-100 outline-none placeholder:text-slate-400",disabled:f})}),(0,t.jsx)("div",{className:"flex items-center gap-1 mb-0.5",children:(0,t.jsx)(w.Button,{size:"icon",className:(0,d.cn)("h-10 w-10 rounded-full shadow-md transition-all duration-200",e?"bg-brand text-white shadow-brand/20 hover:bg-brand-strong":"bg-slate-700/70 text-slate-300 hover:bg-slate-700"),disabled:!e.trim()||f,onClick:D,children:(0,t.jsx)(W.Send,{className:"h-4 w-4 ml-0.5"})})})]}),(0,t.jsxs)("div",{className:"mt-3 flex justify-between px-4",children:[(0,t.jsxs)("div",{className:"flex gap-4 text-[10px] font-medium text-slate-400",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("kbd",{className:"flex h-[18px] min-w-[18px] items-center justify-center rounded border border-white/16 bg-white/8 px-1 font-sans",children:"â†µ"}),"Enviar"]}),(0,t.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,t.jsx)("kbd",{className:"flex h-[18px] min-w-[18px] items-center justify-center rounded border border-white/16 bg-white/8 px-1 font-sans",children:"/"}),"Comandos"]}),v<10&&(0,t.jsxs)("span",{className:"text-amber-300",children:[v," consultas restantes"]})]}),(0,t.jsx)("p",{className:"text-[10px] text-slate-500",children:"Menux Intelligence pode cometer erros. Verifique as informacoes."})]})]})})]})}function eb(){let{proactiveSuggestions:e,dismissSuggestion:i,sendMessage:n}=(0,y.useIntelligenceStore)(),r=(0,s.useMemo)(()=>{let t=e.filter(e=>!e.dismissed);if(0===t.length)return null;let s={high:0,medium:1,low:2};return[...t].sort((e,t)=>s[e.priority]-s[t.priority])[0]},[e]);if(!r)return null;let o={high:{bg:"border-red-300/30 bg-red-500/12",text:"text-red-100",icon:(0,t.jsx)(B.AlertTriangle,{className:"h-4 w-4 text-red-200"})},medium:{bg:"border-amber-300/30 bg-amber-500/12",text:"text-amber-100",icon:(0,t.jsx)(R.TrendingUp,{className:"h-4 w-4 text-amber-200"})},low:{bg:"border-cyan-300/30 bg-cyan-500/12",text:"text-cyan-100",icon:(0,t.jsx)(P,{className:"h-4 w-4 text-cyan-200"})}}[r.priority];return(0,t.jsx)(a.AnimatePresence,{children:(0,t.jsxs)(l.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.24,ease:[.22,.61,.36,1]},className:(0,d.cn)("flex items-center gap-3 border-b px-4 py-2.5",o.bg),children:[o.icon,(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:(0,d.cn)("text-xs font-semibold truncate",o.text),children:r.cardName?`${r.cardName} â€” ${r.message}`:r.message}),(0,t.jsx)("p",{className:"truncate text-[10px] capitalize text-slate-400",children:r.type.replace(/-/g," ")})]}),(0,t.jsx)("button",{onClick:()=>{n(r.cardName?`Analisar: ${r.cardName}`:`Analisar: ${r.message}`),i(r.id)},className:(0,d.cn)("shrink-0 rounded-full px-3 py-1 text-[10px] font-semibold transition-colors","high"===r.priority?"bg-red-500/20 text-red-100 hover:bg-red-500/28":"medium"===r.priority?"bg-amber-500/20 text-amber-100 hover:bg-amber-500/28":"bg-cyan-500/20 text-cyan-100 hover:bg-cyan-500/28"),children:"Investigar"}),(0,t.jsx)("button",{onClick:()=>i(r.id),className:"shrink-0 rounded-full p-1 text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-100",title:"Dispensar",children:(0,t.jsx)(c.X,{className:"h-3.5 w-3.5"})})]},r.id)})}var ef=e.i(72520),ej=e.i(51737),ew=e.i(64030),eN=e.i(64659),ey=e.i(55900),ev=e.i(17923);let ek=(0,i.default)("sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);var eC=e.i(32739);function eS(){let{contextCard:e,executeSlashCommand:i,proactiveSuggestions:n,dismissSuggestion:r,menuxIntelligenceMode:o}=(0,y.useIntelligenceStore)(),{opportunities:c}=(0,L.useOpportunityStore)(),m=(0,$.useAuthStore)(e=>e.user?.role),{priorities:x,insights:h,quickWins:u,riskAlerts:g}=(0,eC.useExecutionPanelData)(),j=!!e,w=n.filter(e=>!e.dismissed),N={focus:{suggestions:!0,priorities:!0,actions:!0,insights:!1,quickWins:!1,risks:!1},audit:{suggestions:!1,priorities:!1,actions:!0,insights:!0,quickWins:!0,risks:!0},reply:{suggestions:!0,priorities:!0,actions:!0,insights:!1,quickWins:!1,risks:!1},proposal:{suggestions:!1,priorities:!1,actions:!0,insights:!0,quickWins:!0,risks:!1}},k=N[o]??N.focus,C={focus:["whatsapp","email","agendar","proposta","resumo","funil","riscos","planos"],audit:["resumo","funil","riscos","planos"],reply:["whatsapp","email","agendar"],proposal:["proposta","planos"]},S=C[o]??C.focus,T=(0,s.useMemo)(()=>"master"!==m&&"admin"!==m&&"comercial"!==m&&"cs"!==m?new Set:new Set((0,ee.getAvailableCommands)(m).map(e=>e.command)),[m]),A=[{key:"whatsapp",command:"/mensagem",icon:(0,t.jsx)(b.MessageSquare,{className:"h-3.5 w-3.5"}),label:"WhatsApp",color:"border-emerald-300/25 bg-emerald-400/12 text-emerald-100 hover:bg-emerald-400/18 hover:border-emerald-300/40",needsClient:!0},{key:"email",command:"/mensagem",icon:(0,t.jsx)(X.Mail,{className:"h-3.5 w-3.5"}),label:"Email",color:"border-cyan-300/25 bg-cyan-400/12 text-cyan-100 hover:bg-cyan-400/18 hover:border-cyan-300/40",needsClient:!0},{key:"agendar",command:"/followup",icon:(0,t.jsx)(H.Calendar,{className:"h-3.5 w-3.5"}),label:"Follow-up",color:"border-violet-300/25 bg-violet-400/12 text-violet-100 hover:bg-violet-400/18 hover:border-violet-300/40",needsClient:!0},{key:"proposta",command:"/pitch",icon:(0,t.jsx)(p.Target,{className:"h-3.5 w-3.5"}),label:"Pitch",color:"border-amber-300/25 bg-amber-400/12 text-amber-100 hover:bg-amber-400/18 hover:border-amber-300/40",needsClient:!0},{key:"resumo",command:"/resumo",icon:(0,t.jsx)(ek,{className:"h-3.5 w-3.5"}),label:"Resumo",color:"border-indigo-300/25 bg-indigo-400/12 text-indigo-100 hover:bg-indigo-400/18 hover:border-indigo-300/40",needsClient:!1},{key:"funil",command:"/funil",icon:(0,t.jsx)(R.TrendingUp,{className:"h-3.5 w-3.5"}),label:"Funil",color:"border-blue-300/25 bg-blue-400/12 text-blue-100 hover:bg-blue-400/18 hover:border-blue-300/40",needsClient:!1},{key:"riscos",command:"/riscos",icon:(0,t.jsx)(ej.ShieldAlert,{className:"h-3.5 w-3.5"}),label:"Riscos",color:"border-rose-300/25 bg-rose-400/12 text-rose-100 hover:bg-rose-400/18 hover:border-rose-300/40",needsClient:!1},{key:"planos",command:"/planos",icon:(0,t.jsx)(U.FileText,{className:"h-3.5 w-3.5"}),label:"Planos",color:"border-slate-300/25 bg-slate-400/12 text-slate-100 hover:bg-slate-400/18 hover:border-slate-200/35",needsClient:!1}].filter(e=>S.includes(e.key)&&T.has(e.command)),[M,D]=(0,s.useState)({priorities:!0,actions:!0,insights:!0,quickWins:!1,risks:!0,suggestions:!0}),E=e=>{D(t=>({...t,[e]:!t[e]}))};return(0,t.jsx)("div",{className:"flex h-full flex-col overflow-y-auto bg-transparent",children:(0,t.jsxs)("div",{className:"p-5 space-y-6",children:[k.suggestions&&w.length>0&&(0,t.jsxs)("section",{children:[(0,t.jsx)(eT,{icon:(0,t.jsx)(ek,{className:"h-4 w-4 text-violet-500"}),title:"Sugestoes da Menux Intelligence",count:w.length,expanded:M.suggestions,onToggle:()=>E("suggestions"),accentColor:"violet"}),(0,t.jsx)(a.AnimatePresence,{children:M.suggestions&&(0,t.jsx)(l.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"space-y-2 mt-3",children:w.slice(0,5).map(e=>(0,t.jsxs)(l.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:(0,d.cn)("rounded-lg border p-3 text-xs","high"===e.priority?"border-red-300/35 bg-red-500/12":"medium"===e.priority?"border-amber-300/35 bg-amber-500/12":"border-white/14 bg-white/7"),children:[(0,t.jsx)("p",{className:(0,d.cn)("leading-relaxed","high"===e.priority?"text-red-100":"medium"===e.priority?"text-amber-100":"text-slate-200"),children:e.message}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[e.cardName&&(0,t.jsx)("button",{onClick:()=>{let t=c.find(t=>t.id===e.cardId||t.clientName===e.cardName);t&&y.useIntelligenceStore.getState().selectClient({id:t.id,entityId:t.id,entityType:"opportunity",companyName:t.clientName??t.title,stage:t.stage,stageLabel:t.stage,temperature:t.temperature,lastContact:t.updatedAt,value:t.monthlyValue,tags:t.tags})},className:"text-[10px] font-medium text-cyan-200 hover:text-cyan-100",children:"Investigar â†’"}),(0,t.jsx)("button",{onClick:()=>r(e.id),className:"ml-auto text-[10px] text-slate-400 hover:text-slate-200",children:"Dispensar"})]})]},e.id))})})})]}),k.priorities&&(0,t.jsxs)("section",{children:[(0,t.jsx)(eT,{icon:(0,t.jsx)(I.Clock,{className:"h-4 w-4 text-red-500"}),title:"Prioridades de Hoje",count:x.length,expanded:M.priorities,onToggle:()=>E("priorities"),accentColor:"red"}),(0,t.jsx)(a.AnimatePresence,{children:M.priorities&&(0,t.jsx)(l.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:x.length>0?(0,t.jsx)("div",{className:"space-y-2 mt-3",children:x.map(e=>(0,t.jsx)(eI,{severity:e.severity,title:e.title,subtitle:e.subtitle,type:e.type,onClick:()=>{if(e.linkedEntityId){let t=c.find(t=>t.id===e.linkedEntityId);t&&y.useIntelligenceStore.getState().selectClient({id:t.id,entityId:t.id,entityType:"opportunity",companyName:t.clientName??t.title,stage:t.stage,stageLabel:t.stage,temperature:t.temperature,lastContact:t.updatedAt,value:t.monthlyValue,tags:t.tags})}}},e.id))}):(0,t.jsx)("div",{className:"rounded-lg border border-white/14 bg-slate-900/55 p-3 text-center mt-3",children:(0,t.jsx)("p",{className:"text-xs text-slate-400",children:"âœ… Nenhuma prioridade urgente."})})})})]}),k.actions&&(0,t.jsxs)("section",{children:[(0,t.jsx)(eT,{icon:(0,t.jsx)(f.Zap,{className:"h-4 w-4 text-amber-500 fill-amber-500"}),title:"Acoes Rapidas",expanded:M.actions,onToggle:()=>E("actions"),accentColor:"amber"}),(0,t.jsx)(a.AnimatePresence,{children:M.actions&&(0,t.jsx)(l.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)(v.TooltipProvider,{children:(0,t.jsx)("div",{className:"mt-3 grid grid-cols-1 gap-2 [@media(min-width:1200px)]:grid-cols-2",children:A.map(e=>(0,t.jsx)(eA,{icon:e.icon,label:e.label,color:e.color,onClick:()=>(e=>{switch(e){case"whatsapp":i("/mensagem","WhatsApp");break;case"email":i("/mensagem","email");break;case"agendar":i("/followup");break;case"proposta":i("/pitch");break;case"funil":i("/funil");break;case"planos":i("/planos");break;case"resumo":i("/resumo");break;case"riscos":i("/riscos")}})(e.key),disabled:e.needsClient&&!j,tooltip:e.needsClient&&!j?"Selecione um cliente primeiro":void 0},e.key))})})})})]}),k.insights&&h.length>0&&(0,t.jsxs)("section",{children:[(0,t.jsx)(eT,{icon:(0,t.jsx)(ev.BarChart3,{className:"h-4 w-4 text-indigo-500"}),title:"Insights Inteligentes",count:h.length,expanded:M.insights,onToggle:()=>E("insights"),accentColor:"indigo"}),(0,t.jsx)(a.AnimatePresence,{children:M.insights&&(0,t.jsx)(l.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"space-y-2 mt-3",children:h.map(e=>(0,t.jsx)(eM,{title:e.title,description:e.description,metric:e.metric,actionLabel:e.actionLabel,onAction:e.actionCommand?()=>i(e.actionCommand):void 0},e.id))})})})]}),k.quickWins&&u.length>0&&(0,t.jsxs)("section",{children:[(0,t.jsx)(eT,{icon:(0,t.jsx)(ew.Trophy,{className:"h-4 w-4 text-emerald-500"}),title:"Ganhos Rapidos",count:u.length,expanded:M.quickWins,onToggle:()=>E("quickWins"),accentColor:"emerald"}),(0,t.jsx)(a.AnimatePresence,{children:M.quickWins&&(0,t.jsx)(l.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"space-y-2 mt-3",children:u.map(e=>(0,t.jsxs)("div",{onClick:()=>{let t=c.find(t=>t.id===e.opportunityId);t&&y.useIntelligenceStore.getState().selectClient({id:t.id,entityId:t.id,entityType:"opportunity",companyName:t.clientName??t.title,stage:t.stage,stageLabel:t.stage,temperature:t.temperature,lastContact:t.updatedAt,value:t.monthlyValue,tags:t.tags})},className:"group flex cursor-pointer items-center gap-3 rounded-lg border border-emerald-300/24 bg-emerald-400/8 p-3 transition-all hover:border-emerald-300/38 hover:shadow-sm",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"line-clamp-1 text-xs font-medium text-slate-100 transition-colors group-hover:text-emerald-100",children:e.clientName}),(0,t.jsxs)("p",{className:"text-[10px] text-slate-400 mt-0.5",children:[e.reason," Â· ",(0,ei.formatCurrencyBRL)(e.value),"/mes"]})]}),(0,t.jsx)("div",{className:"shrink-0 flex items-center gap-1.5",children:(0,t.jsxs)("div",{className:(0,d.cn)("h-7 w-7 rounded-full flex items-center justify-center text-[10px] font-bold",e.probability>=70?"bg-emerald-400/20 text-emerald-100":e.probability>=50?"bg-amber-400/20 text-amber-100":"bg-slate-700/70 text-slate-200"),children:[e.probability,"%"]})})]},e.id))})})})]}),k.risks&&g.length>0&&(0,t.jsxs)("section",{children:[(0,t.jsx)(eT,{icon:(0,t.jsx)(ej.ShieldAlert,{className:"h-4 w-4 text-red-500"}),title:"Alertas de Risco",count:g.length,expanded:M.risks,onToggle:()=>E("risks"),accentColor:"red"}),(0,t.jsx)(a.AnimatePresence,{children:M.risks&&(0,t.jsx)(l.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,t.jsx)("div",{className:"space-y-2 mt-3",children:g.map(e=>(0,t.jsxs)("div",{onClick:()=>{if(e.linkedEntityId){let t=c.find(t=>t.id===e.linkedEntityId);t&&y.useIntelligenceStore.getState().selectClient({id:t.id,entityId:t.id,entityType:"opportunity",companyName:t.clientName??t.title,stage:t.stage,stageLabel:t.stage,temperature:t.temperature,lastContact:t.updatedAt,value:t.monthlyValue,tags:t.tags})}},className:(0,d.cn)("rounded-lg border p-3 cursor-pointer transition-all","critical"===e.severity?"border-red-300/35 bg-red-500/12 hover:border-red-300/50":"border-amber-300/35 bg-amber-500/12 hover:border-amber-300/50"),children:[(0,t.jsx)("p",{className:(0,d.cn)("font-medium text-xs","critical"===e.severity?"text-red-100":"text-amber-100"),children:e.title}),(0,t.jsx)("p",{className:(0,d.cn)("text-[10px] mt-0.5","critical"===e.severity?"text-red-200":"text-amber-200"),children:e.description})]},e.id))})})})]}),e&&(0,t.jsxs)("section",{children:[(0,t.jsx)(eT,{icon:(0,t.jsx)(p.Target,{className:"h-4 w-4 text-violet-500"}),title:`Contexto: ${e.cardName}`,accentColor:"violet"}),(0,t.jsxs)("div",{className:"space-y-2 mt-3",children:[(0,t.jsx)(eM,{title:"hot"===e.temperature?"Lead quente!":"cold"===e.temperature?"Lead frio":"Lead morno",description:"hot"===e.temperature?"Momento ideal para avancar com proposta ou demonstracao.":"cold"===e.temperature?"Considere reengajamento antes de oferecer algo.":"Mantenha contato e identifique gatilhos de decisao.",actionLabel:"Analise completa",onAction:()=>i("/analise")}),e.registeredObjections.length>0&&(0,t.jsx)(eM,{title:`${e.registeredObjections.length} objecao(oes)`,description:"Use /objecao para preparar contra-argumentos personalizados.",actionLabel:"Quebrar objecao",onAction:()=>i("/objecao",e.registeredObjections[0])})]})]})]})})}function eT({icon:e,title:s,count:a,expanded:l,onToggle:i,accentColor:n="zinc"}){let r=(0,t.jsxs)(t.Fragment,{children:[e,(0,t.jsx)("h3",{className:"font-heading text-xs font-bold uppercase tracking-wider text-slate-400 flex-1 text-left",children:s}),"number"==typeof a&&a>0&&(0,t.jsx)("span",{className:(0,d.cn)("text-[10px] font-bold px-1.5 py-0.5 rounded-full","red"===n?"bg-red-500/22 text-red-100":"amber"===n?"bg-amber-500/22 text-amber-100":"emerald"===n?"bg-emerald-500/22 text-emerald-100":"violet"===n?"bg-violet-500/22 text-violet-100":"bg-indigo-500/22 text-indigo-100"),children:a})]});return i?(0,t.jsxs)("button",{type:"button",onClick:i,className:"flex items-center gap-2 w-full px-1 group",children:[r,(0,t.jsx)("span",{className:"text-slate-500 group-hover:text-slate-300 transition-colors",children:l?(0,t.jsx)(ey.ChevronUp,{className:"h-3.5 w-3.5"}):(0,t.jsx)(eN.ChevronDown,{className:"h-3.5 w-3.5"})})]}):(0,t.jsx)("div",{className:"flex items-center gap-2 w-full px-1",children:r})}function eI({severity:e,title:s,subtitle:a,type:l,onClick:i}){return(0,t.jsxs)("div",{onClick:i,className:(0,d.cn)("group flex items-start gap-3 p-3 rounded-lg border transition-all cursor-pointer","critical"===e?"border-red-300/30 bg-red-500/11 hover:border-red-300/45":"warning"===e?"border-amber-300/30 bg-amber-500/11 hover:border-amber-300/45":"border-white/14 bg-white/7 hover:border-cyan-300/30"),children:[(0,t.jsx)("div",{className:(0,d.cn)("h-6 w-6 shrink-0 rounded-full flex items-center justify-center mt-0.5","critical"===e?"bg-red-400/20":"warning"===e?"bg-amber-400/20":"bg-slate-700/65"),children:"overdue"===l?(0,t.jsx)(B.AlertTriangle,{className:(0,d.cn)("h-3 w-3","critical"===e?"text-red-100":"text-amber-100")}):"sla-warning"===l?(0,t.jsx)(I.Clock,{className:"h-3 w-3 text-red-100"}):"hot-idle"===l?(0,t.jsx)(f.Zap,{className:"h-3 w-3 fill-amber-100 text-amber-100"}):(0,t.jsx)(H.Calendar,{className:"h-3 w-3 text-slate-200"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-medium text-xs text-slate-100 line-clamp-1",children:s}),(0,t.jsx)("p",{className:"text-[10px] text-slate-400 mt-0.5 line-clamp-1",children:a})]}),(0,t.jsx)(ef.ArrowRight,{className:"h-3 w-3 text-slate-500 group-hover:text-slate-300 group-hover:translate-x-0.5 transition-all shrink-0 mt-1"})]})}function eA({label:e,icon:s,color:a,onClick:l,disabled:i,tooltip:n}){let r=(0,t.jsxs)("button",{onClick:i?void 0:l,disabled:i,className:(0,d.cn)("flex h-20 flex-col items-center justify-center gap-1.5 rounded-lg border p-2.5 text-sm font-medium transition-all",i?"cursor-not-allowed border-white/10 bg-slate-900/35 text-slate-500 opacity-50":a),children:[s,(0,t.jsx)("span",{className:"text-[10px]",children:e})]});return n?(0,t.jsxs)(v.Tooltip,{children:[(0,t.jsx)(v.TooltipTrigger,{asChild:!0,children:r}),(0,t.jsx)(v.TooltipContent,{side:"top",children:n})]}):r}function eM({title:e,description:s,metric:a,actionLabel:l,onAction:i}){return(0,t.jsxs)("div",{className:"group relative overflow-hidden rounded-lg border border-indigo-300/22 bg-indigo-400/8 p-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"font-semibold text-xs text-slate-100",children:e}),a&&(0,t.jsxs)("span",{className:(0,d.cn)("text-xs font-bold","up"===a.trend?"text-emerald-200":"down"===a.trend?"text-red-200":"text-slate-400"),children:[a.value," ","up"===a.trend?"â†‘":"down"===a.trend?"â†“":"â†’"]})]}),(0,t.jsx)("p",{className:"text-[10px] text-slate-300 leading-relaxed",children:s}),l&&i&&(0,t.jsxs)(w.Button,{variant:"link",className:"mt-1 h-auto p-0 text-[10px] text-cyan-200 hover:text-cyan-100",onClick:i,children:[l," ",(0,t.jsx)(ef.ArrowRight,{className:"h-2.5 w-2.5 ml-0.5"})]})]})}let eL={xl:"XL Â· 3 colunas",lg:"LG Â· Insights colapsÃ¡vel",md:"MD Â· 2 colunas + drawer",sm:"SM Â· Console + drawers",xs:"XS Â· Tabs internas"},e$=[{id:"client",label:"Cliente",icon:(0,t.jsx)(o.Users,{className:"h-3.5 w-3.5"})},{id:"console",label:"Console",icon:(0,t.jsx)(n,{className:"h-3.5 w-3.5"})},{id:"insights",label:"Insights",icon:(0,t.jsx)(r.Sparkles,{className:"h-3.5 w-3.5"})}];function eD(e){return e>=1440?"xl":e>=1200?"lg":e>=900?"md":e>=600?"sm":"xs"}function eE(){let[e,i]=(0,s.useState)(()=>eD(window.innerWidth)),[n,c]=(0,s.useState)("console"),[m,x]=(0,s.useState)({xl:{left:!0,right:!0},lg:{left:!0,right:!1},md:{left:!0,right:!1},sm:{left:!1,right:!1},xs:{left:!1,right:!1}});(0,s.useEffect)(()=>{let e=()=>i(eD(window.innerWidth));return window.addEventListener("resize",e,{passive:!0}),()=>window.removeEventListener("resize",e)},[]);let h=m[e]?.left??!1,u=m[e]?.right??!1,p="xs"===e,g="xl"===e||"lg"===e||"md"===e&&h,b="xl"===e||"lg"===e&&u,f="sm"===e&&h,j=("md"===e||"sm"===e)&&u,w=(0,s.useMemo)(()=>{let e=[];return g&&e.push("minmax(280px, 360px)"),e.push("minmax(0, 1fr)"),b&&e.push("minmax(300px, 380px)"),e.join(" ")},[g,b]);return(0,t.jsxs)("div",{className:"menux-intelligence-theme menux-intelligence-theme-full dark flex h-full min-h-0 w-full flex-col overflow-hidden",children:[(0,t.jsx)(S,{}),!p&&"xl"!==e&&(0,t.jsxs)("div",{className:"z-[95] flex shrink-0 items-center gap-2 border-b border-white/10 bg-slate-950/30 px-4 py-2 backdrop-blur-sm",children:[("md"===e||"sm"===e)&&(0,t.jsx)(eq,{active:h,label:"Clientes",icon:(0,t.jsx)(o.Users,{className:"h-3.5 w-3.5"}),onClick:()=>{x(t=>{let s=t[e],a=!s.left;return{...t,[e]:{left:a,right:("sm"!==e||!a)&&s.right}}})}}),("lg"===e||"md"===e||"sm"===e)&&(0,t.jsx)(eq,{active:u,label:"Insights",icon:(0,t.jsx)(r.Sparkles,{className:"h-3.5 w-3.5"}),onClick:()=>{x(t=>{let s=t[e],a=!s.right;return{...t,[e]:{left:("sm"!==e||!a)&&s.left,right:a}}})}}),(0,t.jsx)("span",{className:"ml-auto text-[10px] font-semibold uppercase tracking-wide text-slate-400",children:eL[e]})]}),p?(0,t.jsxs)("div",{className:"flex min-h-0 flex-1 flex-col overflow-hidden",children:[(0,t.jsx)("div",{className:"z-[95] shrink-0 border-b border-white/10 bg-slate-950/28 p-3 backdrop-blur-sm",children:(0,t.jsx)("div",{className:"grid grid-cols-3 gap-1 rounded-full border border-white/12 bg-white/6 p-1",children:e$.map(e=>{let s=e.id===n;return(0,t.jsxs)("button",{onClick:()=>c(e.id),className:(0,d.cn)("relative flex items-center justify-center gap-1.5 rounded-full px-3 py-2 text-xs font-medium transition-colors",s?"bg-white/12 text-slate-100":"text-slate-300 hover:bg-white/8 hover:text-slate-100"),children:[e.icon,(0,t.jsx)("span",{children:e.label})]},e.id)})})}),(0,t.jsx)("div",{className:"relative min-h-0 flex-1 overflow-hidden",children:(0,t.jsx)(a.AnimatePresence,{mode:"wait",children:(0,t.jsxs)(l.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},transition:{duration:.18,ease:"easeOut"},className:"h-full min-h-0 overflow-hidden",children:["client"===n&&(0,t.jsx)("section",{className:"menux-intelligence-surface h-full min-h-0 overflow-hidden",children:(0,t.jsx)(E,{})}),"console"===n&&(0,t.jsx)("section",{className:"h-full min-h-0 overflow-hidden",children:(0,t.jsx)(eg,{})}),"insights"===n&&(0,t.jsx)("section",{className:"menux-intelligence-surface h-full min-h-0 overflow-hidden",children:(0,t.jsx)(eS,{})})]},n)})})]}):(0,t.jsxs)("div",{className:"relative min-h-0 flex-1 overflow-hidden",children:[(0,t.jsxs)("div",{className:"grid h-full min-h-0 w-full overflow-hidden",style:{gridTemplateColumns:w},children:[g&&(0,t.jsx)("aside",{className:"menux-intelligence-surface min-h-0 min-w-0 overflow-hidden border-r border-white/10",children:(0,t.jsx)(E,{})}),(0,t.jsx)("main",{className:"relative min-h-0 min-w-0 overflow-hidden bg-transparent",children:(0,t.jsx)(eg,{})}),b&&(0,t.jsx)("aside",{className:"menux-intelligence-surface min-h-0 min-w-0 overflow-hidden border-l border-white/10 xl:sticky xl:top-0",children:(0,t.jsx)(eS,{})})]}),(0,t.jsx)(ez,{open:f,side:"left",title:"Clientes",onClose:()=>x(t=>({...t,[e]:{...t[e],left:!1}})),children:(0,t.jsx)(E,{})}),(0,t.jsx)(ez,{open:j,side:"right",title:"Insights",onClose:()=>x(t=>({...t,[e]:{...t[e],right:!1}})),children:(0,t.jsx)(eS,{})})]})]})}function eq({active:e,label:s,icon:a,onClick:l}){return(0,t.jsxs)("button",{onClick:l,className:(0,d.cn)("inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-xs font-medium transition-colors",e?"border-cyan-300/26 bg-cyan-500/16 text-cyan-100":"border-white/14 bg-white/7 text-slate-300 hover:bg-white/10 hover:text-slate-100"),children:[a,s]})}function ez({open:e,side:s,title:i,onClose:n,children:r}){return(0,t.jsx)(a.AnimatePresence,{children:e&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.motion.button,{type:"button","aria-label":"Fechar painel",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.18,ease:"easeOut"},onClick:n,className:"absolute inset-0 z-[190] bg-black/46 backdrop-blur-[2px]"}),(0,t.jsx)(l.motion.aside,{initial:{x:"left"===s?"-100%":"100%"},animate:{x:0,transition:{duration:.22,ease:[.22,.61,.36,1]}},exit:{x:"left"===s?"-100%":"100%",transition:{duration:.18,ease:[.4,0,1,1]}},className:(0,d.cn)("absolute inset-y-0 z-[200] w-[min(88vw,420px)] overflow-hidden","left"===s?"left-0 border-r border-white/10":"right-0 border-l border-white/10"),children:(0,t.jsxs)("div",{className:"menux-intelligence-surface flex h-full min-h-0 flex-col",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-4 py-3",children:[(0,t.jsx)("p",{className:"font-heading text-sm font-semibold text-slate-100",children:i}),(0,t.jsx)("button",{onClick:n,className:"rounded-lg p-1 text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-100",children:(0,t.jsx)(c.X,{className:"h-4 w-4"})})]}),(0,t.jsx)("div",{className:"min-h-0 flex-1 overflow-hidden",children:r})]})})]})})}e.s(["IntelligenceLayout",()=>eE],88015)}]);