module.exports=[30617,27999,24679,a=>{"use strict";var b=a.i(70106);let c=(0,b.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);a.s(["LayoutDashboard",()=>c],30617);let d=(0,b.default)("calendar-check",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);a.s(["CalendarCheck",()=>d],27999);let e=(0,b.default)("kanban",[["path",{d:"M5 3v14",key:"9nsxs2"}],["path",{d:"M12 3v8",key:"1h2ygw"}],["path",{d:"M19 3v18",key:"1sk56x"}]]);a.s(["Kanban",()=>e],24679)},9392,a=>{"use strict";let b={master:{canAccessIntelligence:!0,canBriefingAllCards:!0,canBriefingOwnCards:!0,canViewAllFunnel:!0,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!0,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!0},admin:{canAccessIntelligence:!0,canBriefingAllCards:!0,canBriefingOwnCards:!0,canViewAllFunnel:!0,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!0},comercial:{canAccessIntelligence:!0,canBriefingAllCards:!1,canBriefingOwnCards:!0,canViewAllFunnel:!1,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!1},cs:{canAccessIntelligence:!0,canBriefingAllCards:!1,canBriefingOwnCards:!0,canViewAllFunnel:!1,canViewOwnFunnel:!0,canGhostwrite:!0,canUseObjectionsAndPitch:!0,canQueryMenuxBase:!0,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!0,canSelectAllClientsInPicker:!1},leitura:{canAccessIntelligence:!1,canBriefingAllCards:!1,canBriefingOwnCards:!1,canViewAllFunnel:!1,canViewOwnFunnel:!1,canGhostwrite:!1,canUseObjectionsAndPitch:!1,canQueryMenuxBase:!1,canViewOthersHistory:!1,canReceiveProactiveSuggestions:!1,canSelectAllClientsInPicker:!1}};function c(a){let c=b[a];return c?.canAccessIntelligence??!1}a.s(["canAccessIntelligence",()=>c])},76865,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(45113),f=a.i(20226),g=a.i(62435);let h=(0,f.create)()((0,g.persist)(a=>({isExpanded:!0,toggle:()=>a(a=>({isExpanded:!a.isExpanded})),setExpanded:b=>a({isExpanded:b})}),{name:"flow-sidebar"}));var i=a.i(38246),j=a.i(71987),k=a.i(30617),l=a.i(27999),m=a.i(24679),n=a.i(60246),o=a.i(90166),p=a.i(21161),q=a.i(13749),r=a.i(50522),s=a.i(50429),t=a.i(8406),u=a.i(46271),v=a.i(62036),w=a.i(99570),x=a.i(85259),y=a.i(66206),z=a.i(9392);let A=[{label:"Dashboard",href:"/dashboard",icon:k.LayoutDashboard},{label:"Atividades",href:"/activities",icon:l.CalendarCheck,badge:3},{label:"Pipes",href:"/pipes",icon:m.Kanban},{label:"Clientes",href:"/clients",icon:n.Users},{label:"Financeiro",href:"/finance",icon:o.DollarSign,permission:"canViewFinance"},{label:"Metas",href:"/goals",icon:s.Target,permission:"canManageGoals"},{label:"Configurações",href:"/settings/general",icon:p.Settings,permission:"canManageSettings"}];function B(){let a=(0,d.usePathname)(),{isExpanded:f,toggle:g}=h(),{permissions:k,user:l}=(0,y.useAuthStore)(),m=function(a){let[b,d]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{},[a]),b}("(min-width: 768px)"),[n,o]=(0,c.useState)(!1),p=!!l?.role&&(0,z.canAccessIntelligence)(l.role);(0,c.useEffect)(()=>{(0,c.startTransition)(()=>{o(!1)})},[a]),(0,c.useEffect)(()=>{},[m]);let s=A.filter(a=>!a.permission||!!k&&k[a.permission]),B=!m||f;return(0,c.useEffect)(()=>{if(!m)return h.subscribe((a,b)=>{a.isExpanded!==b.isExpanded&&o(a=>!a)})},[m]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.AnimatePresence,{children:!m&&n&&(0,b.jsx)(u.motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 top-16 z-40 bg-black/30 backdrop-blur-sm",onClick:()=>o(!1)})}),(0,b.jsxs)("aside",{className:(0,e.cn)("fixed left-0 top-0 z-40 flex h-screen flex-col border-r border-zinc-200/70 bg-white/90 backdrop-blur-xl transition-[width,transform] duration-200 ease-[cubic-bezier(0.4,0,0.2,1)]",m?f?"w-60":"w-16":"w-60",!m&&!n&&"-translate-x-full"),children:[(0,b.jsx)("div",{className:"border-b border-zinc-200/80 p-3",children:(0,b.jsx)(i.default,{href:"/dashboard",onClick:()=>{m||o(!1)},className:(0,e.cn)("premium-shine flex h-11 items-center justify-center rounded-[14px] px-0 transition-colors","hover:bg-zinc-100/80"),children:(0,b.jsx)(v.AnimatePresence,{mode:"wait",children:B?(0,b.jsx)(u.motion.div,{initial:{opacity:0,x:-6},animate:{opacity:1,x:0},exit:{opacity:0,x:-6},transition:{duration:.14},children:(0,b.jsx)(j.default,{src:"/flow-logo.svg",alt:"Flow by Menux",width:84,height:22,priority:!0,className:"h-[22px] w-auto"})},"expanded-logo"):(0,b.jsx)(u.motion.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.14},className:"flex h-8 w-8 items-center justify-center rounded-full bg-brand/10 font-heading text-base font-semibold text-brand-strong",children:"F"},"collapsed-logo")})})}),(0,b.jsx)("nav",{className:"flex flex-1 flex-col gap-1 p-3",children:s.map(c=>{let d=a===c.href||a.startsWith(c.href+"/"),f=c.icon,g=c.badge&&c.badge>0,h=(0,b.jsxs)(i.default,{href:c.href,onClick:()=>{m||o(!1)},className:(0,e.cn)("premium-shine flex items-center gap-3 rounded-[15px] px-3 py-2.5 text-sm font-medium transition-colors duration-100",d?"bg-brand/10 text-brand-strong ring-1 ring-brand/15":"text-zinc-600 hover:bg-zinc-100/80 hover:text-black"),children:[(0,b.jsxs)("div",{className:"relative shrink-0",children:[(0,b.jsx)(f,{className:"h-5 w-5"}),g&&!B&&(0,b.jsx)("span",{className:"absolute -right-1.5 -top-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-status-danger text-[10px] font-bold text-white",children:c.badge})]}),(0,b.jsx)(v.AnimatePresence,{children:B&&(0,b.jsx)(u.motion.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"overflow-hidden whitespace-nowrap font-body",children:c.label})}),g&&B&&(0,b.jsx)("span",{className:"ml-auto flex h-5 w-5 items-center justify-center rounded-full bg-status-danger text-[10px] font-bold text-white",children:c.badge})]});return B?(0,b.jsx)("div",{children:h},c.href):(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:h}),(0,b.jsx)(x.TooltipContent,{side:"right",children:(0,b.jsx)("p",{children:c.label})})]},c.href)})}),p&&(0,b.jsx)("div",{className:"px-3 pb-3",children:(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(i.default,{href:"/intelligence",className:(0,e.cn)("premium-shine group flex items-center gap-3 rounded-[15px] px-3 py-2.5 text-sm font-medium transition-all duration-200","/intelligence"===a?"menux-intelligence-btn text-slate-100":"menux-intelligence-btn-soft"),onClick:()=>{m||o(!1)},children:[(0,b.jsxs)("div",{className:"relative shrink-0",children:[(0,b.jsx)(t.Sparkles,{className:(0,e.cn)("h-5 w-5 transition-transform duration-300","/intelligence"===a?"text-cyan-100":"text-cyan-200","group-hover:scale-110")}),"/intelligence"===a&&(0,b.jsx)("span",{className:"absolute inset-0 animate-ping rounded-full bg-white opacity-30"})]}),(0,b.jsx)(v.AnimatePresence,{children:B&&(0,b.jsx)(u.motion.span,{initial:{opacity:0,width:0},animate:{opacity:1,width:"auto"},exit:{opacity:0,width:0},transition:{duration:.15},className:"overflow-hidden whitespace-nowrap font-heading font-semibold",children:"Menux Intelligence"})})]})}),(0,b.jsx)(x.TooltipContent,{side:"right",children:(0,b.jsx)("p",{children:"Menux Intelligence"})})]})}),m&&(0,b.jsx)("div",{className:"border-t border-zinc-200 p-3",children:(0,b.jsx)(w.Button,{variant:"ghost",size:"icon",onClick:g,className:(0,e.cn)("h-9 w-9 rounded-full text-zinc-400 hover:bg-zinc-100 hover:text-zinc-700",f&&"ml-auto"),children:f?(0,b.jsx)(q.ChevronLeft,{className:"h-4 w-4"}):(0,b.jsx)(r.ChevronRight,{className:"h-4 w-4"})})})]})]})}function C({children:a}){let{isExpanded:f}=h(),g=(0,c.useRef)(null),i=(0,d.usePathname)(),j="/intelligence"===i||i.startsWith("/intelligence/");return(0,b.jsxs)("div",{className:"flex h-screen w-full overflow-hidden premium-mesh",children:[(0,b.jsx)(B,{}),(0,b.jsx)("div",{className:(0,e.cn)("flex min-w-0 flex-1 flex-col h-full relative transition-[margin-left] duration-200 ease-[cubic-bezier(0.4,0,0.2,1)]","ml-0 md:ml-0"),style:{marginLeft:f?"15rem":"4rem"},children:(0,b.jsx)("main",{ref:g,className:(0,e.cn)("flex-1 overflow-x-hidden",j?"overflow-hidden p-0":"overflow-y-auto px-6 pb-24 pt-4 md:pb-8"),children:a})})]})}a.s(["AppShell",()=>C],76865)},15171,85930,a=>{"use strict";let b=(0,a.i(70106).default)("handshake",[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]]);a.s(["Handshake",()=>b],15171);var c=a.i(87924),d=/[\\\/_+.#"@\[\(\{&]/,e=/[\\\/_+.#"@\[\(\{&]/g,f=/[\s-]/,g=/[\s-]/g;function h(a){return a.toLowerCase().replace(g," ")}var i=a.i(97942),j=a.i(72131);a.i(35112);var k=a.i(70121),l=Symbol.for("react.lazy"),m=j[" use ".trim().toString()];function n(a){var b;return null!=a&&"object"==typeof a&&"$$typeof"in a&&a.$$typeof===l&&"_payload"in a&&"object"==typeof(b=a._payload)&&null!==b&&"then"in b}var o=Symbol("radix.slottable");function p(a){return j.isValidElement(a)&&"function"==typeof a.type&&"__radixId"in a.type&&a.type.__radixId===o}var q=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,b)=>{var d,e;let f,g,h,i=(e=d=`Primitive.${b}`,(f=j.forwardRef((a,b)=>{let{children:c,...d}=a;if(n(c)&&"function"==typeof m&&(c=m(c._payload)),j.isValidElement(c)){var e;let a,f,g=(e=c,(f=(a=Object.getOwnPropertyDescriptor(e.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.ref:(f=(a=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?e.props.ref:e.props.ref||e.ref),h=function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{let b=f(...a);return e(...a),b}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(d,c.props);return c.type!==j.Fragment&&(h.ref=b?(0,k.composeRefs)(b,g):g),j.cloneElement(c,h)}return j.Children.count(c)>1?j.Children.only(null):null})).displayName=`${e}.SlotClone`,g=f,(h=j.forwardRef((a,b)=>{let{children:d,...e}=a;n(d)&&"function"==typeof m&&(d=m(d._payload));let f=j.Children.toArray(d),h=f.find(p);if(h){let a=h.props.children,d=f.map(b=>b!==h?b:j.Children.count(a)>1?j.Children.only(null):j.isValidElement(a)?a.props.children:null);return(0,c.jsx)(g,{...e,ref:b,children:j.isValidElement(a)?j.cloneElement(a,void 0,d):null})}return(0,c.jsx)(g,{...e,ref:b,children:d})})).displayName=`${d}.Slot`,h),l=j.forwardRef((a,d)=>{let{asChild:e,...f}=a;return(0,c.jsx)(e?i:b,{...f,ref:d})});return l.displayName=`Primitive.${b}`,{...a,[b]:l}},{}),r=a.i(92843),s='[cmdk-group=""]',t='[cmdk-group-items=""]',u='[cmdk-item=""]',v=`${u}:not([aria-disabled="true"])`,w="cmdk-item-select",x="data-value",y=(a,b,c)=>{var i;return i=a,function a(b,c,h,i,j,k,l){if(k===c.length)return j===b.length?1:.99;var m=`${j},${k}`;if(void 0!==l[m])return l[m];for(var n,o,p,q,r=i.charAt(k),s=h.indexOf(r,j),t=0;s>=0;)(n=a(b,c,h,i,s+1,k+1,l))>t&&(s===j?n*=1:d.test(b.charAt(s-1))?(n*=.8,(p=b.slice(j,s-1).match(e))&&j>0&&(n*=Math.pow(.999,p.length))):f.test(b.charAt(s-1))?(n*=.9,(q=b.slice(j,s-1).match(g))&&j>0&&(n*=Math.pow(.999,q.length))):(n*=.17,j>0&&(n*=Math.pow(.999,s-j))),b.charAt(s)!==c.charAt(k)&&(n*=.9999)),(n<.1&&h.charAt(s-1)===i.charAt(k+1)||i.charAt(k+1)===i.charAt(k)&&h.charAt(s-1)!==i.charAt(k))&&.1*(o=a(b,c,h,i,s+1,k+2,l))>n&&(n=.1*o),n>t&&(t=n),s=h.indexOf(r,s+1);return l[m]=t,t}(i=c&&c.length>0?`${i+" "+c.join(" ")}`:i,b,h(i),h(b),0,0,{})},z=j.createContext(void 0),A=j.createContext(void 0),B=j.createContext(void 0),C=j.forwardRef((a,b)=>{let c=M(()=>{var b,c;return{search:"",value:null!=(c=null!=(b=a.value)?b:a.defaultValue)?c:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),d=M(()=>new Set),e=M(()=>new Map),f=M(()=>new Map),g=M(()=>new Set),h=K(a),{label:i,children:k,value:l,onValueChange:m,filter:n,shouldFilter:o,loop:p,disablePointerSelection:B=!1,vimBindings:C=!0,...D}=a,E=(0,r.useId)(),F=(0,r.useId)(),G=(0,r.useId)(),H=j.useRef(null),I=P();L(()=>{if(void 0!==l){let a=l.trim();c.current.value=a,J.emit()}},[l]),L(()=>{I(6,V)},[]);let J=j.useMemo(()=>({subscribe:a=>(g.current.add(a),()=>g.current.delete(a)),snapshot:()=>c.current,setState:(a,b,d)=>{var e,f,g,i;if(!Object.is(c.current[a],b)){if(c.current[a]=b,"search"===a)U(),S(),I(1,T);else if("value"===a){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let a=document.getElementById(G);a?a.focus():null==(e=document.getElementById(E))||e.focus()}if(I(7,()=>{var a;c.current.selectedItemId=null==(a=W())?void 0:a.id,J.emit()}),d||I(5,V),(null==(f=h.current)?void 0:f.value)!==void 0){null==(i=(g=h.current).onValueChange)||i.call(g,null!=b?b:"");return}}J.emit()}},emit:()=>{g.current.forEach(a=>a())}}),[]),N=j.useMemo(()=>({value:(a,b,d)=>{var e;b!==(null==(e=f.current.get(a))?void 0:e.value)&&(f.current.set(a,{value:b,keywords:d}),c.current.filtered.items.set(a,O(b,d)),I(2,()=>{S(),J.emit()}))},item:(a,b)=>(d.current.add(a),b&&(e.current.has(b)?e.current.get(b).add(a):e.current.set(b,new Set([a]))),I(3,()=>{U(),S(),c.current.value||T(),J.emit()}),()=>{f.current.delete(a),d.current.delete(a),c.current.filtered.items.delete(a);let b=W();I(4,()=>{U(),(null==b?void 0:b.getAttribute("id"))===a&&T(),J.emit()})}),group:a=>(e.current.has(a)||e.current.set(a,new Set),()=>{f.current.delete(a),e.current.delete(a)}),filter:()=>h.current.shouldFilter,label:i||a["aria-label"],getDisablePointerSelection:()=>h.current.disablePointerSelection,listId:E,inputId:G,labelId:F,listInnerRef:H}),[]);function O(a,b){var d,e;let f=null!=(e=null==(d=h.current)?void 0:d.filter)?e:y;return a?f(a,c.current.search,b):0}function S(){if(!c.current.search||!1===h.current.shouldFilter)return;let a=c.current.filtered.items,b=[];c.current.filtered.groups.forEach(c=>{let d=e.current.get(c),f=0;d.forEach(b=>{f=Math.max(a.get(b),f)}),b.push([c,f])});let d=H.current;X().sort((b,c)=>{var d,e;let f=b.getAttribute("id"),g=c.getAttribute("id");return(null!=(d=a.get(g))?d:0)-(null!=(e=a.get(f))?e:0)}).forEach(a=>{let b=a.closest(t);b?b.appendChild(a.parentElement===b?a:a.closest(`${t} > *`)):d.appendChild(a.parentElement===d?a:a.closest(`${t} > *`))}),b.sort((a,b)=>b[1]-a[1]).forEach(a=>{var b;let c=null==(b=H.current)?void 0:b.querySelector(`${s}[${x}="${encodeURIComponent(a[0])}"]`);null==c||c.parentElement.appendChild(c)})}function T(){let a=X().find(a=>"true"!==a.getAttribute("aria-disabled")),b=null==a?void 0:a.getAttribute(x);J.setState("value",b||void 0)}function U(){var a,b,g,i;if(!c.current.search||!1===h.current.shouldFilter){c.current.filtered.count=d.current.size;return}c.current.filtered.groups=new Set;let j=0;for(let e of d.current){let d=O(null!=(b=null==(a=f.current.get(e))?void 0:a.value)?b:"",null!=(i=null==(g=f.current.get(e))?void 0:g.keywords)?i:[]);c.current.filtered.items.set(e,d),d>0&&j++}for(let[a,b]of e.current)for(let d of b)if(c.current.filtered.items.get(d)>0){c.current.filtered.groups.add(a);break}c.current.filtered.count=j}function V(){var a,b,c;let d=W();d&&((null==(a=d.parentElement)?void 0:a.firstChild)===d&&(null==(c=null==(b=d.closest(s))?void 0:b.querySelector('[cmdk-group-heading=""]'))||c.scrollIntoView({block:"nearest"})),d.scrollIntoView({block:"nearest"}))}function W(){var a;return null==(a=H.current)?void 0:a.querySelector(`${u}[aria-selected="true"]`)}function X(){var a;return Array.from((null==(a=H.current)?void 0:a.querySelectorAll(v))||[])}function Y(a){let b=X()[a];b&&J.setState("value",b.getAttribute(x))}function Z(a){var b;let c=W(),d=X(),e=d.findIndex(a=>a===c),f=d[e+a];null!=(b=h.current)&&b.loop&&(f=e+a<0?d[d.length-1]:e+a===d.length?d[0]:d[e+a]),f&&J.setState("value",f.getAttribute(x))}function $(a){let b=W(),c=null==b?void 0:b.closest(s),d;for(;c&&!d;)d=null==(c=a>0?function(a,b){let c=a.nextElementSibling;for(;c;){if(c.matches(b))return c;c=c.nextElementSibling}}(c,s):function(a,b){let c=a.previousElementSibling;for(;c;){if(c.matches(b))return c;c=c.previousElementSibling}}(c,s))?void 0:c.querySelector(v);d?J.setState("value",d.getAttribute(x)):Z(a)}let _=()=>Y(X().length-1),aa=a=>{a.preventDefault(),a.metaKey?_():a.altKey?$(1):Z(1)},ab=a=>{a.preventDefault(),a.metaKey?Y(0):a.altKey?$(-1):Z(-1)};return j.createElement(q.div,{ref:b,tabIndex:-1,...D,"cmdk-root":"",onKeyDown:a=>{var b;null==(b=D.onKeyDown)||b.call(D,a);let c=a.nativeEvent.isComposing||229===a.keyCode;if(!(a.defaultPrevented||c))switch(a.key){case"n":case"j":C&&a.ctrlKey&&aa(a);break;case"ArrowDown":aa(a);break;case"p":case"k":C&&a.ctrlKey&&ab(a);break;case"ArrowUp":ab(a);break;case"Home":a.preventDefault(),Y(0);break;case"End":a.preventDefault(),_();break;case"Enter":{a.preventDefault();let b=W();if(b){let a=new Event(w);b.dispatchEvent(a)}}}}},j.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:R},i),Q(a,a=>j.createElement(A.Provider,{value:J},j.createElement(z.Provider,{value:N},a))))}),D=j.forwardRef((a,b)=>{var c,d;let e=(0,r.useId)(),f=j.useRef(null),g=j.useContext(B),h=j.useContext(z),i=K(a),l=null!=(d=null==(c=i.current)?void 0:c.forceMount)?d:null==g?void 0:g.forceMount;L(()=>{if(!l)return h.item(e,null==g?void 0:g.id)},[l]);let m=O(e,f,[a.value,a.children,f],a.keywords),n=j.useContext(A),o=N(a=>a.value&&a.value===m.current),p=N(a=>!!l||!1===h.filter()||!a.search||a.filtered.items.get(e)>0);function s(){var a,b;t(),null==(b=(a=i.current).onSelect)||b.call(a,m.current)}function t(){n.setState("value",m.current,!0)}if(j.useEffect(()=>{let b=f.current;if(!(!b||a.disabled))return b.addEventListener(w,s),()=>b.removeEventListener(w,s)},[p,a.onSelect,a.disabled]),!p)return null;let{disabled:u,value:v,onSelect:x,forceMount:y,keywords:C,...D}=a;return j.createElement(q.div,{ref:(0,k.composeRefs)(f,b),...D,id:e,"cmdk-item":"",role:"option","aria-disabled":!!u,"aria-selected":!!o,"data-disabled":!!u,"data-selected":!!o,onPointerMove:u||h.getDisablePointerSelection()?void 0:t,onClick:u?void 0:s},a.children)}),E=j.forwardRef((a,b)=>{let{heading:c,children:d,forceMount:e,...f}=a,g=(0,r.useId)(),h=j.useRef(null),i=j.useRef(null),l=(0,r.useId)(),m=j.useContext(z),n=N(a=>!!e||!1===m.filter()||!a.search||a.filtered.groups.has(g));L(()=>m.group(g),[]),O(g,h,[a.value,a.heading,i]);let o=j.useMemo(()=>({id:g,forceMount:e}),[e]);return j.createElement(q.div,{ref:(0,k.composeRefs)(h,b),...f,"cmdk-group":"",role:"presentation",hidden:!n||void 0},c&&j.createElement("div",{ref:i,"cmdk-group-heading":"","aria-hidden":!0,id:l},c),Q(a,a=>j.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":c?l:void 0},j.createElement(B.Provider,{value:o},a))))}),F=j.forwardRef((a,b)=>{let{alwaysRender:c,...d}=a,e=j.useRef(null),f=N(a=>!a.search);return c||f?j.createElement(q.div,{ref:(0,k.composeRefs)(e,b),...d,"cmdk-separator":"",role:"separator"}):null}),G=j.forwardRef((a,b)=>{let{onValueChange:c,...d}=a,e=null!=a.value,f=j.useContext(A),g=N(a=>a.search),h=N(a=>a.selectedItemId),i=j.useContext(z);return j.useEffect(()=>{null!=a.value&&f.setState("search",a.value)},[a.value]),j.createElement(q.input,{ref:b,...d,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":i.listId,"aria-labelledby":i.labelId,"aria-activedescendant":h,id:i.inputId,type:"text",value:e?a.value:g,onChange:a=>{e||f.setState("search",a.target.value),null==c||c(a.target.value)}})}),H=j.forwardRef((a,b)=>{let{children:c,label:d="Suggestions",...e}=a,f=j.useRef(null),g=j.useRef(null),h=N(a=>a.selectedItemId),i=j.useContext(z);return j.useEffect(()=>{if(g.current&&f.current){let a=g.current,b=f.current,c,d=new ResizeObserver(()=>{c=requestAnimationFrame(()=>{let c=a.offsetHeight;b.style.setProperty("--cmdk-list-height",c.toFixed(1)+"px")})});return d.observe(a),()=>{cancelAnimationFrame(c),d.unobserve(a)}}},[]),j.createElement(q.div,{ref:(0,k.composeRefs)(f,b),...e,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":h,"aria-label":d,id:i.listId},Q(a,a=>j.createElement("div",{ref:(0,k.composeRefs)(g,i.listInnerRef),"cmdk-list-sizer":""},a)))}),I=j.forwardRef((a,b)=>{let{open:c,onOpenChange:d,overlayClassName:e,contentClassName:f,container:g,...h}=a;return j.createElement(i.Root,{open:c,onOpenChange:d},j.createElement(i.Portal,{container:g},j.createElement(i.Overlay,{"cmdk-overlay":"",className:e}),j.createElement(i.Content,{"aria-label":a.label,"cmdk-dialog":"",className:f},j.createElement(C,{ref:b,...h}))))}),J=Object.assign(C,{List:H,Item:D,Input:G,Group:E,Separator:F,Dialog:I,Empty:j.forwardRef((a,b)=>N(a=>0===a.filtered.count)?j.createElement(q.div,{ref:b,...a,"cmdk-empty":"",role:"presentation"}):null),Loading:j.forwardRef((a,b)=>{let{progress:c,children:d,label:e="Loading...",...f}=a;return j.createElement(q.div,{ref:b,...f,"cmdk-loading":"",role:"progressbar","aria-valuenow":c,"aria-valuemin":0,"aria-valuemax":100,"aria-label":e},Q(a,a=>j.createElement("div",{"aria-hidden":!0},a)))})});function K(a){let b=j.useRef(a);return L(()=>{b.current=a}),b}var L=j.useEffect;function M(a){let b=j.useRef();return void 0===b.current&&(b.current=a()),b}function N(a){let b=j.useContext(A),c=()=>a(b.snapshot());return j.useSyncExternalStore(b.subscribe,c,c)}function O(a,b,c,d=[]){let e=j.useRef(),f=j.useContext(z);return L(()=>{var g;let h=(()=>{var a;for(let b of c){if("string"==typeof b)return b.trim();if("object"==typeof b&&"current"in b)return b.current?null==(a=b.current.textContent)?void 0:a.trim():e.current}})(),i=d.map(a=>a.trim());f.value(a,h,i),null==(g=b.current)||g.setAttribute(x,h),e.current=h}),e}var P=()=>{let[a,b]=j.useState(),c=M(()=>new Map);return L(()=>{c.current.forEach(a=>a()),c.current=new Map},[a]),(a,d)=>{c.current.set(a,d),b({})}};function Q({asChild:a,children:b},c){let d;return a&&j.isValidElement(b)?j.cloneElement("function"==typeof(d=b.type)?d(b.props):"render"in d?d.render(b.props):b,{ref:b.ref},c(b.props.children)):c(b)}var R={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"},S=a.i(50537),S=S,T=a.i(68114),U=a.i(14574);function V({className:a,...b}){return(0,c.jsx)(J,{"data-slot":"command",className:(0,T.cn)("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",a),...b})}function W({title:a="Command Palette",description:b="Search for a command to run...",children:d,className:e,showCloseButton:f=!0,...g}){return(0,c.jsxs)(U.Dialog,{...g,children:[(0,c.jsxs)(U.DialogHeader,{className:"sr-only",children:[(0,c.jsx)(U.DialogTitle,{children:a}),(0,c.jsx)(U.DialogDescription,{children:b})]}),(0,c.jsx)(U.DialogContent,{className:(0,T.cn)("overflow-hidden p-0",e),showCloseButton:f,children:(0,c.jsx)(V,{className:"[&_[cmdk-group-heading]]:text-muted-foreground **:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group]]:px-2 [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:d})})]})}function X({className:a,...b}){return(0,c.jsxs)("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[(0,c.jsx)(S.default,{className:"size-4 shrink-0 opacity-50"}),(0,c.jsx)(J.Input,{"data-slot":"command-input",className:(0,T.cn)("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",a),...b})]})}function Y({className:a,...b}){return(0,c.jsx)(J.List,{"data-slot":"command-list",className:(0,T.cn)("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",a),...b})}function Z({...a}){return(0,c.jsx)(J.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...a})}function $({className:a,...b}){return(0,c.jsx)(J.Group,{"data-slot":"command-group",className:(0,T.cn)("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",a),...b})}function _({className:a,...b}){return(0,c.jsx)(J.Separator,{"data-slot":"command-separator",className:(0,T.cn)("bg-border -mx-1 h-px",a),...b})}function aa({className:a,...b}){return(0,c.jsx)(J.Item,{"data-slot":"command-item",className:(0,T.cn)("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",a),...b})}a.s(["Command",()=>V,"CommandDialog",()=>W,"CommandEmpty",()=>Z,"CommandGroup",()=>$,"CommandInput",()=>X,"CommandItem",()=>aa,"CommandList",()=>Y,"CommandSeparator",()=>_],85930)},57061,a=>{"use strict";var b=a.i(87924),c=a.i(22262),d=a.i(33783),e=a.i(68114);function f({...a}){return(0,b.jsx)(d.Dialog.Root,{"data-slot":"sheet",...a})}function g({...a}){return(0,b.jsx)(d.Dialog.Portal,{"data-slot":"sheet-portal",...a})}function h({className:a,...c}){return(0,b.jsx)(d.Dialog.Overlay,{"data-slot":"sheet-overlay",className:(0,e.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50 backdrop-blur-[2px] duration-300",a),...c})}function i({className:a,children:f,side:i="right",showCloseButton:j=!0,...k}){return(0,b.jsxs)(g,{children:[(0,b.jsx)(h,{}),(0,b.jsxs)(d.Dialog.Content,{"data-slot":"sheet-content",className:(0,e.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-2xl transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===i&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===i&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===i&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===i&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",a),...k,children:[f,j&&(0,b.jsxs)(d.Dialog.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,b.jsx)(c.XIcon,{className:"size-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function j({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sheet-header",className:(0,e.cn)("flex flex-col gap-1.5 p-4",a),...c})}function k({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sheet-footer",className:(0,e.cn)("mt-auto flex flex-col gap-2 p-4",a),...c})}function l({className:a,...c}){return(0,b.jsx)(d.Dialog.Title,{"data-slot":"sheet-title",className:(0,e.cn)("text-foreground font-semibold",a),...c})}a.s(["Sheet",()=>f,"SheetContent",()=>i,"SheetFooter",()=>k,"SheetHeader",()=>j,"SheetTitle",()=>l])},78020,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(33508),e=a.i(63519),f=a.i(45222),g=a.i(65151),h=a.i(92258),i=a.i(41675),j=a.i(70106);let k=(0,j.default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var l=a.i(90166),m=a.i(46842),n=a.i(60246);let o=(0,j.default)("store",[["path",{d:"M15 21v-5a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v5",key:"slp6dd"}],["path",{d:"M17.774 10.31a1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.451 0 1.12 1.12 0 0 0-1.548 0 2.5 2.5 0 0 1-3.452 0 1.12 1.12 0 0 0-1.549 0 2.5 2.5 0 0 1-3.77-3.248l2.889-4.184A2 2 0 0 1 7 2h10a2 2 0 0 1 1.653.873l2.895 4.192a2.5 2.5 0 0 1-3.774 3.244",key:"o0xfot"}],["path",{d:"M4 10.95V19a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8.05",key:"wn3emo"}]]);var p=a.i(41710),q=a.i(16106),r=a.i(6021),s=a.i(91361),t=a.i(17755),u=a.i(67900),v=a.i(15618),w=a.i(81560),x=a.i(21374),y=a.i(3314),z=a.i(50522),A=a.i(33441),B=a.i(16201),C=a.i(99464);let D=(0,j.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var E=a.i(24987),F=a.i(24669),G=a.i(4720),H=a.i(32860),I=a.i(73570),J=a.i(69520),K=a.i(96221),L=a.i(5784),M=a.i(90669),N=a.i(69012);let O=(0,j.default)("instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);var P=a.i(52495);let Q=(0,j.default)("utensils-crossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);var R=a.i(5151);let S=(0,j.default)("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),T=(0,j.default)("coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]),U=(0,j.default)("beer",[["path",{d:"M17 11h1a3 3 0 0 1 0 6h-1",key:"1yp76v"}],["path",{d:"M9 12v6",key:"1u1cab"}],["path",{d:"M13 12v6",key:"1sugkk"}],["path",{d:"M14 7.5c-1 0-1.44.5-3 .5s-2-.5-3-.5-1.72.5-2.5.5a2.5 2.5 0 0 1 0-5c.78 0 1.57.5 2.5.5S9.44 2 11 2s2 1.5 3 1.5 1.72-.5 2.5-.5a2.5 2.5 0 0 1 0 5c-.78 0-1.5-.5-2.5-.5Z",key:"1510fo"}],["path",{d:"M5 8v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V8",key:"19jb7n"}]]),V=(0,j.default)("pizza",[["path",{d:"m12 14-1 1",key:"11onhr"}],["path",{d:"m13.75 18.25-1.25 1.42",key:"1yisr3"}],["path",{d:"M17.775 5.654a15.68 15.68 0 0 0-12.121 12.12",key:"1qtqk6"}],["path",{d:"M18.8 9.3a1 1 0 0 0 2.1 7.7",key:"fbbbr2"}],["path",{d:"M21.964 20.732a1 1 0 0 1-1.232 1.232l-18-5a1 1 0 0 1-.695-1.232A19.68 19.68 0 0 1 15.732 2.037a1 1 0 0 1 1.232.695z",key:"1hyfdd"}]]),W=(0,j.default)("shopping-basket",[["path",{d:"m15 11-1 9",key:"5wnq3a"}],["path",{d:"m19 11-4-7",key:"cnml18"}],["path",{d:"M2 11h20",key:"3eubbj"}],["path",{d:"m3.5 11 1.6 7.4a2 2 0 0 0 2 1.6h9.8a2 2 0 0 0 2-1.6l1.7-7.4",key:"yiazzp"}],["path",{d:"M4.5 15.5h15",key:"13mye1"}],["path",{d:"m5 11 4-7",key:"116ra9"}],["path",{d:"m9 11 1 9",key:"1ojof7"}]]),X=(0,j.default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),Y=(0,j.default)("glass-water",[["path",{d:"M5.116 4.104A1 1 0 0 1 6.11 3h11.78a1 1 0 0 1 .994 1.105L17.19 20.21A2 2 0 0 1 15.2 22H8.8a2 2 0 0 1-2-1.79z",key:"p55z4y"}],["path",{d:"M6 12a5 5 0 0 1 6 0 5 5 0 0 0 6 0",key:"mjntcy"}]]),Z=(0,j.default)("chef-hat",[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]]),$=(0,j.default)("wine",[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]]);var _=a.i(16221),aa=a.i(46271),ab=a.i(62036),ac=a.i(68114),ad=a.i(99570),ae=a.i(5084);let af={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function ag(a){return (b={})=>{let c=b.width?String(b.width):a.defaultWidth;return a.formats[c]||a.formats[a.defaultWidth]}}let ah={date:ag({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:ag({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:ag({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},ai={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function aj(a){return(b,c)=>{let d;if("formatting"===(c?.context?String(c.context):"standalone")&&a.formattingValues){let b=a.defaultFormattingWidth||a.defaultWidth,e=c?.width?String(c.width):b;d=a.formattingValues[e]||a.formattingValues[b]}else{let b=a.defaultWidth,e=c?.width?String(c.width):a.defaultWidth;d=a.values[e]||a.values[b]}return d[a.argumentCallback?a.argumentCallback(b):b]}}function ak(a){return(b,c={})=>{let d,e=c.width,f=e&&a.matchPatterns[e]||a.matchPatterns[a.defaultMatchWidth],g=b.match(f);if(!g)return null;let h=g[0],i=e&&a.parsePatterns[e]||a.parsePatterns[a.defaultParseWidth],j=Array.isArray(i)?function(a,b){for(let c=0;c<a.length;c++)if(b(a[c]))return c}(i,a=>a.test(h)):function(a,b){for(let c in a)if(Object.prototype.hasOwnProperty.call(a,c)&&b(a[c]))return c}(i,a=>a.test(h));return d=a.valueCallback?a.valueCallback(j):j,{value:d=c.valueCallback?c.valueCallback(d):d,rest:b.slice(h.length)}}}function al(a){return(b,c={})=>{let d=b.match(a.matchPattern);if(!d)return null;let e=d[0],f=b.match(a.parsePattern);if(!f)return null;let g=a.valueCallback?a.valueCallback(f[0]):f[0];return{value:g=c.valueCallback?c.valueCallback(g):g,rest:b.slice(e.length)}}}let am={code:"en-US",formatDistance:(a,b,c)=>{let d,e=af[a];if(d="string"==typeof e?e:1===b?e.one:e.other.replace("{{count}}",b.toString()),c?.addSuffix)if(c.comparison&&c.comparison>0)return"in "+d;else return d+" ago";return d},formatLong:ah,formatRelative:(a,b,c,d)=>ai[a],localize:{ordinalNumber:(a,b)=>{let c=Number(a),d=c%100;if(d>20||d<10)switch(d%10){case 1:return c+"st";case 2:return c+"nd";case 3:return c+"rd"}return c+"th"},era:aj({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:aj({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:a=>a-1}),month:aj({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:aj({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:aj({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:al({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:a=>parseInt(a,10)}),era:ak({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:ak({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:a=>a+1}),month:ak({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:ak({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:ak({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},an={},ao=Symbol.for("constructDateFrom");function ap(a,b){return"function"==typeof a?a(b):a&&"object"==typeof a&&ao in a?a[ao](b):a instanceof Date?new a.constructor(b):new Date(b)}function aq(a,b){return ap(b||a,a)}function ar(a){let b=aq(a),c=new Date(Date.UTC(b.getFullYear(),b.getMonth(),b.getDate(),b.getHours(),b.getMinutes(),b.getSeconds(),b.getMilliseconds()));return c.setUTCFullYear(b.getFullYear()),a-c}function as(a,b){let c=aq(a,b?.in);return c.setHours(0,0,0,0),c}function at(a,b){let c=b?.weekStartsOn??b?.locale?.options?.weekStartsOn??an.weekStartsOn??an.locale?.options?.weekStartsOn??0,d=aq(a,b?.in),e=d.getDay();return d.setDate(d.getDate()-(7*(e<c)+e-c)),d.setHours(0,0,0,0),d}function au(a,b){return at(a,{...b,weekStartsOn:1})}function av(a,b){let c=aq(a,b?.in),d=c.getFullYear(),e=ap(c,0);e.setFullYear(d+1,0,4),e.setHours(0,0,0,0);let f=au(e),g=ap(c,0);g.setFullYear(d,0,4),g.setHours(0,0,0,0);let h=au(g);return c.getTime()>=f.getTime()?d+1:c.getTime()>=h.getTime()?d:d-1}function aw(a,b){let c=aq(a,b?.in),d=c.getFullYear(),e=b?.firstWeekContainsDate??b?.locale?.options?.firstWeekContainsDate??an.firstWeekContainsDate??an.locale?.options?.firstWeekContainsDate??1,f=ap(b?.in||a,0);f.setFullYear(d+1,0,e),f.setHours(0,0,0,0);let g=at(f,b),h=ap(b?.in||a,0);h.setFullYear(d,0,e),h.setHours(0,0,0,0);let i=at(h,b);return+c>=+g?d+1:+c>=+i?d:d-1}function ax(a,b){let c=Math.abs(a).toString().padStart(b,"0");return(a<0?"-":"")+c}let ay={y(a,b){let c=a.getFullYear(),d=c>0?c:1-c;return ax("yy"===b?d%100:d,b.length)},M(a,b){let c=a.getMonth();return"M"===b?String(c+1):ax(c+1,2)},d:(a,b)=>ax(a.getDate(),b.length),a(a,b){let c=a.getHours()/12>=1?"pm":"am";switch(b){case"a":case"aa":return c.toUpperCase();case"aaa":return c;case"aaaaa":return c[0];default:return"am"===c?"a.m.":"p.m."}},h:(a,b)=>ax(a.getHours()%12||12,b.length),H:(a,b)=>ax(a.getHours(),b.length),m:(a,b)=>ax(a.getMinutes(),b.length),s:(a,b)=>ax(a.getSeconds(),b.length),S(a,b){let c=b.length;return ax(Math.trunc(a.getMilliseconds()*Math.pow(10,c-3)),b.length)}},az={G:function(a,b,c){let d=+(a.getFullYear()>0);switch(b){case"G":case"GG":case"GGG":return c.era(d,{width:"abbreviated"});case"GGGGG":return c.era(d,{width:"narrow"});default:return c.era(d,{width:"wide"})}},y:function(a,b,c){if("yo"===b){let b=a.getFullYear();return c.ordinalNumber(b>0?b:1-b,{unit:"year"})}return ay.y(a,b)},Y:function(a,b,c,d){let e=aw(a,d),f=e>0?e:1-e;return"YY"===b?ax(f%100,2):"Yo"===b?c.ordinalNumber(f,{unit:"year"}):ax(f,b.length)},R:function(a,b){return ax(av(a),b.length)},u:function(a,b){return ax(a.getFullYear(),b.length)},Q:function(a,b,c){let d=Math.ceil((a.getMonth()+1)/3);switch(b){case"Q":return String(d);case"QQ":return ax(d,2);case"Qo":return c.ordinalNumber(d,{unit:"quarter"});case"QQQ":return c.quarter(d,{width:"abbreviated",context:"formatting"});case"QQQQQ":return c.quarter(d,{width:"narrow",context:"formatting"});default:return c.quarter(d,{width:"wide",context:"formatting"})}},q:function(a,b,c){let d=Math.ceil((a.getMonth()+1)/3);switch(b){case"q":return String(d);case"qq":return ax(d,2);case"qo":return c.ordinalNumber(d,{unit:"quarter"});case"qqq":return c.quarter(d,{width:"abbreviated",context:"standalone"});case"qqqqq":return c.quarter(d,{width:"narrow",context:"standalone"});default:return c.quarter(d,{width:"wide",context:"standalone"})}},M:function(a,b,c){let d=a.getMonth();switch(b){case"M":case"MM":return ay.M(a,b);case"Mo":return c.ordinalNumber(d+1,{unit:"month"});case"MMM":return c.month(d,{width:"abbreviated",context:"formatting"});case"MMMMM":return c.month(d,{width:"narrow",context:"formatting"});default:return c.month(d,{width:"wide",context:"formatting"})}},L:function(a,b,c){let d=a.getMonth();switch(b){case"L":return String(d+1);case"LL":return ax(d+1,2);case"Lo":return c.ordinalNumber(d+1,{unit:"month"});case"LLL":return c.month(d,{width:"abbreviated",context:"standalone"});case"LLLLL":return c.month(d,{width:"narrow",context:"standalone"});default:return c.month(d,{width:"wide",context:"standalone"})}},w:function(a,b,c,d){let e,f,g,h,i=Math.round((at(e=aq(a,d?.in),d)-(f=d?.firstWeekContainsDate??d?.locale?.options?.firstWeekContainsDate??an.firstWeekContainsDate??an.locale?.options?.firstWeekContainsDate??1,g=aw(e,d),(h=ap(d?.in||e,0)).setFullYear(g,0,f),h.setHours(0,0,0,0),at(h,d)))/6048e5)+1;return"wo"===b?c.ordinalNumber(i,{unit:"week"}):ax(i,b.length)},I:function(a,b,c){let d,e,f,g=Math.round((au(d=aq(a,void 0))-(e=av(d,void 0),(f=ap(d,0)).setFullYear(e,0,4),f.setHours(0,0,0,0),au(f)))/6048e5)+1;return"Io"===b?c.ordinalNumber(g,{unit:"week"}):ax(g,b.length)},d:function(a,b,c){return"do"===b?c.ordinalNumber(a.getDate(),{unit:"date"}):ay.d(a,b)},D:function(a,b,c){let d,e,f=function(a,b,c){let[d,e]=function(a,...b){let c=ap.bind(null,a||b.find(a=>"object"==typeof a));return b.map(c)}(void 0,a,b),f=as(d),g=as(e);return Math.round((f-ar(f)-(g-ar(g)))/864e5)}(d=aq(a,void 0),((e=aq(d,void 0)).setFullYear(e.getFullYear(),0,1),e.setHours(0,0,0,0),e))+1;return"Do"===b?c.ordinalNumber(f,{unit:"dayOfYear"}):ax(f,b.length)},E:function(a,b,c){let d=a.getDay();switch(b){case"E":case"EE":case"EEE":return c.day(d,{width:"abbreviated",context:"formatting"});case"EEEEE":return c.day(d,{width:"narrow",context:"formatting"});case"EEEEEE":return c.day(d,{width:"short",context:"formatting"});default:return c.day(d,{width:"wide",context:"formatting"})}},e:function(a,b,c,d){let e=a.getDay(),f=(e-d.weekStartsOn+8)%7||7;switch(b){case"e":return String(f);case"ee":return ax(f,2);case"eo":return c.ordinalNumber(f,{unit:"day"});case"eee":return c.day(e,{width:"abbreviated",context:"formatting"});case"eeeee":return c.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return c.day(e,{width:"short",context:"formatting"});default:return c.day(e,{width:"wide",context:"formatting"})}},c:function(a,b,c,d){let e=a.getDay(),f=(e-d.weekStartsOn+8)%7||7;switch(b){case"c":return String(f);case"cc":return ax(f,b.length);case"co":return c.ordinalNumber(f,{unit:"day"});case"ccc":return c.day(e,{width:"abbreviated",context:"standalone"});case"ccccc":return c.day(e,{width:"narrow",context:"standalone"});case"cccccc":return c.day(e,{width:"short",context:"standalone"});default:return c.day(e,{width:"wide",context:"standalone"})}},i:function(a,b,c){let d=a.getDay(),e=0===d?7:d;switch(b){case"i":return String(e);case"ii":return ax(e,b.length);case"io":return c.ordinalNumber(e,{unit:"day"});case"iii":return c.day(d,{width:"abbreviated",context:"formatting"});case"iiiii":return c.day(d,{width:"narrow",context:"formatting"});case"iiiiii":return c.day(d,{width:"short",context:"formatting"});default:return c.day(d,{width:"wide",context:"formatting"})}},a:function(a,b,c){let d=a.getHours()/12>=1?"pm":"am";switch(b){case"a":case"aa":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"aaa":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return c.dayPeriod(d,{width:"narrow",context:"formatting"});default:return c.dayPeriod(d,{width:"wide",context:"formatting"})}},b:function(a,b,c){let d,e=a.getHours();switch(d=12===e?"noon":0===e?"midnight":e/12>=1?"pm":"am",b){case"b":case"bb":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"bbb":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return c.dayPeriod(d,{width:"narrow",context:"formatting"});default:return c.dayPeriod(d,{width:"wide",context:"formatting"})}},B:function(a,b,c){let d,e=a.getHours();switch(d=e>=17?"evening":e>=12?"afternoon":e>=4?"morning":"night",b){case"B":case"BB":case"BBB":return c.dayPeriod(d,{width:"abbreviated",context:"formatting"});case"BBBBB":return c.dayPeriod(d,{width:"narrow",context:"formatting"});default:return c.dayPeriod(d,{width:"wide",context:"formatting"})}},h:function(a,b,c){if("ho"===b){let b=a.getHours()%12;return 0===b&&(b=12),c.ordinalNumber(b,{unit:"hour"})}return ay.h(a,b)},H:function(a,b,c){return"Ho"===b?c.ordinalNumber(a.getHours(),{unit:"hour"}):ay.H(a,b)},K:function(a,b,c){let d=a.getHours()%12;return"Ko"===b?c.ordinalNumber(d,{unit:"hour"}):ax(d,b.length)},k:function(a,b,c){let d=a.getHours();return(0===d&&(d=24),"ko"===b)?c.ordinalNumber(d,{unit:"hour"}):ax(d,b.length)},m:function(a,b,c){return"mo"===b?c.ordinalNumber(a.getMinutes(),{unit:"minute"}):ay.m(a,b)},s:function(a,b,c){return"so"===b?c.ordinalNumber(a.getSeconds(),{unit:"second"}):ay.s(a,b)},S:function(a,b){return ay.S(a,b)},X:function(a,b,c){let d=a.getTimezoneOffset();if(0===d)return"Z";switch(b){case"X":return aB(d);case"XXXX":case"XX":return aC(d);default:return aC(d,":")}},x:function(a,b,c){let d=a.getTimezoneOffset();switch(b){case"x":return aB(d);case"xxxx":case"xx":return aC(d);default:return aC(d,":")}},O:function(a,b,c){let d=a.getTimezoneOffset();switch(b){case"O":case"OO":case"OOO":return"GMT"+aA(d,":");default:return"GMT"+aC(d,":")}},z:function(a,b,c){let d=a.getTimezoneOffset();switch(b){case"z":case"zz":case"zzz":return"GMT"+aA(d,":");default:return"GMT"+aC(d,":")}},t:function(a,b,c){return ax(Math.trunc(a/1e3),b.length)},T:function(a,b,c){return ax(+a,b.length)}};function aA(a,b=""){let c=a>0?"-":"+",d=Math.abs(a),e=Math.trunc(d/60),f=d%60;return 0===f?c+String(e):c+String(e)+b+ax(f,2)}function aB(a,b){return a%60==0?(a>0?"-":"+")+ax(Math.abs(a)/60,2):aC(a,b)}function aC(a,b=""){let c=Math.abs(a);return(a>0?"-":"+")+ax(Math.trunc(c/60),2)+b+ax(c%60,2)}let aD=(a,b)=>{switch(a){case"P":return b.date({width:"short"});case"PP":return b.date({width:"medium"});case"PPP":return b.date({width:"long"});default:return b.date({width:"full"})}},aE=(a,b)=>{switch(a){case"p":return b.time({width:"short"});case"pp":return b.time({width:"medium"});case"ppp":return b.time({width:"long"});default:return b.time({width:"full"})}},aF={p:aE,P:(a,b)=>{let c,d=a.match(/(P+)(p+)?/)||[],e=d[1],f=d[2];if(!f)return aD(a,b);switch(e){case"P":c=b.dateTime({width:"short"});break;case"PP":c=b.dateTime({width:"medium"});break;case"PPP":c=b.dateTime({width:"long"});break;default:c=b.dateTime({width:"full"})}return c.replace("{{date}}",aD(e,b)).replace("{{time}}",aE(f,b))}},aG=/^D+$/,aH=/^Y+$/,aI=["D","DD","YY","YYYY"],aJ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,aK=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,aL=/^'([^]*?)'?$/,aM=/''/g,aN=/[a-zA-Z]/;function aO(a,b,c){let d=c?.locale??an.locale??am,e=c?.firstWeekContainsDate??c?.locale?.options?.firstWeekContainsDate??an.firstWeekContainsDate??an.locale?.options?.firstWeekContainsDate??1,f=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??an.weekStartsOn??an.locale?.options?.weekStartsOn??0,g=aq(a,c?.in);if(!(g instanceof Date||"object"==typeof g&&"[object Date]"===Object.prototype.toString.call(g))&&"number"!=typeof g||isNaN(+aq(g)))throw RangeError("Invalid time value");let h=b.match(aK).map(a=>{let b=a[0];return"p"===b||"P"===b?(0,aF[b])(a,d.formatLong):a}).join("").match(aJ).map(a=>{if("''"===a)return{isToken:!1,value:"'"};let b=a[0];if("'"===b){var c;let b;return{isToken:!1,value:(b=(c=a).match(aL))?b[1].replace(aM,"'"):c}}if(az[b])return{isToken:!0,value:a};if(b.match(aN))throw RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:a}});d.localize.preprocessor&&(h=d.localize.preprocessor(g,h));let i={firstWeekContainsDate:e,weekStartsOn:f,locale:d};return h.map(e=>{if(!e.isToken)return e.value;let f=e.value;return(!c?.useAdditionalWeekYearTokens&&aH.test(f)||!c?.useAdditionalDayOfYearTokens&&aG.test(f))&&function(a,b,c){var d,e,f;let g,h=(d=a,e=b,f=c,g="Y"===d[0]?"years":"days of the month",`Use \`${d.toLowerCase()}\` instead of \`${d}\` (in \`${e}\`) for formatting ${g} to the input \`${f}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`);if(console.warn(h),aI.includes(a))throw RangeError(h)}(f,b,String(a)),(0,az[f[0]])(g,f,d.localize,i)}).join("")}let aP={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 mês",other:"cerca de {{count}} meses"},xMonths:{one:"1 mês",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},aQ={date:ag({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},defaultWidth:"full"}),time:ag({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:ag({formats:{full:"{{date}} 'às' {{time}}",long:"{{date}} 'às' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},aR={lastWeek:a=>{let b=a.getDay();return"'"+(0===b||6===b?"último":"última")+"' eeee 'às' p"},yesterday:"'ontem às' p",today:"'hoje às' p",tomorrow:"'amanhã às' p",nextWeek:"eeee 'às' p",other:"P"},aS={code:"pt-BR",formatDistance:(a,b,c)=>{let d,e=aP[a];if(d="string"==typeof e?e:1===b?e.one:e.other.replace("{{count}}",String(b)),c?.addSuffix)if(c.comparison&&c.comparison>0)return"em "+d;else return"há "+d;return d},formatLong:aQ,formatRelative:(a,b,c,d)=>{let e=aR[a];return"function"==typeof e?e(b):e},localize:{ordinalNumber:(a,b)=>{let c=Number(a);return b?.unit==="week"?c+"ª":c+"º"},era:aj({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},defaultWidth:"wide"}),quarter:aj({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},defaultWidth:"wide",argumentCallback:a=>a-1}),month:aj({values:{narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},defaultWidth:"wide"}),day:aj({values:{narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","terça","quarta","quinta","sexta","sábado"],wide:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"]},defaultWidth:"wide"}),dayPeriod:aj({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:al({matchPattern:/^(\d+)[ºªo]?/i,parsePattern:/\d+/i,valueCallback:a=>parseInt(a,10)}),era:ak({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},defaultParseWidth:"any"}),quarter:ak({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:a=>a+1}),month:ak({matchPatterns:{narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|março|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},defaultParseWidth:"any"}),day:ak({matchPatterns:{narrow:/^(dom|[23456]ª?|s[aá]b)/i,short:/^(dom|[23456]ª?|s[aá]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[aá]b)/i,wide:/^(domingo|(segunda|ter[cç]a|quarta|quinta|sexta)([- ]feira)?|s[aá]bado)/i},defaultMatchWidth:"wide",parsePatterns:{short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[aá]b/i]},defaultParseWidth:"any"}),dayPeriod:ak({matchPatterns:{narrow:/^(a|p|mn|md|(da) (manhã|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manhã|tarde|noite))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manhã/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},aT=(0,j.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var aU=a.i(92e3),aV=a.i(86304),aW=a.i(35732);let aX={presencial:"Visita Presencial",remoto:"Reunião Remota",outro:"Outro"},aY={agendada:"Agendada",realizada:"Realizada",cancelada:"Cancelada"},aZ={agendada:"bg-blue-100 text-blue-700",realizada:"bg-green-100 text-green-700",cancelada:"bg-red-100 text-red-700"};function a$({visit:a,isExpanded:c,isLocked:e=!1,onToggleDetails:f,onStatusChange:g,onReschedule:h,onDuplicate:j,onFollowUp:k,onDelete:l}){let n="presencial"===a.type?a.location:"remoto"===a.type?a.platform||"Online":"Outro",o="agendada"===a.status,q="cancelada"===a.status;return(0,b.jsxs)("div",{className:(0,ac.cn)("group relative rounded-2xl border bg-white transition-all duration-200",c?"border-brand/30 shadow-[0_8px_24px_rgba(0,0,0,0.08)] ring-1 ring-brand/10":"border-zinc-100 hover:border-zinc-200 hover:shadow-sm"),children:[(0,b.jsxs)("div",{className:"flex cursor-pointer items-start gap-4 p-4",onClick:f,children:[(0,b.jsx)("div",{className:(0,ac.cn)("flex h-12 w-12 shrink-0 items-center justify-center rounded-2xl border transition-colors","presencial"===a.type?"border-purple-100 bg-purple-50 text-purple-600":"remoto"===a.type?"border-blue-100 bg-blue-50 text-blue-600":"border-zinc-200 bg-zinc-50 text-zinc-500"),children:"presencial"===a.type?(0,b.jsx)(E.MapPin,{className:"h-6 w-6"}):"remoto"===a.type?(0,b.jsx)(aT,{className:"h-6 w-6"}):(0,b.jsx)(i.Calendar,{className:"h-6 w-6"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:(0,ac.cn)("font-heading text-sm font-semibold transition-colors",c?"text-brand":"text-zinc-900",q&&"text-zinc-500 line-through decoration-zinc-400"),children:a.title||aX[a.type]}),(0,b.jsx)("p",{className:"truncate text-xs text-zinc-500",children:n||"Sem local definido"})]}),(0,b.jsx)(aV.Badge,{variant:"secondary",className:(0,ac.cn)("shrink-0 rounded-full px-2.5 py-0.5 text-[10px] font-bold uppercase tracking-wide",aZ[a.status]),children:aY[a.status]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-1 pt-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500",children:[(0,b.jsx)(i.Calendar,{className:"h-3.5 w-3.5 text-zinc-400"}),(0,b.jsx)("span",{className:"font-medium text-zinc-700",children:(a=>{if(!a)return"--/--";let b="string"==typeof a?new Date(a):a;if(isNaN(b.getTime()))return"--/--";let c=new Date;return b.getDate()===c.getDate()&&b.getMonth()===c.getMonth()&&b.getFullYear()===c.getFullYear()?`Hoje, ${aO(b,"HH:mm")}`:aO(b,"dd/MM, HH:mm",{locale:aS})})(a.startAt||(a.date&&a.time?`${a.date}T${a.time}`:void 0))})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500",children:[(0,b.jsx)(m.User,{className:"h-3.5 w-3.5 text-zinc-400"}),(0,b.jsx)("span",{className:"truncate max-w-[120px]",children:a.responsible||"Sem responsável"})]}),a.durationMinutes?(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-zinc-500",children:[(0,b.jsx)(p.Clock,{className:"h-3.5 w-3.5 text-zinc-400"}),(0,b.jsxs)("span",{children:[a.durationMinutes," min"]})]}):null]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-t border-zinc-50 bg-zinc-50/50 px-4 py-2 rounded-b-2xl",children:[(0,b.jsx)(ad.Button,{size:"sm",variant:"ghost",className:(0,ac.cn)("h-8 -ml-2 gap-1.5 rounded-full px-3 text-xs font-medium transition-colors hover:bg-white hover:shadow-sm",c?"text-brand bg-brand/5":"text-zinc-600"),onClick:f,children:c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d.X,{className:"h-3.5 w-3.5"})," Fechar detalhes"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Plus,{className:"h-3.5 w-3.5"})," Ver detalhes"]})}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[o&&!e&&(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)(ad.Button,{size:"sm",variant:"ghost",className:"h-8 gap-1.5 rounded-full px-3 text-xs font-medium text-green-700 hover:bg-green-50 hover:text-green-800",onClick:()=>g(a.id,"realizada"),children:[(0,b.jsx)(B.CheckCircle,{className:"h-3.5 w-3.5"}),"Realizada"]})}),(0,b.jsxs)(aW.DropdownMenu,{children:[(0,b.jsx)(aW.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(ad.Button,{size:"sm",variant:"ghost",className:"h-8 w-8 rounded-full p-0 text-zinc-400 hover:bg-white hover:text-zinc-600 hover:shadow-sm",disabled:e,children:(0,b.jsx)(t.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(aW.DropdownMenuContent,{align:"end",className:"w-48 rounded-xl p-1",children:[o&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>h(a.id,1),children:[(0,b.jsx)(J.RefreshCw,{className:"mr-2 h-3.5 w-3.5"}),"Reagendar (+1 dia)"]}),(0,b.jsxs)(aW.DropdownMenuItem,{className:"text-red-600 focus:text-red-700 focus:bg-red-50",onClick:()=>g(a.id,"cancelada"),children:[(0,b.jsx)(d.X,{className:"mr-2 h-3.5 w-3.5"}),"Cancelar visita"]}),(0,b.jsx)(aW.DropdownMenuSeparator,{})]}),(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>j(a.id),children:[(0,b.jsx)(R.Copy,{className:"mr-2 h-3.5 w-3.5"}),"Duplicar"]}),(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>k(a),children:[(0,b.jsx)(v.Plus,{className:"mr-2 h-3.5 w-3.5"}),"Criar follow-up"]}),(0,b.jsx)(aW.DropdownMenuSeparator,{}),(0,b.jsxs)(aW.DropdownMenuItem,{className:"text-red-600 focus:text-red-700 focus:bg-red-50",onClick:()=>l(a.id),children:[(0,b.jsx)(w.Trash2,{className:"mr-2 h-3.5 w-3.5"}),"Excluir"]})]})]})]})]}),(0,b.jsx)(ab.AnimatePresence,{children:c&&(0,b.jsx)(aa.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2,ease:"easeInOut"},className:"overflow-hidden border-t border-zinc-100 bg-zinc-50/50",children:(0,b.jsxs)("div",{className:"grid gap-4 p-5 text-sm",children:[a.objective&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h5",{className:"font-heading text-xs font-bold uppercase tracking-wider text-zinc-400",children:"Objetivo"}),(0,b.jsx)("p",{className:"text-zinc-700 leading-relaxed",children:a.objective})]}),a.result&&(0,b.jsxs)("div",{className:"space-y-1 rounded-lg bg-green-50/50 p-3 border border-green-100",children:[(0,b.jsxs)("h5",{className:"flex items-center gap-1.5 font-heading text-xs font-bold uppercase tracking-wider text-green-700",children:[(0,b.jsx)(B.CheckCircle,{className:"h-3 w-3"})," Resultado"]}),(0,b.jsx)("p",{className:"text-zinc-700 leading-relaxed",children:a.result})]}),a.cancellationReason&&(0,b.jsxs)("div",{className:"space-y-1 rounded-lg bg-red-50/50 p-3 border border-red-100",children:[(0,b.jsxs)("h5",{className:"flex items-center gap-1.5 font-heading text-xs font-bold uppercase tracking-wider text-red-700",children:[(0,b.jsx)(aU.AlertCircle,{className:"h-3 w-3"})," Motivo do Cancelamento"]}),(0,b.jsx)("p",{className:"text-zinc-700 leading-relaxed",children:a.cancellationReason})]}),a.details&&(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h5",{className:"font-heading text-xs font-bold uppercase tracking-wider text-zinc-400",children:"Detalhes Internos"}),(0,b.jsx)("p",{className:"text-zinc-600 leading-relaxed whitespace-pre-wrap",children:a.details})]}),a.link&&"remoto"===a.type&&(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsxs)(ad.Button,{variant:"outline",className:"h-9 gap-2 w-full justify-start text-zinc-700 hover:text-brand hover:border-brand/30",onClick:()=>window.open(a.link,"_blank"),children:[(0,b.jsx)(aT,{className:"h-4 w-4"}),"Entrar na reunião agora",(0,b.jsx)(P.ExternalLink,{className:"ml-auto h-3 w-3 opacity-50"})]})})]})})})]})}var a_=a.i(66718),a0=a.i(70430),a1=a.i(43904),a2=a.i(53168),a3=a.i(63658),a4=a.i(187),a5=a.i(7554),a6=a.i(50104),a7=a.i(24050),a8=a.i(77192);a.i(35112);var a9=a.i(11011),ba=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((a,d)=>{let e=(0,a9.createSlot)(`Primitive.${d}`),f=c.forwardRef((a,c)=>{let{asChild:f,...g}=a;return(0,b.jsx)(f?e:d,{...g,ref:c})});return f.displayName=`Primitive.${d}`,{...a,[d]:f}},{}),bb=a.i(7827),bc=a.i(25152),bd=a.i(92843),be="Tabs",[bf,bg]=(0,a6.createContextScope)(be,[a7.createRovingFocusGroupScope]),bh=(0,a7.createRovingFocusGroupScope)(),[bi,bj]=bf(be),bk=c.forwardRef((a,c)=>{let{__scopeTabs:d,value:e,onValueChange:f,defaultValue:g,orientation:h="horizontal",dir:i,activationMode:j="automatic",...k}=a,l=(0,bb.useDirection)(i),[m,n]=(0,bc.useControllableState)({prop:e,onChange:f,defaultProp:g??"",caller:be});return(0,b.jsx)(bi,{scope:d,baseId:(0,bd.useId)(),value:m,onValueChange:n,orientation:h,dir:l,activationMode:j,children:(0,b.jsx)(ba.div,{dir:l,"data-orientation":h,...k,ref:c})})});bk.displayName=be;var bl="TabsList",bm=c.forwardRef((a,c)=>{let{__scopeTabs:d,loop:e=!0,...f}=a,g=bj(bl,d),h=bh(d);return(0,b.jsx)(a7.Root,{asChild:!0,...h,orientation:g.orientation,dir:g.dir,loop:e,children:(0,b.jsx)(ba.div,{role:"tablist","aria-orientation":g.orientation,...f,ref:c})})});bm.displayName=bl;var bn="TabsTrigger",bo=c.forwardRef((a,c)=>{let{__scopeTabs:d,value:e,disabled:f=!1,...g}=a,h=bj(bn,d),i=bh(d),j=br(h.baseId,e),k=bs(h.baseId,e),l=e===h.value;return(0,b.jsx)(a7.Item,{asChild:!0,...i,focusable:!f,active:l,children:(0,b.jsx)(ba.button,{type:"button",role:"tab","aria-selected":l,"aria-controls":k,"data-state":l?"active":"inactive","data-disabled":f?"":void 0,disabled:f,id:j,...g,ref:c,onMouseDown:(0,a5.composeEventHandlers)(a.onMouseDown,a=>{f||0!==a.button||!1!==a.ctrlKey?a.preventDefault():h.onValueChange(e)}),onKeyDown:(0,a5.composeEventHandlers)(a.onKeyDown,a=>{[" ","Enter"].includes(a.key)&&h.onValueChange(e)}),onFocus:(0,a5.composeEventHandlers)(a.onFocus,()=>{let a="manual"!==h.activationMode;l||f||!a||h.onValueChange(e)})})})});bo.displayName=bn;var bp="TabsContent",bq=c.forwardRef((a,d)=>{let{__scopeTabs:e,value:f,forceMount:g,children:h,...i}=a,j=bj(bp,e),k=br(j.baseId,f),l=bs(j.baseId,f),m=f===j.value,n=c.useRef(m);return c.useEffect(()=>{let a=requestAnimationFrame(()=>n.current=!1);return()=>cancelAnimationFrame(a)},[]),(0,b.jsx)(a8.Presence,{present:g||m,children:({present:c})=>(0,b.jsx)(ba.div,{"data-state":m?"active":"inactive","data-orientation":j.orientation,role:"tabpanel","aria-labelledby":k,hidden:!c,id:l,tabIndex:0,...i,ref:d,style:{...a.style,animationDuration:n.current?"0s":void 0},children:c&&h})})});function br(a,b){return`${a}-trigger-${b}`}function bs(a,b){return`${a}-content-${b}`}bq.displayName=bp,a.s(["Content",()=>bq,"List",()=>bm,"Root",()=>bk,"Tabs",()=>bk,"TabsContent",()=>bq,"TabsList",()=>bm,"TabsTrigger",()=>bo,"Trigger",()=>bo,"createTabsScope",()=>bg],44135);var bt=a.i(44135),bt=bt;function bu({className:a,orientation:c="horizontal",...d}){return(0,b.jsx)(bt.Root,{"data-slot":"tabs","data-orientation":c,orientation:c,className:(0,ac.cn)("group/tabs flex gap-2 data-[orientation=horizontal]:flex-col",a),...d})}let bv=(0,a4.cva)("rounded-lg p-[3px] group-data-[orientation=horizontal]/tabs:h-9 data-[variant=line]:rounded-none group/tabs-list text-muted-foreground inline-flex w-fit items-center justify-center group-data-[orientation=vertical]/tabs:h-fit group-data-[orientation=vertical]/tabs:flex-col",{variants:{variant:{default:"bg-muted",line:"gap-1 bg-transparent"}},defaultVariants:{variant:"default"}});function bw({className:a,variant:c="default",...d}){return(0,b.jsx)(bt.List,{"data-slot":"tabs-list","data-variant":c,className:(0,ac.cn)(bv({variant:c}),a),...d})}function bx({className:a,...c}){return(0,b.jsx)(bt.Trigger,{"data-slot":"tabs-trigger",className:(0,ac.cn)("focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring text-foreground/60 hover:text-foreground dark:text-muted-foreground dark:hover:text-foreground relative inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-all group-data-[orientation=vertical]/tabs:w-full group-data-[orientation=vertical]/tabs:justify-start focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 group-data-[variant=default]/tabs-list:data-[state=active]:shadow-sm group-data-[variant=line]/tabs-list:data-[state=active]:shadow-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4","group-data-[variant=line]/tabs-list:bg-transparent group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:border-transparent dark:group-data-[variant=line]/tabs-list:data-[state=active]:bg-transparent","data-[state=active]:bg-background dark:data-[state=active]:text-foreground dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 data-[state=active]:text-foreground","after:bg-foreground after:absolute after:opacity-0 after:transition-opacity group-data-[orientation=horizontal]/tabs:after:inset-x-0 group-data-[orientation=horizontal]/tabs:after:bottom-[-5px] group-data-[orientation=horizontal]/tabs:after:h-0.5 group-data-[orientation=vertical]/tabs:after:inset-y-0 group-data-[orientation=vertical]/tabs:after:-right-1 group-data-[orientation=vertical]/tabs:after:w-0.5 group-data-[variant=line]/tabs-list:data-[state=active]:after:opacity-100",a),...c})}function by({className:a,...c}){return(0,b.jsx)(bt.Content,{"data-slot":"tabs-content",className:(0,ac.cn)("flex-1 outline-none",a),...c})}var bz=a.i(80701),bA=a.i(29246),bB=a.i(69876),bC=a.i(14574),bD=a.i(86192),bE=a.i(30455),bF=a.i(31791);a.i(42651);var bG=a.i(76535);let bH={text:"Texto curto",textarea:"Texto longo",number:"Número decimal",integer:"Número inteiro",currency:"Moeda (R$)",percentage:"Porcentagem (%)",url:"URL",email:"E-mail",phone:"Telefone",date:"Data",time:"Hora",datetime:"Data e hora",select:"Seleção única",multiselect:"Múltipla seleção",boolean:"Sim/Não",user:"Usuário",contact:"Contato",file:"Arquivo"},bI={text:"Para nomes, títulos e textos curtos",textarea:"Para descrições e observações longas",number:"Valores numéricos com decimais",integer:"Valores numéricos inteiros exatos",currency:"Valores monetários formatados em R$",percentage:"Valores em porcentagem (%)",url:"Links e endereços de sites",email:"Endereços de e-mail válidos",phone:"Números de telefone ou WhatsApp",date:"Para selecionar uma data específica",time:"Para definir um horário",datetime:"Data e hora combinadas",select:"Escolher uma única opção",multiselect:"Escolher múltiplas opções",boolean:"Verdadeiro ou Falso (Sim/Não)",user:"Vincular a um usuário do sistema",contact:"Vincular a um contato salvo",file:"Anexar documentos ou imagens"},bJ={"lead-in":[{id:"sf-lead-in-1",stageId:"lead-in",key:"origem_lead",label:"Origem do Lead",type:"select",required:!0,order:0,isActive:!0,options:[{label:"Google",value:"google"},{label:"Indicação",value:"indicacao"},{label:"Instagram",value:"instagram"},{label:"Outros",value:"outros"}]},{id:"sf-lead-in-2",stageId:"lead-in",key:"decisor",label:"Nome do Decisor",type:"text",order:1,isActive:!0,placeholder:"Quem decide a compra?"}],"contato-feito":[{id:"sf-contato-feito-1",stageId:"contato-feito",key:"interesse",label:"Nível de Interesse",type:"select",order:0,isActive:!0,options:[{label:"Alto",value:"alto"},{label:"Médio",value:"medio"},{label:"Baixo",value:"baixo"}]},{id:"sf-contato-feito-2",stageId:"contato-feito",key:"melhor_horario",label:"Melhor Horário para Contato",type:"text",order:1,isActive:!0,placeholder:"Ex: Manhã, após as 14h..."},{id:"sf-contato-feito-3",stageId:"contato-feito",key:"dores_cliente",label:"Principais Dores",type:"textarea",order:2,isActive:!0,placeholder:"Descreva as dificuldades atuais do cliente..."}],"reuniao-agendada":[{id:"sf-reuniao-1",stageId:"reuniao-agendada",key:"data_reuniao",label:"Data da Reunião",type:"date",required:!0,order:0,isActive:!0},{id:"sf-reuniao-2",stageId:"reuniao-agendada",key:"pauta",label:"Pauta da Reunião",type:"textarea",order:1,isActive:!0,placeholder:"O que será discutido?"},{id:"sf-reuniao-3",stageId:"reuniao-agendada",key:"participantes",label:"Participantes Esperados",type:"text",order:2,isActive:!0,helperText:"Separe por vírgulas"}],"proposta-enviada":[{id:"sf-proposta-1",stageId:"proposta-enviada",key:"valor_proposta",label:"Valor da Proposta (R$)",type:"currency",required:!0,order:0,isActive:!0},{id:"sf-proposta-2",stageId:"proposta-enviada",key:"link_proposta",label:"Link da Proposta",type:"url",order:1,isActive:!0,placeholder:"URL do documento"},{id:"sf-proposta-3",stageId:"proposta-enviada",key:"prazo_validade",label:"Validade da Proposta",type:"date",order:2,isActive:!0}],negociacao:[{id:"sf-negociacao-1",stageId:"negociacao",key:"objecoes",label:"Objeções Levantadas",type:"textarea",order:0,isActive:!0},{id:"sf-negociacao-2",stageId:"negociacao",key:"desconto_aprovado",label:"Desconto Aprovado (%)",type:"percentage",order:1,isActive:!0,validationRules:{min:0,max:100}},{id:"sf-negociacao-3",stageId:"negociacao",key:"concorrentes",label:"Concorrentes Envolvidos",type:"text",order:2,isActive:!0}],fechamento:[{id:"sf-fechamento-1",stageId:"fechamento",key:"data_assinatura",label:"Data de Assinatura",type:"date",required:!0,order:0,isActive:!0},{id:"sf-fechamento-2",stageId:"fechamento",key:"contrato_anexado",label:"Contrato Assinado",type:"file",order:1,isActive:!0,helperText:"PDF ou Imagem"},{id:"sf-fechamento-3",stageId:"fechamento",key:"obs_finais",label:"Observações Finais",type:"textarea",order:2,isActive:!0}]};function bK(a){return!!(null==a||"string"==typeof a&&""===a.trim()||Array.isArray(a)&&0===a.length)}let bL=(0,j.default)("layout-list",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);var bM=a.i(99209),bN=a.i(85930),bO=a.i(20226),bP=a.i(62435);function bQ(a,b){return`${a}:${b}`}let bR=(0,bO.create)()((0,bP.devtools)((a,b)=>({opportunityId:null,opportunityStage:null,fieldDefinitions:{},fieldValues:{},fieldSaveStates:{},fieldErrors:{},isSaving:!1,isLoadingFields:!1,isChangingStage:!1,loadError:null,banner:null,isNewFieldModalOpen:!1,initForOpportunity:(c,d,e)=>{let f={};for(let[a,b]of Object.entries(bJ))f[a]=b.filter(a=>a.isActive);let g=bQ(c,d),h=b().fieldValues[g];a({opportunityId:c,opportunityStage:d,fieldDefinitions:f,fieldValues:{...b().fieldValues,[g]:h??e??{}},fieldSaveStates:{},fieldErrors:{},isSaving:!1,isLoadingFields:!1,isChangingStage:!1,loadError:null,banner:null,isNewFieldModalOpen:!1})},updateFieldValue:(c,d)=>{let{opportunityId:e,opportunityStage:f,fieldValues:g}=b();if(!e||!f)return;let h=bQ(e,f),i={...g[h]||{},[c]:d},j={...b().fieldErrors};delete j[c],a({fieldValues:{...g,[h]:i},fieldErrors:j,banner:null,fieldSaveStates:{...b().fieldSaveStates,[c]:"saving"}}),setTimeout(()=>{a(a=>({fieldSaveStates:{...a.fieldSaveStates,[c]:"saved"}})),setTimeout(()=>{a(a=>({fieldSaveStates:{...a.fieldSaveStates,[c]:"idle"}}))},1400)},280)},saveAllFields:()=>{let{opportunityId:c,opportunityStage:d,fieldDefinitions:e,fieldValues:f}=b();if(!c||!d)return;let g=e[d]||[],h=f[bQ(c,d)]||{},i={},j=[];for(let a of g){let b=function(a,b){if(a.required&&bK(b))return"Preencha este campo para avançar etapa.";if(bK(b))return null;let c=a.validationRules;if(!c)return null;if("string"==typeof b){if(c.minLength&&b.length<c.minLength)return`M\xednimo ${c.minLength} caracteres.`;if(c.maxLength&&b.length>c.maxLength)return`M\xe1ximo ${c.maxLength} caracteres.`}if("number"==typeof b){if(void 0!==c.min&&b<c.min)return`Valor m\xednimo: ${c.min}.`;if(void 0!==c.max&&b>c.max)return`Valor m\xe1ximo: ${c.max}.`}if("url"===a.type&&"string"==typeof b)try{new URL(b)}catch{return"URL inválida."}if("email"===a.type&&"string"==typeof b&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(b))return"E-mail inválido.";if(("select"===a.type||"multiselect"===a.type)&&a.options){let d=a.options.map(a=>a.value);if("string"==typeof b&&!d.includes(b))return"Opção inválida.";if(Array.isArray(b)){if(b.filter(a=>!d.includes(a)).length>0)return"Opção(ões) inválida(s).";if(c?.minItems&&b.length<c.minItems)return`Selecione no m\xednimo ${c.minItems} item(ns).`;if(c?.maxItems&&b.length>c.maxItems)return`Selecione no m\xe1ximo ${c.maxItems} item(ns).`}}return null}(a,h[a.id]);b&&(i[a.id]=b,a.required&&j.push(a))}if(j.length>0)return void a({fieldErrors:i,banner:{message:`Faltam ${j.length} campo(s) obrigat\xf3rio(s) para salvar e avan\xe7ar.`,variant:"warning"}});a({isSaving:!0});let k={};g.forEach(a=>{k[a.id]="saving"}),a({fieldSaveStates:k}),setTimeout(()=>{let b={};g.forEach(a=>{b[a.id]="saved"});let c=new Date().toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});a({fieldSaveStates:b,isSaving:!1,fieldErrors:{},banner:{message:`Salvo agora \xe0s ${c}`,variant:"success"}}),setTimeout(()=>{let b={};g.forEach(a=>{b[a.id]="idle"}),a({fieldSaveStates:b})},1400)},380)},updateOpportunityStage:(c,d)=>{let{opportunityId:e}=b();if(!e)return;a({isChangingStage:!0,banner:null});let f=d(c);setTimeout(()=>{if(!1===f)return void a({isChangingStage:!1,banner:{message:"Não consegui mudar a etapa. Tente novamente.",variant:"error"}});let{fieldDefinitions:d,fieldValues:g}=b(),h={...d};h[c]||(h[c]=(bJ[c]||[]).filter(a=>a.isActive));let i=bQ(e,c),j={...g};j[i]||(j[i]={}),a({opportunityStage:c,fieldDefinitions:h,fieldValues:j,fieldSaveStates:{},fieldErrors:{},isChangingStage:!1,banner:{message:"Etapa alterada. Preencha os campos para continuar.",variant:"success"}})},600)},advanceStage:(c,d)=>{let{opportunityId:e,opportunityStage:f,fieldDefinitions:g,fieldValues:h}=b();if(!e||!f)return;let i=g[f]||[],j=h[bQ(e,f)]||{},k={},l=[];for(let a of i)a.required&&bK(j[a.id])&&(k[a.id]="Preencha este campo para avançar etapa.",l.push(a));l.length>0?a({fieldErrors:k,banner:{message:"Preencha os campos obrigatórios para avançar etapa.",variant:"warning"}}):!1!==d(c)&&a({opportunityStage:c,fieldSaveStates:{},fieldErrors:{},banner:null})},addFieldDefinition:(c,d)=>{let{fieldDefinitions:e}=b(),f=e[c]||[],g={...d,id:`sf-${c}-${Date.now()}`,stageId:c,order:f.length,isActive:!0},h=bJ[c];h&&h.push(g),a({fieldDefinitions:{...e,[c]:[...f,g]},isNewFieldModalOpen:!1,banner:{message:`Campo "${g.label}" criado com sucesso.`,variant:"success"}})},setNewFieldModalOpen:b=>a({isNewFieldModalOpen:b}),setBanner:b=>a({banner:b}),reset:()=>a({opportunityId:null,opportunityStage:null,fieldSaveStates:{},fieldErrors:{},isSaving:!1,isLoadingFields:!1,isChangingStage:!1,loadError:null,banner:null,isNewFieldModalOpen:!1})}),{name:"stage-fields-store"}));function bS(){let a=bR(a=>a.opportunityStage),b=bR(a=>a.fieldDefinitions);return a?(b[a]||[]).sort((a,b)=>a.order-b.order):[]}function bT(){let a=bR(a=>a.opportunityId),b=bR(a=>a.opportunityStage),c=bR(a=>a.fieldValues);return a&&b&&c[bQ(a,b)]||{}}function bU({field:a,value:c,onChange:e,disabled:f=!1,error:g,saveState:h="idle"}){return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-1.5 flex items-center justify-between gap-2",children:[(0,b.jsxs)(a0.Label,{className:"font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:[a.label," ",a.required&&(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),"saving"===h&&(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-[10px] text-zinc-400",children:[(0,b.jsx)(K.Loader2,{className:"h-3 w-3 animate-spin"}),"Salvando..."]}),"saved"===h&&(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-[10px] text-emerald-600",children:[(0,b.jsx)(A.Check,{className:"h-3 w-3"}),"Salvo"]}),"error"===h&&(0,b.jsx)("span",{className:"text-[10px] text-red-600",children:"Falha ao salvar"})]}),(0,b.jsx)("div",{className:"mt-1.5",children:function(a,c,e,f,g){let h=g?"border-red-300 focus:ring-red-200 focus-visible:ring-red-200":"",i=(0,ac.cn)("h-9 rounded-lg border-zinc-200 font-body text-xs focus:ring-brand/10",h);switch(a.type){case"select":return(0,b.jsxs)(bz.Select,{value:"string"==typeof c?c:"",onValueChange:a=>e(a),disabled:f,children:[(0,b.jsx)(bz.SelectTrigger,{className:(0,ac.cn)("h-9 w-full rounded-lg border-zinc-200 font-body text-xs focus:ring-brand/10",h),children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione..."})}),(0,b.jsx)(bz.SelectContent,{children:a.options?.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.value,className:"text-xs",children:a.label},a.value))})]});case"multiselect":{let g=Array.isArray(c)?c:[];return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:g.map(c=>{let h=a.options?.find(a=>a.value===c);return(0,b.jsxs)(aV.Badge,{variant:"secondary",className:"gap-1 rounded-full px-2 py-0.5 text-[10px]",children:[h?.label||c,!f&&(0,b.jsx)("button",{type:"button",onClick:()=>e(g.filter(a=>a!==c)),className:"ml-0.5 hover:text-red-600",children:(0,b.jsx)(d.X,{className:"h-2.5 w-2.5"})})]},c)})}),(0,b.jsxs)(bz.Select,{value:"",onValueChange:a=>{g.includes(a)||e([...g,a])},disabled:f,children:[(0,b.jsx)(bz.SelectTrigger,{className:(0,ac.cn)("h-9 w-full rounded-lg border-zinc-200 font-body text-xs focus:ring-brand/10",h),children:(0,b.jsx)(bz.SelectValue,{placeholder:"Adicionar..."})}),(0,b.jsx)(bz.SelectContent,{children:a.options?.filter(a=>!g.includes(a.value)).map(a=>(0,b.jsx)(bz.SelectItem,{value:a.value,className:"text-xs",children:a.label},a.value))})]})]})}case"textarea":return(0,b.jsx)(bA.Textarea,{value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),className:(0,ac.cn)("min-h-[86px] resize-none rounded-lg border border-zinc-200 px-3 py-2 text-xs placeholder:text-zinc-400 focus-visible:ring-2 focus-visible:ring-brand/10",h),placeholder:a.placeholder,disabled:f});case"boolean":return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a3.Switch,{checked:!!c,onCheckedChange:a=>e(a),disabled:f}),(0,b.jsx)("span",{className:"text-xs text-zinc-600",children:c?"Sim":"Não"})]});case"currency":return(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-xs text-zinc-400",children:"R$"}),(0,b.jsx)(a_.Input,{type:"text",inputMode:"decimal",value:null!=c?String(c):"",onChange:a=>{e(a.target.value.replace(/[^\d.,]/g,""))},placeholder:a.placeholder||"0,00",className:(0,ac.cn)(i,"pl-9"),disabled:f})]});case"percentage":return(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(a_.Input,{type:"number",inputMode:"decimal",value:null!=c?String(c):"",onChange:a=>e(a.target.value?Number(a.target.value):null),placeholder:a.placeholder||"0",className:(0,ac.cn)(i,"pr-8"),disabled:f,min:a.validationRules?.min,max:a.validationRules?.max}),(0,b.jsx)("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-xs text-zinc-400",children:"%"})]});case"url":return(0,b.jsx)(a_.Input,{type:"url",value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),placeholder:a.placeholder||"https://...",className:i,disabled:f});case"email":return(0,b.jsx)(a_.Input,{type:"email",value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),placeholder:a.placeholder||"email@exemplo.com",className:i,disabled:f});case"phone":return(0,b.jsx)(a_.Input,{type:"tel",value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),placeholder:a.placeholder||"(00) 00000-0000",className:i,disabled:f});case"date":return(0,b.jsx)(a_.Input,{type:"date",value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),className:i,disabled:f});case"time":return(0,b.jsx)(a_.Input,{type:"time",value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),className:i,disabled:f});case"datetime":return(0,b.jsx)(a_.Input,{type:"datetime-local",value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),className:i,disabled:f});case"integer":return(0,b.jsx)(a_.Input,{type:"number",inputMode:"numeric",step:"1",value:null!=c?String(c):"",onChange:a=>e(a.target.value?parseInt(a.target.value,10):null),placeholder:a.placeholder,className:i,disabled:f});case"number":return(0,b.jsx)(a_.Input,{type:"number",inputMode:"decimal",value:null!=c?String(c):"",onChange:a=>e(a.target.value?Number(a.target.value):null),placeholder:a.placeholder,className:i,disabled:f});case"file":return(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(a_.Input,{type:"file",onChange:()=>e("arquivo_anexado"),className:(0,ac.cn)(i,"cursor-pointer file:mr-2 file:rounded-md file:border-0 file:bg-zinc-100 file:px-2 file:py-1 file:text-[10px] file:font-medium file:text-zinc-700"),disabled:f})});case"user":case"contact":return(0,b.jsx)(a_.Input,{type:"text",value:"string"==typeof c?c:"",onChange:a=>e(a.target.value),placeholder:a.placeholder||("user"===a.type?"Nome do usuário":"Nome do contato"),className:i,disabled:f});default:return(0,b.jsx)(a_.Input,{type:"text",value:"string"==typeof c?c:null!=c?String(c):"",onChange:a=>e(a.target.value),placeholder:a.placeholder,className:i,disabled:f})}}(a,c,b=>{e(a.id,b)},f,g)}),g&&(0,b.jsx)("p",{className:"mt-1 text-[10px] text-red-600",children:g}),!g&&a.helperText&&(0,b.jsx)("p",{className:"mt-1 text-[9px] text-zinc-400",children:a.helperText}),!g&&a.description&&!a.helperText&&(0,b.jsx)("p",{className:"mt-1 text-[9px] text-zinc-400",children:a.description})]})}let bV=(0,j.default)("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),bW=(0,j.default)("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]]),bX=(0,j.default)("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);var bY=a.i(67329),bZ=a.i(87534);let b$=(0,j.default)("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]),b_=(0,j.default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),b0=(0,j.default)("percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);var b1=a.i(77156);let b2=(0,j.default)("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]),b3=["select","multiselect"],b4={text:bW,textarea:b$,number:bX,integer:bX,currency:l.DollarSign,percentage:b0,url:b_,email:h.Mail,phone:e.Phone,date:i.Calendar,datetime:i.Calendar,time:p.Clock,select:bY.List,multiselect:bZ.CheckSquare,boolean:b2,user:m.User,contact:n.Users,file:G.FileText};function b5({open:a,onOpenChange:e,stageId:f,stageName:g,onSave:h}){let[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)("text"),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(""),[s,t]=(0,c.useState)(""),[u,w]=(0,c.useState)([]),[x,y]=(0,c.useState)(""),[z,B]=(0,c.useState)({}),[C,D]=(0,c.useState)(!1),[E,F]=(0,c.useState)({}),G=b3.includes(k),H=(0,c.useMemo)(()=>i.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"_").replace(/^_|_$/g,""),[i]),I=(0,c.useMemo)(()=>({id:"preview",stageId:f,key:H||"preview",label:i||"Nome do campo",type:k,required:o,order:0,description:q,placeholder:s,options:G?u:void 0,validationRules:Object.keys(z).length>0?z:void 0,isActive:!0}),[i,k,o,q,s,u,z,f,H,G]),J=()=>{let a=x.trim();if(!a)return;let b=a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"_");u.some(a=>a.value===b)||(w([...u,{label:a,value:b}]),y(""))},L=()=>{j(""),l("text"),p(!1),r(""),t(""),w([]),y(""),B({}),F({})},M=a=>{a||L(),e(a)},N=b4[k]||bW;return(0,b.jsx)(bC.Dialog,{open:a,onOpenChange:M,children:(0,b.jsxs)(bC.DialogContent,{className:"max-h-[90vh] w-full sm:max-w-4xl flex-col gap-0 p-0 overflow-hidden bg-white border-zinc-200/50 shadow-2xl sm:rounded-2xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-100 bg-white/50 px-6 py-4 backdrop-blur-sm",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-xl bg-brand/5 border border-brand/10 text-brand shadow-sm",children:(0,b.jsx)(v.Plus,{className:"h-5 w-5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(bC.DialogTitle,{className:"text-base font-semibold text-zinc-900",children:"Novo Campo Personalizado"}),(0,b.jsxs)("p",{className:"text-xs text-zinc-500",children:["Adicionando em ",(0,b.jsx)("span",{className:"font-medium text-zinc-700",children:g})]})]})]}),(0,b.jsx)(bC.DialogClose,{asChild:!0,children:(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-zinc-400 hover:text-zinc-600",children:(0,b.jsx)(d.X,{className:"h-4 w-4"})})})]}),(0,b.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-6 lg:p-10 scrollbar-thin scrollbar-thumb-zinc-200 scrollbar-track-transparent",children:(0,b.jsxs)("div",{className:"space-y-10 max-w-2xl mx-auto",children:[(0,b.jsxs)("section",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-base font-semibold text-zinc-900",children:"Informações Básicas"}),(0,b.jsx)("p",{className:"text-sm text-zinc-500 mt-0.5",children:"Defina o nome principal e o formato de dados que este campo irá receber no card."})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(a0.Label,{className:"text-sm font-semibold text-zinc-900 flex items-center gap-1.5",children:["Nome do Campo ",(0,b.jsx)("span",{className:"text-red-500 text-xs",children:"*"})]}),(0,b.jsx)(a_.Input,{value:i,onChange:a=>{j(a.target.value),E.label&&F(a=>{let b={...a};return delete b.label,b})},placeholder:"Ex: Data de follow-up",className:(0,ac.cn)("h-10 bg-white transition-all hover:bg-zinc-50 focus:bg-white text-sm shadow-sm",E.label?"border-red-300 focus-visible:ring-red-100":"border-zinc-200 focus-visible:ring-brand/15")}),E.label?(0,b.jsxs)("p",{className:"flex items-center gap-1.5 text-[11px] font-medium text-red-600 mt-1",children:[(0,b.jsx)(aU.AlertCircle,{className:"h-3.5 w-3.5"})," ",E.label]}):H&&(0,b.jsxs)("p",{className:"text-[11px] text-zinc-400 font-mono mt-1",children:["ID interno: ",H]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(a0.Label,{className:"text-sm font-semibold text-zinc-900 flex items-center gap-1.5",children:["Tipo de Dado ",(0,b.jsx)("span",{className:"text-red-500 text-xs",children:"*"})]}),(0,b.jsxs)(bM.Popover,{open:m,onOpenChange:n,children:[(0,b.jsx)(bM.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(ad.Button,{variant:"outline",role:"combobox","aria-expanded":m,className:"w-full justify-between h-auto py-2.5 px-3.5 bg-white border-zinc-200 focus:ring-brand/15 transition-all hover:bg-zinc-50 hover:border-zinc-300 font-normal shadow-sm group",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 text-left",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-zinc-50 border border-zinc-200 shadow-xs text-zinc-600 group-hover:text-brand transition-colors",children:(0,b.jsx)(N,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:bH[k]}),(0,b.jsx)("span",{className:"text-xs text-zinc-500 truncate",children:bI[k]})]})]}),(0,b.jsx)(bV,{className:"ml-2 h-4 w-4 shrink-0 opacity-50 text-zinc-500"})]})}),(0,b.jsx)(bM.PopoverContent,{className:"w-(--radix-popover-trigger-width) p-0 shadow-xl border-zinc-200/80 rounded-xl",align:"start",children:(0,b.jsxs)(bN.Command,{className:"max-h-[380px]",children:[(0,b.jsx)(bN.CommandInput,{placeholder:"Buscar tipo de campo...",className:"h-10 text-sm"}),(0,b.jsxs)(bN.CommandList,{className:"max-h-[330px] scrollbar-thin scrollbar-thumb-zinc-200",children:[(0,b.jsx)(bN.CommandEmpty,{className:"py-6 text-center text-sm text-zinc-500",children:"Nenhum tipo encontrado."}),(0,b.jsx)(bN.CommandGroup,{heading:"Texto e Números",className:"px-1.5 pt-1.5 pb-0",children:["text","textarea","number","currency","percentage","integer"].map(a=>{let c=b4[a];return(0,b.jsxs)(bN.CommandItem,{value:`${bH[a]} ${bI[a]}`,onSelect:()=>{l(a),w([]),B({}),n(!1)},className:"flex items-start gap-3 rounded-md px-2 py-2 cursor-pointer mb-1 data-[selected=true]:bg-zinc-100/80",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-white border border-zinc-200/60 shadow-xs text-zinc-500 mt-0.5",children:(0,b.jsx)(c,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:bH[a]}),(0,b.jsx)("span",{className:"text-xs text-zinc-500 leading-tight",children:bI[a]})]}),k===a&&(0,b.jsx)(A.Check,{className:"ml-auto h-4 w-4 text-brand mt-2"})]},a)})}),(0,b.jsx)(bN.CommandGroup,{heading:"Seleção",className:"px-1.5 py-0",children:["select","multiselect","boolean","date","datetime"].map(a=>{let c=b4[a];return(0,b.jsxs)(bN.CommandItem,{value:`${bH[a]} ${bI[a]}`,onSelect:()=>{l(a),w([]),B({}),n(!1)},className:"flex items-start gap-3 rounded-md px-2 py-2 cursor-pointer mb-1 data-[selected=true]:bg-zinc-100/80",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-white border border-zinc-200/60 shadow-xs text-zinc-500 mt-0.5",children:(0,b.jsx)(c,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:bH[a]}),(0,b.jsx)("span",{className:"text-xs text-zinc-500 leading-tight",children:bI[a]})]}),k===a&&(0,b.jsx)(A.Check,{className:"ml-auto h-4 w-4 text-brand mt-2"})]},a)})}),(0,b.jsx)(bN.CommandGroup,{heading:"Contato e Especial",className:"px-1.5 pb-1.5 pt-0",children:["email","phone","url","file"].map(a=>{let c=b4[a];return(0,b.jsxs)(bN.CommandItem,{value:`${bH[a]} ${bI[a]}`,onSelect:()=>{l(a),w([]),B({}),n(!1)},className:"flex items-start gap-3 rounded-md px-2 py-2 cursor-pointer mb-1 data-[selected=true]:bg-zinc-100/80",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg bg-white border border-zinc-200/60 shadow-xs text-zinc-500 mt-0.5",children:(0,b.jsx)(c,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex flex-col flex-1",children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-zinc-900",children:bH[a]}),(0,b.jsx)("span",{className:"text-xs text-zinc-500 leading-tight",children:bI[a]})]}),k===a&&(0,b.jsx)(A.Check,{className:"ml-auto h-4 w-4 text-brand mt-2"})]},a)})})]})]})})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-xl border border-zinc-200 bg-zinc-50/50 hover:bg-zinc-50 transition-colors",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a0.Label,{className:"text-sm font-semibold text-zinc-900 cursor-pointer",htmlFor:"required-switch",children:"Campo Obrigatório"}),(0,b.jsx)(aV.Badge,{variant:"secondary",className:"h-5 px-1.5 text-[10px] font-semibold text-brand bg-brand/5 border-brand/20 uppercase tracking-wider hidden sm:inline-flex",children:"Required"})]}),(0,b.jsx)("p",{className:"text-xs text-zinc-500",children:"O card não avançará para a próxima etapa se este campo estiver vazio."})]}),(0,b.jsx)(a3.Switch,{id:"required-switch",checked:o,onCheckedChange:p,className:"data-[state=checked]:bg-brand"})]})]})]}),(0,b.jsx)("hr",{className:"border-t border-zinc-100"}),(0,b.jsxs)("section",{className:"space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-base font-semibold text-zinc-900",children:"Aparência e Configuração"}),(0,b.jsx)("p",{className:"text-sm text-zinc-500 mt-0.5",children:"Ajuste como o campo será exibido e preenchido pela equipe."})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[G&&(0,b.jsxs)("div",{className:"space-y-4 pb-6 border-b border-zinc-100/80",children:[(0,b.jsxs)(a0.Label,{className:"text-sm font-semibold text-zinc-900 flex items-center gap-1.5",children:["Opções de seleção ",(0,b.jsx)("span",{className:"text-red-500 text-xs",children:"*"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(a_.Input,{value:x,onChange:a=>y(a.target.value),placeholder:"Digite uma opção e pressione Enter",className:"h-10 flex-1 bg-white border-zinc-200 focus:ring-brand/15 text-sm shadow-sm transition-all",onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),J())}}),(0,b.jsxs)(ad.Button,{type:"button",size:"sm",variant:"secondary",onClick:J,disabled:!x.trim(),className:"h-10 px-4 bg-zinc-100 text-zinc-700 hover:bg-zinc-200 shadow-sm transition-all",children:[(0,b.jsx)(v.Plus,{className:"mr-1.5 h-4 w-4"})," Adicionar"]})]}),(0,b.jsx)("div",{className:"min-h-[60px] rounded-xl border border-dashed border-zinc-200 bg-zinc-50/50 p-3 transition-colors",children:u.length>0?(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:u.map(a=>(0,b.jsxs)(aV.Badge,{variant:"outline",className:"gap-1.5 rounded-lg px-2.5 py-1.5 text-xs font-semibold border-zinc-200/80 bg-white text-zinc-700 shadow-sm hover:border-zinc-300 transition-colors",children:[a.label,(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.value,void w(u.filter(a=>a.value!==b))},className:"ml-1 rounded-full p-0.5 text-zinc-400 hover:bg-red-50 hover:text-red-600 transition-colors",children:(0,b.jsx)(d.X,{className:"h-3.5 w-3.5"})})]},a.value))}):(0,b.jsx)("div",{className:"flex h-full items-center justify-center py-4 text-sm font-medium text-zinc-400",children:"Nenhuma opção adicionada ainda."})}),E.options&&(0,b.jsx)("p",{className:"text-[11px] font-medium text-red-600 mt-1",children:E.options})]}),(0,b.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"text-sm font-semibold text-zinc-900",children:"Placeholder"}),(0,b.jsx)(a_.Input,{value:s,onChange:a=>t(a.target.value),placeholder:"Texto de fundo vazio",className:"h-10 bg-white border-zinc-200 focus:ring-brand/15 text-sm shadow-sm transition-all"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"text-sm font-semibold text-zinc-900",children:"Texto de Ajuda"}),(0,b.jsx)(a_.Input,{value:q,onChange:a=>r(a.target.value),placeholder:"Dica exibida abaixo do campo",className:"h-10 bg-white border-zinc-200 focus:ring-brand/15 text-sm shadow-sm transition-all"})]})]})]})]})]})}),(0,b.jsxs)("div",{className:"w-80 border-l border-zinc-100 bg-zinc-50/50 hidden md:flex flex-col",children:[(0,b.jsx)("div",{className:"p-4 border-b border-zinc-100 bg-white/50",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-zinc-500",children:[(0,b.jsx)(b1.Eye,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-xs font-semibold uppercase tracking-wider",children:"Pré-visualização"})]})}),(0,b.jsxs)("div",{className:"flex-1 p-6 flex flex-col items-center justify-center",children:[(0,b.jsxs)("div",{className:"w-full space-y-2 rounded-xl border border-zinc-200 bg-white p-4 shadow-sm",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-2",children:(0,b.jsx)("span",{className:"text-[10px] text-zinc-400 font-medium",children:"Como aparecerá no card"})}),(0,b.jsx)(bU,{field:I,value:null,onChange:()=>{},disabled:!1})]}),(0,b.jsx)("p",{className:"mt-4 text-center text-[10px] text-zinc-400 max-w-[200px]",children:"Esta é uma representação visual de como o campo será exibido para sua equipe."})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-t border-zinc-100 bg-white px-6 py-4",children:[(0,b.jsx)(ad.Button,{variant:"ghost",type:"button",onClick:()=>M(!1),className:"text-zinc-500 hover:text-zinc-900",children:"Cancelar"}),(0,b.jsxs)(ad.Button,{onClick:()=>{let a;a={},i.trim()||(a.label="Nome do campo é obrigatório."),k||(a.type="Tipo é obrigatório."),G&&0===u.length&&(a.options="Adicione pelo menos uma opção."),F(a),0===Object.keys(a).length&&(D(!0),setTimeout(()=>{h({key:H,label:i.trim(),type:k,required:o,description:q.trim()||void 0,placeholder:s.trim()||void 0,helperText:q.trim()||void 0,options:G?u:void 0}),L(),D(!1)},500))},disabled:C,className:"bg-zinc-900 text-white hover:bg-black shadow-lg shadow-zinc-900/10 min-w-[140px]",children:[C?(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):(0,b.jsx)(v.Plus,{className:"mr-2 h-4 w-4"}),"Criar campo"]})]})]})})}function b6({banner:a,onDismiss:d}){(0,c.useEffect)(()=>{if("success"===a.variant||"info"===a.variant){let a=setTimeout(d,3e3);return()=>clearTimeout(a)}},[a,d]);let e={success:(0,b.jsx)(A.Check,{className:"h-3.5 w-3.5 shrink-0"}),error:(0,b.jsx)(I.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"}),info:(0,b.jsx)(M.Activity,{className:"h-3.5 w-3.5 shrink-0"}),warning:(0,b.jsx)(I.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"})};return(0,b.jsxs)("div",{className:`flex items-center gap-2 rounded-[10px] border px-3 py-2 font-body text-xs font-medium animate-in fade-in slide-in-from-top-1 duration-200 ${{success:"bg-status-success/10 text-status-success border-status-success/20",error:"bg-status-danger/10 text-status-danger border-status-danger/20",info:"bg-brand/10 text-brand border-brand/20",warning:"bg-status-warning/10 text-status-warning border-status-warning/20"}[a.variant]}`,role:"error"===a.variant?"alert":"status","aria-live":"error"===a.variant?"assertive":"polite",children:[e[a.variant],(0,b.jsx)("span",{className:"flex-1",children:a.message}),(0,b.jsx)("button",{onClick:d,className:"ml-auto shrink-0 opacity-70 hover:opacity-100","aria-label":"Fechar",children:"×"})]})}function b7({title:a,description:c,headerAction:d,children:e}){return(0,b.jsxs)(aa.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{duration:.25,delay:.1},className:"rounded-2xl border border-zinc-200/80 bg-white p-5 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-4 flex items-start justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-xl bg-zinc-100 text-zinc-600",children:(0,b.jsx)(bL,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:a}),(0,b.jsx)("p",{className:"text-[11px] text-zinc-500",children:c})]})]}),d]}),(0,b.jsx)("div",{className:"space-y-4",children:e})]})}function b8({opportunityId:a,currentStage:d,stages:e,initialValues:f,isLocked:g,onStageChange:h,canCreateFields:i=!1,advanceBlockedReason:j=null}){let k,l,m,n,o=bR(),p=bS(),q=bT(),r=(k=bS(),l=bT(),n=(m=k.filter(a=>a.required)).filter(a=>!bK(l[a.id])),{total:m.length,completed:n.length,missing:m.length-n.length,missingFields:m.filter(a=>bK(l[a.id]))});(0,c.useEffect)(()=>{o.initForOpportunity(a,d,f)},[a,d]),(0,c.useEffect)(()=>{o.opportunityStage!==d&&o.initForOpportunity(a,d,f)},[d]);let s=(0,c.useCallback)((a,b)=>{g||o.isChangingStage||o.updateFieldValue(a,b)},[g,o]),t=(0,c.useCallback)(()=>{g||o.saveAllFields()},[g,o]),u=(0,c.useCallback)(a=>{o.opportunityStage&&o.addFieldDefinition(o.opportunityStage,a)},[o]),w=(0,c.useMemo)(()=>e.find(a=>a.id===o.opportunityStage)?.label??"Etapa",[e,o.opportunityStage]),x=(0,c.useMemo)(()=>p.filter(a=>a.required),[p]),y=(0,c.useMemo)(()=>p.filter(a=>!a.required),[p]),z=!g&&!o.isChangingStage,B=!!(j&&j.trim().length>0);return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"sticky top-4",children:(0,b.jsxs)(b7,{title:"Campos da etapa",description:"Preencha para destravar avanço e fechamento.",headerAction:(0,b.jsx)(aV.Badge,{variant:"outline",className:"rounded-full border-zinc-200 bg-zinc-50 text-[11px] text-zinc-700",children:w}),children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex-1",children:(0,b.jsxs)(bM.Popover,{children:[(0,b.jsxs)("div",{className:"group relative w-full",children:[(0,b.jsx)("div",{className:"absolute -top-2 left-2 z-10 bg-white px-1 text-[10px] font-semibold tracking-wide text-zinc-500",children:"Etapa atual"}),(0,b.jsx)(bM.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(ad.Button,{variant:"outline",role:"combobox",className:"h-11 w-full justify-between rounded-xl border-zinc-200 bg-white px-3 font-normal text-zinc-900 shadow-sm transition-all hover:border-brand/40 hover:bg-zinc-50 focus:border-brand/40 focus:ring-2 focus:ring-brand/10 disabled:opacity-70",disabled:o.isChangingStage,children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[o.isChangingStage?(0,b.jsx)(K.Loader2,{className:"h-4 w-4 animate-spin text-brand"}):(0,b.jsx)("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-brand/10 text-brand",children:(0,b.jsx)(M.Activity,{className:"h-3 w-3"})}),(0,b.jsx)("span",{className:"text-sm font-semibold",children:o.isChangingStage?"Alterando etapa...":w})]}),(0,b.jsx)(L.ChevronDown,{className:"h-4 w-4 opacity-50"})]})})]}),(0,b.jsx)(bM.PopoverContent,{className:"w-[280px] p-0 rounded-2xl shadow-xl border-zinc-100",align:"start",children:(0,b.jsx)(bN.Command,{children:(0,b.jsxs)(bN.CommandList,{className:"max-h-[300px] p-1.5",children:[(0,b.jsx)("div",{className:"px-2 py-1.5 text-[10px] font-semibold uppercase tracking-wider text-zinc-400",children:"Alterar etapa da oportunidade"}),(0,b.jsx)(bN.CommandGroup,{children:e.map((a,c)=>{let d=a.id===o.opportunityStage,f=e.findIndex(a=>a.id===o.opportunityStage);return(0,b.jsxs)(bN.CommandItem,{value:a.label,onSelect:()=>{d||o.updateOpportunityStage(a.id,h)},className:(0,ac.cn)("group flex items-center gap-3 rounded-xl px-3 py-2.5 text-xs transition-colors cursor-pointer",d?"bg-zinc-50":"hover:bg-zinc-50"),children:[(0,b.jsx)("div",{className:(0,ac.cn)("flex h-2 w-2 shrink-0 rounded-full",c<f?"bg-brand/40":d?"bg-brand ring-2 ring-brand/20":"bg-zinc-200")}),(0,b.jsx)("span",{className:(0,ac.cn)("flex-1 truncate font-medium",d?"text-zinc-900":"text-zinc-600"),children:a.label}),d&&(0,b.jsx)(aV.Badge,{variant:"secondary",className:"ml-auto h-5 rounded-full bg-brand/10 px-1.5 text-[9px] font-semibold text-brand",children:"Atual"})]},a.id)})})]})})})]})}),i&&(0,b.jsxs)(ad.Button,{size:"sm",className:"h-11 rounded-xl bg-zinc-900 px-4 text-sm font-medium text-white shadow-sm transition-all hover:bg-black hover:shadow-md",onClick:()=>o.setNewFieldModalOpen(!0),children:[(0,b.jsx)(v.Plus,{className:"mr-1.5 h-4 w-4"}),"Novo campo"]})]}),(0,b.jsx)(ab.AnimatePresence,{children:o.banner&&(0,b.jsx)(aa.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:(0,b.jsx)(b6,{banner:o.banner,onDismiss:()=>o.setBanner(null)})})}),r.missingFields.length>0&&!o.isChangingStage&&(0,b.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold text-amber-700",children:"Pendências para avanço"}),(0,b.jsx)("ul",{className:"mt-1 space-y-1 text-[11px] text-amber-700",children:r.missingFields.map(a=>(0,b.jsxs)("li",{children:["• ",a.label]},a.id))})]}),B&&!o.isChangingStage&&(0,b.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold text-amber-700",children:"Avanço bloqueado"}),(0,b.jsx)("p",{className:"mt-1 text-[11px] text-amber-700",children:j})]}),p.length>0?(0,b.jsxs)("div",{className:"space-y-4",children:[x.map(a=>(0,b.jsx)(bU,{field:a,value:q[a.id],onChange:s,disabled:!z,error:o.fieldErrors[a.id],saveState:o.fieldSaveStates[a.id]||"idle"},a.id)),y.length>0&&x.length>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-px flex-1 bg-zinc-100"}),(0,b.jsx)("span",{className:"text-[9px] font-medium uppercase tracking-wider text-zinc-400",children:"Opcionais"}),(0,b.jsx)("div",{className:"h-px flex-1 bg-zinc-100"})]}),y.map(a=>(0,b.jsx)(bU,{field:a,value:q[a.id],onChange:s,disabled:!z,error:o.fieldErrors[a.id],saveState:o.fieldSaveStates[a.id]||"idle"},a.id))]}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-xl border border-dashed border-zinc-200 bg-zinc-50/50 py-8 text-center",children:[(0,b.jsx)(bL,{className:"mb-2 h-8 w-8 text-zinc-200"}),(0,b.jsx)("p",{className:"font-heading text-xs font-medium text-zinc-400",children:"Esta etapa não possui campos configurados"}),i&&(0,b.jsxs)(ad.Button,{size:"sm",variant:"outline",className:"mt-3 h-7 rounded-full px-3 text-[10px]",onClick:()=>o.setNewFieldModalOpen(!0),children:[(0,b.jsx)(v.Plus,{className:"mr-1 h-3 w-3"}),"Criar primeiro campo"]})]}),(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:(0,b.jsxs)(ad.Button,{size:"sm",variant:"outline",className:"h-9 rounded-xl px-4 text-xs font-semibold shadow-sm hover:bg-zinc-50 hover:text-zinc-900",onClick:t,disabled:g||o.isSaving||o.isChangingStage||0===p.length,children:[o.isSaving?(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(A.Check,{className:"mr-1.5 h-3.5 w-3.5"}),o.isSaving?"Salvando...":"Salvar campos"]})})]})}),(0,b.jsx)(b5,{open:o.isNewFieldModalOpen,onOpenChange:o.setNewFieldModalOpen,stageId:o.opportunityStage||"",stageName:w,onSave:u})]})}var b9=a.i(67552),ca=a.i(84505),cb=a.i(15171),cc=a.i(92759),cd=a.i(67453),ce=a.i(62722);let cf=(0,j.default)("git-compare-arrows",[["circle",{cx:"5",cy:"6",r:"3",key:"1qnov2"}],["path",{d:"M12 6h5a2 2 0 0 1 2 2v7",key:"1yj91y"}],["path",{d:"m15 9-3-3 3-3",key:"1lwv8l"}],["circle",{cx:"19",cy:"18",r:"3",key:"1qljk2"}],["path",{d:"M12 18H7a2 2 0 0 1-2-2V9",key:"16sdep"}],["path",{d:"m9 15 3 3-3 3",key:"1m3kbl"}]]);var cg=a.i(49363);let ch=(0,j.default)("badge-check",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var ci=a.i(84643);let cj=[{id:"u1",name:"Maria Silva"},{id:"u2",name:"Pedro Santos"},{id:"u3",name:"Julia Fernandes"}],ck={proposal:{label:"Proposta",badgeClass:"border-blue-200 bg-blue-50 text-blue-700",icon:G.FileText},counter:{label:"Contra proposta",badgeClass:"border-amber-200 bg-amber-50 text-amber-700",icon:H.ArrowRight},internal:{label:"Ajuste interno",badgeClass:"border-zinc-200 bg-zinc-100 text-zinc-700",icon:cb.Handshake},agreement:{label:"Fechamento",badgeClass:"border-emerald-200 bg-emerald-50 text-emerald-700",icon:ch}},cl={draft:{label:"Rascunho",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-600"},sent:{label:"Enviada",chipClass:"border-sky-200 bg-sky-50 text-sky-700"},awaiting:{label:"Aguardando cliente",chipClass:"border-violet-200 bg-violet-50 text-violet-700"},accepted:{label:"Aceita",chipClass:"border-emerald-200 bg-emerald-50 text-emerald-700"},rejected:{label:"Rejeitada",chipClass:"border-red-200 bg-red-50 text-red-700"}},cm={client:{label:"Visível ao cliente",chipClass:"border-zinc-200 bg-zinc-50 text-zinc-600"},internal:{label:"Interna",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-500"}},cn=[{id:"call",label:"Ligação"},{id:"whatsapp",label:"WhatsApp"},{id:"email",label:"E-mail"},{id:"meeting",label:"Reunião"},{id:"visit",label:"Visita"}],co=[{id:"proposal",label:"Proposta do time"},{id:"counter",label:"Contra proposta do cliente"},{id:"internal",label:"Ajuste interno"},{id:"agreement",label:"Fechamento"}],cp=[{id:"draft",label:"Rascunho"},{id:"sent",label:"Enviada ao cliente"},{id:"awaiting",label:"Aguardando resposta"},{id:"accepted",label:"Aceita"},{id:"rejected",label:"Rejeitada"}],cq=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a),cr=a=>{if(!a)return"Sem data";let b=new Date(a);return Number.isNaN(b.getTime())?"Sem data":aO(b,"dd MMM, HH:mm",{locale:aS})},cs=a=>{let b=Number(a);return Number.isNaN(b)?0:b},ct=a=>"proposal"===a||"counter"===a||"agreement"===a,cu=a=>("proposal"===a.type||"agreement"===a.type)&&"team"===a.actorRole&&"client"===a.visibility,cv=a=>{if("u1"!==a.authorId||"draft"!==a.lifecycleStatus)return!1;let b=new Date(a.createdAt).getTime();return!Number.isNaN(b)&&Date.now()-b<=864e5},cw=a=>cv(a)&&!a.isFinal,cx=()=>new Date().toISOString();function cy(a){let b=[...a].sort((a,b)=>new Date(a.createdAt).getTime()-new Date(b.createdAt).getTime()),c=[...b].reverse().find(a=>cu(a)&&"accepted"===a.lifecycleStatus);if(c)return c.id;let d=[...b].reverse().find(a=>cu(a)&&("sent"===a.lifecycleStatus||"awaiting"===a.lifecycleStatus));return d?.id??null}function cz(a){return a?{type:a.type,actorRole:a.actorRole,visibility:a.visibility,lifecycleStatus:a.lifecycleStatus,monthlyValue:String(a.monthlyValue??""),setupValue:String(a.setupValue??""),termMonths:String(a.termMonths??12),notes:a.details??"",conditionsText:a.conditions.join(", "),rejectedReason:a.rejectedReason??""}:{type:"proposal",actorRole:"team",visibility:"client",lifecycleStatus:"draft",monthlyValue:"",setupValue:"",termMonths:"12",notes:"",conditionsText:"",rejectedReason:""}}function cA({dealId:a,dealTitle:d}){let e=(0,c.useMemo)(()=>ci.mockNegotiationRounds.map(a=>"counter"===a.type?{...a,actorRole:"client",visibility:"client",lifecycleStatus:"awaiting",sentAt:a.createdAt}:"internal"===a.type?{...a,actorRole:"team",visibility:"internal",lifecycleStatus:"draft"}:"agreement"===a.type?{...a,actorRole:"team",visibility:"client",lifecycleStatus:"accepted",sentAt:a.createdAt,acceptedAt:a.createdAt,isFinal:!0}:{...a,actorRole:"team",visibility:"client",lifecycleStatus:"sent",sentAt:a.createdAt}),[]),[f,g]=(0,c.useState)(e),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)("create"),[l,m]=(0,c.useState)(cz()),[n,o]=(0,c.useState)(null),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)(null),[t,u]=(0,c.useState)(cy(e)),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(null),[A,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(null),[E,F]=(0,c.useState)(null),[G,H]=(0,c.useState)({action:"Validar retorno do cliente sobre a proposta vigente",dueAt:"",channel:"whatsapp",ownerId:"u1"}),[I,J]=(0,c.useState)("idle"),[L,M]=(0,c.useState)(null),[N,O]=(0,c.useState)(null),[P,Q]=(0,c.useState)(!1),S=(0,c.useMemo)(()=>[...f].sort((a,b)=>new Date(a.createdAt).getTime()-new Date(b.createdAt).getTime()),[f]),T=(0,c.useMemo)(()=>S.find(a=>a.id===t)??null,[S,t]),U=(0,c.useMemo)(()=>{if(!T)return null;let a=S.findIndex(a=>a.id===T.id);return a>=0?a+1:null},[T,S]),V=(0,c.useMemo)(()=>(function(a){if(!a||!ct(a.type))return null;let b=a.monthlyValue??0,c=a.setupValue??0,d=a.termMonths??12;return{sourceRoundId:a.id,monthlyValue:b,setupValue:c,termMonths:d,totalValue:b*d+c,updatedAt:a.updatedAt??a.createdAt,updatedBy:a.authorName,sourceStatus:a.lifecycleStatus,sourceVisibility:a.visibility}})(T),[T]),W=(0,c.useMemo)(()=>[...S].reverse().find(a=>cu(a))??null,[S]),X=(0,c.useMemo)(()=>[...S].reverse().find(a=>"counter"===a.type)??null,[S]),Y=(0,c.useMemo)(()=>(function(a,b){if(0===a.length)return{label:"Não iniciada",description:"Nenhuma rodada registrada até agora.",tone:"neutral"};if(a.find(a=>"accepted"===a.lifecycleStatus))return{label:"Aceita",description:"Rodada aceita pelo cliente. Pronta para fechamento.",tone:"success"};let c=a.find(a=>a.id===b);return c?.lifecycleStatus==="awaiting"||c?.lifecycleStatus==="sent"?{label:"Aguardando cliente",description:`Aguardando resposta da rodada vigente enviada em ${cr(c.sentAt)}.`,tone:"warning"}:{label:"Em negociação",description:"Negociação ativa com ajustes internos e respostas em andamento.",tone:"info"}})(S,t),[S,t]),Z=async(a,b,c,d)=>{x(c=>({...c,[a]:b}));try{await new Promise(a=>setTimeout(a,220)),c()}catch{z({type:"error",message:d})}finally{x(b=>({...b,[a]:null}))}},$=a=>{z(a),window.setTimeout(()=>z(null),2200)},ae=a=>{O(a),window.setTimeout(()=>{O(b=>b===a?null:b)},1800)},af=a=>{let b=cz(a??void 0);k("create"),o(null),s(null),m({...b,type:a?.type==="counter"?"proposal":b.type,actorRole:"team",visibility:a?.visibility==="internal"?"client":b.visibility,lifecycleStatus:"draft",rejectedReason:""}),i(!0)},ag=a=>{cv(a)?(k("edit"),o(a.id),s(null),m(cz(a)),i(!0)):$({type:"warning",message:"Você só pode editar rodadas próprias em rascunho dentro da janela de 24h."})},ah=()=>{i(!1),s(null),o(null),m(cz())},ai=async b=>{q(!0),s(null);try{if(await new Promise(a=>setTimeout(a,250)),"edit"===j&&n)g(a=>a.map(a=>{let c,d,e;if(a.id!==n)return a;let f=(c=b.monthlyValue,d=b.setupValue,e=b.termMonths,c*e+d);return{...a,type:b.type,actorRole:b.actorRole,visibility:b.visibility,lifecycleStatus:b.lifecycleStatus,monthlyValue:b.monthlyValue,setupValue:b.setupValue,termMonths:b.termMonths,totalValue:f,conditions:b.conditions,details:b.notes,rejectedReason:"rejected"===b.lifecycleStatus?b.rejectedReason:void 0,sentAt:"sent"===b.lifecycleStatus||"awaiting"===b.lifecycleStatus||"accepted"===b.lifecycleStatus?a.sentAt??cx():void 0,acceptedAt:"accepted"===b.lifecycleStatus?a.acceptedAt??cx():void 0,rejectedAt:"rejected"===b.lifecycleStatus?a.rejectedAt??cx():void 0,updatedAt:cx()}})),"accepted"===b.lifecycleStatus&&"team"===b.actorRole&&"client"===b.visibility&&("proposal"===b.type||"agreement"===b.type)&&(u(n),ae(n)),$({type:"success",message:"Rodada atualizada com sucesso."});else{let c,d,e,f=cx(),h=(c=b.monthlyValue,d=b.setupValue,e=b.termMonths,c*e+d),i={id:`round-${Date.now()}-${Math.floor(999*Math.random())}`,opportunityId:a,type:b.type,authorId:"team"===b.actorRole?"u1":"client-user",authorName:"team"===b.actorRole?"Maria Silva - Equipe":"Cliente - Cliente",actorRole:b.actorRole,visibility:b.visibility,lifecycleStatus:b.lifecycleStatus,createdAt:f,monthlyValue:b.monthlyValue,setupValue:b.setupValue,termMonths:b.termMonths,totalValue:h,conditions:b.conditions,details:b.notes,rejectedReason:"rejected"===b.lifecycleStatus?b.rejectedReason:void 0,sentAt:"sent"===b.lifecycleStatus||"awaiting"===b.lifecycleStatus||"accepted"===b.lifecycleStatus?f:void 0,acceptedAt:"accepted"===b.lifecycleStatus?f:void 0,rejectedAt:"rejected"===b.lifecycleStatus?f:void 0,status:"active"};g(a=>[...a,i]),"accepted"===i.lifecycleStatus&&cu(i)&&(u(i.id),ae(i.id)),$({type:"success",message:"Rodada registrada. Histórico e resumo atualizados."})}ah()}catch{s("Não consegui salvar a rodada. Revise os campos e tente novamente.")}finally{q(!1)}},aj=async a=>{cu(a)?"draft"!==a.lifecycleStatus?$({type:"warning",message:"Apenas rodadas em rascunho podem ser enviadas."}):window.confirm("Confirmar envio desta rodada ao cliente?")&&await Z(a.id,"send",()=>{g(b=>b.map(b=>b.id===a.id?{...b,lifecycleStatus:"sent",sentAt:cx(),updatedAt:cx()}:b)),$({type:"success",message:"Rodada enviada ao cliente e pronta para acompanhamento."})},"Não consegui marcar a rodada como enviada."):$({type:"warning",message:"Somente propostas visíveis ao cliente podem ser enviadas."})},ak=async a=>{"sent"===a.lifecycleStatus&&await Z(a.id,"awaiting",()=>{g(b=>b.map(b=>b.id===a.id?{...b,lifecycleStatus:"awaiting",updatedAt:cx()}:b)),$({type:"info",message:"Status atualizado para aguardando resposta do cliente."})},"Não consegui atualizar o status da rodada.")},al=async a=>{window.confirm("Confirmar esta rodada como aceita?")&&await Z(a.id,"accept",()=>{g(b=>b.map(b=>b.id===a.id?{...b,lifecycleStatus:"accepted",acceptedAt:cx(),updatedAt:cx()}:b)),cu(a)&&(u(a.id),ae(a.id)),$({type:"success",message:cu(a)?"Rodada aceita e promovida para termos vigentes.":"Rodada aceita com sucesso."})},"Não consegui marcar a rodada como aceita.")},am=async a=>{let b=window.prompt("Informe o motivo da rejeição (mínimo 5 caracteres):");!b||b.trim().length<5?$({type:"warning",message:"Motivo obrigatório para rejeitar a rodada."}):await Z(a.id,"reject",()=>{g(c=>c.map(c=>c.id===a.id?{...c,lifecycleStatus:"rejected",rejectedAt:cx(),rejectedReason:b.trim(),updatedAt:cx()}:c)),$({type:"warning",message:"Rodada marcada como rejeitada."})},"Não consegui rejeitar a rodada.")},an=async a=>{cu(a)?await Z(a.id,"set-current",()=>{u(a.id),ae(a.id),$({type:"success",message:`Rodada ${a.id} definida como fonte dos termos vigentes.`})},"Não consegui definir os termos vigentes desta rodada."):$({type:"warning",message:"Somente proposta do time visível ao cliente pode virar termo vigente."})},ao=async a=>{cw(a)?window.confirm("Excluir esta rodada? Esta ação remove o item do histórico.")&&await Z(a.id,"delete",()=>{g(b=>{let c=b.filter(b=>b.id!==a.id);return t===a.id&&u(cy(c)),c}),$({type:"success",message:"Rodada excluída com sucesso."})},"Não consegui excluir a rodada."):$({type:"warning",message:"Você só pode excluir rodadas próprias em rascunho dentro da janela permitida."})},ap=async()=>{if(!V){D("Export bloqueado. Defina termos vigentes antes de exportar."),$({type:"warning",message:"Defina os termos vigentes para gerar um resumo confiável."});return}B(!0),D(null);try{let a;await new Promise(a=>setTimeout(a,260));let b=(a=S.filter(a=>"client"===a.visibility&&"internal"!==a.type).map((a,b)=>{let c=ck[a.type].label,d=cl[a.lifecycleStatus].label;return`${b+1}. ${c} | ${d} | Mensal ${cq(a.monthlyValue??0)} | Setup ${cq(a.setupValue??0)} | ${a.termMonths??12} meses`}),[`Resumo de negocia\xe7\xe3o - ${d}`,"","Termos vigentes",`Mensal: ${cq(V.monthlyValue)}`,`Setup: ${cq(V.setupValue)}`,`Prazo: ${V.termMonths} meses`,`Valor total: ${cq(V.totalValue)}`,`Origem: rodada ${V.sourceRoundId}`,`Atualizado por: ${V.updatedBy} em ${cr(V.updatedAt)}`,"","Rodadas relevantes para cliente",...a].join("\n"));F(b),$({type:"success",message:"Resumo exportado com base nos termos vigentes."})}catch{D("Não consegui gerar o resumo. Tente novamente.")}finally{B(!1)}},aq=async()=>{if(E)try{if(navigator.clipboard?.writeText)await navigator.clipboard.writeText(E);else{let a=document.createElement("textarea");a.value=E,document.body.append(a),a.select(),document.execCommand("copy"),a.remove()}$({type:"success",message:"Resumo copiado para a área de transferência."})}catch{$({type:"error",message:"Não consegui copiar o resumo."})}},ar=async()=>{if(J("saving"),M(null),G.action.trim().length<4){J("error"),M("Defina uma ação objetiva para o próximo passo.");return}if(!G.dueAt){J("error"),M("Defina a data para o próximo passo.");return}try{await new Promise(a=>setTimeout(a,220)),J("saved"),$({type:"success",message:"Próximo passo salvo com sucesso."}),window.setTimeout(()=>J("idle"),1600)}catch{J("error"),M("Não consegui salvar o próximo passo. Tente novamente.")}},as="success"===Y.tone?"border-emerald-200 bg-emerald-50 text-emerald-700":"warning"===Y.tone?"border-amber-200 bg-amber-50 text-amber-700":"info"===Y.tone?"border-sky-200 bg-sky-50 text-sky-700":"border-zinc-200 bg-zinc-100 text-zinc-600";return(0,b.jsxs)("div",{className:"space-y-5","data-deal-id":a,children:[(0,b.jsxs)("header",{className:"space-y-4 border-b border-zinc-100 pb-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg border border-violet-200 bg-violet-50 text-violet-700",children:(0,b.jsx)(cb.Handshake,{className:"h-4 w-4"})}),(0,b.jsx)("h2",{className:"font-heading text-lg font-semibold text-zinc-900",children:"Negociação"})]}),(0,b.jsx)("p",{className:"pl-10 text-sm text-zinc-500",children:"Rodadas, termos vigentes e próximo passo em uma única execução."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsxs)(ad.Button,{variant:"outline",size:"sm",className:"h-8 gap-1.5 rounded-full text-xs",onClick:ap,disabled:A,children:[A?(0,b.jsx)(K.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(ca.Download,{className:"h-3.5 w-3.5"}),A?"Gerando...":"Exportar resumo"]}),(0,b.jsxs)(ad.Button,{size:"sm",className:"h-8 gap-1.5 rounded-full bg-zinc-900 text-xs text-white hover:bg-zinc-800",onClick:()=>af(W),children:[(0,b.jsx)(v.Plus,{className:"h-3.5 w-3.5"}),"Nova rodada"]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsxs)("div",{className:(0,ac.cn)("inline-flex items-center gap-2 rounded-full border px-2.5 py-1 text-[11px] font-medium",as),children:[(0,b.jsx)(_.Clock3,{className:"h-3.5 w-3.5"}),Y.label]}),(0,b.jsx)("p",{className:"text-xs text-zinc-500",children:Y.description})]})]}),y?(0,b.jsx)("div",{className:(0,ac.cn)("rounded-lg border px-3 py-2 text-xs font-medium","success"===y.type&&"border-emerald-200 bg-emerald-50 text-emerald-700","error"===y.type&&"border-red-200 bg-red-50 text-red-700","warning"===y.type&&"border-amber-200 bg-amber-50 text-amber-700","info"===y.type&&"border-sky-200 bg-sky-50 text-sky-700"),role:"status",children:y.message}):null,(0,b.jsxs)("div",{className:"grid grid-cols-1 items-start gap-5 lg:grid-cols-12",children:[(0,b.jsxs)("div",{className:"space-y-4 lg:col-span-8 lg:min-h-[calc(100vh-24rem)] lg:space-y-3",children:[(0,b.jsx)(ab.AnimatePresence,{children:h&&(0,b.jsx)(aa.motion.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.16},children:(0,b.jsx)(cJ,{mode:j,seed:l,isSaving:p,errorMessage:r,onCancel:ah,onSave:ai})})}),0===S.length?(0,b.jsx)(cI,{onStart:()=>af()}):(0,b.jsxs)("div",{className:"relative space-y-2.5 rounded-2xl border border-zinc-200 bg-white p-3",children:[(0,b.jsx)("div",{className:"absolute bottom-3 left-[1.35rem] top-3 w-px bg-zinc-200"}),S.map((a,c)=>(0,b.jsx)(cG,{round:a,displayIndex:c+1,isCurrentTerms:a.id===t,isLast:c===S.length-1,isHighlighted:N===a.id,loadingAction:w[a.id]??null,onEdit:ag,onDelete:ao,onSend:aj,onAwaiting:ak,onAccept:al,onReject:am,onSetCurrent:an,onCreateFromRound:a=>af(a)},a.id))]}),(0,b.jsx)(cF,{hasRounds:S.length>0,hasCurrentTerms:!!V,sourceRound:T,hasClientCounter:!!X,nextStep:G,onCreateRound:()=>af(W??T),onExport:ap,onRegisterClientReturn:()=>{k("create"),o(null),s(null),m({type:"counter",actorRole:"client",visibility:"client",lifecycleStatus:"awaiting",monthlyValue:String(X?.monthlyValue??V?.monthlyValue??W?.monthlyValue??0),setupValue:String(X?.setupValue??V?.setupValue??W?.setupValue??0),termMonths:String(X?.termMonths??V?.termMonths??W?.termMonths??12),notes:"",conditionsText:"",rejectedReason:""}),i(!0)},onFocusNextStep:()=>{let a=document.querySelector('[data-next-step-card="true"]');a instanceof HTMLElement&&(a.scrollIntoView({behavior:"smooth",block:"center"}),Q(!0),window.setTimeout(()=>Q(!1),1600))},isExporting:A})]}),(0,b.jsxs)("div",{className:"space-y-4 lg:col-span-4 lg:sticky lg:top-4 lg:self-start",children:[(0,b.jsx)(cB,{terms:V,sourceRound:T,sourceRoundNumber:U,onJumpToSourceRound:a=>{let b=document.querySelector(`[data-round-anchor="${a}"]`);b instanceof HTMLElement&&(b.scrollIntoView({behavior:"smooth",block:"center"}),ae(a))},onCreateFromCurrent:()=>af(T)}),(0,b.jsx)(cD,{currentOfferRound:T??W,lastClientCounter:X}),(0,b.jsx)(cE,{draft:G,saveState:I,errorMessage:L,onChange:H,onSave:ar,highlighted:P}),(0,b.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Resumo para envio"}),(0,b.jsx)("p",{className:"text-xs text-zinc-500",children:"O export usa os termos vigentes e ignora rodadas internas por padrão."})]}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,b.jsxs)(ad.Button,{type:"button",variant:"outline",size:"sm",className:"h-8 gap-1.5 rounded-full text-xs",onClick:ap,disabled:A,children:[A?(0,b.jsx)(K.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(ca.Download,{className:"h-3.5 w-3.5"}),"Exportar"]}),(0,b.jsxs)(ad.Button,{type:"button",variant:"ghost",size:"sm",className:"h-8 gap-1.5 rounded-full text-xs text-zinc-600 hover:bg-zinc-100",onClick:aq,disabled:!E,children:[(0,b.jsx)(R.Copy,{className:"h-3.5 w-3.5"}),"Copiar texto"]})]}),C?(0,b.jsx)("p",{className:"mt-2 text-xs text-red-600",children:C}):null,E?(0,b.jsx)("p",{className:"mt-2 text-xs text-emerald-700",children:"Resumo pronto para compartilhamento."}):null]})]})]})]})}function cB({terms:a,sourceRound:c,sourceRoundNumber:d,onJumpToSourceRound:e,onCreateFromCurrent:f}){return(0,b.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Termos vigentes"}),(0,b.jsx)("p",{className:"text-xs text-zinc-500",children:"Fonte de verdade para resumo e decisão de fechamento."})]}),a&&c?(0,b.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)(cC,{label:"Mensal",value:cq(a.monthlyValue)}),(0,b.jsx)(cC,{label:"Setup",value:cq(a.setupValue)}),(0,b.jsx)(cC,{label:"Prazo",value:`${a.termMonths} meses`}),(0,b.jsx)(cC,{label:"Total",value:cq(a.totalValue)})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2 text-[11px]",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>e(c.id),className:"inline-flex h-6 items-center rounded-full border border-zinc-200 bg-zinc-100 px-2 text-[11px] font-medium text-zinc-700 transition-colors hover:border-brand/30 hover:text-brand",children:["Rodada fonte: ",d?`Rodada ${d}`:c.id]}),(0,b.jsx)(aV.Badge,{className:(0,ac.cn)("border",cl[c.lifecycleStatus].chipClass),children:cl[c.lifecycleStatus].label}),(0,b.jsx)(aV.Badge,{className:(0,ac.cn)("border",cm[c.visibility].chipClass),children:cm[c.visibility].label})]}),(0,b.jsxs)("p",{className:"text-[11px] text-zinc-500",children:["Atualizado por ",a.updatedBy," em ",cr(a.updatedAt),"."]})]}):(0,b.jsx)("div",{className:"mt-4 rounded-xl border border-dashed border-zinc-200 bg-zinc-50 p-3",children:(0,b.jsx)("p",{className:"text-xs text-zinc-600",children:"Ainda não existem termos vigentes. Defina uma rodada do time como vigente."})}),(0,b.jsxs)(ad.Button,{type:"button",variant:"outline",size:"sm",className:"mt-4 h-8 w-full gap-1.5 rounded-full text-xs",onClick:f,children:[(0,b.jsx)(v.Plus,{className:"h-3.5 w-3.5"}),"Nova rodada baseada na última oferta"]})]})}function cC({label:a,value:c}){return(0,b.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-2.5",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:a}),(0,b.jsx)("p",{className:"mt-1 text-sm font-semibold text-zinc-900",children:c})]})}function cD({currentOfferRound:a,lastClientCounter:c}){let d=(c?.monthlyValue??0)-(a?.monthlyValue??0),e=(c?.setupValue??0)-(a?.setupValue??0);return(0,b.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(cf,{className:"h-4 w-4 text-zinc-500"}),(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Comparador de negociação"})]}),(0,b.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-3",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:"Nossa última oferta"}),(0,b.jsxs)("p",{className:"mt-1 text-sm font-semibold text-zinc-900",children:[a?cq(a.monthlyValue??0):"--"," /mês"]}),(0,b.jsxs)("p",{className:"text-[11px] text-zinc-500",children:["Setup ",a?cq(a.setupValue??0):"--"]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-amber-200 bg-amber-50/70 p-3",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-amber-700",children:"Última contra proposta do cliente"}),(0,b.jsxs)("p",{className:"mt-1 text-sm font-semibold text-amber-900",children:[c?cq(c.monthlyValue??0):"--"," /mês"]}),(0,b.jsxs)("p",{className:"text-[11px] text-amber-700",children:["Setup ",c?cq(c.setupValue??0):"--"]})]})]}),a&&c?(0,b.jsxs)("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-white p-2.5",children:[(0,b.jsx)("p",{className:"text-[10px] uppercase tracking-wide text-zinc-500",children:"Delta mensal"}),(0,b.jsxs)("p",{className:(0,ac.cn)("mt-1 text-sm font-semibold",d<=0?"text-emerald-700":"text-amber-700"),children:[d>0?"+":"",cq(d)]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-zinc-200 bg-white p-2.5",children:[(0,b.jsx)("p",{className:"text-[10px] uppercase tracking-wide text-zinc-500",children:"Delta setup"}),(0,b.jsxs)("p",{className:(0,ac.cn)("mt-1 text-sm font-semibold",e<=0?"text-emerald-700":"text-amber-700"),children:[e>0?"+":"",cq(e)]})]})]}):(0,b.jsx)("p",{className:"mt-3 text-xs text-zinc-500",children:"Registre ao menos uma proposta do time e uma contra proposta do cliente para comparar."})]})}function cE({draft:a,saveState:c,errorMessage:d,onChange:e,onSave:f,highlighted:g}){return(0,b.jsxs)("div",{className:(0,ac.cn)("rounded-2xl border border-zinc-200 bg-white p-4 transition-all duration-200",g&&"ring-2 ring-brand/30"),"data-next-step-card":"true",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(cg.CalendarClock,{className:"h-4 w-4 text-zinc-500"}),(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Próximo passo"})]}),(0,b.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Defina ação, data, canal e responsável para manter a negociação no ritmo."}),(0,b.jsxs)("div",{className:"mt-3 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Ação"}),(0,b.jsx)(a_.Input,{value:a.action,onChange:b=>e({...a,action:b.target.value}),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Ligar para validar objeção de setup"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Data"}),(0,b.jsx)(a_.Input,{type:"date",value:a.dueAt,onChange:b=>e({...a,dueAt:b.target.value}),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Canal"}),(0,b.jsxs)(bz.Select,{value:a.channel,onValueChange:b=>e({...a,channel:b}),children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsx)(bz.SelectContent,{children:cn.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.label},a.id))})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Responsável"}),(0,b.jsxs)(bz.Select,{value:a.ownerId,onValueChange:b=>e({...a,ownerId:b}),children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsx)(bz.SelectContent,{children:cj.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.name},a.id))})]})]}),(0,b.jsx)(ad.Button,{type:"button",size:"sm",className:"h-8 w-full rounded-full bg-zinc-900 text-xs text-white hover:bg-zinc-800",onClick:f,disabled:"saving"===c,children:"saving"===c?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}),"Salvando..."]}):"Salvar próximo passo"}),"saved"===c?(0,b.jsx)("p",{className:"text-xs text-emerald-700",children:"Próximo passo salvo."}):null,"error"===c&&d?(0,b.jsx)("p",{className:"text-xs text-red-600",children:d}):null]})]})}function cF({hasRounds:a,hasCurrentTerms:c,sourceRound:d,hasClientCounter:e,nextStep:f,onCreateRound:g,onExport:h,onRegisterClientReturn:i,onFocusNextStep:j,isExporting:k}){let l=f.action.trim().length>=4&&!!f.dueAt,m=f.dueAt?new Date(`${f.dueAt}T00:00:00`):null,n=m&&!Number.isNaN(m.getTime())?aO(m,"dd MMM",{locale:aS}):"Sem data",o=d?.visibility==="client"&&("sent"===d.lifecycleStatus||"awaiting"===d.lifecycleStatus||"accepted"===d.lifecycleStatus);return(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200 bg-white p-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Execução da negociação"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Fechamento visual da timeline com checklist e ações rápidas da rodada vigente."})]}),a?null:(0,b.jsx)(aV.Badge,{className:"border-zinc-200 bg-zinc-100 text-[10px] text-zinc-600",children:"Sem rodadas"})]}),(0,b.jsxs)("div",{className:"mt-3 rounded-xl border border-zinc-200 bg-zinc-50/80 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-zinc-800",children:"Próximo passo"}),(0,b.jsx)("button",{type:"button",className:"text-[11px] font-medium text-brand transition-colors hover:text-brand/80",onClick:j,children:"Editar"})]}),(0,b.jsx)("p",{className:"mt-1 text-xs text-zinc-600",children:l?`${f.action} \xb7 ${n} \xb7 ${cn.find(a=>a.id===f.channel)?.label??"Canal"}`:"Defina ação, data e canal para não perder o timing da negociação."})]}),(0,b.jsx)("div",{className:"mt-3 grid gap-2 sm:grid-cols-2",children:[{id:"terms",label:"Termos vigentes definidos",done:c},{id:"source",label:"Rodada vigente enviada ao cliente",done:o},{id:"counter",label:"Retorno do cliente registrado",done:e},{id:"next-step",label:"Próximo passo com data",done:l}].map(a=>(0,b.jsxs)("div",{className:(0,ac.cn)("flex items-center gap-2 rounded-lg border px-2.5 py-2",a.done?"border-emerald-200 bg-emerald-50 text-emerald-700":"border-zinc-200 bg-zinc-50 text-zinc-600"),children:[a.done?(0,b.jsx)(cd.CheckCircle2,{className:"h-3.5 w-3.5"}):(0,b.jsx)(_.Clock3,{className:"h-3.5 w-3.5"}),(0,b.jsx)("span",{className:"text-[11px] font-medium",children:a.label})]},a.id))}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[(0,b.jsxs)(ad.Button,{type:"button",size:"sm",className:"h-8 rounded-full bg-zinc-900 px-3 text-xs text-white hover:bg-zinc-800",onClick:g,children:[(0,b.jsx)(v.Plus,{className:"mr-1.5 h-3.5 w-3.5"}),"Nova rodada"]}),(0,b.jsx)(ad.Button,{type:"button",size:"sm",variant:"outline",className:"h-8 rounded-full px-3 text-xs",onClick:i,children:"Registrar retorno do cliente"}),(0,b.jsxs)(ad.Button,{type:"button",size:"sm",variant:"outline",className:"h-8 rounded-full px-3 text-xs",onClick:h,disabled:k,children:[k?(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(ca.Download,{className:"mr-1.5 h-3.5 w-3.5"}),"Exportar resumo"]})]})]})}function cG({round:a,displayIndex:d,isCurrentTerms:e,isLast:f,isHighlighted:g,loadingAction:h,onEdit:i,onDelete:j,onSend:k,onAwaiting:l,onAccept:m,onReject:n,onSetCurrent:o,onCreateFromRound:p}){let[q,r]=(0,c.useState)(f),s=ck[a.type],t=s.icon,u=cu(a)&&"draft"===a.lifecycleStatus,x="sent"===a.lifecycleStatus,y="sent"===a.lifecycleStatus||"awaiting"===a.lifecycleStatus,z="sent"===a.lifecycleStatus||"awaiting"===a.lifecycleStatus,A=cu(a)&&"draft"!==a.lifecycleStatus,B=cv(a),D=cw(a);return(0,b.jsxs)("div",{className:"relative pl-6","data-round-anchor":a.id,children:[(0,b.jsx)("div",{className:(0,ac.cn)("absolute left-3 top-5 h-6 w-6 -translate-x-1/2 rounded-full border-2 bg-white",e?"border-brand":"border-zinc-300"),children:(0,b.jsx)("div",{className:(0,ac.cn)("absolute left-1/2 top-1/2 h-2 w-2 -translate-x-1/2 -translate-y-1/2 rounded-full",e?"bg-brand":"bg-zinc-300")})}),(0,b.jsxs)(aa.motion.div,{layout:!0,className:(0,ac.cn)("rounded-xl border bg-white shadow-sm transition-all duration-200",q&&"ring-1 ring-zinc-200",g&&"border-brand/50 ring-2 ring-brand/20"),children:[(0,b.jsxs)("button",{type:"button",className:"flex w-full items-center gap-3 p-3 text-left",onClick:()=>r(a=>!a),children:[(0,b.jsx)("div",{className:(0,ac.cn)("flex h-8 w-8 shrink-0 items-center justify-center rounded-lg border",s.badgeClass),children:(0,b.jsx)(t,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"min-w-0 flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,b.jsxs)("span",{className:"text-[11px] font-bold uppercase tracking-wide text-zinc-500",children:["Rodada ",d]}),(0,b.jsx)(aV.Badge,{className:(0,ac.cn)("border text-[10px]",s.badgeClass),children:s.label}),(0,b.jsx)(aV.Badge,{className:(0,ac.cn)("border text-[10px]",cl[a.lifecycleStatus].chipClass),children:cl[a.lifecycleStatus].label}),(0,b.jsx)(aV.Badge,{className:(0,ac.cn)("border text-[10px]",cm[a.visibility].chipClass),children:cm[a.visibility].label}),e?(0,b.jsx)(aV.Badge,{className:"border-emerald-200 bg-emerald-50 text-[10px] text-emerald-700",children:"Fonte dos termos vigentes"}):null]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2.5 text-xs text-zinc-600",children:[(0,b.jsx)("span",{className:"font-medium text-zinc-800",children:a.authorName}),(0,b.jsxs)("span",{children:[cq(a.monthlyValue??0)," /mês"]}),(0,b.jsxs)("span",{children:["Setup ",cq(a.setupValue??0)]}),(0,b.jsxs)("span",{className:"text-zinc-500",children:[a.termMonths??12," meses"]})]}),(0,b.jsxs)("div",{className:"text-[11px] text-zinc-400",children:["Criada em ",cr(a.createdAt),a.sentAt?` \xb7 Enviada em ${cr(a.sentAt)}`:""]})]}),q?(0,b.jsx)(b9.ChevronUp,{className:"h-4 w-4 text-zinc-400"}):(0,b.jsx)(L.ChevronDown,{className:"h-4 w-4 text-zinc-400"})]}),(0,b.jsx)(ab.AnimatePresence,{children:q&&(0,b.jsx)(aa.motion.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.16},className:"overflow-hidden",children:(0,b.jsxs)("div",{className:"space-y-3 px-3 pb-3 pt-0",children:[(0,b.jsx)(ae.Separator,{}),ct(a.type)?(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2",children:[(0,b.jsx)(cC,{label:"Mensal",value:cq(a.monthlyValue??0)}),(0,b.jsx)(cC,{label:"Setup",value:cq(a.setupValue??0)}),(0,b.jsx)(cC,{label:"Prazo",value:`${a.termMonths??12} meses`}),(0,b.jsx)(cC,{label:"Total",value:cq(a.totalValue??0)})]}):(0,b.jsx)("div",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-3 text-xs text-zinc-600",children:"Ajuste interno sem alteração direta de termos vigentes."}),a.conditions.length>0?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:"Condições"}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-1.5",children:[a.conditions.slice(0,3).map(c=>(0,b.jsx)(aV.Badge,{className:"border-zinc-200 bg-zinc-100 text-[10px] font-normal text-zinc-700",children:c},`${a.id}-${c}`)),a.conditions.length>3?(0,b.jsxs)(aV.Badge,{className:"border-zinc-200 bg-zinc-100 text-[10px] font-normal text-zinc-700",children:["+",a.conditions.length-3]}):null]})]}):null,a.details?(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-zinc-500",children:"Observações"}),(0,b.jsx)("p",{className:"rounded-xl border border-zinc-200 bg-zinc-50/80 p-3 text-xs text-zinc-700",children:a.details})]}):null,a.rejectedReason?(0,b.jsxs)("p",{className:"rounded-lg border border-red-200 bg-red-50 px-2.5 py-2 text-xs text-red-700",children:["Motivo da rejeição: ",a.rejectedReason]}):null,(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,b.jsx)(cH,{label:"Marcar enviada",icon:cc.Send,visible:u,loading:"send"===h,onClick:()=>k(a)}),(0,b.jsx)(cH,{label:"Aguardando",icon:_.Clock3,visible:x,loading:"awaiting"===h,onClick:()=>l(a)}),(0,b.jsx)(cH,{label:"Aceita",icon:cd.CheckCircle2,visible:y,loading:"accept"===h,onClick:()=>m(a)}),(0,b.jsx)(cH,{label:"Rejeitar",icon:ce.XCircle,visible:z,loading:"reject"===h,onClick:()=>n(a)}),(0,b.jsx)(cH,{label:"Definir vigente",icon:ch,visible:A&&!e,loading:"set-current"===h,onClick:()=>o(a)}),(0,b.jsx)(cH,{label:"Nova rodada",icon:v.Plus,visible:!0,loading:!1,onClick:()=>p(a)}),(0,b.jsx)(cH,{label:"Editar",icon:C.Pencil,visible:B,loading:"save-edit"===h,onClick:()=>i(a)}),(0,b.jsx)(cH,{label:"Excluir",icon:w.Trash2,visible:D,loading:"delete"===h,onClick:()=>j(a)})]})]})})})]})]})}function cH({label:a,icon:c,visible:d,loading:e,onClick:f}){return d?(0,b.jsxs)(ad.Button,{type:"button",size:"sm",variant:"outline",className:"h-7 gap-1.5 rounded-full px-2.5 text-[11px]",onClick:f,disabled:e,children:[e?(0,b.jsx)(K.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(c,{className:"h-3.5 w-3.5"}),a]}):null}function cI({onStart:a}){return(0,b.jsxs)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50/70 p-8 text-center",children:[(0,b.jsx)("div",{className:"mx-auto flex h-11 w-11 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:(0,b.jsx)(cb.Handshake,{className:"h-5 w-5"})}),(0,b.jsx)("h3",{className:"mt-3 font-heading text-base font-semibold text-zinc-900",children:"Nenhuma rodada registrada"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-zinc-500",children:"Registre a primeira rodada para iniciar os termos e o fluxo de decisão."}),(0,b.jsxs)(ad.Button,{type:"button",variant:"outline",className:"mt-4 h-8 rounded-full text-xs",onClick:a,children:[(0,b.jsx)(v.Plus,{className:"mr-1.5 h-3.5 w-3.5"}),"Registrar primeira rodada"]})]})}function cJ({mode:a,seed:d,isSaving:e,errorMessage:f,onCancel:g,onSave:h}){let[i,j]=(0,c.useState)(d),[k,l]=(0,c.useState)(null),m=ct(i.type),n="internal"===i.type||"internal"===i.visibility,o=async a=>{if(a.preventDefault(),l(null),m){let a=cs(i.monthlyValue),b=cs(i.setupValue),c=cs(i.termMonths);if(a<0||a>999999)return void l("Valor mensal inválido.");if(b<0||b>999999)return void l("Valor de setup inválido.");if(c<1||c>36)return void l("Prazo deve estar entre 1 e 36 meses.")}if("rejected"===i.lifecycleStatus&&i.rejectedReason.trim().length<5)return void l("Informe motivo de rejeição com pelo menos 5 caracteres.");if(("sent"===i.lifecycleStatus||"awaiting"===i.lifecycleStatus)&&"internal"===i.visibility)return void l("Rodadas internas não podem ser marcadas como enviadas.");if(i.notes.trim().length>0&&i.notes.trim().length<10)return void l(`Observa\xe7\xf5es devem ter no m\xednimo 10 caracteres.`);let b={type:i.type,actorRole:i.actorRole,visibility:i.visibility,lifecycleStatus:i.lifecycleStatus,monthlyValue:m?cs(i.monthlyValue):0,setupValue:m?cs(i.setupValue):0,termMonths:m?cs(i.termMonths):12,notes:i.notes.trim(),conditions:i.conditionsText.split(",").map(a=>a.trim()).filter(Boolean),rejectedReason:"rejected"===i.lifecycleStatus?i.rejectedReason.trim():void 0};await h(b)};return(0,b.jsxs)("div",{className:"rounded-2xl border border-zinc-200 bg-white p-4 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"create"===a?"Nova rodada":"Editar rodada"}),(0,b.jsx)("p",{className:"text-xs text-zinc-500",children:"Defina tipo, status, termos e condições com validação antes de salvar."})]}),(0,b.jsx)(ad.Button,{type:"button",variant:"ghost",size:"sm",className:"h-7 rounded-full px-2.5 text-xs",onClick:g,children:"Cancelar"})]}),(0,b.jsxs)("form",{className:"space-y-3",onSubmit:o,children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Tipo da rodada"}),(0,b.jsxs)(bz.Select,{value:i.type,onValueChange:a=>{j(b=>({...b,type:a,actorRole:"counter"===a?"client":"team",visibility:"internal"===a?"internal":b.visibility,lifecycleStatus:"internal"===a?"draft":b.lifecycleStatus}))},children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsx)(bz.SelectContent,{children:co.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.label},a.id))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Status operacional"}),(0,b.jsxs)(bz.Select,{value:i.lifecycleStatus,onValueChange:a=>j(b=>({...b,lifecycleStatus:a})),disabled:n,children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsx)(bz.SelectContent,{children:cp.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.label},a.id))})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Origem"}),(0,b.jsxs)(bz.Select,{value:i.actorRole,onValueChange:a=>j(b=>({...b,actorRole:a})),disabled:"counter"===i.type,children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsxs)(bz.SelectContent,{children:[(0,b.jsx)(bz.SelectItem,{value:"team",children:"Time interno"}),(0,b.jsx)(bz.SelectItem,{value:"client",children:"Cliente"}),(0,b.jsx)(bz.SelectItem,{value:"system",children:"Sistema"})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Visibilidade"}),(0,b.jsxs)(bz.Select,{value:i.visibility,onValueChange:a=>j(b=>({...b,visibility:a,lifecycleStatus:"internal"===a?"draft":b.lifecycleStatus})),disabled:"internal"===i.type,children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsxs)(bz.SelectContent,{children:[(0,b.jsx)(bz.SelectItem,{value:"client",children:"Visível ao cliente"}),(0,b.jsx)(bz.SelectItem,{value:"internal",children:"Interna"})]})]})]})]}),m?(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Mensal"}),(0,b.jsx)(a_.Input,{type:"number",min:0,max:999999,value:i.monthlyValue,onChange:a=>j(b=>({...b,monthlyValue:a.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"0"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Setup"}),(0,b.jsx)(a_.Input,{type:"number",min:0,max:999999,value:i.setupValue,onChange:a=>j(b=>({...b,setupValue:a.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"0"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Prazo (meses)"}),(0,b.jsx)(a_.Input,{type:"number",min:1,max:36,value:i.termMonths,onChange:a=>j(b=>({...b,termMonths:a.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"12"})]})]}):null,(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Condições (separe por vírgula)"}),(0,b.jsx)(a_.Input,{value:i.conditionsText,onChange:a=>j(b=>({...b,conditionsText:a.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Setup reduzido, carência de 15 dias"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Observações"}),(0,b.jsx)(bA.Textarea,{value:i.notes,onChange:a=>j(b=>({...b,notes:a.target.value})),className:"mt-1 min-h-[86px] resize-none rounded-lg border-zinc-200 text-xs",placeholder:"Contexto da rodada e próximos pontos de negociação..."})]}),"rejected"===i.lifecycleStatus?(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-semibold uppercase tracking-wider text-zinc-500",children:"Motivo da rejeição"}),(0,b.jsx)(a_.Input,{value:i.rejectedReason,onChange:a=>j(b=>({...b,rejectedReason:a.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Cliente não aprovou condição de setup"})]}):null,k?(0,b.jsx)("p",{className:"text-xs text-red-600",children:k}):null,f?(0,b.jsx)("p",{className:"text-xs text-red-600",children:f}):null,(0,b.jsxs)("div",{className:"flex justify-end gap-2 pt-1",children:[(0,b.jsx)(ad.Button,{type:"button",variant:"ghost",size:"sm",className:"h-8 rounded-full px-3 text-xs",onClick:g,children:"Fechar"}),(0,b.jsx)(ad.Button,{type:"submit",size:"sm",className:"h-8 rounded-full bg-zinc-900 px-3 text-xs text-white hover:bg-zinc-800",disabled:e,children:e?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}),"Salvando..."]}):"create"===a?"Salvar rodada":"Salvar alterações"})]})]})]})}var cK=a.i(2789),cL=a.i(95245),cM=a.i(59501);let cN=(0,j.default)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var cO=a.i(50429),cP=a.i(8406),cQ=a.i(83604),cQ=cQ,cR=a.i(56757);let cS=cR.z.object({type:cR.z.enum(["presencial","remoto","outro"]),status:cR.z.enum(["agendada","realizada","cancelada"]),date:cR.z.string().optional(),time:cR.z.string().optional(),duration:cR.z.string().optional(),location:cR.z.string().optional(),accessSearch:cR.z.string().optional(),platform:cR.z.enum(["google-meet","zoom","whatsapp","outro"]).optional(),link:cR.z.string().optional(),typeDescription:cR.z.string().optional(),details:cR.z.string().optional(),responsibleId:cR.z.string().min(1,"Responsável é obrigatório"),participants:cR.z.array(cR.z.string()).optional(),objective:cR.z.string().max(500,"Objetivo deve ter no máximo 500 caracteres").optional(),result:cR.z.string().optional(),outcome:cR.z.enum(["realizada","no-show","remarcada"]).optional(),cancellationReason:cR.z.string().optional()}).superRefine((a,b)=>{if("agendada"===a.status&&(a.date||b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Data é obrigatória",path:["date"]}),a.time||b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Hora é obrigatória",path:["time"]}),a.duration||b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Duração é obrigatória",path:["duration"]})),"agendada"===a.status&&a.date&&a.time){let c=new Date;new Date(`${a.date}T${a.time}`)<c&&b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Data e hora não podem ficar no passado para visitas agendadas",path:["date"]})}if("cancelada"!==a.status||a.cancellationReason?.trim()||b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Motivo do cancelamento é obrigatório",path:["cancellationReason"]}),"presencial"===a.type&&(!a.location?.trim()||a.location.trim().length<3)&&b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Local é obrigatório e deve ter ao menos 3 caracteres",path:["location"]}),"remoto"===a.type)if(a.platform||b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Plataforma é obrigatória para visita remota",path:["platform"]}),a.link?.trim())try{new URL(a.link)}catch{b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Informe um link válido (https://...)",path:["link"]})}else b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Link da reunião é obrigatório",path:["link"]});"outro"===a.type&&(!a.typeDescription?.trim()||a.typeDescription.trim().length<3)&&b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Detalhe do tipo é obrigatório (mínimo 3 caracteres)",path:["typeDescription"]}),"realizada"!==a.status||a.outcome||b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Selecione o resultado da visita",path:["outcome"]}),"realizada"===a.status&&(!a.result?.trim()||a.result.trim().length<10)&&b.addIssue({code:cR.z.ZodIssueCode.custom,message:"Informe uma nota de resultado com pelo menos 10 caracteres",path:["result"]})}),cT=[{id:"presencial",label:"Presencial",icon:E.MapPin},{id:"remoto",label:"Remoto",icon:aT},{id:"outro",label:"Outro",icon:cN}],cU=[{id:"agendada",label:"Agendada"},{id:"realizada",label:"Realizada"},{id:"cancelada",label:"Cancelada"}],cV=["15","30","45","60","90","120"],cW=[{id:"google-meet",label:"Google Meet"},{id:"zoom",label:"Zoom"},{id:"whatsapp",label:"WhatsApp"},{id:"outro",label:"Outro"}],cX=[{id:"realizada",label:"Realizada"},{id:"no-show",label:"No-show"},{id:"remarcada",label:"Remarcada"}],cY=[{id:"u1",label:"Eu (Logado)",role:"Sales Executive"},{id:"u2",label:"Ana Costa",role:"Closer"},{id:"u3",label:"Carlos Mendes",role:"SDR"}];function cZ({isOpen:a,onClose:e,onSave:f,dealId:g,contacts:h=[],onAddContact:j}){let[k,l]=c.useState(!1),[o,q]=c.useState(!1),[r,s]=c.useState(null),[t,u]=c.useState(!1),[w,x]=c.useState(!1),[y,z]=c.useState(null),[C,D]=c.useState(null),[F,G]=c.useState(!1),[H,I]=c.useState(!1),[J,M]=c.useState(!1),[N,O]=c.useState(!1),[P,Q]=c.useState(!1),[S,T]=c.useState({nome:"",cargo:"",telefone:"",email:""}),U=(0,cL.useForm)({resolver:(0,cM.zodResolver)(cS),mode:"onChange",reValidateMode:"onChange",defaultValues:{type:"presencial",status:"agendada",duration:"60",platform:"google-meet",responsibleId:"u1",participants:[],objective:"",result:"",outcome:void 0,location:"",accessSearch:"",link:"",typeDescription:"",details:"",cancellationReason:"",date:"",time:""}}),{control:V,handleSubmit:W,watch:X,setValue:Y,trigger:Z,formState:{errors:$,isDirty:_,isValid:aa,submitCount:ab}}=U,ae=X("type"),af=X("status"),ag=X("date"),ah=X("time"),ai=X("duration"),aj=X("participants")||[],ak=X("responsibleId"),al=X("platform"),am=X("location"),an=X("link"),ao=X("typeDescription"),ap=c.useCallback(a=>{if(!a)return"??";let b=a.trim().split(/\s+/).filter(Boolean);return 0===b.length?"??":1===b.length?b[0].slice(0,2).toUpperCase():`${b[0][0]}${b[b.length-1][0]}`.toUpperCase()},[]),aq=c.useCallback(a=>a?a.replace(/-/g," ").replace(/\s+/g," ").trim().replace(/\b\w/g,a=>a.toUpperCase()):"Sem cargo definido",[]);c.useEffect(()=>{if(a){q(!1),l(!1),s(null),u(!1),x(!1),z(null),D(null),M(!1),I(!1),G(!1),U.reset(),Q(!0),O(!0);let a=setTimeout(()=>{Q(!1),O(!1)},250);return()=>clearTimeout(a)}},[a,U]);let ar=c.useRef(h.length);c.useEffect(()=>{if(h.length>ar.current){let a=h[h.length-1];if(a){let b=U.getValues("participants")||[];b.includes(a.id)||U.setValue("participants",[...b,a.id],{shouldValidate:!0,shouldDirty:!0}),I(!1)}}ar.current=h.length},[h,U]),c.useEffect(()=>{"presencial"===ae&&(Y("platform","google-meet",{shouldValidate:!1}),Y("link","",{shouldValidate:!1}),Y("typeDescription","",{shouldValidate:!1}),Y("details","",{shouldValidate:!1})),"remoto"===ae&&(Y("location","",{shouldValidate:!1}),Y("accessSearch","",{shouldValidate:!1}),Y("typeDescription","",{shouldValidate:!1}),Y("details","",{shouldValidate:!1}),X("platform")||Y("platform","google-meet",{shouldValidate:!1})),"outro"===ae&&(Y("location","",{shouldValidate:!1}),Y("accessSearch","",{shouldValidate:!1}),Y("platform","google-meet",{shouldValidate:!1}),Y("link","",{shouldValidate:!1}))},[ae,Y]),c.useEffect(()=>{"realizada"!==af&&(Y("outcome",void 0,{shouldValidate:!1}),Y("result","",{shouldValidate:!1})),"cancelada"!==af&&Y("cancellationReason","",{shouldValidate:!1})},[af,Y]);let as=c.useCallback(a=>{let b=new Date;b.setDate(b.getDate()+1);let c=b.getFullYear(),d=String(b.getMonth()+1).padStart(2,"0"),e=String(b.getDate()).padStart(2,"0");Y("date",`${c}-${d}-${e}`),Y("time",a),Z(["date","time"])},[Y,Z]),at=c.useCallback(()=>{let a=`Ol\xe1! Confirmando nossa ${"presencial"===ae?"visita":"reunião"} para ${ag?aO(new Date(ag),"dd/MM"):"dia a confirmar"} \xe0s ${ah||"horário a confirmar"}.`;navigator.clipboard.writeText(a)},[ae,ag,ah]),au=c.useMemo(()=>{let a=[];return ak||a.push("Responsável"),"agendada"===af&&(ag||a.push("Data"),ah||a.push("Hora"),ai||a.push("Duração")),"presencial"===ae&&(!am||am.trim().length<3)&&a.push("Local"),"remoto"===ae&&(al||a.push("Plataforma"),an?.trim()||a.push("Link da reunião")),"outro"===ae&&(!ao||ao.trim().length<3)&&a.push("Detalhe do tipo"),"realizada"===af&&(X("outcome")||a.push("Resultado da visita"),(!X("result")||10>(X("result")?.trim().length||0))&&a.push("Nota do resultado")),"cancelada"!==af||X("cancellationReason")?.trim()||a.push("Motivo do cancelamento"),a},[ak,af,ag,ah,ai,ae,am,al,an,ao,X]),av=au.length>0,aw=ab>0&&Object.keys($).length>1&&!r,ax=c.useCallback(async a=>{l(!0),s(null),D(a);try{await new Promise(a=>setTimeout(a,700)),await Promise.resolve(f(a)),q(!0),setTimeout(()=>{e()},450)}catch{s("Não consegui salvar agora. Verifique sua conexão e tente novamente.")}finally{l(!1)}},[e,f]),ay=W(c.useCallback(async a=>{if("realizada"===a.status){z(a),x(!0);return}await ax(a)},[ax]),c.useCallback(()=>{let a=Object.keys(U.formState.errors)[0];if(!a)return;let b=document.querySelector(`[name="${a}"]`);b&&(b.scrollIntoView({behavior:"smooth",block:"center"}),b.focus())},[U.formState.errors])),az=c.useCallback(async()=>{C&&await ax(C)},[ax,C]),aA=c.useCallback(()=>{if(!S.nome.trim())return;let a={...S,isDecisionMaker:!1};j?.(a),T({nome:"",cargo:"",telefone:"",email:""})},[S,j]),aB=c.useCallback(()=>{!_||t||o?(u(!1),x(!1),z(null),e()):u(!0)},[_,e,o,t]),aC=c.useCallback(()=>{u(!1),x(!1),z(null),e()},[e]),aD=c.useMemo(()=>[{label:"Tipo",value:cT.find(a=>a.id===ae)?.label??"Não definido"},{label:"Status",value:cU.find(a=>a.id===af)?.label??"Não definido"},{label:"Quando",value:ag&&ah?`${aO(new Date(`${ag}T${ah}`),"dd/MM/yyyy HH:mm")}`:"A definir"},{label:"Duração",value:ai?`${ai} min`:"A definir"},{label:"remoto"===ae?"Link":"Local",value:"remoto"===ae?an||"Não informado":"presencial"===ae?am||"Não informado":ao||"Não informado"},{label:"Responsável",value:cY.find(a=>a.id===ak)?.label??"Não definido"},{label:"Participantes",value:aj.length>0?`${aj.length} selecionado${aj.length>1?"s":""}`:"Nenhum selecionado"}],[ag,ai,am,an,aj.length,ak,ah,ao,af,ae]),aE=(0,b.jsxs)("div",{className:"flex h-full flex-col bg-white",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-20 flex-none border-b border-zinc-100 bg-white px-8 py-6",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"flex items-center gap-2 text-lg font-semibold text-zinc-900",children:o?(0,b.jsxs)("span",{className:"flex items-center gap-2 text-emerald-600 animate-in fade-in slide-in-from-bottom-2",children:[(0,b.jsx)(B.CheckCircle,{className:"h-5 w-5"})," Visita registrada"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(i.Calendar,{className:"h-5 w-5 text-brand"})," Nova Visita"]})}),!o&&(0,b.jsx)("p",{className:"text-sm text-zinc-500",children:"Registre uma visita ou reunião para este cliente"})]}),(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",onClick:aB,title:"Fechar",children:(0,b.jsx)(d.X,{className:"h-5 w-5"})})]}),(aw||r)&&(0,b.jsx)("div",{className:(0,ac.cn)("mt-3 rounded-xl border px-3 py-2 text-xs",r?"border-red-200 bg-red-50 text-red-700":"border-amber-200 bg-amber-50 text-amber-700"),children:r||"Revise os campos destacados para continuar."})]}),(0,b.jsxs)("div",{className:"flex-1 space-y-8 overflow-y-auto px-8 py-8",children:[(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-end md:justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"text-[11px] uppercase tracking-[0.08em] text-zinc-500",children:"Tipo da visita"}),(0,b.jsx)(cL.Controller,{name:"type",control:V,render:({field:a})=>(0,b.jsx)("div",{className:"inline-flex rounded-xl border border-zinc-200 bg-zinc-50 p-1",children:cT.map(c=>(0,b.jsxs)("button",{type:"button",onClick:()=>a.onChange(c.id),className:(0,ac.cn)("flex h-9 items-center gap-2 rounded-lg px-3 text-sm font-medium transition-all duration-[120ms]",a.value===c.id?"bg-white text-brand shadow-sm ring-1 ring-black/5":"text-zinc-500 hover:bg-zinc-100 hover:text-zinc-800"),children:[(0,b.jsx)(c.icon,{className:"h-4 w-4"}),c.label]},c.id))})})]}),(0,b.jsxs)("div",{className:"w-full max-w-[240px] space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Status ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(cL.Controller,{name:"status",control:V,render:({field:a})=>(0,b.jsxs)(bz.Select,{value:a.value,onValueChange:a.onChange,children:[(0,b.jsx)(bz.SelectTrigger,{className:(0,ac.cn)($.status&&"border-red-300 ring-red-100"),children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsx)(bz.SelectContent,{children:cU.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.label},a.id))})]})}),$.status&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.status.message})]})]}),"cancelada"===af&&(0,b.jsxs)("div",{className:"mt-4 animate-in fade-in slide-in-from-top-2 space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Motivo do cancelamento ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(a_.Input,{...U.register("cancellationReason"),placeholder:"Ex: Cliente pediu para remarcar",className:(0,ac.cn)($.cancellationReason&&"border-red-300")}),$.cancellationReason&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.cancellationReason.message})]})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:[(0,b.jsx)(p.Clock,{className:"h-4 w-4 text-zinc-400"}),(0,b.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Quando"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Data ","agendada"===af&&(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(a_.Input,{type:"date",...U.register("date"),className:(0,ac.cn)($.date&&"border-red-300")}),$.date&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.date.message})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Hora ","agendada"===af&&(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(a_.Input,{type:"time",...U.register("time"),className:(0,ac.cn)($.time&&"border-red-300")}),$.time&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.time.message})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Duração ","agendada"===af&&(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(cL.Controller,{name:"duration",control:V,render:({field:a})=>(0,b.jsxs)(bz.Select,{value:a.value,onValueChange:a.onChange,children:[(0,b.jsx)(bz.SelectTrigger,{className:(0,ac.cn)($.duration&&"border-red-300"),children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione..."})}),(0,b.jsx)(bz.SelectContent,{children:cV.map(a=>(0,b.jsxs)(bz.SelectItem,{value:a,children:[a," min"]},a))})]})}),$.duration&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.duration.message})]})]})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:[(0,b.jsx)(n.Users,{className:"h-4 w-4 text-zinc-400"}),(0,b.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Quem"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Responsável ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),P?(0,b.jsx)("div",{className:"h-10 w-full animate-pulse rounded-md border border-zinc-200 bg-zinc-100"}):(0,b.jsx)(cL.Controller,{name:"responsibleId",control:V,render:({field:a})=>(0,b.jsxs)(bz.Select,{value:a.value,onValueChange:a.onChange,disabled:!0,children:[(0,b.jsx)(bz.SelectTrigger,{className:(0,ac.cn)($.responsibleId&&"border-red-300"),children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsx)(bz.SelectContent,{children:cY.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{children:a.label}),(0,b.jsx)("span",{className:"text-[10px] text-zinc-500",children:a.role})]})},a.id))})]})}),(0,b.jsx)("p",{className:"text-[11px] text-zinc-500",children:"Delegação desabilitada para seu perfil."}),$.responsibleId&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.responsibleId.message})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(a0.Label,{children:"Participantes (Clientes)"}),N?(0,b.jsx)("div",{className:"h-10 w-full animate-pulse rounded-md border border-zinc-200 bg-zinc-100"}):(0,b.jsx)(cL.Controller,{name:"participants",control:V,render:({field:a})=>(0,b.jsxs)(bM.Popover,{open:F,onOpenChange:G,children:[(0,b.jsx)(bM.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(ad.Button,{variant:"outline",role:"combobox","aria-expanded":F,className:"h-10 w-full justify-between px-3 font-normal text-zinc-600",children:[a.value?.length?`${a.value.length} participante${a.value.length>1?"s":""} selecionado${a.value.length>1?"s":""}`:"Selecionar participantes...",(0,b.jsx)(L.ChevronDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(bM.PopoverContent,{className:"w-[calc(100vw-4rem)] sm:w-[340px] md:w-[var(--radix-popover-trigger-width)] min-w-[300px] overflow-hidden rounded-2xl border border-zinc-200/90 p-0 shadow-[0_18px_40px_rgba(15,23,42,0.14)]",align:"start",children:H?(0,b.jsxs)("div",{className:"space-y-3 p-3 animate-in slide-in-from-right-2 duration-200",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-zinc-100 pb-2",children:[(0,b.jsx)("h4",{className:"text-sm font-semibold text-zinc-900",children:"Novo contato"}),(0,b.jsx)(ad.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-zinc-500 hover:text-zinc-900",onClick:()=>I(!1),children:(0,b.jsx)(d.X,{className:"h-3 w-3"})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a_.Input,{placeholder:"Nome *",value:S.nome,onChange:a=>T(b=>({...b,nome:a.target.value})),className:"h-8 text-sm"}),(0,b.jsx)(a_.Input,{placeholder:"Cargo",value:S.cargo,onChange:a=>T(b=>({...b,cargo:a.target.value})),className:"h-8 text-sm"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)(a_.Input,{placeholder:"Telefone",value:S.telefone,onChange:a=>T(b=>({...b,telefone:a.target.value})),className:"h-8 text-sm"}),(0,b.jsx)(a_.Input,{placeholder:"Email",value:S.email,onChange:a=>T(b=>({...b,email:a.target.value})),className:"h-8 text-sm"})]}),(0,b.jsx)(ad.Button,{size:"sm",className:"mt-2 w-full",disabled:!S.nome.trim(),onClick:aA,children:"Cadastrar"})]})]}):(0,b.jsxs)(bN.Command,{className:"bg-white",children:[(0,b.jsxs)("div",{className:"border-b border-zinc-100 px-3 py-2",children:[(0,b.jsx)("p",{className:"font-body text-[10px] font-semibold uppercase tracking-[0.08em] text-zinc-500",children:"Participantes"}),(0,b.jsxs)("p",{className:"font-body text-xs text-zinc-500",children:[(a.value||[]).length," selecionado",1===(a.value||[]).length?"":"s"]})]}),(0,b.jsx)("div",{className:"px-3 pb-2 pt-2",children:(0,b.jsx)(bN.CommandInput,{placeholder:"Buscar contato...",className:"h-9 rounded-xl border border-zinc-200 bg-zinc-50/60 px-2 text-sm"})}),(0,b.jsxs)(bN.CommandList,{className:"max-h-[260px] px-2 pb-2",children:[(0,b.jsx)(bN.CommandEmpty,{className:"py-8 text-center font-body text-xs text-zinc-500",children:"Nenhum contato encontrado."}),(0,b.jsx)(bN.CommandGroup,{className:"space-y-1",children:h.map(c=>{let d=(a.value||[]).includes(c.id);return(0,b.jsxs)(bN.CommandItem,{value:`${c.nome} ${c.cargo||""}`,className:(0,ac.cn)("group flex cursor-pointer items-center gap-3 rounded-xl border px-2.5 py-2.5 transition-all duration-[140ms]",d?"border-brand/30 bg-brand/10 shadow-[0_6px_14px_rgba(37,99,235,0.14)]":"border-transparent hover:border-zinc-200 hover:bg-zinc-50"),onSelect:()=>{let b=a.value||[];b.includes(c.id)?a.onChange(b.filter(a=>a!==c.id)):a.onChange([...b,c.id])},children:[(0,b.jsx)("div",{className:(0,ac.cn)("flex h-8 w-8 shrink-0 items-center justify-center rounded-full border font-body text-[11px] font-semibold transition-colors",d?"border-brand/35 bg-brand text-white":"border-zinc-200 bg-white text-zinc-600"),children:ap(c.nome)}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsx)("p",{className:(0,ac.cn)("truncate font-body text-sm font-medium",d?"text-zinc-900":"text-zinc-800"),children:c.nome}),(0,b.jsx)("p",{className:"truncate font-body text-[11px] text-zinc-500",children:aq(c.cargo)})]}),(0,b.jsx)("div",{className:(0,ac.cn)("flex h-5 w-5 shrink-0 items-center justify-center rounded-full border transition-all",d?"border-brand bg-brand text-white":"border-zinc-300 bg-white text-zinc-400 opacity-0 group-hover:opacity-100"),children:(0,b.jsx)(A.Check,{className:"h-3 w-3"})})]},c.id)})}),(0,b.jsx)(bN.CommandSeparator,{className:"mx-1 my-2"}),(0,b.jsx)(bN.CommandGroup,{children:(0,b.jsxs)(bN.CommandItem,{onSelect:()=>I(!0),className:"group flex cursor-pointer items-center gap-2.5 rounded-xl border border-dashed border-zinc-300 bg-zinc-50/50 px-2.5 py-2.5 text-zinc-600 transition-colors duration-[120ms] hover:border-brand/40 hover:bg-brand/5 hover:text-brand",children:[(0,b.jsx)("span",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-white border border-zinc-200 text-zinc-400 group-hover:border-brand/30 group-hover:text-brand",children:(0,b.jsx)(v.Plus,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-col",children:[(0,b.jsx)("span",{className:"font-body text-sm font-semibold",children:"Cadastrar novo contato"}),(0,b.jsx)("span",{className:"font-body text-[11px] text-zinc-400 group-hover:text-brand/80",children:"Adicione e selecione sem sair da visita"})]})]})})]})]})})]})}),0===aj.length?(0,b.jsx)("p",{className:"text-[11px] text-amber-600",children:"Nenhum participante cliente selecionado. Recomendado incluir ao menos 1 contato."}):(0,b.jsx)("div",{className:"flex flex-wrap gap-1.5 pt-1",children:aj.map(a=>{let c=h.find(b=>b.id===a);return c?(0,b.jsx)(aV.Badge,{variant:"outline",className:"h-6 rounded-full border-zinc-200 text-[11px]",children:c.nome},a):null})})]})]})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:["presencial"===ae?(0,b.jsx)(E.MapPin,{className:"h-4 w-4 text-zinc-400"}):"remoto"===ae?(0,b.jsx)(b_,{className:"h-4 w-4 text-zinc-400"}):(0,b.jsx)(cN,{className:"h-4 w-4 text-zinc-400"}),(0,b.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Onde"})]}),"presencial"===ae&&(0,b.jsxs)("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-2",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Local ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(a_.Input,{...U.register("location"),placeholder:"Endereço, unidade ou ponto de referência",className:(0,ac.cn)($.location&&"border-red-300")}),$.location&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.location.message})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(a0.Label,{className:"text-zinc-500",children:"Observação de acesso (Opcional)"}),(0,b.jsx)(bA.Textarea,{...U.register("accessSearch"),placeholder:"Instruções para portaria, estacionamento...",className:"h-20 resize-none"})]})]}),"remoto"===ae&&(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 animate-in fade-in slide-in-from-top-2",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Plataforma ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(cL.Controller,{name:"platform",control:V,render:({field:a})=>(0,b.jsxs)(bz.Select,{value:a.value,onValueChange:a.onChange,children:[(0,b.jsx)(bz.SelectTrigger,{className:(0,ac.cn)($.platform&&"border-red-300"),children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione..."})}),(0,b.jsx)(bz.SelectContent,{children:cW.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.label},a.id))})]})}),$.platform&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.platform.message})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Link da reunião ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(a_.Input,{...U.register("link"),placeholder:"https://meet.google.com/...",className:(0,ac.cn)($.link&&"border-red-300")}),$.link&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.link.message})]})]}),"outro"===ae&&(0,b.jsxs)("div",{className:"space-y-3 animate-in fade-in slide-in-from-top-2",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Tipo ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(a_.Input,{...U.register("typeDescription"),placeholder:"Ex: Ligação, WhatsApp, Evento",className:(0,ac.cn)($.typeDescription&&"border-red-300")}),$.typeDescription&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.typeDescription.message})]}),(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsx)(a0.Label,{children:"Detalhe (Opcional)"}),(0,b.jsx)(bA.Textarea,{...U.register("details"),className:"h-20 resize-none",placeholder:"Contexto adicional desta interação"})]})]})]}),"realizada"===af&&(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-4 animate-in fade-in slide-in-from-top-2",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center gap-2 border-b border-zinc-100 pb-2",children:[(0,b.jsx)(cO.Target,{className:"h-4 w-4 text-zinc-400"}),(0,b.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Resultado"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1.5",children:[(0,b.jsxs)(a0.Label,{children:["Resultado da visita ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(cL.Controller,{name:"outcome",control:V,render:({field:a})=>(0,b.jsxs)(bz.Select,{value:a.value,onValueChange:a.onChange,children:[(0,b.jsx)(bz.SelectTrigger,{className:(0,ac.cn)($.outcome&&"border-red-300"),children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione..."})}),(0,b.jsx)(bz.SelectContent,{children:cX.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.label},a.id))})]})}),$.outcome&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.outcome.message})]}),(0,b.jsxs)("div",{className:"space-y-1.5 md:col-span-1",children:[(0,b.jsxs)(a0.Label,{children:["Nota do resultado ",(0,b.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,b.jsx)(bA.Textarea,{...U.register("result"),placeholder:"Resuma o que aconteceu e próximos passos (mín. 10 caracteres)",className:(0,ac.cn)("h-24 resize-none",$.result&&"border-red-300")}),$.result&&(0,b.jsx)("p",{className:"text-xs text-red-500",children:$.result.message})]})]})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-white p-4",children:[(0,b.jsxs)("button",{type:"button",className:"flex w-full items-center justify-between",onClick:()=>M(a=>!a),children:[(0,b.jsx)("span",{className:"text-sm font-semibold text-zinc-700",children:"Observações"}),(0,b.jsx)("span",{className:"text-xs text-zinc-500",children:J?"Ocultar":"Mostrar"})]}),J&&(0,b.jsxs)("div",{className:"mt-3 space-y-1.5 animate-in fade-in slide-in-from-top-2",children:[(0,b.jsx)(a0.Label,{children:"Notas (Opcional)"}),(0,b.jsx)(bA.Textarea,{...U.register("objective"),placeholder:"Contexto para o time, objeções, detalhes importantes...",className:"h-24 resize-none"})]})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-brand/10 bg-brand/5 p-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-brand",children:[(0,b.jsx)(cP.Sparkles,{className:"h-4 w-4 fill-brand/20"}),(0,b.jsx)("h4",{className:"text-xs font-semibold uppercase tracking-wider",children:"Menux Intelligence"})]}),!ag&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs text-zinc-600",children:"Sugestão de horários para esta oportunidade:"}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:["09:00","14:30","16:00"].map(a=>(0,b.jsxs)(aV.Badge,{variant:"outline",className:"cursor-pointer border-brand/20 text-zinc-600 transition-colors hover:bg-brand/10 hover:text-brand",onClick:()=>as(a),children:["Amanhã, ",a]},a))})]}),ag&&ah&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs text-zinc-600",children:"Mensagem de confirmação sugerida:"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 rounded border border-brand/10 bg-white p-2 text-xs text-zinc-500 italic",children:[(0,b.jsxs)("span",{className:"flex-1 truncate",children:["Olá! Confirmando nossa ","presencial"===ae?"visita":"reunião"," para ",aO(new Date(ag),"dd/MM")," às ",ah,"..."]}),(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:at,title:"Copiar",children:(0,b.jsx)(R.Copy,{className:"h-3 w-3"})})]})]})]}),(0,b.jsxs)("section",{className:"rounded-2xl border border-zinc-200/80 bg-zinc-50/70 p-4",children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,b.jsx)(m.User,{className:"h-4 w-4 text-zinc-500"}),(0,b.jsx)("h4",{className:"text-sm font-semibold text-zinc-700",children:"Resumo antes de salvar"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2",children:aD.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3 rounded-lg border border-zinc-200/80 bg-white px-3 py-2",children:[(0,b.jsx)("span",{className:"text-xs text-zinc-500",children:a.label}),(0,b.jsx)("span",{className:"max-w-[60%] truncate text-xs font-medium text-zinc-800",children:a.value})]},a.label))}),au.length>0&&(0,b.jsxs)("div",{className:"mt-3 rounded-xl border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-700",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 font-medium",children:[(0,b.jsx)(cQ.default,{className:"h-3.5 w-3.5"}),"Faltando para salvar"]}),(0,b.jsx)("p",{className:"mt-1",children:au.join(" • ")})]})]})]}),(0,b.jsx)("div",{className:"flex-none border-t border-zinc-100 bg-white px-8 py-6 z-10",children:t?(0,b.jsxs)("div",{className:"flex w-full items-center justify-end gap-2 animate-in fade-in slide-in-from-right-2",children:[(0,b.jsx)("span",{className:"mr-2 text-xs text-zinc-500",children:"Alterações não salvas. Descartar?"}),(0,b.jsx)(ad.Button,{variant:"outline",size:"sm",onClick:()=>u(!1),children:"Voltar"}),(0,b.jsx)(ad.Button,{variant:"destructive",size:"sm",onClick:aC,children:"Descartar"})]}):w&&y?(0,b.jsxs)("div",{className:"flex flex-col gap-3 rounded-xl border border-amber-200 bg-amber-50 px-3 py-2 animate-in fade-in slide-in-from-bottom-2 md:flex-row md:items-center md:justify-between",children:[(0,b.jsxs)("p",{className:"text-xs text-amber-700",children:["Você selecionou status ",(0,b.jsx)("strong",{children:"Realizada"}),". Confirmar criação agora com este status?"]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(ad.Button,{variant:"outline",size:"sm",onClick:()=>{x(!1),z(null)},children:"Revisar"}),(0,b.jsx)(ad.Button,{size:"sm",onClick:async()=>{x(!1),await ax(y),z(null)},children:"Confirmar realizada"})]})]}):(0,b.jsxs)("div",{className:"space-y-2",children:[r&&(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 rounded-lg border border-red-200 bg-red-50 px-3 py-2",children:[(0,b.jsx)("p",{className:"text-xs text-red-700",children:r}),(0,b.jsx)(ad.Button,{variant:"outline",size:"sm",className:"h-7",onClick:az,disabled:!C||k,children:"Tentar novamente"})]}),!aa&&(0,b.jsx)("p",{className:"text-xs text-zinc-500",children:"Complete os campos obrigatórios para liberar o salvamento."}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(ad.Button,{variant:"ghost",onClick:aB,children:"Cancelar"}),(0,b.jsx)(ad.Button,{onClick:ay,disabled:k||o||av,className:"min-w-[140px]",children:k?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"})," Salvando..."]}):o?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.CheckCircle,{className:"mr-2 h-4 w-4"})," Salvo"]}):"Salvar Visita"})]})]})})]});return(0,b.jsx)(bC.Dialog,{open:a,onOpenChange:a=>!a&&aB(),children:(0,b.jsx)(bC.DialogContent,{showCloseButton:!1,className:"flex max-h-[90vh] w-full sm:max-w-2xl md:max-w-3xl flex-col gap-0 p-0 overflow-hidden bg-white border-zinc-200/50 shadow-2xl sm:rounded-2xl",children:aE})})}let c$=(0,j.default)("link-2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var c_=a.i(57061);let c0=(0,j.default)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);function c1({options:a,value:d,onValueChange:e,placeholder:f="Selecionar...",searchPlaceholder:g="Buscar...",emptyMessage:h="Nenhum resultado encontrado.",disabled:i=!1,locked:j=!1,className:k,...l}){let[m,n]=c.useState(!1),o=c.useMemo(()=>a.find(a=>a.value===d)??null,[a,d]);return(0,b.jsxs)(bM.Popover,{open:m,onOpenChange:j||i?void 0:n,children:[(0,b.jsx)(bM.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(ad.Button,{variant:"outline",role:"combobox","aria-expanded":m,"aria-label":l["aria-label"],disabled:i,className:(0,ac.cn)("w-full justify-between font-normal h-10",!o&&"text-muted-foreground",j&&"cursor-default opacity-100 bg-zinc-50",k),onClick:a=>{j&&a.preventDefault()},children:[(0,b.jsx)("span",{className:"truncate",children:o?o.label:f}),j?(0,b.jsx)(c0,{className:"ml-2 h-3.5 w-3.5 shrink-0 text-zinc-400"}):(0,b.jsx)(bV,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(bM.PopoverContent,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:(0,b.jsxs)(bN.Command,{children:[(0,b.jsx)(bN.CommandInput,{placeholder:g}),(0,b.jsxs)(bN.CommandList,{children:[(0,b.jsx)(bN.CommandEmpty,{children:h}),(0,b.jsx)(bN.CommandGroup,{children:a.map(a=>(0,b.jsxs)(bN.CommandItem,{value:a.label,disabled:a.disabled,onSelect:()=>{let b=a.value===d?null:a.value;e(b,b?a:null),n(!1)},children:[(0,b.jsx)(A.Check,{className:(0,ac.cn)("mr-2 h-4 w-4 shrink-0",d===a.value?"opacity-100":"opacity-0")}),(0,b.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,b.jsx)("span",{className:"truncate",children:a.label}),a.subtitle&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground truncate",children:a.subtitle})]})]},a.value))})]})]})})]})}function c2({options:a,values:e,onValuesChange:f,placeholder:g="Selecionar...",searchPlaceholder:h="Buscar...",emptyMessage:i="Nenhum resultado encontrado.",disabled:j=!1,className:k,...l}){let[m,n]=c.useState(!1),o=c.useMemo(()=>a.filter(a=>e.includes(a.value)),[a,e]),p=c.useCallback(b=>{let c;c=e.includes(b.value)?e.filter(a=>a!==b.value):[...e,b.value];let d=a.filter(a=>c.includes(a.value));f(c,d)},[e,a,f]),q=c.useCallback(b=>{let c=e.filter(a=>a!==b),d=a.filter(a=>c.includes(a.value));f(c,d)},[e,a,f]);return(0,b.jsxs)("div",{className:(0,ac.cn)("space-y-1.5",k),children:[(0,b.jsxs)(bM.Popover,{open:m,onOpenChange:j?void 0:n,children:[(0,b.jsx)(bM.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(ad.Button,{variant:"outline",role:"combobox","aria-expanded":m,"aria-label":l["aria-label"],disabled:j,className:(0,ac.cn)("w-full justify-between font-normal h-10",0===e.length&&"text-muted-foreground"),children:[(0,b.jsx)("span",{className:"truncate",children:0===e.length?g:`${e.length} selecionado${e.length>1?"s":""}`}),(0,b.jsx)(bV,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(bM.PopoverContent,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",children:(0,b.jsxs)(bN.Command,{children:[(0,b.jsx)(bN.CommandInput,{placeholder:h}),(0,b.jsxs)(bN.CommandList,{children:[(0,b.jsx)(bN.CommandEmpty,{children:i}),(0,b.jsx)(bN.CommandGroup,{children:a.map(a=>{let c=e.includes(a.value);return(0,b.jsxs)(bN.CommandItem,{value:a.label,disabled:a.disabled,onSelect:()=>p(a),children:[(0,b.jsx)(A.Check,{className:(0,ac.cn)("mr-2 h-4 w-4 shrink-0",c?"opacity-100":"opacity-0")}),(0,b.jsxs)("div",{className:"flex flex-col min-w-0",children:[(0,b.jsx)("span",{className:"truncate",children:a.label}),a.subtitle&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground truncate",children:a.subtitle})]})]},a.value)})})]})]})})]}),o.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-1",children:o.map(a=>(0,b.jsxs)(aV.Badge,{variant:"secondary",className:"gap-1 pr-1 text-xs font-normal",children:[a.label,(0,b.jsx)("button",{type:"button",onClick:()=>q(a.value),className:"ml-0.5 rounded-full p-0.5 hover:bg-zinc-300/50","aria-label":`Remover ${a.label}`,children:(0,b.jsx)(d.X,{className:"h-3 w-3"})})]},a.value))})]})}var c3=a.i(54714),c4=a.i(25770);let c5=c3.object({type:c3.enum(["call","email","meeting","visit","task","follow-up","whatsapp"]),title:c3.string().min(6,"O título deve ter pelo menos 6 caracteres").max(120,"O título deve ter no máximo 120 caracteres"),date:c3.string().min(1,"Data é obrigatória"),time:c3.string().optional(),description:c3.string().max(2e3,"Descrição pode ter no máximo 2000 caracteres").optional(),responsible:c3.string().optional(),clientId:c3.string().optional(),clientName:c3.string().optional(),contactIds:c3.array(c3.string()).optional(),contactNames:c3.array(c3.string()).optional(),opportunityId:c3.string().optional(),opportunityTitle:c3.string().optional()}).superRefine((a,b)=>{["call","meeting","whatsapp","email"].includes(a.type)&&!a.time&&b.addIssue({code:c4.ZodIssueCode.custom,message:"Horário é obrigatório para este tipo de atividade",path:["time"]}),a.contactIds?.length&&!a.clientId&&b.addIssue({code:c4.ZodIssueCode.custom,message:"Selecione um cliente antes de vincular contatos",path:["contactIds"]}),a.opportunityId&&!a.clientId&&b.addIssue({code:c4.ZodIssueCode.custom,message:"Selecione um cliente antes de vincular uma oportunidade",path:["opportunityId"]})}),c6=c3.object({type:c3.enum(["call","email","meeting","visit","task","follow-up","whatsapp"]),title:c3.string().min(6,"O título deve ter pelo menos 6 caracteres").max(120,"O título deve ter no máximo 120 caracteres"),date:c3.string().min(1,"Data é obrigatória"),time:c3.string().optional(),description:c3.string().max(2e3,"Descrição pode ter no máximo 2000 caracteres").optional(),responsible:c3.string().optional(),clientId:c3.string().min(1,"Cliente é obrigatório"),clientName:c3.string().min(1),contactIds:c3.array(c3.string()).optional(),contactNames:c3.array(c3.string()).optional(),opportunityId:c3.string().optional(),opportunityTitle:c3.string().optional()}).superRefine((a,b)=>{["call","meeting","whatsapp","email"].includes(a.type)&&!a.time&&b.addIssue({code:c4.ZodIssueCode.custom,message:"Horário é obrigatório para este tipo de atividade",path:["time"]})});var c7=a.i(73331),c8=a.i(66812);let c9=(0,bO.create)()((0,bP.devtools)((a,b)=>({contacts:c8.mockContacts,isLoading:!1,getByClient:a=>b().contacts.filter(b=>b.clientId===a),getById:a=>b().contacts.find(b=>b.id===a)}),{name:"contact-store"})),da=[{id:"call",label:"Ligação",icon:e.Phone},{id:"whatsapp",label:"WhatsApp",icon:f.MessageCircle},{id:"email",label:"E-mail",icon:h.Mail},{id:"meeting",label:"Reunião",icon:n.Users},{id:"task",label:"Tarefa",icon:bZ.CheckSquare}],db=new Set(["call","meeting","whatsapp","email"]);function dc({isOpen:a,onClose:e,onSave:f,dealId:g,initialType:h="task",initialClientId:j,initialClientName:k,initialContactIds:l,initialContactNames:m,initialOpportunityId:n,initialOpportunityTitle:o,lockClient:q=!1,requireClient:r=!1}){let s=function(a){let[b,d]=c.useState(!1);return c.useEffect(()=>{function b(a){d(a.matches)}let c=window.matchMedia(a);return c.addEventListener("change",b),d(c.matches),()=>c.removeEventListener("change",b)},[a]),b}("(min-width: 768px)"),[t,u]=c.useState(!1),[v,w]=c.useState(!1),[x,y]=c.useState(null),z=(0,c7.useClientStore)(a=>a.clients),A=c9(a=>a.getByClient),C=(0,cK.useOpportunityStore)(a=>a.opportunities),D=r?c6:c5,E=(0,cL.useForm)({resolver:(0,cM.zodResolver)(D),mode:"onChange",defaultValues:{type:h,title:"",date:aO(new Date,"yyyy-MM-dd"),time:aO(new Date,"HH:mm"),description:"",clientId:j??"",clientName:k??"",contactIds:l??[],contactNames:m??[],opportunityId:n??"",opportunityTitle:o??""}}),{register:F,handleSubmit:G,control:H,setValue:I,formState:{errors:J,isValid:L},reset:M}=E,N=(0,cL.useWatch)({control:H,name:"type"}),O=(0,cL.useWatch)({control:H,name:"clientId"}),P=(0,cL.useWatch)({control:H,name:"description"}),Q=(0,cL.useWatch)({control:H,name:"contactIds"}),R=(0,cL.useWatch)({control:H,name:"opportunityId"}),S=c.useMemo(()=>z.map(a=>({value:a.id,label:a.companyName,subtitle:a.city??void 0})),[z]),T=c.useMemo(()=>O?A(O).map(a=>{var b;return{value:a.id,label:a.nome,subtitle:(b=a.cargo,bF.RESTAURANT_POSITIONS.find(a=>a.value===b)?.label??b)}}):[],[O,A]),U=c.useMemo(()=>O?C.filter(a=>a.clientId===O&&"open"===a.status).map(a=>({value:a.id,label:a.title})):[],[O,C]),V=c.useCallback((a,b)=>{I("clientId",a??"",{shouldValidate:!0}),I("clientName",b?.label??""),I("contactIds",[]),I("contactNames",[]),I("opportunityId",""),I("opportunityTitle","")},[I]),W=c.useCallback((a,b)=>{I("contactIds",a),I("contactNames",b.map(a=>a.label))},[I]),X=c.useCallback((a,b)=>{I("opportunityId",a??""),I("opportunityTitle",b?.label??"")},[I]),Y=c.useRef(O);c.useEffect(()=>{if(O&&O!==Y.current&&!q){let a=C.filter(a=>a.clientId===O&&"open"===a.status).sort((a,b)=>b.updatedAt.localeCompare(a.updatedAt));a.length>0&&(I("opportunityId",a[0].id),I("opportunityTitle",a[0].title))}Y.current=O},[O,q,C,I]),c.useEffect(()=>{a&&setTimeout(()=>{M({type:h,title:"",date:aO(new Date,"yyyy-MM-dd"),time:aO(new Date,"HH:mm"),description:"",clientId:j??"",clientName:k??"",contactIds:l??[],contactNames:m??[],opportunityId:n??"",opportunityTitle:o??""}),Y.current=j??"",w(!1),y(null)},50)},[a,M,h,j,k,l,m,n,o]);let Z=async a=>{u(!0),y(null);try{await Promise.resolve(f(a)),w(!0),setTimeout(()=>{u(!1),e()},320)}catch{u(!1),w(!1),y("Não foi possível criar a atividade. Tente novamente.")}},$=db.has(N),_=(0,b.jsxs)("div",{className:"flex h-full flex-col bg-white",children:[(0,b.jsx)("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(0,b.jsxs)("form",{id:"activity-form",onSubmit:G(Z),className:"space-y-5",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(a0.Label,{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Tipo de Atividade"}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-5",children:da.map(a=>{let c=a.icon,d=N===a.id;return(0,b.jsxs)("button",{type:"button",onClick:()=>I("type",a.id,{shouldValidate:!0}),className:(0,ac.cn)("flex h-[72px] flex-col items-center justify-center gap-2 rounded-xl border p-2 transition-all hover:bg-zinc-50",d?"border-brand bg-brand/5 text-brand ring-1 ring-brand":"border-zinc-200 bg-white text-zinc-600"),children:[(0,b.jsx)(c,{className:(0,ac.cn)("h-5 w-5",d?"text-brand":"text-zinc-400")}),(0,b.jsx)("span",{className:"text-[10px] font-medium",children:a.label})]},a.id)})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)(a0.Label,{className:"flex items-center gap-1.5 text-xs font-semibold uppercase tracking-wider text-zinc-500",children:[(0,b.jsx)(c$,{className:"h-3.5 w-3.5"}),"Vincular a"]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(a0.Label,{className:"mb-1.5 block text-xs text-zinc-500",children:["Cliente (restaurante)",r&&(0,b.jsx)("span",{className:"ml-0.5 text-red-500",children:"*"})]}),(0,b.jsx)(c1,{options:S,value:O||null,onValueChange:V,placeholder:"Buscar cliente...",searchPlaceholder:"Digite o nome do cliente...",emptyMessage:"Nenhum cliente encontrado.",locked:q,"aria-label":"Cliente"}),J.clientId&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-500",children:J.clientId.message}),!r&&!O&&(0,b.jsx)("p",{className:"mt-1 text-[11px] text-amber-600",children:"Vincular a um cliente melhora a rastreabilidade da atividade"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block text-xs text-zinc-500",children:"Contatos (pessoas)"}),(0,b.jsx)(c2,{options:T,values:Q??[],onValuesChange:W,placeholder:O?"Selecionar contatos...":"Selecione um restaurante primeiro",searchPlaceholder:"Buscar contato...",emptyMessage:"Nenhum contato encontrado.",disabled:!O,"aria-label":"Contatos"})]}),O&&U.length>0&&(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block text-xs text-zinc-500",children:"Oportunidade (opcional)"}),(0,b.jsx)(c1,{options:U,value:R||null,onValueChange:X,placeholder:"Selecionar oportunidade...",searchPlaceholder:"Buscar oportunidade...",emptyMessage:"Nenhuma oportunidade aberta.","aria-label":"Oportunidade"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Título"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(a_.Input,{...F("title"),placeholder:"Ex: Ligar para confirmar recebimento...",className:(0,ac.cn)("pr-10 font-medium",J.title&&"border-red-300 ring-red-100")}),(0,b.jsx)("button",{type:"button",onClick:()=>{let a=E.getValues("clientName")||"",b=da.find(a=>a.id===N)?.label??"Follow-up";I("title",a?`${b} com ${a}`:"Follow-up da proposta enviada",{shouldValidate:!0});let c=g?` para a negocia\xe7\xe3o`:"";I("description",`Verificar se o cliente teve alguma d\xfavida sobre os valores apresentados${c}.`)},className:"absolute right-2 top-1/2 -translate-y-1/2 rounded-full p-1 text-brand transition-colors hover:bg-brand/10",title:"Sugestão Menux AI",children:(0,b.jsx)(cP.Sparkles,{className:"h-4 w-4"})})]}),J.title&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-500",children:J.title.message})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Data"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(i.Calendar,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-zinc-400"}),(0,b.jsx)(a_.Input,{type:"date",...F("date"),className:(0,ac.cn)("pl-9",J.date&&"border-red-300 ring-red-100")})]}),J.date&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-500",children:J.date.message})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(a0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:["Hora"," ",$?(0,b.jsx)("span",{className:"text-red-500",children:"*"}):(0,b.jsx)("span",{className:"font-normal normal-case text-zinc-400",children:"(opcional)"})]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(p.Clock,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-zinc-400"}),(0,b.jsx)(a_.Input,{type:"time",...F("time"),className:(0,ac.cn)("pl-9",J.time&&"border-red-300 ring-red-100")})]}),J.time&&(0,b.jsx)("p",{className:"mt-1 text-xs text-red-500",children:J.time.message})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Descrição (Opcional)"}),(0,b.jsx)(bA.Textarea,{...F("description"),placeholder:"Detalhes adicionais sobre a atividade...",className:"min-h-[100px] resize-none",maxLength:2e3}),(0,b.jsxs)("div",{className:"mt-1 flex items-center justify-between",children:[J.description?(0,b.jsx)("p",{className:"text-xs text-red-500",children:J.description.message}):(0,b.jsx)("span",{}),(0,b.jsxs)("span",{className:"text-[11px] text-zinc-400",children:[P?.length??0,"/2000"]})]})]}),O&&N&&(0,b.jsx)("div",{className:"rounded-lg border border-indigo-100 bg-indigo-50/50 p-3",children:(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(cP.Sparkles,{className:"mt-0.5 h-4 w-4 text-indigo-500"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-indigo-900",children:"Sugestão Menux"}),(0,b.jsxs)("p",{className:"text-[11px] leading-relaxed text-indigo-700",children:["Baseado no histórico, o melhor horário para ligar para este cliente é entre ",(0,b.jsx)("strong",{children:"14:00 e 16:00"}),"."]})]})]})}),x&&(0,b.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2",children:(0,b.jsx)("p",{className:"text-xs text-red-700",children:x})})]})}),(0,b.jsx)("div",{className:"mt-auto border-t border-zinc-100 bg-zinc-50/50 p-4 md:px-6 md:py-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,b.jsx)(ad.Button,{variant:"ghost",onClick:e,disabled:t,children:"Cancelar"}),(0,b.jsx)(ad.Button,{type:"submit",form:"activity-form",className:"min-w-[160px] bg-brand text-white hover:bg-brand/90",disabled:t||v||!L,children:t?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Criando..."]}):v?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(B.CheckCircle,{className:"mr-2 h-4 w-4"}),"Criado!"]}):"Criar Atividade"})]})})]});return s?(0,b.jsx)(bC.Dialog,{open:a,onOpenChange:e,children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-md gap-0 overflow-hidden border-0 p-0 shadow-2xl sm:max-w-xl",children:[(0,b.jsx)(bC.DialogHeader,{className:"border-b border-zinc-100 bg-white px-6 py-4",children:(0,b.jsx)(bC.DialogTitle,{className:"flex items-center gap-2 font-heading text-lg font-semibold text-zinc-900",children:"Nova Atividade"})}),_]})}):(0,b.jsx)(c_.Sheet,{open:a,onOpenChange:e,children:(0,b.jsxs)(c_.SheetContent,{side:"bottom",className:"h-[90vh] gap-0 overflow-hidden rounded-t-[20px] p-0",children:[(0,b.jsx)(c_.SheetHeader,{className:"border-b border-zinc-100 bg-white px-4 py-3 text-left",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)(c_.SheetTitle,{className:"font-heading text-lg font-semibold text-zinc-900",children:"Nova Atividade"}),(0,b.jsx)("button",{onClick:e,className:"rounded-full p-2 hover:bg-zinc-100",children:(0,b.jsx)(d.X,{className:"h-5 w-5 text-zinc-500"})})]})}),_]})})}var dd=a.i(6468);let de=(0,bO.create)()((0,bP.devtools)((a,b)=>({visits:dd.mockVisits,isLoading:!1,getByOpportunity:a=>b().visits.filter(b=>b.opportunityId===a),getByClient:a=>b().visits.filter(b=>b.clientId===a),getById:a=>b().visits.find(b=>b.id===a)}),{name:"visit-store"}));var df=a.i(24700);let dg=(0,bO.create)()((0,bP.devtools)((a,b)=>({notes:df.mockNotes,isLoading:!1,getByOpportunity:a=>b().notes.filter(b=>b.opportunityId===a),getById:a=>b().notes.find(b=>b.id===a)}),{name:"note-store"}));var dh=a.i(69506);let di="proposta-enviada",dj="Maria Silva",dk=[{id:"pedido_cliente",label:"Pedido do cliente"},{id:"objecao",label:"Objeção"},{id:"decisao",label:"Decisão"},{id:"proximo_passo",label:"Próximo passo"}],dl=[{id:"all",label:"Todos"},{id:"cliente",label:"Cliente"},{id:"decisao",label:"Decisões"},{id:"proximo_passo",label:"Próximo passo"}],dm={general:{label:"Registro",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-700"},pedido_cliente:{label:"Pedido do cliente",chipClass:"border-sky-200 bg-sky-50 text-sky-700"},objecao:{label:"Objeção",chipClass:"border-amber-200 bg-amber-50 text-amber-700"},decisao:{label:"Decisão",chipClass:"border-emerald-200 bg-emerald-50 text-emerald-700"},proximo_passo:{label:"Próximo passo",chipClass:"border-brand/20 bg-brand/10 text-brand"},system:{label:"Sistema",chipClass:"border-zinc-200 bg-zinc-100 text-zinc-500"}};function dn(a){if("string"!=typeof a)return"empresa";switch(a.trim().toLowerCase()){case"empresa":default:return"empresa";case"contatos":return"contatos";case"visitas":return"visitas";case"atividades":return"atividades";case"negociacao":case"negociação":return"negociacao";case"anotacoes":case"anotações":case"notes":return"anotacoes";case"linha-do-tempo":case"timeline":return"linha-do-tempo"}}function dp(a,b){}let dq={hot:{label:"Quente",icon:(0,b.jsx)(q.Flame,{className:"h-3.5 w-3.5"}),color:"text-status-danger",bg:"bg-status-danger-light",border:"border-status-danger/15",chipClass:"bg-red-50 text-red-600 border-red-200/40 hover:bg-red-100/60"},warm:{label:"Morna",icon:(0,b.jsx)(r.Thermometer,{className:"h-3.5 w-3.5"}),color:"text-status-warning",bg:"bg-status-warning-light",border:"border-status-warning/15",chipClass:"bg-amber-50 text-amber-600 border-amber-200/40 hover:bg-amber-100/60"},cold:{label:"Fria",icon:(0,b.jsx)(s.Snowflake,{className:"h-3.5 w-3.5"}),color:"text-status-info",bg:"bg-status-info-light",border:"border-status-info/15",chipClass:"bg-sky-50 text-sky-600 border-sky-200/40 hover:bg-sky-100/60"}},dr=[{id:"lead-in",label:"Lead-In"},{id:"contato-feito",label:"Contato Feito"},{id:"reuniao-agendada",label:"Reuniao Agendada"},{id:"proposta-enviada",label:"Proposta Enviada"},{id:"negociacao",label:"Negociacao"},{id:"fechamento",label:"Fechamento"}],ds={open:{label:"Aberto",color:"text-brand",bg:"bg-brand/10"},won:{label:"Ganho",color:"text-status-success",bg:"bg-status-success/10"},lost:{label:"Perdido",color:"text-status-danger",bg:"bg-status-danger/10"}},dt=[{id:"restaurante",label:"Restaurante",icon:Q},{id:"cafeteria",label:"Cafeteria",icon:T},{id:"bar",label:"Bar / Pub",icon:U},{id:"pizzaria",label:"Pizzaria",icon:V},{id:"hamburgueria",label:"Hamburgueria",icon:Z},{id:"padaria",label:"Padaria",icon:W},{id:"sorveteria",label:"Sorveteria",icon:Y},{id:"delivery",label:"Delivery",icon:X},{id:"food-truck",label:"Food Truck",icon:q.Flame},{id:"bistro",label:"Bistrô",icon:$},{id:"buffet",label:"Buffet",icon:n.Users},{id:"adega",label:"Adega / Empório",icon:o}],du=[{id:"seg",label:"Segunda"},{id:"ter",label:"Terça"},{id:"qua",label:"Quarta"},{id:"qui",label:"Quinta"},{id:"sex",label:"Sexta"},{id:"sab",label:"Sábado"},{id:"dom",label:"Domingo"}],dv=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"],dw={id:"1",clientId:"client-1",title:"Restaurante Bela Vista",clientName:"Restaurante Bela Vista Ltda",nomeFantasia:"Restaurante Bela Vista",segmento:"Food service premium",nomeInterno:"",fonte:"Indicação parceiro",cep:"01411-000",logradouro:"Rua das Flores",numero:"123",complemento:"",bairro:"Jardim Paulista",cidade:"Sao Paulo",estado:"SP",telefoneEmpresa:"(11) 3456-7890",emailEmpresa:"contato@belavista.com",value:12e3,monthlyValue:1e3,stage:"contato-feito",temperature:"hot",score:78,responsibleId:"u1",responsibleName:"Maria Silva",responsibleAvatar:"",tags:["food-service","restaurante","premium"],source:"Indicacao",currency:"BRL",expectedCloseDate:"2026-03-15",createdAt:"2026-01-15",updatedAt:"2026-02-05",notes:"Cliente muito interessado. Agendar reuniao de apresentacao do modulo financeiro.",groupName:null,website:"https://belavista.com.br",instagram:"https://instagram.com/belavistarestaurante",cardapio:"https://belavista.com.br/cardapio",metadata:{stageValues:{origem_lead:"google"}}};function dx(a){return bF.RESTAURANT_POSITIONS.find(b=>b.value===a)?.label??a}function dy(a){return(0,bF.getPositionPatentScore)(a)}let dz=dh.mockUsers.filter(a=>a.isActive).map(a=>({id:a.id,name:a.name,avatar:""})),dA={"google-meet":"Google Meet",zoom:"Zoom",whatsapp:"WhatsApp",outro:"Outra plataforma"},dB={realizada:"Realizada","no-show":"No-show",remarcada:"Remarcada"},dC={agendada:0,realizada:1,cancelada:2},dD=[{id:"v1",type:"presencial",location:"Restaurante Bela Vista",status:"agendada",startAt:"2026-02-15T14:00:00.000Z",responsible:"Maria Silva",objective:"Validar escopo de onboarding e próximos marcos.",durationMinutes:60,createdAt:"2026-02-10T09:00:00.000Z"},{id:"v2",type:"remoto",location:"Google Meet",status:"realizada",startAt:"2026-02-10T10:00:00.000Z",responsible:"Pedro Santos",result:"Cliente demonstrou interesse no módulo financeiro.",objective:"Apresentar proposta e mapear objeções.",platform:"google-meet",link:"https://meet.google.com/abc-defg-hij",durationMinutes:60,createdAt:"2026-02-06T12:00:00.000Z"}],dE=[{id:"n1",authorId:"u1",authorName:"Maria Silva",createdAt:"2026-02-14T09:30:00.000Z",body:"Cliente solicitou nova proposta com desconto de 5% para fechar ainda este mês.",intent:"pedido_cliente",visibility:"team"},{id:"n2",authorId:"u2",authorName:"Pedro Santos",createdAt:"2026-02-10T16:15:00.000Z",body:"Reunião de alinhamento realizada. O cliente gostou bastante da demonstração do painel financeiro.",intent:"decisao",visibility:"team"},{id:"n3",authorId:"system",authorName:"Sistema",createdAt:"2026-02-05T10:00:00.000Z",body:"Oportunidade movida para a etapa de Negociação.",intent:"system",visibility:"team",isSystem:!0}],dF=["Preco alto","Escolheu concorrente","Sem orcamento","Projeto cancelado","Sem resposta","Outro"];function dG(a){return a.split(" ").map(a=>a[0]).join("").slice(0,2).toUpperCase()}function dH({banner:a,onDismiss:e}){(0,c.useEffect)(()=>{if("success"===a.variant||"info"===a.variant){let a=setTimeout(e,3e3);return()=>clearTimeout(a)}},[a,e]);let f={success:(0,b.jsx)(A.Check,{className:"h-3.5 w-3.5 shrink-0"}),error:(0,b.jsx)(I.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"}),info:(0,b.jsx)(M.Activity,{className:"h-3.5 w-3.5 shrink-0"}),warning:(0,b.jsx)(I.AlertTriangle,{className:"h-3.5 w-3.5 shrink-0"})};return(0,b.jsxs)("div",{className:`flex items-center gap-2 rounded-[10px] border px-3 py-2 font-body text-xs font-medium animate-in fade-in slide-in-from-top-1 duration-200 ${{success:"bg-status-success/10 text-status-success border-status-success/20",error:"bg-status-danger/10 text-status-danger border-status-danger/20",info:"bg-brand/10 text-brand border-brand/20",warning:"bg-status-warning/10 text-status-warning border-status-warning/20"}[a.variant]}`,role:"error"===a.variant?"alert":"status","aria-live":"error"===a.variant?"assertive":"polite",children:[f[a.variant],(0,b.jsx)("span",{className:"flex-1",children:a.message}),a.action&&(0,b.jsx)("button",{onClick:a.action.onClick,className:"shrink-0 underline underline-offset-2 transition-opacity hover:opacity-70",children:a.action.label}),(0,b.jsx)("button",{onClick:e,className:"shrink-0 rounded p-0.5 transition-colors hover:bg-black/10","aria-label":"Fechar",children:(0,b.jsx)(d.X,{className:"h-3 w-3"})})]})}function dI({value:a,onSave:e,className:f="",inputClassName:g="",type:h="text",readOnly:i=!1,validate:j}){let[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(a),[o,p]=(0,c.useState)(null),q=(0,c.useRef)(null);function r(){if(j){let a=j(m);if(a)return void p(a)}l(!1),p(null),m!==a&&e(m)}function s(){n(a),l(!1),p(null)}return((0,c.useEffect)(()=>{k&&q.current&&(q.current.focus(),q.current.select())},[k]),i)?(0,b.jsx)("span",{className:f,children:a||"--"}):k?(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(a_.Input,{ref:q,type:h,value:m,onChange:a=>{n(a.target.value),p(null)},onBlur:r,onKeyDown:a=>{"Enter"===a.key&&r(),"Escape"===a.key&&s()},className:`h-7 rounded-[10px] font-body text-sm ${g}`}),(0,b.jsx)("button",{onMouseDown:a=>a.preventDefault(),onClick:r,className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md text-status-success transition-colors hover:bg-status-success/10","aria-label":"Salvar",children:(0,b.jsx)(A.Check,{className:"h-3.5 w-3.5"})}),(0,b.jsx)("button",{onMouseDown:a=>a.preventDefault(),onClick:s,className:"flex h-6 w-6 shrink-0 items-center justify-center rounded-md text-zinc-400 transition-colors hover:bg-zinc-100","aria-label":"Cancelar",children:(0,b.jsx)(d.X,{className:"h-3.5 w-3.5"})})]}),o&&(0,b.jsx)("p",{className:"font-body text-[10px] text-status-danger",role:"alert",children:o})]}):(0,b.jsx)("span",{onClick:()=>{n(a),l(!0)},className:`cursor-pointer rounded-md px-1 py-0.5 transition-colors hover:bg-zinc-100 ${f}`,title:"Clique para editar",role:"button",tabIndex:0,onKeyDown:b=>{("Enter"===b.key||" "===b.key)&&(b.preventDefault(),n(a),l(!0))},children:a||"--"})}function dJ({currentStage:a,onStageChange:c,disabled:d=!1,statusBanner:e,onBannerDismiss:f}){let g=dr.findIndex(b=>b.id===a),h=dr[g]?.label??"Etapa";return(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(aW.DropdownMenu,{children:[(0,b.jsx)(aW.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{disabled:d,className:`inline-flex h-8 items-center gap-1.5 rounded-full border border-brand/20 bg-brand/10 px-3 py-1.5 font-body text-xs font-semibold text-brand transition-all duration-150 ease-out hover:bg-brand/15 hover:border-brand/30 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 focus-visible:ring-offset-1 ${d?"pointer-events-none opacity-50":""}`,"aria-label":`Etapa atual: ${h}`,children:[(0,b.jsx)("span",{className:"font-body text-[10px] font-medium text-brand/60",children:"Etapa"}),(0,b.jsx)("span",{className:"font-body text-[11px]",children:h}),(0,b.jsx)(L.ChevronDown,{className:"h-3 w-3 opacity-60"})]})}),(0,b.jsx)(aW.DropdownMenuContent,{align:"start",className:"rounded-[var(--radius-bento-card)] min-w-[200px]",children:dr.map((d,e)=>{let f=d.id===a,h=e<g;return(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>c(d.id),className:`flex items-center gap-2 font-body text-sm ${f?"font-semibold text-brand":h?"text-brand/70":"text-zinc-500"}`,children:[h&&(0,b.jsx)(A.Check,{className:"h-3.5 w-3.5 text-brand"}),f&&(0,b.jsx)(z.ChevronRight,{className:"h-3.5 w-3.5 text-brand"}),!h&&!f&&(0,b.jsx)("span",{className:"h-3.5 w-3.5"}),d.label,f&&(0,b.jsx)("span",{className:"ml-auto rounded-full bg-brand/10 px-1.5 py-0.5 font-body text-[9px] font-medium text-brand",children:"Atual"})]},d.id)})})]}),e&&(0,b.jsx)(dH,{banner:e,onDismiss:f})]})}function dK({events:a}){let[d,e]=(0,c.useState)("all"),f="all"===d?a:a.filter(a=>a.type===d);return(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(N.Filter,{className:"h-3.5 w-3.5 text-zinc-300"}),[{value:"all",label:"Todos"},{value:"activity",label:"Atividades"},{value:"stage-change",label:"Etapas"},{value:"note",label:"Notas"},{value:"value-change",label:"Valores"}].map(a=>(0,b.jsx)("button",{onClick:()=>e(a.value),className:(0,ac.cn)("rounded-full px-2.5 py-1 font-body text-[11px] font-medium transition-all",d===a.value?"bg-brand/10 text-brand":"bg-zinc-50 text-zinc-400 hover:bg-zinc-100"),children:a.label},a.value))]}),0===f.length?(0,b.jsxs)("div",{className:"flex flex-col items-center py-8 text-center",children:[(0,b.jsx)(M.Activity,{className:"h-8 w-8 text-zinc-200"}),(0,b.jsx)("p",{className:"mt-2 font-body text-sm text-zinc-400",children:"Sem atividades encontradas"}),(0,b.jsx)(ad.Button,{size:"sm",variant:"ghost",className:"mt-2 rounded-full font-body text-xs text-brand",onClick:()=>e("all"),children:"Limpar filtro"})]}):(0,b.jsx)("div",{className:"relative space-y-0",children:f.map((a,c)=>(0,b.jsxs)("div",{className:"group relative flex gap-3 pb-5",children:[c<f.length-1&&(0,b.jsx)("div",{className:"absolute left-[13px] top-7 h-full w-px bg-zinc-100"}),(0,b.jsx)("div",{className:(0,ac.cn)("relative z-10 flex h-7 w-7 shrink-0 items-center justify-center rounded-full transition-all ring-4 ring-white",function(a){switch(a){case"activity":return"bg-brand/10 text-brand";case"stage-change":return"bg-purple-50 text-purple-600";case"note":return"bg-yellow-50 text-yellow-600";case"value-change":return"bg-green-50 text-green-600";default:return"bg-zinc-100 text-zinc-500"}}(a.type)),children:function(a,c){if(c)return(0,b.jsx)(c,{className:"h-3.5 w-3.5"});switch(a){case"activity":return(0,b.jsx)(B.CheckCircle,{className:"h-3.5 w-3.5"});case"stage-change":return(0,b.jsx)(H.ArrowRight,{className:"h-3.5 w-3.5"});case"note":return(0,b.jsx)(G.FileText,{className:"h-3.5 w-3.5"});case"value-change":return(0,b.jsx)(l.DollarSign,{className:"h-3.5 w-3.5"});case"tag-added":return(0,b.jsx)(k,{className:"h-3.5 w-3.5"});default:return(0,b.jsx)(p.Clock,{className:"h-3.5 w-3.5"})}}(a.type,a.icon)}),(0,b.jsxs)("div",{className:"min-w-0 flex-1 pt-0.5",children:[(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-heading text-xs font-semibold text-zinc-900",children:a.title||"Evento"}),(0,b.jsx)("p",{className:"font-body text-sm text-zinc-600",children:a.description||a.message})]}),(0,b.jsxs)("div",{className:"mt-1 flex items-center gap-1.5",children:[(0,b.jsx)("div",{className:"flex h-4 w-4 items-center justify-center rounded-full bg-zinc-100 text-[9px] font-bold text-zinc-500",children:(a.author||a.user||"?").charAt(0)}),(0,b.jsxs)("p",{className:"font-body text-[10px] text-zinc-400",children:[a.author||a.user," · ",a.date]})]})]})]},a.id))})]})}function dL({contact:a,patentScore:c,isPrimary:d,onEdit:f,onDelete:g,onToggleDecisionMaker:i}){return(0,b.jsxs)("div",{className:"group flex items-stretch rounded-[14px] border border-zinc-100 transition-all hover:border-zinc-200 hover:shadow-sm",children:[(0,b.jsx)("button",{type:"button",onClick:i,className:`flex w-9 shrink-0 items-center justify-center rounded-l-[14px] border-r transition-colors ${a.isDecisionMaker?"border-brand/20 bg-brand/10 text-brand":"border-zinc-100 bg-zinc-50/50 text-zinc-300 hover:bg-zinc-100 hover:text-zinc-400"}`,"aria-label":a.isDecisionMaker?"Remover como decisor":"Marcar como decisor",title:a.isDecisionMaker?"Decisor (clique para remover)":"Marcar como decisor",children:(0,b.jsx)(y.Shield,{className:"h-3.5 w-3.5"})}),(0,b.jsxs)("div",{className:"flex flex-1 items-start justify-between p-3.5",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-zinc-50",children:(0,b.jsx)(m.User,{className:"h-4 w-4 text-zinc-400"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-heading text-sm font-semibold text-black",children:a.nome}),d&&(0,b.jsx)(aV.Badge,{className:"rounded-[6px] bg-zinc-100 px-1.5 py-0.5 font-body text-[9px] text-zinc-700",children:"Principal"}),a.isDecisionMaker&&(0,b.jsxs)(aV.Badge,{className:"gap-0.5 rounded-[6px] bg-brand/10 px-1.5 py-0.5 font-body text-[9px] text-brand",children:[(0,b.jsx)(y.Shield,{className:"h-2.5 w-2.5"})," Decisor"]}),(0,b.jsxs)(aV.Badge,{className:"gap-0.5 rounded-[6px] bg-indigo-50 px-1.5 py-0.5 font-body text-[9px] text-indigo-700",children:["Patente ",c]})]}),(0,b.jsx)("p",{className:"font-body text-[11px] text-zinc-400",children:dx(a.cargo)}),(0,b.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-3",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1 font-body text-[11px] text-zinc-500",children:[(0,b.jsx)(h.Mail,{className:"h-3 w-3"})," ",a.email]}),(0,b.jsxs)("span",{className:"flex items-center gap-1 font-body text-[11px] text-zinc-500",children:[(0,b.jsx)(e.Phone,{className:"h-3 w-3"})," ",a.telefone]})]}),a.personalidade&&(0,b.jsxs)("p",{className:"mt-1.5 font-body text-[11px] italic text-zinc-400",children:["“",a.personalidade,"”"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-0.5 opacity-0 transition-opacity group-hover:opacity-100",children:[(0,b.jsx)("button",{onClick:f,className:"flex h-7 w-7 items-center justify-center rounded-md text-zinc-400 transition-colors hover:bg-zinc-100 hover:text-zinc-600","aria-label":"Editar contato",children:(0,b.jsx)(C.Pencil,{className:"h-3.5 w-3.5"})}),(0,b.jsx)("button",{onClick:g,className:"flex h-7 w-7 items-center justify-center rounded-md text-zinc-400 transition-colors hover:bg-status-danger/10 hover:text-status-danger","aria-label":"Remover contato",children:(0,b.jsx)(w.Trash2,{className:"h-3.5 w-3.5"})})]})]})]})}function dM({current:a,onChange:c,suggested:d,disabled:e=!1}){let f=dq[a];return(0,b.jsx)("div",{className:`flex items-center gap-2 ${e?"pointer-events-none opacity-50":""}`,children:(0,b.jsxs)(aW.DropdownMenu,{children:[(0,b.jsx)(aW.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{disabled:e,className:`inline-flex h-8 items-center gap-1.5 rounded-full border px-3 py-1.5 font-body text-[11px] font-semibold transition-all duration-150 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/40 focus-visible:ring-offset-1 ${f.chipClass}`,"aria-label":`Temperatura: ${f.label}`,children:[f.icon,f.label,(0,b.jsx)(L.ChevronDown,{className:"h-3 w-3 opacity-50"})]})}),(0,b.jsxs)(aW.DropdownMenuContent,{align:"start",className:"rounded-[var(--radius-bento-card)] min-w-[180px]",children:[["hot","warm","cold"].map(d=>{let e=dq[d],f=a===d;return(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>c(d),className:`flex items-center gap-2 font-body text-sm ${f?"font-semibold":""}`,children:[(0,b.jsx)("span",{className:e.color,children:e.icon}),(0,b.jsx)("span",{className:f?e.color:"text-zinc-600",children:e.label}),f&&(0,b.jsx)(A.Check,{className:"ml-auto h-3.5 w-3.5 text-brand"})]},d)}),d&&d!==a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(aW.DropdownMenuSeparator,{}),(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>c(d),className:"flex items-center gap-2 font-body text-xs text-brand",children:[(0,b.jsx)(x.Star,{className:"h-3 w-3"}),"Sugestao: ",dq[d].label]})]})]})]})})}function dN({onConfirm:a,onCancel:d,isLoading:e}){let[f,g]=(0,c.useState)("");return(0,b.jsxs)("div",{className:"animate-in slide-in-from-right-2 space-y-4 rounded-[14px] border border-status-danger/20 bg-status-danger/5 p-4 duration-200",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{className:"font-heading text-sm font-semibold text-status-danger",children:"Motivo da perda"}),(0,b.jsx)("p",{className:"mt-0.5 font-body text-xs text-zinc-500",children:"Marcar como perdido encerra a oportunidade. Voce quer continuar?"})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:dF.map(a=>(0,b.jsx)("button",{onClick:()=>g(a),className:`rounded-full border px-3 py-1.5 font-body text-xs transition-all ${f===a?"border-status-danger bg-status-danger text-white":"border-zinc-200 bg-white text-zinc-600 hover:border-zinc-300"}`,children:a},a))}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,b.jsx)(ad.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-xs",onClick:d,disabled:e,children:"Cancelar"}),(0,b.jsxs)(ad.Button,{size:"sm",className:"rounded-full bg-status-danger font-heading text-xs text-white hover:bg-status-danger/90",onClick:()=>{f&&a(f)},disabled:!f||e,children:[e?(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):null,"Confirmar perda"]})]})]})}function dO({value:a,children:d,className:e=""}){let[f,g]=(0,c.useState)(!1),h=(0,c.useCallback)(()=>{navigator.clipboard.writeText(a).then(()=>{g(!0),setTimeout(()=>g(!1),1200)})},[a]);return(0,b.jsxs)("button",{onClick:h,className:`group/copy relative inline-flex items-center gap-1.5 transition-all duration-120 ease-out hover:scale-[1.03] hover:bg-black/[0.04] active:scale-[0.97] rounded-md px-1 py-0.5 ${e}`,title:`Copiar: ${a}`,children:[d,f?(0,b.jsxs)("span",{className:"inline-flex items-center gap-0.5 font-body text-[9px] font-semibold text-status-success animate-in fade-in duration-[90ms]",children:[(0,b.jsx)(A.Check,{className:"h-2.5 w-2.5"}),"Copiado"]}):(0,b.jsx)(R.Copy,{className:"h-2.5 w-2.5 text-zinc-300 opacity-0 transition-opacity duration-120 group-hover/copy:opacity-100"})]})}function dP({nomeFantasia:a,segmento:d,enderecoFormatado:f,telefoneEmpresa:g,emailEmpresa:i,website:j,instagramUrl:k,cardapioUrl:l,primaryContact:n,stage:o,temperature:p,responsibleName:q,responsibleId:r,suggestedTemperature:s,onStageChange:t,onTemperatureChange:w,onResponsibleChange:x,onOpenPrimaryContact:y,onCreatePrimaryContact:B,teamMembers:D,isLocked:F,stageBanner:G,onStageBannerDismiss:H}){let[I,J]=(0,c.useState)(null),K=j||k||l,L=g||i||K,M=(0,c.useCallback)(a=>{J(a),setTimeout(()=>J(null),1200)},[]);return(0,b.jsx)("div",{className:"mt-4 pb-2 animate-in fade-in slide-in-from-bottom-1 duration-[180ms] ease-out",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-12 md:gap-6",children:[(0,b.jsxs)("div",{className:"md:col-span-5 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,b.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg bg-brand/8",children:(0,b.jsx)(u.Building2,{className:"h-3.5 w-3.5 text-brand"})}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsx)("p",{className:"truncate font-heading text-[13px] font-bold text-black leading-tight",children:a||"Sem empresa vinculada"}),d&&(0,b.jsx)("p",{className:"truncate font-body text-[10px] text-zinc-400 leading-tight",children:d})]})]}),(0,b.jsxs)("div",{className:"mt-1.5 pl-[38px]",children:[f?(0,b.jsxs)("p",{className:"truncate font-body text-[10px] text-zinc-400 leading-tight",title:f,children:[(0,b.jsx)(E.MapPin,{className:"mr-0.5 inline h-2.5 w-2.5 text-zinc-300 align-[-1px]"}),f]}):(0,b.jsxs)("p",{className:"font-body text-[10px] text-zinc-300 italic leading-tight",children:[(0,b.jsx)(E.MapPin,{className:"mr-0.5 inline h-2.5 w-2.5 text-zinc-200 align-[-1px]"}),"Endereco nao informado"]}),L?(0,b.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-0.5",children:[g&&(0,b.jsxs)(dO,{value:g,className:"!px-1 !py-0.5",children:[(0,b.jsx)(e.Phone,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,b.jsx)("span",{className:"font-body text-[10px] text-zinc-500",children:g})]}),i&&(0,b.jsxs)(dO,{value:i,className:"!px-1 !py-0.5",children:[(0,b.jsx)(h.Mail,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,b.jsx)("span",{className:"truncate max-w-[120px] font-body text-[10px] text-zinc-500",children:i})]}),j&&(0,b.jsxs)("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 rounded px-1 py-0.5 font-body text-[10px] text-brand/70 transition-all duration-[120ms] hover:bg-brand/5 hover:text-brand hover:scale-[1.05] active:scale-[0.97]",children:[(0,b.jsx)(P.ExternalLink,{className:"h-2.5 w-2.5"}),"Site"]}),k&&(0,b.jsxs)("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 rounded px-1 py-0.5 font-body text-[10px] text-brand/70 transition-all duration-[120ms] hover:bg-brand/5 hover:text-brand hover:scale-[1.05] active:scale-[0.97]",children:[(0,b.jsx)(O,{className:"h-2.5 w-2.5"}),"IG"]}),l&&(0,b.jsxs)("a",{href:l,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-0.5 rounded px-1 py-0.5 font-body text-[10px] text-brand/70 transition-all duration-[120ms] hover:bg-brand/5 hover:text-brand hover:scale-[1.05] active:scale-[0.97]",children:[(0,b.jsx)(Q,{className:"h-2.5 w-2.5"}),"Menu"]})]}):(0,b.jsx)("p",{className:"mt-1.5 font-body text-[10px] text-zinc-300 italic",children:"Sem links cadastrados"})]})]}),(0,b.jsx)("div",{className:"md:col-span-4 md:border-l md:border-zinc-200/30 md:pl-4 min-w-0",children:n?(0,b.jsxs)("div",{className:"group/contact relative",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-zinc-100",children:(0,b.jsx)(m.User,{className:"h-3.5 w-3.5 text-zinc-500"})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("p",{className:"truncate font-heading text-[13px] font-semibold text-black leading-tight",children:n.nome}),(0,b.jsx)("p",{className:"truncate font-body text-[10px] text-zinc-400 leading-tight",children:dx(n.cargo)}),(0,b.jsxs)("p",{className:"truncate font-body text-[10px] text-zinc-500 leading-tight",children:["Patente ",dy(n.cargo)]})]})]}),(0,b.jsxs)("div",{className:"mt-1.5 flex flex-wrap items-center gap-0.5 pl-[36px]",children:[n.email&&(0,b.jsxs)(dO,{value:n.email,className:"!px-1 !py-0.5",children:[(0,b.jsx)(h.Mail,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,b.jsx)("span",{className:"truncate max-w-[110px] font-body text-[10px] text-zinc-500",children:n.email})]}),n.telefone&&(0,b.jsxs)(dO,{value:n.telefone,className:"!px-1 !py-0.5",children:[(0,b.jsx)(e.Phone,{className:"h-2.5 w-2.5 text-zinc-400"}),(0,b.jsx)("span",{className:"font-body text-[10px] text-zinc-500",children:n.telefone})]})]}),(0,b.jsxs)("button",{type:"button",onClick:y,className:"absolute top-0 right-0 inline-flex items-center gap-0.5 rounded-md border border-zinc-200/50 bg-white px-1.5 py-0.5 font-body text-[9px] font-medium text-zinc-400 shadow-sm opacity-0 transition-all duration-[120ms] group-hover/contact:opacity-100 hover:text-brand hover:border-brand/20 active:scale-[0.98]",children:[(0,b.jsx)(z.ChevronRight,{className:"h-2 w-2"}),"Abrir"]})]}):(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-full bg-zinc-100",children:(0,b.jsx)(m.User,{className:"h-3.5 w-3.5 text-zinc-300"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-body text-[10px] text-zinc-400",children:"Sem decisor definido"}),(0,b.jsxs)("button",{type:"button",onClick:B,className:"mt-0.5 inline-flex items-center gap-0.5 font-body text-[10px] font-medium text-brand transition-colors hover:text-brand/80",children:[(0,b.jsx)(v.Plus,{className:"h-2.5 w-2.5"}),"Definir contato"]})]})]})}),(0,b.jsx)("div",{className:"md:col-span-3 md:border-l md:border-zinc-200/30 md:pl-4 min-w-0",children:(0,b.jsxs)("div",{className:"relative space-y-1.5",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-1.5",children:[(0,b.jsx)(dJ,{currentStage:o,onStageChange:a=>{t(a),M("Atualizado")},disabled:F,statusBanner:G,onBannerDismiss:H}),(0,b.jsx)(dM,{current:p,onChange:a=>{w(a),M("Atualizado")},suggested:s,disabled:F})]}),(0,b.jsx)("div",{className:"flex items-center justify-end",children:(0,b.jsxs)(aW.DropdownMenu,{children:[(0,b.jsx)(aW.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{className:"group/owner flex items-center gap-1.5 rounded-full py-0.5 pl-0.5 pr-2 transition-colors duration-[140ms] hover:bg-white/80 active:scale-[0.98]",children:[(0,b.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-brand text-[8px] font-bold text-white",children:dG(q)}),(0,b.jsx)("span",{className:"font-body text-[10px] text-zinc-500",children:q}),(0,b.jsx)(C.Pencil,{className:"h-2 w-2 text-zinc-300 opacity-0 transition-opacity duration-[140ms] group-hover/owner:opacity-100"})]})}),(0,b.jsx)(aW.DropdownMenuContent,{align:"end",className:"rounded-xl min-w-[180px]",children:D.map(a=>(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>{x(a.id,a.name),M("Atualizado")},className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-zinc-200 text-[9px] font-bold text-zinc-600",children:dG(a.name)}),(0,b.jsx)("span",{className:"font-body text-xs",children:a.name}),a.id===r&&(0,b.jsx)(A.Check,{className:"ml-auto h-3.5 w-3.5 text-brand"})]},a.id))})]})}),I&&(0,b.jsxs)("div",{className:"absolute -top-1.5 right-0 inline-flex items-center gap-0.5 rounded-full bg-status-success/10 px-1.5 py-0.5 font-body text-[8px] font-semibold text-status-success animate-in fade-in duration-90",children:[(0,b.jsx)(A.Check,{className:"h-2 w-2"}),I]})]})})]})})}function dQ({children:a,title:c,description:d,icon:e,delay:f=0,successMessage:g,headerAction:h}){return(0,b.jsxs)(aa.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.18,delay:f,ease:"easeOut"},className:"relative rounded-[20px] border border-zinc-100 bg-white p-5 shadow-sm transition-all duration-300 hover:shadow-md group",children:[(0,b.jsx)(ab.AnimatePresence,{children:g&&(0,b.jsxs)(aa.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute -top-3 right-5 z-20 flex items-center gap-1.5 rounded-full bg-emerald-50 px-3 py-1 font-heading text-[11px] font-bold text-emerald-600 shadow-sm border border-emerald-100",children:[(0,b.jsx)(A.Check,{className:"h-3 w-3"}),g]})}),(0,b.jsxs)("div",{className:"mb-5 flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3.5",children:[(0,b.jsx)("div",{className:"flex h-11 w-11 items-center justify-center rounded-[14px] bg-zinc-50 text-zinc-400 group-hover:bg-brand/5 group-hover:text-brand transition-colors",children:(0,b.jsx)(e,{className:"h-5.5 w-5.5"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-heading text-[15px] font-semibold tracking-tight text-zinc-900",children:c}),(0,b.jsx)("p",{className:"font-body text-[11px] text-zinc-400 leading-relaxed",children:d})]})]}),h&&(0,b.jsx)("div",{children:h})]}),(0,b.jsx)("div",{className:"space-y-4",children:a})]})}function dR(){let{modalType:a,modalData:j,closeModal:l}=(0,bE.useUIStore)(),o="lead-card"===a,q=j?.id,r=(0,c.useMemo)(()=>{let a=j?.opportunitySnapshot;return a&&"object"==typeof a?"string"!=typeof a.id?null:a:null},[j?.opportunitySnapshot]),s=(0,c.useMemo)(()=>{let a=j?.focusFields;return Array.isArray(a)?a.filter(a=>"string"==typeof a&&a.trim().length>0):[]},[j?.focusFields]),u=(0,c.useMemo)(()=>"string"!=typeof j?.pendingStage?null:j.pendingStage,[j?.pendingStage]),x=(0,c.useMemo)(()=>dn(j?.initialTab),[j?.initialTab]),G=(0,c.useMemo)(()=>{let a=j?.prefillNote;return"string"==typeof a?a.trim():""},[j?.prefillNote]),I=(0,cK.useOpportunityStore)(a=>a.opportunities),L=(0,c.useMemo)(()=>{let a=I.find(a=>a.id===q);return a||(r?.id===q?r:null)},[I,r,q]),M=(0,c.useMemo)(()=>L?{...dw,id:L.id,title:L.title,clientName:L.clientName,nomeFantasia:L.clientName||L.title,value:L.value,monthlyValue:L.monthlyValue,stage:L.stage,temperature:L.temperature,responsibleId:L.responsibleId,responsibleName:L.responsibleName,tags:L.tags,source:L.source??dw.source,expectedCloseDate:L.expectedCloseDate??dw.expectedCloseDate,createdAt:L.createdAt,updatedAt:L.updatedAt,notes:L.notes??dw.notes}:dw,[L]),P=(0,c.useMemo)(()=>M.metadata?.stageValues||{},[M.metadata?.stageValues]),T=(0,c.useMemo)(()=>M.notes?.trim()||"",[M.notes]),U=(0,c.useMemo)(()=>M.responsibleId??"u1",[M.responsibleId]),V=(0,c.useMemo)(()=>M.stage,[M.stage]),[W,X]=(0,c.useState)(M.title),[Y,Z]=(0,c.useState)(V),[$,af]=(0,c.useState)(M.temperature),[ag,ah]=(0,c.useState)(M.responsibleId),[ai,aj]=(0,c.useState)(M.responsibleName),[ak,al]=(0,c.useState)(()=>{let a=c9.getState().getByClient(M.clientId??"");return a.length>0?a:[]}),am=(0,c.useMemo)(()=>[...ak].sort((a,b)=>dy(b.cargo)-dy(a.cargo)),[ak]),[an,ao]=(0,c.useState)("open"),ap="open"!==an,[aq]=(0,c.useState)(M.source),[ar]=(0,c.useState)(M.nomeFantasia),[as]=(0,c.useState)(M.segmento),[at,au]=(0,c.useState)(M.cep),[av,aw]=(0,c.useState)(M.logradouro),[ax,ay]=(0,c.useState)(M.numero),[az,aA]=(0,c.useState)(M.complemento),[aB,aC]=(0,c.useState)(M.bairro),[aD,aE]=(0,c.useState)(M.cidade),[aF,aG]=(0,c.useState)(M.estado),[aH,aI]=(0,c.useState)(!1),[aJ,aK]=(0,c.useState)(null),[aL]=(0,c.useState)(M.telefoneEmpresa),[aM]=(0,c.useState)(M.emailEmpresa),[aN,aO]=(0,c.useState)(M.website),[aP,aQ]=(0,c.useState)(M.instagram),[aR,aS]=(0,c.useState)(M.cardapio),[aT,aU]=(0,c.useState)([]),[aV,aX]=(0,c.useState)("daily"),[aY,aZ]=(0,c.useState)({open:"08:00",close:"18:00"}),[a4,a5]=(0,c.useState)(du.reduce((a,b)=>({...a,[b.id]:{active:!0,open:"08:00",close:"19:00",isClosed:!1}}),{})),[a6]=(0,c.useState)({localizacao:null,tipo:null,horario:null,online:null}),[a7,a8]=(0,c.useState)(P),[,a9]=(0,c.useState)({}),[,ba]=(0,c.useState)({}),[,bb]=(0,c.useState)(null),[,bc]=(0,c.useState)(!1),bd=(0,c.useRef)({}),[be,bf]=(0,c.useState)(""),[bg,bh]=(0,c.useState)("general"),[bi,bj]=(0,c.useState)("team"),[bk,bl]=(0,c.useState)("idle"),[bm,bn]=(0,c.useState)(null),[bo,bp]=(0,c.useState)("all"),[bq,br]=(0,c.useState)(null),[bs,bt]=(0,c.useState)(""),[bv,bw]=(0,c.useState)("idle"),[bx,bH]=(0,c.useState)(null),[bI,bK]=(0,c.useState)({action:"",dueDate:"",channel:"call",ownerId:U}),[bL,bM]=(0,c.useState)("idle"),[bN,bO]=(0,c.useState)(null),[bP,bQ]=(0,c.useState)(()=>{let a=[...dE];return T&&a.unshift({id:`n-init-${M.id}`,authorId:"u1",authorName:dj,createdAt:new Date().toISOString(),body:T,intent:"general",visibility:"team"}),a}),bR=async a=>{au((0,a1.maskCep)(a)),aK(null);let b=a.replace(/\D/g,"").slice(0,8);if(8===b.length){aI(!0);try{let a=await fetch(`https://viacep.com.br/ws/${b}/json/`),c=await a.json();c.erro?aK("CEP não encontrado."):(aw(c.logradouro||""),aC(c.bairro||""),aE(c.localidade||""),aG(c.uf||""),c.complemento&&aA(c.complemento),dp("cep_lookup_success",{cep:b}))}catch{aK("Erro ao buscar CEP. Verifique sua conexão.")}finally{aI(!1)}}},bS=(0,c.useMemo)(()=>{let a=[];return av&&a.push(ax?`${av}, ${ax}`:av),az&&a.push(az),aB&&a.push(aB),aD&&aF?a.push(`${aD} - ${aF}`):aD&&a.push(aD),a.join(", ")},[av,ax,az,aB,aD,aF]),[bT,bU]=(0,c.useState)(null),[bV,bW]=(0,c.useState)(null),[bX,bY]=(0,c.useState)(!1),[bZ,b$]=(0,c.useState)(!1),[b_,b0]=(0,c.useState)(!1),[b1,b2]=(0,c.useState)(!1),[b3,b4]=(0,c.useState)(!1),[b5,b6]=(0,c.useState)(!1),[b7,b9]=(0,c.useState)(null),[ca,cb]=(0,c.useState)(null),[cc,cd]=(0,c.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),[ce,cf]=(0,c.useState)(null),[cg,ch]=(0,c.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),[ci,cj]=(0,c.useState)(x),ck=(0,c.useMemo)(()=>be.trim().length>0||null!==bq&&bs.trim().length>0||bI.action.trim().length>0,[be,bq,bs,bI.action]),[cl,cm]=(0,c.useState)(null),[cn,co]=(0,c.useState)(!1),[cp,cq]=(0,c.useState)(null),cr=(0,c.useCallback)(a=>{let b=dn(a);b!==ci&&(ck?(cm(b),cq("tab"),co(!0)):cj(b))},[ci,ck]),cs=(0,c.useCallback)(()=>{ck?(cq("close"),co(!0)):l()},[ck,l]),ct=(0,c.useCallback)(()=>{co(!1),bf(""),bt(""),br(null),bK({action:"",dueDate:"",channel:"call",ownerId:U}),"tab"===cp&&cl?cj(cl):"close"===cp&&l(),cq(null),cm(null)},[cp,cl,l,U]),cu=(0,c.useCallback)(()=>{co(!1),cq(null),cm(null)},[]),[cv,cw]=(0,c.useState)(!1),[cx,cy]=(0,c.useState)(!1),[cz,cB]=(0,c.useState)("task"),cC=(0,c.useCallback)((a="task")=>{ap||(cB(a),cy(!0))},[ap]),[cD,cE]=(0,c.useState)("all"),[cF,cG]=(0,c.useState)(null),[cH,cI]=(0,c.useState)(dD),cJ=(0,c.useMemo)(()=>{let a={all:cH.length,agendada:0,realizada:0,cancelada:0};for(let b of cH)a[b.status]+=1;return a},[cH]),cL=(0,c.useMemo)(()=>[..."all"===cD?cH:cH.filter(a=>a.status===cD)].sort((a,b)=>{if("all"===cD&&a.status!==b.status)return dC[a.status]-dC[b.status];let c=new Date(a.startAt).getTime(),d=new Date(b.startAt).getTime();return"agendada"===cD||"agendada"===a.status&&"agendada"===b.status?c-d:d-c}),[cD,cH]),cM=(0,c.useCallback)((a,b)=>{ap||cH.find(b=>b.id===a)&&(cI(c=>c.map(c=>c.id===a?{...c,status:b,result:"realizada"!==b||c.result?c.result:"Visita concluída. Próximos passos registrados.",cancellationReason:"cancelada"===b?c.cancellationReason||"Cancelada pelo responsável":void 0}:c)),bU({message:`Visita marcada como ${b}.`,variant:"cancelada"===b?"warning":"success"}))},[ap,cH]),cN=(0,c.useCallback)(a=>{if(ap)return;let b=cH.find(b=>b.id===a);if(!b)return;let c=new Date(b.startAt),d=Number.isNaN(c.getTime())?new Date:new Date(c.getTime()+6048e5),e={...b,id:`visit-${Date.now()}`,status:"agendada",result:void 0,cancellationReason:void 0,startAt:d.toISOString(),createdAt:new Date().toISOString()};cI(a=>[e,...a]),cE("agendada"),cG(e.id),bU({message:"Visita duplicada e reagendada para a próxima semana",variant:"success"})},[ap,cH]),cO=(0,c.useCallback)((a,b)=>{if(ap)return;let c=cH.find(b=>b.id===a);if(!c)return;let d=new Date(c.startAt);Number.isNaN(d.getTime())||(d.setDate(d.getDate()+b),cI(b=>b.map(b=>b.id===a?{...b,startAt:d.toISOString(),status:"agendada",cancellationReason:void 0}:b)),bU({message:`Visita reagendada em ${b} dia${b>1?"s":""}.`,variant:"info"}))},[ap,cH]),cP=(0,c.useCallback)(a=>{ap||(cI(b=>b.filter(b=>b.id!==a)),cF===a&&cG(null),bU({message:"Visita removida da agenda",variant:"info"}))},[cF,ap]),cQ=(0,c.useCallback)(a=>{cG(b=>b===a?null:a)},[]),[cR,cS]=(0,c.useState)("all"),[cT,cU]=(0,c.useState)(()=>bG.mockActivities.filter(a=>a.opportunityId===M.id)),cV=(0,c.useMemo)(()=>dr.findIndex(a=>a.id===Y),[Y]),cW=(0,c.useMemo)(()=>ak.some(a=>a.isDecisionMaker),[ak]),cX=(0,c.useMemo)(()=>(0,bF.calculateCardPatentScore)(ak),[ak]),cY=(0,c.useMemo)(()=>dr[cV+1]??null,[cV]),c$=(0,c.useMemo)(()=>ak.find(a=>a.isDecisionMaker)??am[0]??null,[ak,am]),c_=(0,c.useMemo)(()=>cT,[cT]),c0=(0,c.useMemo)(()=>"pending"===cR?cT.filter(a=>"completed"!==a.status):"completed"===cR?cT.filter(a=>"completed"===a.status):cT,[cR,cT]),c1=(0,c.useMemo)(()=>(0,bF.calculateLeadScore)(M,c_),[M,c_]),c2=(0,c.useMemo)(()=>(0,bF.calculateTemperature)(M),[M]),c3=(0,c.useMemo)(()=>"all"===bo?bP:"cliente"===bo?bP.filter(a=>"pedido_cliente"===a.intent):"decisao"===bo?bP.filter(a=>"decisao"===a.intent):bP.filter(a=>"proximo_passo"===a.intent),[bo,bP]),c4=(0,c.useMemo)(()=>{let a=new Map;return[...c3].sort((a,b)=>new Date(b.createdAt).getTime()-new Date(a.createdAt).getTime()).forEach(b=>{let c=b.createdAt.slice(0,10);a.has(c)||a.set(c,{dayLabel:new Date(b.createdAt).toLocaleDateString("pt-BR",{weekday:"long",day:"2-digit",month:"2-digit"}),items:[]}),a.get(c)?.items.push(b)}),Array.from(a.values())},[c3]),c5=(0,c.useMemo)(()=>{let a=Date.now()-6048e5,b=bP.some(b=>{if(b.isSystem)return!1;let c=new Date(b.createdAt).getTime();return!Number.isNaN(c)&&c>=a}),c=cT.some(b=>{let c=new Date(b.createdAt).getTime();return!Number.isNaN(c)&&c>=a});return b||c},[cT,bP]),c6=(0,c.useCallback)(a=>{let b=(bJ[a]||[]).filter(a=>a.required),c={},d=b.filter(a=>{var b;let d=null==(b=a7[a.id])||"boolean"!=typeof b&&("number"==typeof b?Number.isNaN(b)||0===b:0===b.toString().trim().length);return d&&(c[a.id]="Preencha este campo para avançar etapa."),d});return ba(a=>({...a,...c})),d},[a7]);(0,c.useEffect)(()=>{o&&dp("view_opened",{entity_type:"deal",entity_id:M.id})},[o,M.id]),(0,c.useEffect)(()=>{let a=bd.current;return()=>{Object.values(a).forEach(a=>clearTimeout(a))}},[]),(0,c.useEffect)(()=>{cj(x),cI([...dD]),cE("all"),cG(null),cw(!1),cS("all"),cU(bG.mockActivities.filter(a=>a.opportunityId===M.id)),Z(V),b6(!1),a8(P),ba({}),a9({}),bb(null),b9(null),cb(null),bc(!1),bf(G),bh("general"),bj("team"),bl("idle"),bn(null),bp("all"),br(null),bt(""),bw("idle"),bH(null),bK({action:"",dueDate:"",channel:"call",ownerId:U}),bM("idle"),bO(null),bU(null),bW(null);let a=[...dE];T&&a.unshift({id:`n-init-${M.id}`,authorId:"u1",authorName:dj,createdAt:new Date().toISOString(),body:T,intent:"general",visibility:"team"}),bQ(a)},[T,U,V,P,x,G,M.id]),(0,c.useEffect)(()=>{if(!o||0===s.length)return;let a=u?dr.find(a=>a.id===u)?.label:null;cj("empresa"),bU({message:a?`Movimento bloqueado para ${a}. Preencha os campos obrigat\xf3rios.`:"Movimento bloqueado. Preencha os campos obrigatórios para avançar etapa.",variant:"warning",action:{label:"Ir para campos",onClick:()=>cj("empresa")}})},[s.length,o,u]);let c7=(0,c.useCallback)(a=>{if(ap||a===Y)return!1;let b=dr.findIndex(a=>a.id===Y);if(dr.findIndex(b=>b.id===a)>b){if(ak.length<1)return cj("contatos"),b9({message:"Adicione pelo menos 1 contato para avançar no funil.",variant:"warning"}),bW({message:"Etapa bloqueada. O card precisa ter ao menos 1 contato.",variant:"warning"}),dp("stage_change_blocked_missing_contact",{from_stage_id:Y,to_stage_id:a,entity_id:M.id}),!1;if(a===di&&!cW)return cj("contatos"),b9({message:"Defina ao menos 1 decisor para avançar para Proposta.",variant:"warning"}),bW({message:"Etapa bloqueada. É obrigatório ter um decisor para avançar para Proposta.",variant:"warning"}),dp("stage_change_blocked_missing_decision_maker",{from_stage_id:Y,to_stage_id:a,entity_id:M.id}),!1;let b=c6(Y);if(b.length>0){let c=b.map(a=>a.label).join(", ");return bW({message:`Etapa bloqueada. Preencha: ${c}`,variant:"warning"}),bb({message:`${b.length} campo(s) obrigat\xf3rio(s) pendente(s) para avan\xe7ar.`,variant:"warning"}),dp("stage_change_blocked_missing_required",{from_stage_id:Y,to_stage_id:a,missing_count:b.length,entity_id:M.id}),!1}}return dp("stage_changed",{from_stage_id:Y,to_stage_id:a,entity_id:M.id}),Z(a),bW({message:"Etapa atualizada",variant:"success"}),bb({message:`Checklist atualizado para ${dr.find(b=>b.id===a)?.label??"nova etapa"}.`,variant:"info"}),!0},[ak.length,cW,ap,M.id,Y,c6]),c8=(0,c.useCallback)(a=>c7(a),[c7]),da=(0,c.useCallback)(()=>{if("fechamento"!==Y){bY(!1),bU({message:"Para marcar como ganho, mova a oportunidade para a etapa Fechamento.",variant:"warning"});return}if(c6(Y).length>0){bY(!1),cj("anotacoes"),bb({message:"Checklist incompleto. Preencha os campos obrigatórios antes de fechar.",variant:"warning"}),bU({message:"Fechamento bloqueado por pendências nos campos da etapa.",variant:"warning"});return}if(!c5){bY(!1),cj("anotacoes"),bU({message:"Registre ao menos uma nota ou atividade recente antes de encerrar como ganho.",variant:"warning"});return}dp("mark_won_clicked",{entity_id:M.id}),b0(!0),setTimeout(()=>{ao("won"),bY(!1),b0(!1),bU({message:"Oportunidade marcada como ganho",variant:"success"}),dp("mark_won_succeeded",{entity_id:M.id})},600)},[c5,M.id,Y,c6]),db=(0,c.useCallback)(a=>{if("fechamento"!==Y){b$(!1),bU({message:"Para marcar como perdido, mova a oportunidade para a etapa Fechamento.",variant:"warning"});return}if(!a?.trim())return void bU({message:"Selecione um motivo de perda para continuar.",variant:"warning"});if(!c5){b$(!1),cj("anotacoes"),bU({message:"Adicione uma nota de contexto antes de encerrar como perdido.",variant:"warning"});return}dp("mark_lost_clicked",{entity_id:M.id,reason:a}),b2(!0),setTimeout(()=>{ao("lost"),b$(!1),b2(!1),bU({message:`Oportunidade marcada como perdida — ${a}`,variant:"info"}),dp("mark_lost_succeeded",{entity_id:M.id,reason:a})},600)},[c5,M.id,Y]),dd=()=>{if(ce){if(!cg.nome.trim())return void b9({message:"O nome do contato é obrigatório.",variant:"warning"});if(!cg.cargo)return void b9({message:"Selecione o cargo para manter o score de patente correto.",variant:"warning"});al(ak.map(a=>a.id===ce?{...a,...cg}:a)),cf(null),ch({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),b9({message:"Contato atualizado. Score de patente recalculado.",variant:"success"})}},df=(0,c.useCallback)((a,b="follow-up")=>{let c=new Date(Date.now()+36e5),d=`${c.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})} ${c.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})}`,e={id:`activity-${Date.now()}`,title:a,type:b,status:"pending",dueDate:d,responsibleId:ag,responsibleName:ai,opportunityId:M.id,opportunityTitle:W,clientId:M.id,clientName:M.clientName??ar,createdAt:new Date().toISOString()};cU(a=>[e,...a]),bU({message:"Atividade criada com sucesso",variant:"success"})},[ar,M.clientName,M.id,ag,ai,W]),dh=(0,c.useCallback)(a=>!a.isSystem&&"u1"===a.authorId&&Date.now()-new Date(a.createdAt).getTime()<=9e5,[]),dq=(0,c.useCallback)(()=>{if(ap)return;let a=be.trim();if(a.length<10){bn("A nota precisa ter pelo menos 10 caracteres."),bl("error"),dp("validation_failed",{field:"noteDraft"});return}if(a.length>2e3){bn("A nota excedeu o limite de 2000 caracteres."),bl("error"),dp("validation_failed",{field:"noteDraft_max"});return}bn(null),bl("saving"),setTimeout(()=>{let b={id:`note-${Date.now()}`,body:a,authorId:"u1",authorName:dj,createdAt:new Date().toISOString(),intent:bg,visibility:bi};bQ(a=>[b,...a]),bf(""),bh("general"),bj("team"),bl("saved"),bU({message:"Nota salva e adicionada ao histórico.",variant:"success"}),dp("note_created",{entity_id:M.id}),setTimeout(()=>bl("idle"),1600)},320)},[ap,be,bg,bi,M.id]),dx=(0,c.useCallback)(()=>{if(ap)return;let a=bI.action.trim()||be.trim();if(a.length<3){bO("Defina uma ação para criar o próximo passo."),bM("error");return}if("proximo_passo"===bg&&!bI.dueDate){bO("Defina a data do próximo passo."),bM("error");return}bO(null),bM("saving");let b={call:"call",whatsapp:"whatsapp",email:"email",meeting:"meeting",visit:"visit"};setTimeout(()=>{let c=dz.find(a=>a.id===bI.ownerId)?.name??ai,d=bI.dueDate?` at\xe9 ${new Date(bI.dueDate).toLocaleDateString("pt-BR")}`:"";df(`${a}${d} • ${c}`,b[bI.channel]),bM("saved"),bU({message:"Próximo passo criado na aba Atividades.",variant:"success"}),setTimeout(()=>bM("idle"),1600)},280)},[df,ap,bI,be,bg,ai]),dF=(0,c.useCallback)(a=>{dh(a)&&(br(a.id),bt(a.body),bH(null),bw("idle"))},[dh]),dG=(0,c.useCallback)(()=>{if(!bq)return;let a=bs.trim();if(a.length<10){bH("A nota precisa ter pelo menos 10 caracteres."),bw("error");return}bH(null),bw("saving"),setTimeout(()=>{bQ(b=>b.map(b=>b.id===bq?{...b,body:a}:b)),bw("saved"),br(null),bt(""),bU({message:"Nota atualizada.",variant:"success"}),setTimeout(()=>bw("idle"),1400),dp("note_edited",{entity_id:M.id})},280)},[bs,bq,M.id]),dJ=(0,c.useCallback)(a=>{a.isSystem||(bf(a.body),bh("system"===a.intent?"general":a.intent),bp("all"),bU({message:"Conteúdo duplicado no registro rápido.",variant:"info"}))},[]),dM=(0,c.useCallback)(a=>{let b={id:Math.random().toString(36).substr(2,9),title:a.title,type:a.type,status:"pending",dueDate:`${new Date(a.date).toLocaleDateString("pt-BR")} ${a.time||""}`.trim(),responsibleName:"Eu (Logado)",responsibleId:"u1",opportunityId:a.opportunityId||M.id,clientId:a.clientId,clientName:a.clientName,contactIds:a.contactIds?.length?a.contactIds:void 0,contactNames:a.contactNames?.length?a.contactNames:void 0,createdAt:new Date().toISOString()};cU(a=>[b,...a]),bU({message:"Atividade criada com sucesso",variant:"success"})},[M.id]),dO=(0,c.useCallback)(()=>{ap||(cj("atividades"),cC("task"))},[cC,ap]),dR=(0,c.useCallback)(a=>{let b,c=Number.isNaN((b=new Date(a.startAt)).getTime())?"Data inválida":b.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});df(`Follow-up da visita (${c})`,"follow-up"),cj("atividades")},[df]),dS=(0,c.useCallback)(a=>{cU(b=>b.map(b=>b.id===a?{...b,status:"completed",completedAt:new Date().toISOString()}:b)),bU({message:"Atividade concluída",variant:"success"})},[]),dT=(0,c.useCallback)(()=>{let a="all"===cR?"pending":"pending"===cR?"completed":"all";cS(a);let b="all"===a?"Todos":"pending"===a?"Pendentes":"Concluídas";bU({message:`Filtro de atividades: ${b}`,variant:"info"})},[cR]),dU=(a,b,c)=>{ap||a5(d=>({...d,[a]:{...d[a],[b]:c}}))},dV=ds[an];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(bC.Dialog,{open:o,onOpenChange:a=>{a||cs()},children:(0,b.jsxs)(bC.DialogContent,{className:"flex h-[90vh] !max-h-[90vh] w-[90vw] !max-w-[90vw] flex-col overflow-hidden rounded-[var(--radius-bento-card)] !gap-0 !p-0 bg-zinc-50/50",showCloseButton:!1,children:[(0,b.jsxs)("div",{className:"sticky top-0 z-10 border-b border-zinc-200/50 bg-white/85 backdrop-blur-xl transition-shadow duration-[120ms] shadow-[0_4px_30px_rgba(0,0,0,0.02)]",children:[(0,b.jsxs)("div",{className:"px-5 pt-3 pb-0 md:px-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsxs)("nav",{className:"mb-1 flex items-center gap-1 font-body text-[10px] text-zinc-400","aria-label":"Breadcrumb",children:[(0,b.jsx)("span",{children:"Pipes"}),(0,b.jsx)(z.ChevronRight,{className:"h-2.5 w-2.5","aria-hidden":"true"}),(0,b.jsx)("span",{className:"text-zinc-500",children:"Pipeline Comercial"})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-bold tracking-tight text-black sm:text-[22px] leading-tight",children:(0,b.jsx)(dI,{value:W,onSave:X,className:"font-heading text-xl font-bold tracking-tight sm:text-[22px] leading-tight",readOnly:ap})}),c1>0&&(0,b.jsxs)("div",{className:`inline-flex items-center gap-0.5 rounded-md px-1.5 py-0.5 font-heading text-[10px] font-bold leading-none ${c1>=70?"bg-emerald-50 text-emerald-700 border border-emerald-200/50":c1>=40?"bg-amber-50 text-amber-700 border border-amber-200/50":"bg-red-50 text-red-700 border border-red-200/50"}`,title:`Lead Score: ${c1} (${c1>=70?"Alto":c1>=40?"Medio":"Baixo"})`,children:[(0,b.jsx)(F.TrendingUp,{className:"h-2 w-2","aria-hidden":"true"}),c1]}),(0,b.jsxs)("div",{className:"inline-flex items-center gap-0.5 rounded-md border border-indigo-200 bg-indigo-50 px-1.5 py-0.5 font-heading text-[10px] font-bold leading-none text-indigo-700",title:`Score de Patente: ${cX}`,children:[(0,b.jsx)(y.Shield,{className:"h-2 w-2","aria-hidden":"true"}),cX]}),(0,b.jsxs)("span",{className:`inline-flex items-center gap-0.5 rounded-full px-1.5 py-0.5 font-body text-[10px] font-medium transition-all duration-[140ms] ${dV.color} ${dV.bg}`,children:["won"===an&&(0,b.jsx)(A.Check,{className:"h-2 w-2","aria-hidden":"true"}),"lost"===an&&(0,b.jsx)(d.X,{className:"h-2 w-2","aria-hidden":"true"}),dV.label]}),aq&&(0,b.jsxs)("span",{className:"font-body text-[10px] text-zinc-400",children:["via ",aq]})]})]}),(0,b.jsxs)("div",{className:"flex shrink-0 items-center gap-1",children:["open"===an&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("button",{onClick:()=>bY(!0),disabled:b_,className:"group/won inline-flex h-[34px] items-center gap-1 rounded-full border border-emerald-200/80 bg-emerald-50/80 px-3 font-heading text-[11px] font-semibold text-emerald-700 transition-all duration-300 ease-out hover:-translate-y-[1px] hover:border-emerald-500 hover:bg-emerald-600 hover:text-white hover:shadow-[0_4px_12px_rgba(16,185,129,0.2)] active:scale-[0.96] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-500/30 disabled:pointer-events-none disabled:opacity-50",children:[b_?(0,b.jsx)(K.Loader2,{className:"h-3 w-3 animate-spin"}):(0,b.jsx)(A.Check,{className:"h-3 w-3","aria-hidden":"true"}),(0,b.jsx)("span",{className:"max-sm:hidden",children:"Ganho"})]}),(0,b.jsxs)("button",{onClick:()=>b$(!0),disabled:b1,className:"group/lost inline-flex h-[34px] items-center gap-1 rounded-full border border-zinc-200/80 bg-white px-3 font-heading text-[11px] font-semibold text-zinc-500 transition-all duration-300 ease-out hover:-translate-y-[1px] hover:border-red-400 hover:bg-red-500 hover:text-white hover:shadow-[0_4px_12px_rgba(248,113,113,0.2)] active:scale-[0.96] focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-400/30 disabled:pointer-events-none disabled:opacity-50",children:[b1?(0,b.jsx)(K.Loader2,{className:"h-3 w-3 animate-spin"}):(0,b.jsx)(d.X,{className:"h-3 w-3","aria-hidden":"true"}),(0,b.jsx)("span",{className:"max-sm:hidden",children:"Perdido"})]})]}),(0,b.jsxs)(aW.DropdownMenu,{children:[(0,b.jsx)(aW.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)("button",{className:"flex h-7 w-7 items-center justify-center rounded-full text-zinc-400 transition-all duration-[140ms] hover:bg-zinc-100 hover:text-zinc-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/30",children:(0,b.jsx)(t.MoreHorizontal,{className:"h-3.5 w-3.5"})})}),(0,b.jsxs)(aW.DropdownMenuContent,{align:"end",className:"rounded-[12px]",children:[(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>{dO()},children:[(0,b.jsx)(i.Calendar,{className:"mr-2 h-4 w-4"}),"Nova atividade"]}),"open"!==an&&(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>{ao("open"),bU({message:"Oportunidade reaberta",variant:"info"})},children:[(0,b.jsx)(J.RefreshCw,{className:"mr-2 h-4 w-4"}),"Reabrir oportunidade"]}),(0,b.jsx)(aW.DropdownMenuSeparator,{}),(0,b.jsxs)(aW.DropdownMenuItem,{className:"text-status-danger focus:text-status-danger",onClick:()=>b4(!0),children:[(0,b.jsx)(w.Trash2,{className:"mr-2 h-4 w-4"}),"Excluir"]})]})]}),(0,b.jsx)("button",{onClick:cs,className:"flex h-7 w-7 items-center justify-center rounded-full text-zinc-400 transition-all duration-[140ms] hover:bg-zinc-100 hover:text-zinc-600 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/30","aria-label":"Fechar",children:(0,b.jsx)(d.X,{className:"h-3.5 w-3.5"})})]})]}),bT&&(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)(dH,{banner:bT,onDismiss:()=>bU(null)})}),bZ&&"open"===an&&(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)(dN,{onConfirm:db,onCancel:()=>b$(!1),isLoading:b1})}),(0,b.jsx)(dP,{nomeFantasia:ar,segmento:as,enderecoFormatado:bS,telefoneEmpresa:aL,emailEmpresa:aM,website:aN,instagramUrl:aP,cardapioUrl:aR,primaryContact:c$,stage:Y,temperature:$,responsibleName:ai,responsibleId:ag,suggestedTemperature:c2,onStageChange:c7,onTemperatureChange:af,onResponsibleChange:(a,b)=>{ah(a),aj(b)},onOpenPrimaryContact:()=>cj("contatos"),onCreatePrimaryContact:()=>{cj("contatos"),b6(!0)},teamMembers:dz,isLocked:ap,stageBanner:bV,onStageBannerDismiss:()=>bW(null)})]}),(0,b.jsx)("div",{className:"flex w-full items-end overflow-x-auto px-5 md:px-6 scrollbar-hide",children:[{value:"empresa",label:"Empresa"},{value:"contatos",label:"Contatos"},{value:"visitas",label:"Visitas"},{value:"atividades",label:"Atividades"},{value:"negociacao",label:"Negociação"},{value:"anotacoes",label:"Anotações"},{value:"linha-do-tempo",label:"Linha do Tempo"}].map(a=>{let c=ci===a.value;return(0,b.jsxs)("button",{onClick:()=>cr(a.value),className:(0,ac.cn)("relative whitespace-nowrap px-1 py-3 font-heading text-[11px] font-semibold tracking-wide uppercase transition-colors outline-none mr-6",c?"text-brand":"text-zinc-500 hover:text-zinc-800 focus-visible:ring-2 focus-visible:ring-brand/30"),children:[a.label,c&&(0,b.jsx)(aa.motion.div,{layoutId:"activeDrawerTab",className:"absolute bottom-0 left-0 right-0 h-[3px] rounded-t-full bg-brand",transition:{type:"spring",stiffness:400,damping:30}})]},a.value)})})]}),(0,b.jsx)("div",{className:"flex min-h-0 flex-1",children:(0,b.jsx)("div",{className:"min-h-0 flex-1",children:(0,b.jsx)(bB.ScrollArea,{className:"h-full",children:(0,b.jsx)("div",{className:"p-5 md:px-8 lg:px-10",children:(0,b.jsx)(bu,{value:ci,onValueChange:a=>cr(a),children:(0,b.jsxs)("div",{className:"mt-5 grid grid-cols-1 md:grid-cols-12 gap-6 pb-10",children:[(0,b.jsxs)("div",{className:"md:col-span-12 lg:col-span-7 space-y-4",children:[(0,b.jsxs)(by,{value:"empresa",className:"mt-0 space-y-4",children:[(0,b.jsx)(dQ,{title:"Localização",description:"",icon:E.MapPin,delay:0,successMessage:a6.localizacao,children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"w-[140px] flex-none",children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"CEP"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(a_.Input,{value:at,onChange:a=>bR(a.target.value),placeholder:"00000-000",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs transition-all focus:border-brand focus:ring-2 focus:ring-brand/10",readOnly:ap,maxLength:9}),aH&&(0,b.jsx)(K.Loader2,{className:"absolute right-2 top-1/2 h-3 w-3 -translate-y-1/2 animate-spin text-brand"})]}),aJ&&(0,b.jsx)("p",{className:"mt-1 font-body text-[10px] text-status-danger",children:aJ})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Endereço"}),(0,b.jsx)(a_.Input,{value:av,onChange:a=>aw(a.target.value),placeholder:"Logradouro",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ap})]}),(0,b.jsxs)("div",{className:"w-[70px] flex-none",children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Nº"}),(0,b.jsx)(a_.Input,{value:ax,onChange:a=>ay(a.target.value.replace(/\D/g,"")),placeholder:"123",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ap})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Bairro"}),(0,b.jsx)(a_.Input,{value:aB,onChange:a=>aC(a.target.value),placeholder:"Bairro",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ap})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Cidade"}),(0,b.jsx)(a_.Input,{value:aD,onChange:a=>aE(a.target.value),placeholder:"Cidade",className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",readOnly:ap})]}),(0,b.jsxs)("div",{className:"w-[70px] flex-none",children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"UF"}),(0,b.jsxs)(bz.Select,{value:aF,onValueChange:aG,disabled:ap,children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-9 rounded-lg border-zinc-200 bg-white px-2 font-body text-xs font-medium focus:ring-brand/10",children:(0,b.jsx)(bz.SelectValue,{placeholder:"UF"})}),(0,b.jsx)(bz.SelectContent,{className:"max-h-[220px]",children:dv.map(a=>(0,b.jsx)(bz.SelectItem,{value:a,className:"font-body text-xs",children:a},a))})]})]})]})]})}),(0,b.jsx)(dQ,{title:"Tipo",description:"",icon:k,delay:.06,successMessage:a6.tipo,children:(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2 sm:grid-cols-4",children:dt.map(a=>(0,b.jsxs)("button",{disabled:ap,onClick:()=>{var b;return b=a.id,void(!ap&&aU(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b]))},className:(0,ac.cn)("group flex flex-col items-center gap-1.5 rounded-[12px] p-2.5 text-center transition-all duration-200",aT.includes(a.id)?"bg-brand/5 border border-brand/20 text-brand shadow-sm":"bg-zinc-50/50 border border-transparent text-zinc-400 hover:bg-zinc-100/80 hover:text-zinc-500",!ap&&"active:scale-[0.96] hover:scale-[1.02]"),children:[(0,b.jsx)("div",{className:(0,ac.cn)("flex h-8 w-8 items-center justify-center rounded-lg transition-all duration-200",aT.includes(a.id)?"bg-brand/10 text-brand":"bg-white text-zinc-300 group-hover:text-zinc-400 shadow-sm"),children:(0,b.jsx)(a.icon,{className:"h-4 w-4"})}),(0,b.jsx)("span",{className:"font-heading text-[9px] font-bold tracking-tight uppercase line-clamp-2",children:a.label})]},a.id))})}),(0,b.jsx)(dQ,{title:"Horário e Online",description:"",icon:_.Clock3,delay:.12,successMessage:a6.horario??a6.online,children:(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-4 rounded-[14px] border border-zinc-100 bg-zinc-50/45 p-3.5",children:[(0,b.jsxs)("div",{className:"mb-1 flex items-center justify-between",children:[(0,b.jsx)(a0.Label,{className:"font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:"Configuração"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:(0,ac.cn)("font-heading text-[10px] font-bold transition-colors","standard"===aV?"text-brand":"text-zinc-300"),children:"PADRÃO"}),(0,b.jsx)(a3.Switch,{checked:"daily"===aV,onCheckedChange:a=>aX(a?"daily":"standard"),className:"scale-75 data-[state=checked]:bg-brand",disabled:ap}),(0,b.jsx)("span",{className:(0,ac.cn)("font-heading text-[10px] font-bold transition-colors","daily"===aV?"text-brand":"text-zinc-300"),children:"DIÁRIO"})]})]}),"standard"===aV?(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[9px] font-bold uppercase text-zinc-400",children:"Abertura"}),(0,b.jsx)(a_.Input,{type:"time",value:aY.open,onChange:a=>aZ(b=>({...b,open:a.target.value})),className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",disabled:ap})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"mb-1.5 block font-heading text-[9px] font-bold uppercase text-zinc-400",children:"Fechamento"}),(0,b.jsx)(a_.Input,{type:"time",value:aY.close,onChange:a=>aZ(b=>({...b,close:a.target.value})),className:"h-9 rounded-lg border-zinc-200 bg-white font-body text-xs",disabled:ap})]})]}):(0,b.jsx)("div",{className:"space-y-1",children:du.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a3.Switch,{checked:a4[a.id].active,onCheckedChange:b=>dU(a.id,"active",b),className:"scale-75 data-[state=checked]:bg-brand",disabled:ap}),(0,b.jsx)("span",{className:"w-8 font-heading text-[10px] font-bold uppercase text-zinc-500",children:a.label.slice(0,3)})]}),a4[a.id].active?(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(a_.Input,{type:"time",value:a4[a.id].open,onChange:b=>dU(a.id,"open",b.target.value),className:"h-7 w-[60px] rounded-md border-zinc-200 p-1 text-center font-body text-[10px]",disabled:ap}),(0,b.jsx)("span",{className:"text-zinc-300",children:"-"}),(0,b.jsx)(a_.Input,{type:"time",value:a4[a.id].close,onChange:b=>dU(a.id,"close",b.target.value),className:"h-7 w-[60px] rounded-md border-zinc-200 p-1 text-center font-body text-[10px]",disabled:ap})]}):(0,b.jsx)("span",{className:"font-heading text-[9px] font-bold uppercase text-zinc-300",children:"Fechado"})]},a.id))})]}),(0,b.jsx)("div",{className:"space-y-3 rounded-[14px] border border-zinc-100 bg-zinc-50/45 p-3.5",children:[{id:"site",label:"Site",icon:D,value:aN,setter:aO},{id:"ig",label:"Instagram",icon:O,value:aP,setter:aQ},{id:"menu",label:"Cardápio",icon:Q,value:aR,setter:aS}].map(a=>(0,b.jsxs)("div",{className:"group/field relative",children:[(0,b.jsx)(a0.Label,{className:"font-heading text-[10px] font-bold uppercase tracking-wider text-zinc-400",children:a.label}),(0,b.jsxs)("div",{className:"relative mt-1.5 flex items-center",children:[(0,b.jsx)("div",{className:"absolute left-3 flex items-center gap-1.5 text-zinc-300",children:(0,b.jsx)(a.icon,{className:"h-3.5 w-3.5"})}),(0,b.jsx)(a_.Input,{value:a.value,onChange:b=>a.setter(b.target.value),placeholder:(a.id,"URL"),className:"h-9 rounded-lg border-zinc-200 pl-9 pr-8 font-body text-xs transition-all focus:border-brand focus:ring-2 focus:ring-brand/10",disabled:ap}),(0,b.jsx)(ab.AnimatePresence,{children:a.value&&(0,b.jsx)(aa.motion.button,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},onClick:()=>window.open(a.value.startsWith("http")?a.value:`https://${a.value}`,"_blank"),className:"absolute right-2 h-6 rounded-md bg-zinc-900 px-2 font-heading text-[9px] font-bold text-white shadow-sm transition-all hover:bg-black active:scale-[0.97]",children:"Visitar"})})]})]},a.id))})]})})]}),(0,b.jsxs)(by,{value:"contatos",className:"mt-0",children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"font-heading text-sm font-semibold text-black",children:["Contatos (",am.length,")"]}),(0,b.jsxs)("p",{className:"mt-1 font-body text-[11px] text-zinc-500",children:["Score de Patente do card: ",(0,b.jsx)("span",{className:"font-semibold text-zinc-800",children:cX})," · limite ",1,"-",10," contatos"]})]}),!ap&&(0,b.jsxs)(ad.Button,{onClick:()=>{cb(null),b6(!0)},disabled:ak.length>=10,className:"rounded-full bg-brand font-heading text-xs text-white hover:bg-brand/90",size:"sm",children:[(0,b.jsx)(v.Plus,{className:"mr-1 h-3.5 w-3.5"})," Adicionar"]})]}),b7&&(0,b.jsx)("div",{className:"mb-3",children:(0,b.jsx)(dH,{banner:b7,onDismiss:()=>b9(null)})}),0===am.length?(0,b.jsxs)("div",{className:"flex flex-col items-center py-8 text-center",children:[(0,b.jsx)(m.User,{className:"h-8 w-8 text-zinc-200"}),(0,b.jsx)("p",{className:"mt-2 font-body text-sm text-zinc-400",children:"Sem contatos vinculados"}),!ap&&(0,b.jsxs)(ad.Button,{size:"sm",variant:"ghost",className:"mt-2 rounded-full font-body text-xs text-brand",onClick:()=>{cb(null),b6(!0)},children:[(0,b.jsx)(v.Plus,{className:"mr-1 h-3.5 w-3.5"})," Vincular contato"]})]}):(0,b.jsx)("div",{className:"space-y-2",children:am.map(a=>ce===a.id?(0,b.jsxs)("div",{className:"space-y-3 rounded-[14px] border border-brand/20 bg-brand/5 p-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Nome"}),(0,b.jsx)(a_.Input,{value:cg.nome,onChange:a=>ch({...cg,nome:a.target.value}),className:"mt-1 h-8 rounded-[10px] font-body text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Cargo"}),(0,b.jsxs)(bz.Select,{value:cg.cargo,onValueChange:a=>ch({...cg,cargo:a}),children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-8 w-full rounded-[10px] border-zinc-200 font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione o cargo"})}),(0,b.jsx)(bz.SelectContent,{children:bF.RESTAURANT_POSITIONS.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"E-mail"}),(0,b.jsx)(a_.Input,{type:"email",value:cg.email,onChange:a=>ch({...cg,email:a.target.value}),className:"mt-1 h-8 rounded-[10px] font-body text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Telefone"}),(0,b.jsx)(a2.PhoneInput,{value:cg.telefone,onValueChange:a=>ch({...cg,telefone:a}),className:"mt-1 h-8 rounded-[10px] font-body text-sm"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Personalidade"}),(0,b.jsx)(bA.Textarea,{value:cg.personalidade,onChange:a=>ch({...cg,personalidade:a.target.value}),className:"mt-1 min-h-[60px] rounded-[10px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(ad.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-xs",onClick:()=>{cf(null),ch({nome:"",email:"",telefone:"",cargo:"",personalidade:""})},children:"Cancelar"}),(0,b.jsx)(ad.Button,{size:"sm",className:"rounded-full bg-brand font-heading text-xs text-white hover:bg-brand/90",onClick:dd,children:"Salvar"})]})]},a.id):(0,b.jsx)(dL,{contact:a,patentScore:dy(a.cargo),isPrimary:c$?.id===a.id,onEdit:()=>{cf(a.id),ch({nome:a.nome,email:a.email,telefone:a.telefone,cargo:a.cargo,personalidade:a.personalidade??""})},onDelete:()=>(a=>{if(ak.length<=1)return void b9({message:"O card precisa manter pelo menos 1 contato.",variant:"warning"});let b=ak.find(b=>b.id===a),c=ak.filter(b=>b.id!==a);(al(c),b?.isDecisionMaker&&!c.some(a=>a.isDecisionMaker))?b9({message:"Contato removido. Defina outro decisor para manter avanço até Proposta.",variant:"warning"}):b9({message:"Contato removido com sucesso.",variant:"info"})})(a.id),onToggleDecisionMaker:()=>{var b;let c;return b=a.id,void((al(c=ak.map(a=>a.id===b?{...a,isDecisionMaker:!a.isDecisionMaker}:a)),c.some(a=>a.isDecisionMaker))?b9({message:"Decisor atualizado. Regras de avanço para Proposta atendidas.",variant:"success"}):b9({message:"Sem decisor definido. A etapa Proposta ficará bloqueada.",variant:"warning"}))}},a.id))})]}),(0,b.jsxs)(by,{value:"visitas",className:"mt-0 space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-700",children:"Visitas"}),(0,b.jsx)("p",{className:"mt-0.5 text-xs text-zinc-500",children:"Agenda comercial, resultados e próximos passos."})]}),(0,b.jsxs)(ad.Button,{size:"sm",variant:"outline",className:"h-8 gap-1.5 rounded-full text-xs",onClick:()=>cw(!0),disabled:ap,children:[(0,b.jsx)(v.Plus,{className:"h-3.5 w-3.5"}),"Nova Visita"]})]}),(0,b.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:[{id:"all",label:"Todas",count:cJ.all},{id:"agendada",label:"Agendadas",count:cJ.agendada},{id:"realizada",label:"Realizadas",count:cJ.realizada},{id:"cancelada",label:"Canceladas",count:cJ.cancelada}].map(a=>(0,b.jsxs)("button",{type:"button",onClick:()=>cE(a.id),className:(0,ac.cn)("inline-flex h-7 items-center gap-1.5 rounded-full border px-2.5 font-body text-[11px] font-medium transition-all duration-150",cD===a.id?"border-zinc-300 bg-zinc-100 text-zinc-900":"border-zinc-200 bg-white text-zinc-500 hover:border-zinc-300 hover:text-zinc-700"),children:[a.label,(0,b.jsx)("span",{className:"rounded-full bg-zinc-200/80 px-1.5 py-0 text-[10px] font-semibold text-zinc-600",children:a.count})]},a.id))}),0===cL.length&&(0,b.jsxs)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50/80 p-4",children:[(0,b.jsx)("p",{className:"font-heading text-sm font-medium text-zinc-700",children:"Nenhuma visita neste filtro"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Agende uma nova visita para manter o follow-up ativo."}),(0,b.jsxs)(ad.Button,{size:"sm",variant:"outline",className:"mt-3 h-8 gap-1.5 rounded-full text-xs",onClick:()=>cw(!0),disabled:ap,children:[(0,b.jsx)(v.Plus,{className:"h-3.5 w-3.5"}),"Nova Visita"]})]}),(0,b.jsx)("div",{className:"space-y-3",children:cL.map(a=>(0,b.jsx)(a$,{visit:a,isExpanded:cF===a.id,isLocked:ap,onToggleDetails:()=>cQ(a.id),onStatusChange:cM,onReschedule:cO,onDuplicate:cN,onFollowUp:dR,onDelete:cP},a.id))})]}),(0,b.jsxs)(by,{value:"atividades",className:"mt-0 space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-700",children:"Atividades"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(ad.Button,{size:"sm",variant:"outline",className:"h-8 w-8 rounded-full p-0",onClick:dT,title:"Alternar filtro de atividades",children:(0,b.jsx)(N.Filter,{className:"h-3.5 w-3.5"})}),(0,b.jsxs)(ad.Button,{size:"sm",variant:"outline",className:"h-8 gap-1.5 rounded-full text-xs",onClick:dO,children:[(0,b.jsx)(v.Plus,{className:"h-3.5 w-3.5"}),"Nova"]})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[c0.map(a=>{let c;return(0,b.jsxs)("div",{className:"flex items-start gap-3 rounded-2xl border border-zinc-100 bg-white p-3 transition-all hover:border-zinc-200",children:[(0,b.jsx)("div",{className:(0,ac.cn)("flex h-9 w-9 shrink-0 items-center justify-center rounded-full border","completed"===a.status?"border-zinc-100 bg-zinc-50 text-zinc-400":"border-brand/10 bg-brand/5 text-brand"),children:(c=(a=>{switch(a){case"call":return e.Phone;case"meeting":return n.Users;case"email":return h.Mail;case"whatsapp":return f.MessageCircle;default:return g.Circle}})(a.type),(0,b.jsx)(c,{className:"h-4 w-4"}))}),(0,b.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("p",{className:(0,ac.cn)("font-heading text-sm font-medium","completed"===a.status?"text-zinc-500 line-through":"text-zinc-900"),children:a.title}),(0,b.jsx)("div",{className:"flex gap-1",children:(0,b.jsx)("button",{type:"button",onClick:()=>dS(a.id),disabled:"completed"===a.status,className:"flex h-6 w-6 items-center justify-center rounded-full text-zinc-300 transition-colors hover:bg-zinc-100 hover:text-zinc-600 disabled:cursor-not-allowed disabled:opacity-50","aria-label":"Concluir atividade",children:(0,b.jsx)(B.CheckCircle,{className:"h-4 w-4"})})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-zinc-400",children:[(0,b.jsxs)("span",{className:(0,ac.cn)("flex items-center gap-1","overdue"===a.status&&"text-red-500 font-medium"),children:[(0,b.jsx)(p.Clock,{className:"h-3 w-3"}),a.dueDate]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(S,{className:"h-3 w-3"}),a.responsibleName]})]})]})]},a.id)}),0===c0.length&&(0,b.jsx)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50 p-3 text-xs text-zinc-500",children:"Nenhuma atividade para o filtro atual."})]})]}),(0,b.jsx)(by,{value:"negociacao",className:"mt-0 space-y-4",children:(0,b.jsx)(cA,{dealId:M.id,dealTitle:W})}),(0,b.jsxs)(by,{value:"anotacoes",className:"mt-0 space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-3 rounded-[18px] border border-zinc-200 bg-white p-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Registro rápido"}),(0,b.jsx)("p",{className:"mt-1 text-xs text-zinc-500",children:"Escreva o que aconteceu e registre o próximo passo sem perder o contexto."})]}),(0,b.jsxs)("div",{className:"inline-flex items-center gap-1 rounded-full border border-zinc-200 bg-zinc-50 p-1",children:[(0,b.jsx)("button",{type:"button",onClick:()=>bj("team"),className:(0,ac.cn)("rounded-full px-2.5 py-1 text-[11px] font-medium transition-all","team"===bi?"bg-white text-zinc-900 shadow-sm":"text-zinc-500 hover:text-zinc-700"),children:"Time"}),(0,b.jsx)("button",{type:"button",onClick:()=>bj("internal"),className:(0,ac.cn)("rounded-full px-2.5 py-1 text-[11px] font-medium transition-all","internal"===bi?"bg-white text-zinc-900 shadow-sm":"text-zinc-500 hover:text-zinc-700"),children:"Interna"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bA.Textarea,{value:be,onChange:a=>{bm&&bn(null),bl("idle"),bf(a.target.value)},className:(0,ac.cn)("min-h-[110px] resize-none rounded-[14px] border-zinc-200 text-sm",bm&&"border-red-300 focus-visible:ring-red-200"),placeholder:"Escreva o que aconteceu e qual é o próximo passo..."}),(0,b.jsxs)("div",{className:"flex items-center justify-between text-[11px]",children:[(0,b.jsx)("span",{className:(0,ac.cn)(bm?"text-red-600":"text-zinc-400"),children:bm??`M\xednimo de 10 caracteres.`}),(0,b.jsxs)("span",{className:"text-zinc-400",children:[be.trim().length,"/",2e3]})]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("span",{className:"text-[11px] font-medium text-zinc-500",children:"Intenção:"}),(0,b.jsx)("button",{type:"button",onClick:()=>bh("general"),className:(0,ac.cn)("rounded-full border px-2.5 py-1 text-[11px] font-medium transition-all","general"===bg?"border-zinc-300 bg-zinc-900 text-white":"border-zinc-200 bg-zinc-50 text-zinc-500 hover:bg-zinc-100"),children:"Registro"}),dk.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>bh(a.id),className:(0,ac.cn)("rounded-full border px-2.5 py-1 text-[11px] font-medium transition-all",bg===a.id?"border-brand/20 bg-brand/10 text-brand":"border-zinc-200 bg-zinc-50 text-zinc-500 hover:bg-zinc-100"),children:a.label},a.id))]}),(0,b.jsx)(ab.AnimatePresence,{initial:!1,children:"proximo_passo"===bg&&(0,b.jsxs)(aa.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:4},transition:{duration:.18,ease:"easeOut"},className:"grid gap-3 rounded-[14px] border border-brand/15 bg-brand/5 p-3 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Ação"}),(0,b.jsx)(a_.Input,{value:bI.action,onChange:a=>bK(b=>({...b,action:a.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",placeholder:"Ex.: Confirmar disponibilidade para reunião de proposta"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Data limite"}),(0,b.jsx)(a_.Input,{type:"date",value:bI.dueDate,onChange:a=>bK(b=>({...b,dueDate:a.target.value})),className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Canal"}),(0,b.jsxs)(bz.Select,{value:bI.channel,onValueChange:a=>bK(b=>({...b,channel:a})),children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsxs)(bz.SelectContent,{children:[(0,b.jsx)(bz.SelectItem,{value:"call",children:"Ligação"}),(0,b.jsx)(bz.SelectItem,{value:"whatsapp",children:"WhatsApp"}),(0,b.jsx)(bz.SelectItem,{value:"email",children:"E-mail"}),(0,b.jsx)(bz.SelectItem,{value:"meeting",children:"Reunião"}),(0,b.jsx)(bz.SelectItem,{value:"visit",children:"Visita"})]})]})]}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)(a0.Label,{className:"text-[10px] font-bold uppercase tracking-wider text-zinc-500",children:"Responsável"}),(0,b.jsxs)(bz.Select,{value:bI.ownerId,onValueChange:a=>bK(b=>({...b,ownerId:a})),disabled:ap,children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 rounded-lg border-zinc-200 text-xs",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsx)(bz.SelectContent,{children:dz.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.name},a.id))})]})]})]})}),bN&&(0,b.jsx)("div",{className:"rounded-lg border border-red-200 bg-red-50 px-3 py-2 text-xs text-red-600",children:bN}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 text-[11px] text-zinc-500",children:["saving"===bk&&(0,b.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,b.jsx)(K.Loader2,{className:"h-3 w-3 animate-spin"}),"Salvando nota..."]}),"saved"===bk&&(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-emerald-600",children:[(0,b.jsx)(A.Check,{className:"h-3 w-3"}),"Nota salva agora."]}),"saving"===bL&&(0,b.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,b.jsx)(K.Loader2,{className:"h-3 w-3 animate-spin"}),"Criando próximo passo..."]}),"saved"===bL&&(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 text-emerald-600",children:[(0,b.jsx)(A.Check,{className:"h-3 w-3"}),"Próximo passo criado."]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(ad.Button,{size:"sm",variant:"outline",className:"h-8 rounded-full px-3 text-xs",onClick:dx,disabled:ap||"saving"===bL,children:["saving"===bL?(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(H.ArrowRight,{className:"mr-1.5 h-3.5 w-3.5"}),"Criar próximo passo"]}),(0,b.jsxs)(ad.Button,{size:"sm",className:"h-8 rounded-full bg-zinc-900 px-3 text-xs text-white hover:bg-black",onClick:dq,disabled:ap||"saving"===bk,children:["saving"===bk?(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(A.Check,{className:"mr-1.5 h-3.5 w-3.5"}),"Salvar nota"]})]})]})]}),(0,b.jsx)(ae.Separator,{}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsx)("label",{className:"text-xs font-semibold uppercase tracking-wider text-zinc-500",children:"Histórico"}),(0,b.jsx)("div",{className:"inline-flex items-center gap-1 rounded-full border border-zinc-200 bg-white p-1",children:dl.map(a=>(0,b.jsx)("button",{type:"button",onClick:()=>bp(a.id),className:(0,ac.cn)("rounded-full px-2.5 py-1 text-[11px] font-medium transition-all",bo===a.id?"bg-zinc-900 text-white":"text-zinc-500 hover:text-zinc-700"),children:a.label},a.id))})]}),0===c4.length?(0,b.jsx)("div",{className:"rounded-2xl border border-dashed border-zinc-200 bg-zinc-50 p-4 text-xs text-zinc-500",children:"Nenhuma nota para este filtro."}):(0,b.jsx)("div",{className:"space-y-5",children:c4.map(a=>(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-[11px] font-semibold uppercase tracking-wider text-zinc-400",children:a.dayLabel}),(0,b.jsx)("div",{className:"space-y-3",children:a.items.map(a=>(0,b.jsx)("div",{className:"rounded-[14px] border border-zinc-200 bg-white p-3",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("span",{className:"font-heading text-xs font-semibold text-zinc-700",children:a.authorName}),(0,b.jsx)("span",{className:"text-[10px] text-zinc-400",children:new Date(a.createdAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,b.jsx)("span",{className:(0,ac.cn)("rounded-full border px-2 py-0.5 text-[10px] font-semibold",dm[a.intent].chipClass),children:dm[a.intent].label}),(0,b.jsx)("span",{className:"rounded-full border border-zinc-200 bg-zinc-50 px-2 py-0.5 text-[10px] text-zinc-500",children:"internal"===a.visibility?"Interna":"Time"})]}),bq===a.id?(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(bA.Textarea,{value:bs,onChange:a=>bt(a.target.value),className:"min-h-[86px] rounded-lg border-zinc-200 text-sm"}),bx&&(0,b.jsx)("p",{className:"text-xs text-red-600",children:bx}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(ad.Button,{size:"sm",className:"h-7 rounded-full bg-zinc-900 px-3 text-[11px] text-white hover:bg-black",onClick:dG,disabled:"saving"===bv,children:["saving"===bv&&(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-3 w-3 animate-spin"}),"Salvar edição"]}),(0,b.jsx)(ad.Button,{size:"sm",variant:"ghost",className:"h-7 rounded-full px-3 text-[11px]",onClick:()=>{br(null),bt(""),bH(null)},children:"Cancelar"})]})]}):(0,b.jsx)("p",{className:"font-body text-sm leading-relaxed text-zinc-700",children:a.body})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[dh(a)&&(0,b.jsxs)(ad.Button,{size:"sm",variant:"ghost",className:"h-7 rounded-full px-2 text-[11px]",onClick:()=>dF(a),children:[(0,b.jsx)(C.Pencil,{className:"mr-1 h-3 w-3"}),"Editar"]}),!a.isSystem&&(0,b.jsxs)(ad.Button,{size:"sm",variant:"ghost",className:"h-7 rounded-full px-2 text-[11px]",onClick:()=>dJ(a),children:[(0,b.jsx)(R.Copy,{className:"mr-1 h-3 w-3"}),"Duplicar"]})]})]})},a.id))})]},a.dayLabel))})]})]}),(0,b.jsx)(by,{value:"linha-do-tempo",className:"mt-0 space-y-4",children:(0,b.jsx)(dK,{events:function(a){let b=de.getState().getByOpportunity(a),c=dg.getState().getByOpportunity(a),d=[];for(let a of b)d.push({id:a.id,type:"realizada"===a.status?"activity":"created",message:`Visita ${a.type}: ${a.objective??a.location}`,user:a.responsible,date:new Date(a.startAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})});for(let a of c)d.push({id:a.id,type:a.isSystem?"stage-change":"note",message:a.body.slice(0,80)+(a.body.length>80?"...":""),user:a.authorName,date:new Date(a.createdAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})});return d.sort((a,b)=>{let c=new Date(a.date.split(", ").reverse().join("T")||a.date);return new Date(b.date.split(", ").reverse().join("T")||b.date).getTime()-c.getTime()})}(M.id)})})]}),(0,b.jsx)("div",{className:"md:col-span-12 lg:col-span-5 space-y-4",children:(0,b.jsx)(b8,{opportunityId:M.id,currentStage:Y,stages:dr,initialValues:P,isLocked:ap,onStageChange:a=>c8(a),nextStage:cY,canCreateFields:!1,advanceBlockedReason:ak.length<1?"Adicione pelo menos 1 contato para avançar no funil.":cY?.id!==di||cW?null:"Defina ao menos 1 decisor na aba Contatos para avançar para Proposta."})})]})})})})})})]})}),(0,b.jsx)(bD.AlertDialog,{open:bX,onOpenChange:bY,children:(0,b.jsxs)(bD.AlertDialogContent,{className:"rounded-[20px]",children:[(0,b.jsxs)(bD.AlertDialogHeader,{children:[(0,b.jsx)(bD.AlertDialogTitle,{className:"font-heading text-xl",children:"Marcar como ganho?"}),(0,b.jsx)(bD.AlertDialogDescription,{className:"font-body text-sm text-zinc-600",children:"Marcar como ganho encerra a oportunidade. Edicoes sensiveis serao bloqueadas. Voce quer continuar?"})]}),(0,b.jsxs)(bD.AlertDialogFooter,{children:[(0,b.jsx)(bD.AlertDialogCancel,{className:"rounded-full",disabled:b_,children:"Cancelar"}),(0,b.jsxs)(bD.AlertDialogAction,{onClick:da,disabled:b_,className:"rounded-full bg-status-success text-white hover:bg-status-success/90",children:[b_?(0,b.jsx)(K.Loader2,{className:"mr-1.5 h-4 w-4 animate-spin"}):(0,b.jsx)(A.Check,{className:"mr-1.5 h-4 w-4"}),"Sim, marcar como ganho"]})]})]})}),(0,b.jsx)(bD.AlertDialog,{open:b3,onOpenChange:b4,children:(0,b.jsxs)(bD.AlertDialogContent,{className:"rounded-[20px]",children:[(0,b.jsxs)(bD.AlertDialogHeader,{children:[(0,b.jsx)(bD.AlertDialogTitle,{className:"font-heading text-xl",children:"Excluir oportunidade?"}),(0,b.jsx)(bD.AlertDialogDescription,{className:"font-body text-sm text-zinc-600",children:"Esta acao nao pode ser desfeita. Todos os dados desta oportunidade serao removidos permanentemente."})]}),(0,b.jsxs)(bD.AlertDialogFooter,{children:[(0,b.jsx)(bD.AlertDialogCancel,{className:"rounded-full",children:"Cancelar"}),(0,b.jsx)(bD.AlertDialogAction,{onClick:()=>{b4(!1),l()},className:"rounded-full bg-status-danger text-white hover:bg-status-danger/90",children:"Sim, excluir"})]})]})}),(0,b.jsx)(bC.Dialog,{open:b5,onOpenChange:a=>{b6(a),a||(cb(null),cd({nome:"",email:"",telefone:"",cargo:"",personalidade:""}))},children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-3xl gap-0 overflow-hidden rounded-[20px] p-0",children:[(0,b.jsxs)("div",{className:"border-b border-zinc-100 px-5 py-4",children:[(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-lg font-semibold text-zinc-900",children:"Adicionar contato"}),(0,b.jsx)(bC.DialogDescription,{className:"mt-1 text-sm text-zinc-500",children:"Cadastre um novo contato para este card. Nome e cargo são obrigatórios."})]}),(0,b.jsxs)("div",{className:"space-y-4 px-5 py-4",children:[ca&&(0,b.jsx)(dH,{banner:{message:ca,variant:"warning"},onDismiss:()=>cb(null)}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Nome"}),(0,b.jsx)(a_.Input,{value:cc.nome,onChange:a=>cd({...cc,nome:a.target.value}),className:"mt-1 h-9 rounded-[10px] font-body text-sm",placeholder:"Nome"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Cargo"}),(0,b.jsxs)(bz.Select,{value:cc.cargo,onValueChange:a=>cd({...cc,cargo:a}),children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 w-full rounded-[10px] border-zinc-200 font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione o cargo"})}),(0,b.jsx)(bz.SelectContent,{children:bF.RESTAURANT_POSITIONS.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"E-mail"}),(0,b.jsx)(a_.Input,{type:"email",value:cc.email,onChange:a=>cd({...cc,email:a.target.value}),className:"mt-1 h-9 rounded-[10px] font-body text-sm",placeholder:"email@empresa.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Telefone"}),(0,b.jsx)(a2.PhoneInput,{value:cc.telefone,onValueChange:a=>cd({...cc,telefone:a}),className:"mt-1 h-9 rounded-[10px] font-body text-sm"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-[10px] uppercase tracking-wider text-zinc-400",children:"Personalidade"}),(0,b.jsx)(bA.Textarea,{value:cc.personalidade,onChange:a=>cd({...cc,personalidade:a.target.value}),className:"mt-1 min-h-[86px] rounded-[10px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]})]}),(0,b.jsxs)(bC.DialogFooter,{className:"border-t border-zinc-100 bg-zinc-50/50 px-5 py-3 sm:justify-end",children:[(0,b.jsx)(ad.Button,{variant:"ghost",className:"rounded-full font-heading text-xs",onClick:()=>{b6(!1),cb(null),cd({nome:"",email:"",telefone:"",cargo:"",personalidade:""})},children:"Cancelar"}),(0,b.jsx)(ad.Button,{className:"rounded-full bg-brand font-heading text-xs text-white hover:bg-brand/90",onClick:()=>{if(ak.length>=10){let a=`Limite atingido: no m\xe1ximo 10 contatos por card.`;b9({message:a,variant:"warning"}),cb(a);return}cc.nome.trim()?cc.cargo?(al([...ak,{id:`c${Date.now()}`,clientId:L?.clientId??"1",...cc,isDecisionMaker:!1}]),cd({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),b6(!1),cb(null),b9({message:"Contato adicionado. O score de patente do card foi recalculado.",variant:"success"})):cb("Selecione o cargo do contato para calcular o score de patente."):cb("Informe o nome do contato para continuar.")},children:"Salvar contato"})]})]})}),(0,b.jsx)(cZ,{isOpen:cv,onClose:()=>cw(!1),onSave:a=>{if(ap)return;let b=a.type,c=a.date&&a.time?new Date(`${a.date}T${a.time}:00`):new Date,d="presencial"===b?a.location||"Local a confirmar":"remoto"===b?dA[a.platform??"outro"]??"Reunião remota":a.typeDescription||"Encontro comercial",e="u1"===a.responsibleId?"Eu (Logado)":"u2"===a.responsibleId?"Ana Costa":"u3"===a.responsibleId?"Carlos Mendes":"Responsável do time",f="realizada"===a.status&&a.result?`${a.outcome?`${dB[a.outcome]}: `:""}${a.result}`:a.result||void 0,g={id:`visit-${Date.now()}`,type:b,location:d,status:a.status,startAt:Number.isNaN(c.getTime())?new Date().toISOString():c.toISOString(),responsible:e,objective:a.objective||void 0,result:f,outcome:a.outcome||void 0,durationMinutes:Number(a.duration||60),link:a.link||void 0,platform:a.platform||void 0,cancellationReason:a.cancellationReason||void 0,accessSearch:a.accessSearch||void 0,details:a.details||void 0,createdAt:new Date().toISOString()};cI(a=>[g,...a]),cE(g.status),cG(g.id),bU({message:"Visita salva com sucesso",variant:"success"})},dealId:M.id,contacts:ak,onAddContact:a=>{if(ak.length>=10)return void b9({message:`Limite atingido: no m\xe1ximo 10 contatos por card.`,variant:"warning"});let b={id:`c${Date.now()}`,clientId:L?.clientId??"1",nome:a.nome||"Sem Nome",email:a.email||"",telefone:a.telefone||"",cargo:a.cargo||"operacional",personalidade:"",isDecisionMaker:!1};al(a=>[...a,b]),b9({message:"Contato criado a partir de Visitas.",variant:"success"})}}),(0,b.jsx)(dc,{isOpen:cx,onClose:()=>cy(!1),onSave:dM,dealId:M.id,initialType:cz,initialClientId:L?.clientId,initialClientName:M.clientName,initialContactIds:c$?.id?[c$.id]:void 0,initialContactNames:c$?.nome?[c$.nome]:void 0,initialOpportunityId:M.id,initialOpportunityTitle:M.title,lockClient:!!L?.clientId,requireClient:!!L?.clientId}),(0,b.jsx)(bC.Dialog,{open:cn,onOpenChange:a=>{a||cu()},children:(0,b.jsxs)(bC.DialogContent,{className:"sm:max-w-md p-6",children:[(0,b.jsxs)(bC.DialogHeader,{children:[(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-lg font-bold",children:"Alterações não salvas"}),(0,b.jsx)(bC.DialogDescription,{className:"font-body text-sm text-zinc-500 mt-2",children:"Você tem alterações não salvas. Quer descartar as alterações e sair?"})]}),(0,b.jsxs)(bC.DialogFooter,{className:"mt-6 flex sm:justify-end gap-3",children:[(0,b.jsx)(ad.Button,{variant:"outline",onClick:cu,children:"Cancelar"}),(0,b.jsx)(ad.Button,{className:"bg-red-600 hover:bg-red-700 text-white",onClick:ct,children:"Sair sem salvar"})]})]})})]})}var dS=a.i(76472);let dT=(0,j.default)("log-in",[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]]),dU=(0,j.default)("thumbs-up",[["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}],["path",{d:"M7 10v12",key:"1qc93n"}]]);var dV=a.i(22024);let dW={good:{label:"Saudavel",color:"text-status-success",bgColor:"bg-status-success-light",icon:(0,b.jsx)(dS.Heart,{className:"h-4 w-4 fill-current text-status-success"}),numericScore:85},warning:{label:"Atencao",color:"text-status-warning",bgColor:"bg-status-warning-light",icon:(0,b.jsx)(I.AlertTriangle,{className:"h-4 w-4 text-status-warning"}),numericScore:55},critical:{label:"Critico",color:"text-status-danger",bgColor:"bg-status-danger-light",icon:(0,b.jsx)(ce.XCircle,{className:"h-4 w-4 text-status-danger"}),numericScore:20}},dX=[{id:"onboarding",label:"Onboarding"},{id:"implantacao",label:"Implantacao"},{id:"acompanhamento",label:"Acompanhamento"},{id:"retencao",label:"Retencao"},{id:"churn",label:"Churn"}],dY={id:"1",companyName:"Restaurante Panoramico",cnpj:"12.345.678/0001-00",razaoSocial:"Restaurante Panoramico Ltda ME",endereco:"Av. Paulista, 1000 - Bela Vista, Sao Paulo - SP",telefoneEmpresa:"(11) 3456-7890",emailEmpresa:"contato@panoramico.com",stage:"acompanhamento",healthScore:"good",monthlyRevenue:2500,contractStart:"2025-06-01",contractEnd:"2026-06-01",responsibleId:"u1",responsibleName:"Maria Silva",tags:["food-service","restaurante","premium"],lastInteraction:"2026-02-03",groupName:"Grupo Panoramico",notes:"Cliente com excelente engajamento. Acompanhar renovacao do contrato em junho."};function dZ(a){return bF.RESTAURANT_POSITIONS.find(b=>b.value===a)?.patentScore??0}let d$=dh.mockUsers.filter(a=>a.isActive).map(a=>({id:a.id,name:a.name,avatar:""})),d_=[{month:"Set",value:1800},{month:"Out",value:2e3},{month:"Nov",value:2200},{month:"Dez",value:2300},{month:"Jan",value:2500},{month:"Fev",value:2500}],d0=["Preco muito alto","Nao utiliza o produto","Mudou para concorrente","Empresa fechou","Insatisfacao com suporte","Falta de funcionalidades","Outro"];function d1(a){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL",minimumFractionDigits:0}).format(a)}function d2({icon:a,label:d,value:e,onSave:f,type:g="text"}){let[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(e),l=(0,c.useRef)(null);function m(){i(!1),j!==e&&f(j)}return(0,c.useEffect)(()=>{h&&l.current&&(l.current.focus(),l.current.select())},[h]),(0,b.jsxs)("div",{className:"flex items-center gap-3 rounded-[15px] border border-zinc-100 p-3 transition-colors hover:border-zinc-200",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:a}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-body text-xs text-zinc-500",children:d}),h?(0,b.jsx)(a_.Input,{ref:l,type:g,value:j,onChange:a=>k(a.target.value),onBlur:m,onKeyDown:a=>{"Enter"===a.key&&m(),"Escape"===a.key&&(k(e),i(!1))},className:"mt-0.5 h-7 rounded-[10px] border-zinc-200 font-body text-sm"}):(0,b.jsx)("p",{onClick:()=>{k(e),i(!0)},className:"mt-0.5 cursor-pointer rounded-lg px-1 py-0.5 font-body text-sm font-medium text-black transition-colors hover:bg-zinc-50",title:"Clique para editar",children:e||"--"})]}),!h&&(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 shrink-0 text-zinc-300 hover:text-zinc-500",onClick:()=>{k(e),i(!0)},children:(0,b.jsx)(C.Pencil,{className:"h-3.5 w-3.5"})})]})}function d3({currentStage:a,onStageChange:c}){let d=dX.findIndex(b=>b.id===a);return(0,b.jsx)("div",{className:"flex items-center gap-1",children:dX.map((e,f)=>{let g=e.id===a,h=f<d,i="churn"===e.id;return(0,b.jsxs)("button",{onClick:()=>c(e.id),className:`flex items-center gap-1 rounded-full px-3 py-1.5 font-body text-xs font-medium transition-all ${g?i?"bg-status-danger text-white shadow-sm":"bg-brand text-white shadow-sm":h?"bg-brand/10 text-brand":"bg-zinc-100 text-zinc-400 hover:bg-zinc-200 hover:text-zinc-600"}`,children:[h&&(0,b.jsx)(A.Check,{className:"h-3 w-3"}),e.label]},e.id)})})}function d4({currentId:a,currentName:c,teamMembers:d,onReassign:e}){let f=c.split(" ").map(a=>a[0]).join("").slice(0,2).toUpperCase();return(0,b.jsxs)(aW.DropdownMenu,{children:[(0,b.jsx)(aW.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)("button",{className:"flex items-center gap-2 rounded-full px-2 py-1 transition-colors hover:bg-zinc-100",children:[(0,b.jsx)("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-brand text-xs font-bold text-white",children:f}),(0,b.jsx)("span",{className:"font-body text-sm font-medium text-black",children:c}),(0,b.jsx)(C.Pencil,{className:"h-3 w-3 text-zinc-400"})]})}),(0,b.jsx)(aW.DropdownMenuContent,{align:"start",className:"rounded-[15px]",children:d.map(c=>(0,b.jsxs)(aW.DropdownMenuItem,{onClick:()=>e(c.id,c.name),className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-zinc-200 text-[10px] font-bold text-zinc-600",children:c.name.split(" ").map(a=>a[0]).join("").slice(0,2).toUpperCase()}),(0,b.jsx)("span",{className:"font-body text-sm",children:c.name}),c.id===a&&(0,b.jsx)(A.Check,{className:"ml-auto h-4 w-4 text-brand"})]},c.id))})]})}function d5({contact:a,onEdit:c,onDelete:d,onToggleDecisionMaker:f}){var g;return(0,b.jsxs)("div",{className:"group flex items-stretch rounded-[15px] border border-zinc-200",children:[(0,b.jsx)("button",{type:"button",onClick:f,className:`flex w-10 shrink-0 items-center justify-center rounded-l-[15px] border-r transition-colors ${a.isDecisionMaker?"border-brand/20 bg-brand/10 text-brand":"border-zinc-200 bg-zinc-50/50 text-zinc-300 hover:bg-zinc-100 hover:text-zinc-400"}`,"aria-label":a.isDecisionMaker?"Remover como decisor":"Marcar como decisor",title:a.isDecisionMaker?"Decisor (clique para remover)":"Marcar como decisor",children:(0,b.jsx)(y.Shield,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex flex-1 items-start justify-between p-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-zinc-100",children:(0,b.jsx)(m.User,{className:"h-5 w-5 text-zinc-500"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-heading text-sm font-semibold text-black",children:a.nome}),a.isDecisionMaker&&(0,b.jsxs)(aV.Badge,{className:"gap-1 rounded-[10px] bg-brand/10 text-brand font-body text-[10px]",children:[(0,b.jsx)(y.Shield,{className:"h-3 w-3"}),"Decisor"]})]}),(0,b.jsx)("p",{className:"font-body text-xs text-zinc-500",children:(g=a.cargo,bF.RESTAURANT_POSITIONS.find(a=>a.value===g)?.label??g)}),(0,b.jsxs)("div",{className:"mt-1.5 flex items-center gap-3",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1 font-body text-xs text-zinc-500",children:[(0,b.jsx)(h.Mail,{className:"h-3 w-3"}),a.email]}),(0,b.jsxs)("span",{className:"flex items-center gap-1 font-body text-xs text-zinc-500",children:[(0,b.jsx)(e.Phone,{className:"h-3 w-3"}),a.telefone]})]}),a.personalidade&&(0,b.jsxs)("p",{className:"mt-1.5 font-body text-xs italic text-zinc-400",children:["“",a.personalidade,"”"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-400 hover:text-zinc-600",onClick:c,children:(0,b.jsx)(C.Pencil,{className:"h-3.5 w-3.5"})}),(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-zinc-400 hover:text-status-danger",onClick:d,children:(0,b.jsx)(w.Trash2,{className:"h-3.5 w-3.5"})})]})]})]})}function d6({data:a}){let c=Math.max(...a.map(a=>a.value));return(0,b.jsxs)("div",{className:"rounded-[15px] border border-zinc-100 p-4",children:[(0,b.jsx)("h4",{className:"mb-3 font-heading text-sm font-semibold text-black",children:"MRR - Ultimos 6 Meses"}),(0,b.jsx)("div",{className:"flex items-end gap-2",style:{height:120},children:a.map((d,e)=>{let f=d.value/c*100,g=e===a.length-1;return(0,b.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1",children:[(0,b.jsx)("span",{className:"font-body text-[10px] font-medium text-zinc-500",children:d1(d.value)}),(0,b.jsx)("div",{className:`w-full rounded-t-lg transition-all ${g?"bg-brand":"bg-brand/20"}`,style:{height:`${f}%`,minHeight:8}}),(0,b.jsx)("span",{className:"font-body text-xs text-zinc-400",children:d.month})]},d.month)})})]})}function d7({icon:a,label:c,value:d,suffix:e,color:f="text-black"}){return(0,b.jsxs)("div",{className:"flex items-center gap-3 rounded-[15px] border border-zinc-100 p-4",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:a}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-body text-xs text-zinc-500",children:c}),(0,b.jsxs)("p",{className:`font-heading text-lg font-bold ${f}`,children:[d,e&&(0,b.jsx)("span",{className:"ml-0.5 font-body text-xs font-normal text-zinc-400",children:e})]})]})]})}function d8({open:a,onClose:d,onConfirm:e}){let[f,g]=(0,c.useState)(""),[h,i]=(0,c.useState)("");return(0,b.jsx)(bC.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-[480px] rounded-[20px] p-8",children:[(0,b.jsx)(bC.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-status-danger-light",children:(0,b.jsx)(ce.XCircle,{className:"h-5 w-5 text-status-danger"})}),(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Registrar Churn"})]})}),(0,b.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Motivo do Churn"}),(0,b.jsxs)(bz.Select,{value:f,onValueChange:g,children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione o motivo"})}),(0,b.jsx)(bz.SelectContent,{className:"rounded-[15px]",children:d0.map(a=>(0,b.jsx)(bz.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Observacoes"}),(0,b.jsx)(bA.Textarea,{value:h,onChange:a=>i(a.target.value),className:"min-h-[100px] rounded-[15px] font-body text-sm",placeholder:"Descreva os detalhes do churn..."})]})]}),(0,b.jsxs)(bC.DialogFooter,{className:"mt-6",children:[(0,b.jsx)(ad.Button,{variant:"secondary",onClick:d,className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,b.jsx)(ad.Button,{onClick:function(){e(f,h),g(""),i(""),d()},disabled:!f,className:"rounded-full bg-status-danger font-heading text-sm text-white hover:bg-status-danger/90",children:"Registrar Churn"})]})]})})}function d9(){let a,{drawerType:f,drawerData:g,closeDrawer:j,openModal:o}=(0,bE.useUIStore)(),q=g?.id,r=(0,c7.useClientStore)(a=>a.clients),s=(0,c.useMemo)(()=>r.find(a=>a.id===q),[r,q]),w=(0,c.useMemo)(()=>s?{...dY,id:s.id,companyName:s.companyName,cnpj:s.cnpj,razaoSocial:s.companyName,telefoneEmpresa:s.contactPhone,emailEmpresa:s.contactEmail,stage:s.stage,healthScore:s.healthScore,monthlyRevenue:s.monthlyRevenue,contractStart:s.contractStart,contractEnd:s.contractEnd,responsibleId:s.responsibleId,responsibleName:s.responsibleName,tags:s.tags,lastInteraction:s.lastInteraction,notes:""}:dY,[s]),x=(0,bF.calculateHealthScore)(w),y={...dW[x.category],numericScore:x.numericScore},[z,A]=(0,c.useState)(w.stage),[B,C]=(0,c.useState)(w.responsibleId),[D,I]=(0,c.useState)(w.responsibleName),[J,K]=(0,c.useState)(w.notes),[L,N]=(0,c.useState)(()=>[...w.tags]),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(()=>{let a=c9.getState().getByClient(w.id);return a.length>0?a:[]}),S=(0,c.useMemo)(()=>[...Q].sort((a,b)=>dZ(b.cargo)-dZ(a.cargo)),[Q]),[T,U]=(0,c.useState)(!1),[V,W]=(0,c.useState)(w.cnpj),[X,Y]=(0,c.useState)(w.razaoSocial),[Z,$]=(0,c.useState)(w.endereco),[_,aa]=(0,c.useState)(w.telefoneEmpresa),[ab,ac]=(0,c.useState)(w.emailEmpresa),[af,ag]=(0,c.useState)(!1),[ah,ai]=(0,c.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),[aj,ak]=(0,c.useState)(null),[al,am]=(0,c.useState)(null),[an,ao]=(0,c.useState)({nome:"",email:"",telefone:"",cargo:"",personalidade:""});function ap(){O.trim()&&!L.includes(O.trim().toLowerCase())&&(N([...L,O.trim().toLowerCase()]),P(""))}function aq(){al&&an.nome.trim()&&(R(Q.map(a=>a.id===al?{...a,...an}:a)),am(null),ao({nome:"",email:"",telefone:"",cargo:"",personalidade:""}))}return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c_.Sheet,{open:"client-card"===f,onOpenChange:()=>j(),children:(0,b.jsxs)(c_.SheetContent,{side:"right",className:"w-full overflow-y-auto border-l border-zinc-200 p-0 sm:w-[720px] sm:max-w-[720px]",showCloseButton:!1,children:[(0,b.jsxs)(c_.SheetHeader,{className:"sticky top-0 z-10 border-b border-zinc-200 bg-white px-6 py-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(c_.SheetTitle,{className:"font-heading text-xl font-semibold text-black",children:w.companyName}),(0,b.jsxs)("div",{className:`inline-flex items-center gap-1.5 rounded-[10px] px-3 py-1.5 font-heading text-sm font-bold ${y.bgColor} ${y.color}`,children:[y.icon,y.label,(0,b.jsxs)("span",{className:"ml-1 text-xs font-normal opacity-70",children:["(",y.numericScore,")"]})]}),w.groupName&&(0,b.jsxs)(aV.Badge,{className:"gap-1 rounded-[10px] bg-zinc-100 text-zinc-600 font-body text-xs",children:[(0,b.jsx)(n.Users,{className:"h-3 w-3"}),w.groupName]})]}),(0,b.jsxs)("p",{className:"mt-0.5 font-body text-sm text-zinc-500",children:["CNPJ: ",w.cnpj]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(ad.Button,{onClick:()=>U(!0),variant:"destructive",className:"rounded-full font-heading text-sm",children:"Registrar Churn"}),(0,b.jsxs)(aW.DropdownMenu,{children:[(0,b.jsx)(aW.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"text-zinc-400",children:(0,b.jsx)(t.MoreHorizontal,{className:"h-5 w-5"})})}),(0,b.jsxs)(aW.DropdownMenuContent,{align:"end",className:"rounded-[15px]",children:[(0,b.jsx)(aW.DropdownMenuItem,{onClick:()=>o("new-activity"),children:"Nova atividade"}),(0,b.jsx)(aW.DropdownMenuItem,{onClick:()=>o("new-activity"),children:"Registrar interacao"}),(0,b.jsx)(aW.DropdownMenuSeparator,{}),(0,b.jsx)(aW.DropdownMenuItem,{className:"text-status-danger",onClick:()=>o("confirm-deactivate"),children:"Desativar cliente"})]})]}),(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"text-zinc-400",onClick:()=>j(),children:(0,b.jsx)(d.X,{className:"h-5 w-5"})})]})]}),(0,b.jsx)("div",{className:"mt-3 overflow-x-auto",children:(0,b.jsx)(d3,{currentStage:z,onStageChange:A})}),(0,b.jsxs)("div",{className:"mt-3 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.DollarSign,{className:"h-4 w-4 text-zinc-400"}),(0,b.jsxs)("span",{className:"font-body text-sm text-zinc-600",children:["MRR: ",(0,b.jsx)("strong",{className:"text-black",children:d1(w.monthlyRevenue)})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(i.Calendar,{className:"h-4 w-4 text-zinc-400"}),(0,b.jsxs)("span",{className:"font-body text-sm text-zinc-600",children:["Contrato: ",(0,b.jsx)("strong",{className:"text-black",children:new Date(w.contractStart).toLocaleDateString("pt-BR")})]})]})]}),(0,b.jsx)(d4,{currentId:B,currentName:D,teamMembers:d$,onReassign:(a,b)=>{C(a),I(b)}})]})]}),(0,b.jsxs)("div",{className:"p-6",children:[aj&&(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)(dV.InlineFeedback,{type:aj.type,message:aj.message,compact:!0,onClose:()=>ak(null)})}),(0,b.jsxs)(bu,{defaultValue:"resumo",children:[(0,b.jsx)(bw,{className:"w-full border-b border-zinc-200 bg-transparent p-0",children:[{value:"resumo",label:"Resumo"},{value:"empresa",label:"Empresa"},{value:"contatos",label:"Contatos"},{value:"metricas",label:"Metricas"},{value:"tags",label:"Tags"},{value:"historico",label:"Historico"}].map(a=>(0,b.jsx)(bx,{value:a.value,className:"rounded-none border-b-2 border-transparent px-4 py-2.5 font-body text-sm data-[state=active]:border-brand data-[state=active]:text-brand",children:a.label},a.value))}),(0,b.jsxs)(by,{value:"resumo",className:"mt-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(ea,{icon:(0,b.jsx)(l.DollarSign,{className:"h-4 w-4"}),label:"Receita Mensal",children:(0,b.jsxs)("span",{className:"font-body text-sm font-medium text-black",children:[d1(w.monthlyRevenue),"/mes"]})}),(0,b.jsx)(ea,{icon:(0,b.jsx)(m.User,{className:"h-4 w-4"}),label:"Responsavel",children:(0,b.jsx)("span",{className:"font-body text-sm font-medium text-black",children:D})}),(0,b.jsx)(ea,{icon:(0,b.jsx)(i.Calendar,{className:"h-4 w-4"}),label:"Inicio do Contrato",children:(0,b.jsx)("span",{className:"font-body text-sm font-medium text-black",children:new Date(w.contractStart).toLocaleDateString("pt-BR")})}),(0,b.jsx)(ea,{icon:(0,b.jsx)(p.Clock,{className:"h-4 w-4"}),label:"Ultima Interacao",children:(0,b.jsx)("span",{className:"font-body text-sm font-medium text-black",children:w.lastInteraction?new Date(w.lastInteraction).toLocaleDateString("pt-BR"):"--"})})]}),(0,b.jsxs)("div",{className:"mt-4 flex flex-wrap items-center gap-2",children:[(0,b.jsx)(k,{className:"h-4 w-4 text-zinc-400"}),L.map(a=>(0,b.jsx)(aV.Badge,{variant:"outline",className:"rounded-[10px] font-body text-xs",children:a},a))]}),(0,b.jsx)(ae.Separator,{className:"my-6"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"mb-3 font-heading text-base font-semibold text-black",children:"Anotacoes"}),(0,b.jsx)(bA.Textarea,{value:J,onChange:a=>K(a.target.value),className:"min-h-[100px] rounded-[15px] font-body text-sm",placeholder:"Adicione anotacoes sobre este cliente..."})]})]}),(0,b.jsx)(by,{value:"empresa",className:"mt-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(d2,{icon:(0,b.jsx)(u.Building2,{className:"h-4 w-4"}),label:"CNPJ",value:V,onSave:W}),(0,b.jsx)(d2,{icon:(0,b.jsx)(G.FileText,{className:"h-4 w-4"}),label:"Razao Social",value:X,onSave:Y}),(0,b.jsx)(d2,{icon:(0,b.jsx)(E.MapPin,{className:"h-4 w-4"}),label:"Endereco",value:Z,onSave:$}),(0,b.jsx)(d2,{icon:(0,b.jsx)(e.Phone,{className:"h-4 w-4"}),label:"Telefone",value:_,onSave:aa}),(0,b.jsx)(d2,{icon:(0,b.jsx)(h.Mail,{className:"h-4 w-4"}),label:"E-mail",value:ab,onSave:ac})]})}),(0,b.jsxs)(by,{value:"contatos",className:"mt-6",children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsxs)("h3",{className:"font-heading text-base font-semibold text-black",children:["Contatos (",S.length,")"]}),(0,b.jsxs)(ad.Button,{onClick:()=>ag(!0),className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",size:"sm",children:[(0,b.jsx)(v.Plus,{className:"mr-1.5 h-4 w-4"}),"Adicionar"]})]}),af&&(0,b.jsxs)("div",{className:"mb-4 space-y-3 rounded-[15px] border border-zinc-200 p-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Nome"}),(0,b.jsx)(a_.Input,{value:ah.nome,onChange:a=>ai({...ah,nome:a.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm",placeholder:"Nome do contato"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Cargo"}),(0,b.jsxs)(bz.Select,{value:ah.cargo,onValueChange:a=>ai({...ah,cargo:a}),children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 w-full rounded-[15px] border-zinc-200 font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione o cargo"})}),(0,b.jsx)(bz.SelectContent,{children:bF.RESTAURANT_POSITIONS.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"E-mail"}),(0,b.jsx)(a_.Input,{type:"email",value:ah.email,onChange:a=>ai({...ah,email:a.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm",placeholder:"email@empresa.com"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Telefone"}),(0,b.jsx)(a2.PhoneInput,{value:ah.telefone,onValueChange:a=>ai({...ah,telefone:a}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Personalidade"}),(0,b.jsx)(bA.Textarea,{value:ah.personalidade,onChange:a=>ai({...ah,personalidade:a.target.value}),className:"mt-1 min-h-[60px] rounded-[15px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(ad.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-sm",onClick:()=>ag(!1),children:"Cancelar"}),(0,b.jsx)(ad.Button,{size:"sm",className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",onClick:function(){ah.nome.trim()&&(R([...Q,{id:`c${Date.now()}`,clientId:"client-mock",...ah,isDecisionMaker:!1}]),ai({nome:"",email:"",telefone:"",cargo:"",personalidade:""}),ag(!1))},children:"Salvar"})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:S.map(a=>al===a.id?(0,b.jsxs)("div",{className:"space-y-3 rounded-[15px] border border-brand/30 bg-brand-light/10 p-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Nome"}),(0,b.jsx)(a_.Input,{value:an.nome,onChange:a=>ao({...an,nome:a.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Cargo"}),(0,b.jsxs)(bz.Select,{value:an.cargo,onValueChange:a=>ao({...an,cargo:a}),children:[(0,b.jsx)(bz.SelectTrigger,{className:"mt-1 h-9 w-full rounded-[15px] border-zinc-200 font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione o cargo"})}),(0,b.jsx)(bz.SelectContent,{children:bF.RESTAURANT_POSITIONS.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"E-mail"}),(0,b.jsx)(a_.Input,{type:"email",value:an.email,onChange:a=>ao({...an,email:a.target.value}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Telefone"}),(0,b.jsx)(a2.PhoneInput,{value:an.telefone,onValueChange:a=>ao({...an,telefone:a}),className:"mt-1 h-9 rounded-[15px] font-body text-sm"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(a0.Label,{className:"font-body text-xs text-zinc-500",children:"Personalidade"}),(0,b.jsx)(bA.Textarea,{value:an.personalidade,onChange:a=>ao({...an,personalidade:a.target.value}),className:"mt-1 min-h-[60px] rounded-[15px] font-body text-sm",placeholder:"Ex: Direto e objetivo, prefere reuniões curtas..."})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,b.jsx)(ad.Button,{variant:"ghost",size:"sm",className:"rounded-full font-heading text-sm",onClick:()=>{am(null),ao({nome:"",email:"",telefone:"",cargo:"",personalidade:""})},children:"Cancelar"}),(0,b.jsx)(ad.Button,{size:"sm",className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",onClick:aq,children:"Salvar"})]})]},a.id):(0,b.jsx)(d5,{contact:a,onEdit:()=>{am(a.id),ao({nome:a.nome,email:a.email,telefone:a.telefone,cargo:a.cargo,personalidade:a.personalidade??""})},onDelete:()=>{var b;return b=a.id,void R(Q.filter(a=>a.id!==b))},onToggleDecisionMaker:()=>{var b;return b=a.id,void R(Q.map(a=>a.id===b?{...a,isDecisionMaker:!a.isDecisionMaker}:a))}},a.id))})]}),(0,b.jsx)(by,{value:"metricas",className:"mt-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(d6,{data:d_}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(d7,{icon:(0,b.jsx)(M.Activity,{className:"h-5 w-5"}),label:"Score de Uso",value:82,suffix:"/100",color:"text-status-success"}),(0,b.jsx)(d7,{icon:(0,b.jsx)(dT,{className:"h-5 w-5"}),label:"Dias Desde Ultimo Login",value:2,suffix:"dias",color:"text-status-success"}),(0,b.jsx)(d7,{icon:(0,b.jsx)(dU,{className:"h-5 w-5"}),label:"NPS Score",value:9,suffix:"/10",color:"text-status-success"}),(0,b.jsx)(d7,{icon:(0,b.jsx)(F.TrendingUp,{className:"h-5 w-5"}),label:"Crescimento MRR",value:"+39%",color:"text-status-success"})]})]})}),(0,b.jsx)(by,{value:"tags",className:"mt-6",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a_.Input,{value:O,onChange:a=>P(a.target.value),onKeyDown:a=>{"Enter"===a.key&&(a.preventDefault(),ap())},placeholder:"Digite uma nova tag...",className:"h-9 flex-1 rounded-[15px] font-body text-sm"}),(0,b.jsxs)(ad.Button,{onClick:ap,className:"rounded-full bg-brand font-heading text-sm text-white hover:bg-brand/90",size:"sm",children:[(0,b.jsx)(v.Plus,{className:"mr-1 h-4 w-4"}),"Adicionar"]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:L.map(a=>(0,b.jsxs)(aV.Badge,{variant:"outline",className:"gap-1.5 rounded-[10px] py-1.5 pr-1.5 font-body text-sm",children:[a,(0,b.jsx)("button",{onClick:()=>{N(L.filter(b=>b!==a))},className:"rounded-full p-0.5 transition-colors hover:bg-zinc-200",children:(0,b.jsx)(d.X,{className:"h-3 w-3 text-zinc-400"})})]},a))}),0===L.length&&(0,b.jsx)("p",{className:"py-8 text-center font-body text-sm text-zinc-400",children:"Nenhuma tag adicionada"})]})}),(0,b.jsx)(by,{value:"historico",className:"mt-6",children:(0,b.jsx)("div",{className:"relative space-y-0",children:(a=function(a){let b=de.getState().getByClient(a),c=[];for(let a of b)c.push({id:a.id,type:"realizada"===a.status?"activity":"created",message:`Visita ${a.type}: ${a.objective??a.location}`,user:a.responsible,date:new Date(a.startAt).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})});return c.sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime())}(w.id)).map((c,d)=>(0,b.jsxs)("div",{className:"relative flex gap-4 pb-6",children:[d<a.length-1&&(0,b.jsx)("div",{className:"absolute left-[15px] top-8 h-full w-px bg-zinc-200"}),(0,b.jsx)("div",{className:"relative z-10 flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:function(a){switch(a){case"created":return(0,b.jsx)(v.Plus,{className:"h-3.5 w-3.5"});case"activity":return(0,b.jsx)(i.Calendar,{className:"h-3.5 w-3.5"});case"stage-change":return(0,b.jsx)(H.ArrowRight,{className:"h-3.5 w-3.5"});case"note":return(0,b.jsx)(G.FileText,{className:"h-3.5 w-3.5"});case"tag-added":return(0,b.jsx)(k,{className:"h-3.5 w-3.5"});case"value-change":return(0,b.jsx)(l.DollarSign,{className:"h-3.5 w-3.5"});case"health-change":return(0,b.jsx)(dS.Heart,{className:"h-3.5 w-3.5"});default:return(0,b.jsx)(p.Clock,{className:"h-3.5 w-3.5"})}}(c.type)}),(0,b.jsxs)("div",{className:"flex-1 pt-0.5",children:[(0,b.jsx)("p",{className:"font-body text-sm text-black",children:c.message}),(0,b.jsxs)("p",{className:"font-body text-xs text-zinc-400",children:[c.user," -- ",c.date]})]})]},c.id))})})]})]})]})}),(0,b.jsx)(d8,{open:T,onClose:()=>U(!1),onConfirm:(a,b)=>{A("churn"),ak({type:"success",message:`Churn registrado! Motivo: ${a}.${b?` Observacoes: ${b}.`:""} O cliente foi marcado como churn.`})}})]})}function ea({icon:a,label:c,children:d}){return(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-zinc-100 text-zinc-500",children:a}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-body text-xs text-zinc-500",children:c}),d]})]})}var eb=a.i(39761);let ec=(0,j.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),ed=(0,j.default)("bookmark",[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]]);var ee=a.i(59385),ef=a.i(15055);function eg(a,b){}let eh=[{id:"user-3",name:"Lucas Oliveira"},{id:"user-4",name:"Juliana Costa"},{id:"user-5",name:"Fernanda Lima"},{id:"user-6",name:"Marcos Pereira"},{id:"user-7",name:"Carolina Santos"}],ei=[{id:"lead-in",label:"Lead-In"},{id:"contato-feito",label:"Contato Feito"},{id:"reuniao-agendada",label:"Reuniao Agendada"},{id:"proposta-enviada",label:"Proposta Enviada"},{id:"negociacao",label:"Negociacao"},{id:"fechamento",label:"Fechamento"}],ej=[{id:"onboarding",label:"Onboarding"},{id:"implantacao",label:"Implantacao"},{id:"acompanhamento",label:"Acompanhamento"},{id:"retencao",label:"Retencao"},{id:"churn",label:"Churn"}],ek=[{id:"hot",label:"Quente",icon:(0,b.jsx)(q.Flame,{className:"h-3.5 w-3.5 text-status-danger"})},{id:"warm",label:"Morna",icon:(0,b.jsx)(r.Thermometer,{className:"h-3.5 w-3.5 text-status-warning"})},{id:"cold",label:"Fria",icon:(0,b.jsx)(s.Snowflake,{className:"h-3.5 w-3.5 text-status-info"})}],el=["food-service","restaurante","premium","varejo","saude","tecnologia","educacao","industria"],em=[{id:"call",label:"Ligacao"},{id:"email",label:"E-mail"},{id:"meeting",label:"Reuniao"},{id:"task",label:"Tarefa"},{id:"follow-up",label:"Follow-up"},{id:"whatsapp",label:"WhatsApp"}],en=[{id:"pending",label:"Pendente"},{id:"completed",label:"Concluida"},{id:"overdue",label:"Atrasada"},{id:"cancelled",label:"Cancelada"}],eo=[{id:"good",label:"Saudavel",icon:(0,b.jsx)(dS.Heart,{className:"h-3.5 w-3.5 text-status-success"})},{id:"warning",label:"Atencao",icon:(0,b.jsx)(dS.Heart,{className:"h-3.5 w-3.5 text-status-warning"})},{id:"critical",label:"Critico",icon:(0,b.jsx)(dS.Heart,{className:"h-3.5 w-3.5 text-status-danger"})}],ep=[{id:"projected",label:"Projetado"},{id:"confirmed",label:"Confirmado"},{id:"paid",label:"Pago"},{id:"contested",label:"Contestado"}],eq=[{id:"this-month",label:"Este mes"},{id:"last-month",label:"Mes passado"},{id:"this-quarter",label:"Este trimestre"},{id:"last-quarter",label:"Trimestre passado"},{id:"this-year",label:"Este ano"}];function er({label:a,options:c,selected:d,onChange:e,icon:f}){return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[f&&(0,b.jsx)("span",{className:"text-zinc-400",children:f}),(0,b.jsx)(a0.Label,{className:"font-heading text-sm font-semibold text-black",children:a}),d.length>0&&(0,b.jsx)(aV.Badge,{className:"rounded-[10px] bg-brand px-1.5 py-0 font-body text-[10px] text-white",children:d.length})]}),(0,b.jsx)("div",{className:"space-y-2",children:c.map(a=>(0,b.jsxs)("label",{className:"flex cursor-pointer items-center gap-2.5 rounded-lg px-2 py-1.5 transition-colors hover:bg-zinc-50",children:[(0,b.jsx)(ef.Checkbox,{checked:d.includes(a.id),onCheckedChange:()=>{var b;return b=a.id,void(d.includes(b)?e(d.filter(a=>a!==b)):e([...d,b]))},className:"rounded-checkbox"}),a.icon&&(0,b.jsx)("span",{children:a.icon}),(0,b.jsx)("span",{className:"font-body text-sm text-zinc-700",children:a.label})]},a.id))})]})}function es({label:a,icon:c,minValue:d,maxValue:e,onMinChange:f,onMaxChange:g,placeholder:h,type:i="text"}){return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[c&&(0,b.jsx)("span",{className:"text-zinc-400",children:c}),(0,b.jsx)(a0.Label,{className:"font-heading text-sm font-semibold text-black",children:a})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a_.Input,{type:i,value:d,onChange:a=>f(a.target.value),placeholder:h?.min||"Min",className:"h-9 rounded-[15px] font-body text-sm"}),(0,b.jsx)("span",{className:"font-body text-xs text-zinc-400",children:"ate"}),(0,b.jsx)(a_.Input,{type:i,value:e,onChange:a=>g(a.target.value),placeholder:h?.max||"Max",className:"h-9 rounded-[15px] font-body text-sm"})]})]})}function et({filters:a,setFilters:c}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(er,{label:"Responsavel",icon:(0,b.jsx)(m.User,{className:"h-4 w-4"}),options:eh.map(a=>({id:a.id,label:a.name})),selected:a.responsible,onChange:a=>c(b=>({...b,responsible:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Estagio",icon:(0,b.jsx)(eb.BarChart3,{className:"h-4 w-4"}),options:ei,selected:a.stage,onChange:a=>c(b=>({...b,stage:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Temperatura",icon:(0,b.jsx)(q.Flame,{className:"h-4 w-4"}),options:ek,selected:a.temperature,onChange:a=>c(b=>({...b,temperature:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Tags",icon:(0,b.jsx)(k,{className:"h-4 w-4"}),options:el.map(a=>({id:a,label:a})),selected:a.tags,onChange:a=>c(b=>({...b,tags:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-zinc-400",children:(0,b.jsx)(I.AlertTriangle,{className:"h-4 w-4"})}),(0,b.jsx)(a0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Alertas"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("label",{className:"flex cursor-pointer items-center gap-2.5 rounded-lg px-2 py-1.5 transition-colors hover:bg-zinc-50",children:[(0,b.jsx)(ef.Checkbox,{checked:a.overdue,onCheckedChange:a=>c(b=>({...b,overdue:!!a})),className:"rounded-checkbox"}),(0,b.jsx)(q.Flame,{className:"h-3.5 w-3.5 text-status-danger"}),(0,b.jsx)("span",{className:"font-body text-sm text-zinc-700",children:"Somente Estourados"})]}),(0,b.jsxs)("label",{className:"flex cursor-pointer items-center gap-2.5 rounded-lg px-2 py-1.5 transition-colors hover:bg-zinc-50",children:[(0,b.jsx)(ef.Checkbox,{checked:a.stale,onCheckedChange:a=>c(b=>({...b,stale:!!a})),className:"rounded-checkbox"}),(0,b.jsx)(ee.TimerReset,{className:"h-3.5 w-3.5 text-status-warning"}),(0,b.jsx)("span",{className:"font-body text-sm text-zinc-700",children:"Somente Sem Atividade"})]})]})]}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(es,{label:"Periodo",icon:(0,b.jsx)(i.Calendar,{className:"h-4 w-4"}),minValue:a.dateStart,maxValue:a.dateEnd,onMinChange:a=>c(b=>({...b,dateStart:a})),onMaxChange:a=>c(b=>({...b,dateEnd:a})),placeholder:{min:"Data inicio",max:"Data fim"},type:"date"}),(0,b.jsx)(ae.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-zinc-400",children:(0,b.jsx)(l.DollarSign,{className:"h-4 w-4"})}),(0,b.jsx)(a0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Faixa de Valor"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a2.CurrencyInput,{value:a.valueMin?Number(a.valueMin):void 0,onValueChange:a=>c(b=>({...b,valueMin:a>0?String(a):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Min"}),(0,b.jsx)("span",{className:"font-body text-xs text-zinc-400",children:"ate"}),(0,b.jsx)(a2.CurrencyInput,{value:a.valueMax?Number(a.valueMax):void 0,onValueChange:a=>c(b=>({...b,valueMax:a>0?String(a):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Max"})]})]})]})}function eu({filters:a,setFilters:c}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(er,{label:"Responsavel",icon:(0,b.jsx)(m.User,{className:"h-4 w-4"}),options:eh.map(a=>({id:a.id,label:a.name})),selected:a.responsible,onChange:a=>c(b=>({...b,responsible:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Estagio",icon:(0,b.jsx)(eb.BarChart3,{className:"h-4 w-4"}),options:ej,selected:a.stage,onChange:a=>c(b=>({...b,stage:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Health Score",icon:(0,b.jsx)(dS.Heart,{className:"h-4 w-4"}),options:eo,selected:a.healthScore,onChange:a=>c(b=>({...b,healthScore:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-zinc-400",children:(0,b.jsx)(l.DollarSign,{className:"h-4 w-4"})}),(0,b.jsx)(a0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Faixa de MRR"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a2.CurrencyInput,{value:a.mrrMin?Number(a.mrrMin):void 0,onValueChange:a=>c(b=>({...b,mrrMin:a>0?String(a):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Min"}),(0,b.jsx)("span",{className:"font-body text-xs text-zinc-400",children:"ate"}),(0,b.jsx)(a2.CurrencyInput,{value:a.mrrMax?Number(a.mrrMax):void 0,onValueChange:a=>c(b=>({...b,mrrMax:a>0?String(a):""})),className:"h-9 rounded-[15px] font-body text-sm",placeholder:"R$ Max"})]})]}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(es,{label:"Ultima Interacao",icon:(0,b.jsx)(i.Calendar,{className:"h-4 w-4"}),minValue:a.lastInteractionStart,maxValue:a.lastInteractionEnd,onMinChange:a=>c(b=>({...b,lastInteractionStart:a})),onMaxChange:a=>c(b=>({...b,lastInteractionEnd:a})),placeholder:{min:"Data inicio",max:"Data fim"},type:"date"})]})}function ev({filters:a,setFilters:c}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(er,{label:"Tipo",icon:(0,b.jsx)(M.Activity,{className:"h-4 w-4"}),options:em,selected:a.type,onChange:a=>c(b=>({...b,type:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Responsavel",icon:(0,b.jsx)(m.User,{className:"h-4 w-4"}),options:eh.map(a=>({id:a.id,label:a.name})),selected:a.responsible,onChange:a=>c(b=>({...b,responsible:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Status",icon:(0,b.jsx)(bZ.CheckSquare,{className:"h-4 w-4"}),options:en,selected:a.status,onChange:a=>c(b=>({...b,status:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(es,{label:"Periodo",icon:(0,b.jsx)(i.Calendar,{className:"h-4 w-4"}),minValue:a.dateStart,maxValue:a.dateEnd,onMinChange:a=>c(b=>({...b,dateStart:a})),onMaxChange:a=>c(b=>({...b,dateEnd:a})),placeholder:{min:"Data inicio",max:"Data fim"},type:"date"})]})}function ew({filters:a,setFilters:c}){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(er,{label:"Vendedor",icon:(0,b.jsx)(m.User,{className:"h-4 w-4"}),options:eh.map(a=>({id:a.id,label:a.name})),selected:a.seller,onChange:a=>c(b=>({...b,seller:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Status",icon:(0,b.jsx)(bZ.CheckSquare,{className:"h-4 w-4"}),options:ep,selected:a.status,onChange:a=>c(b=>({...b,status:a}))}),(0,b.jsx)(ae.Separator,{}),(0,b.jsx)(er,{label:"Periodo",icon:(0,b.jsx)(i.Calendar,{className:"h-4 w-4"}),options:eq,selected:a.period,onChange:a=>c(b=>({...b,period:a}))})]})}let ex={responsible:[],stage:[],temperature:[],tags:[],dateStart:"",dateEnd:"",valueMin:"",valueMax:"",overdue:!1,stale:!1},ey={responsible:[],stage:[],healthScore:[],mrrMin:"",mrrMax:"",lastInteractionStart:"",lastInteractionEnd:""},ez={type:[],responsible:[],status:[],dateStart:"",dateEnd:""},eA={seller:[],status:[],period:[]},eB={pipes:"Pipeline",clients:"Clientes",activities:"Atividades",finance:"Financeiro"};function eC({savedFilters:a,onApply:e,onRemove:f,onSave:g,canSave:h}){let[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!1);function m(){let a=i.trim();a&&(g(a),j(""),l(!1))}return(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-2.5 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-zinc-400",children:(0,b.jsx)(ed,{className:"h-4 w-4"})}),(0,b.jsx)(a0.Label,{className:"font-heading text-sm font-semibold text-black",children:"Filtros Salvos"}),a.length>0&&(0,b.jsx)(aV.Badge,{className:"rounded-[10px] bg-zinc-100 px-1.5 py-0 font-body text-[10px] text-zinc-600",children:a.length})]}),a.length>0&&(0,b.jsx)("div",{className:"mb-3 flex flex-wrap gap-2",children:a.map(a=>(0,b.jsxs)("div",{className:"group flex items-center gap-1.5 rounded-[10px] border border-zinc-200 bg-zinc-50 px-3 py-1.5 transition-colors hover:border-brand hover:bg-brand-light",children:[(0,b.jsx)("button",{type:"button",className:"font-body text-sm text-zinc-700 group-hover:text-brand",onClick:()=>e(a),children:a.name}),(0,b.jsx)("button",{type:"button",className:"ml-0.5 text-zinc-400 transition-colors hover:text-status-danger",onClick:b=>{b.stopPropagation(),f(a.id)},children:(0,b.jsx)(d.X,{className:"h-3 w-3"})})]},a.id))}),0===a.length&&!k&&(0,b.jsx)("p",{className:"mb-3 font-body text-xs text-zinc-400",children:"Nenhum filtro salvo ainda."}),k?(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(a_.Input,{value:i,onChange:a=>j(a.target.value),placeholder:"Nome do filtro",className:"h-8 flex-1 rounded-[15px] font-body text-sm",onKeyDown:a=>{"Enter"===a.key&&m(),"Escape"===a.key&&(l(!1),j(""))},autoFocus:!0}),(0,b.jsxs)(ad.Button,{variant:"outline",size:"sm",className:"h-8 rounded-full font-heading text-xs",onClick:m,disabled:!i.trim(),children:[(0,b.jsx)(ec,{className:"mr-1 h-3 w-3"}),"Salvar"]}),(0,b.jsx)(ad.Button,{variant:"ghost",size:"sm",className:"h-8 rounded-full font-heading text-xs text-zinc-400",onClick:()=>{l(!1),j("")},children:(0,b.jsx)(d.X,{className:"h-3 w-3"})})]}):(0,b.jsxs)(ad.Button,{variant:"outline",size:"sm",className:"h-8 rounded-full border-dashed border-zinc-300 font-heading text-xs text-zinc-500 hover:border-brand hover:text-brand",onClick:()=>l(!0),disabled:!h,title:h?void 0:"Maximo de 10 filtros salvos",children:[(0,b.jsx)(ec,{className:"mr-1.5 h-3 w-3"}),"Salvar filtro atual"]})]})}function eD({context:a,onApplyFilters:e}){let{drawerType:f,closeDrawer:g}=(0,bE.useUIStore)(),[h,i]=(0,c.useState)(ex),[j,k]=(0,c.useState)(ey),[l,m]=(0,c.useState)(ez),[n,o]=(0,c.useState)(eA),[p,q]=(0,c.useState)([]);(0,c.useEffect)(()=>{q([])},[a]);let r=(0,c.useCallback)(()=>{switch(a){case"pipes":return h;case"clients":return j;case"activities":return l;case"finance":return n}},[a,h,j,l,n]),s=(0,c.useMemo)(()=>{switch(a){case"pipes":return h.responsible.length+h.stage.length+h.temperature.length+h.tags.length+ +!!h.dateStart+ +!!h.dateEnd+ +!!h.valueMin+ +!!h.valueMax+ +!!h.overdue+ +!!h.stale;case"clients":return j.responsible.length+j.stage.length+j.healthScore.length+ +!!j.mrrMin+ +!!j.mrrMax+ +!!j.lastInteractionStart+ +!!j.lastInteractionEnd;case"activities":return l.type.length+l.responsible.length+l.status.length+ +!!l.dateStart+ +!!l.dateEnd;case"finance":return n.seller.length+n.status.length+n.period.length;default:return 0}},[a,h,j,l,n]),t=(0,c.useCallback)(()=>{switch(a){case"pipes":i(ex);break;case"clients":k(ey);break;case"activities":m(ez);break;case"finance":o(eA)}},[a]);return(0,c.useEffect)(()=>{},[a,t]),(0,b.jsx)(c_.Sheet,{open:"filters"===f,onOpenChange:()=>g(),children:(0,b.jsxs)(c_.SheetContent,{side:"right",className:"flex w-[400px] max-w-full flex-col overflow-hidden border-l border-zinc-200 p-0 sm:max-w-[400px]",showCloseButton:!1,children:[(0,b.jsxs)(c_.SheetHeader,{className:"flex flex-row items-center justify-between border-b border-zinc-200 px-6 py-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-brand-light",children:(0,b.jsx)(N.Filter,{className:"h-4 w-4 text-brand"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(c_.SheetTitle,{className:"font-heading text-lg font-semibold text-black",children:"Filtros"}),(0,b.jsx)("p",{className:"font-body text-xs text-zinc-500",children:eB[a]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[s>0&&(0,b.jsxs)(aV.Badge,{className:"rounded-[10px] bg-brand px-2 py-0.5 font-body text-xs text-white",children:[s," ativo",1!==s?"s":""]}),(0,b.jsx)(ad.Button,{variant:"ghost",size:"icon",className:"text-zinc-400",onClick:()=>g(),children:(0,b.jsx)(d.X,{className:"h-5 w-5"})})]})]}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto px-6 py-5",children:[(0,b.jsx)(eC,{savedFilters:p,onApply:function(b){switch(a){case"pipes":i(b.filters);break;case"clients":k(b.filters);break;case"activities":m(b.filters);break;case"finance":o(b.filters)}},onRemove:function(b){let c=p.filter(a=>a.id!==b);q(c),eg(a,c)},onSave:function(b){let c=[...p,{id:`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:b,filters:r()}].slice(-10);q(c),eg(a,c)},canSave:p.length<10}),(0,b.jsx)(ae.Separator,{className:"my-5"}),"pipes"===a&&(0,b.jsx)(et,{filters:h,setFilters:i}),"clients"===a&&(0,b.jsx)(eu,{filters:j,setFilters:k}),"activities"===a&&(0,b.jsx)(ev,{filters:l,setFilters:m}),"finance"===a&&(0,b.jsx)(ew,{filters:n,setFilters:o})]}),(0,b.jsx)(c_.SheetFooter,{className:"border-t border-zinc-200 px-6 py-4",children:(0,b.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,b.jsx)(ad.Button,{variant:"ghost",onClick:t,className:"font-heading text-sm text-zinc-500 hover:text-zinc-700",children:"Limpar"}),(0,b.jsxs)(ad.Button,{onClick:function(){let a=r();e&&e(a),g()},className:"rounded-full bg-brand px-6 font-heading text-sm text-white hover:bg-brand/90",children:["Aplicar Filtros",s>0&&(0,b.jsx)(aV.Badge,{className:"ml-2 rounded-full bg-white/20 px-1.5 py-0 font-body text-[10px] text-white",children:s})]})]})})]})})}var eE=a.i(90090);let eF=(0,bO.create)()((0,bP.devtools)((a,b)=>({notifications:eE.mockNotifications,addNotification:b=>a(a=>({notifications:[{...b,id:`notif-${Date.now()}`,createdAt:new Date().toISOString(),isRead:!1},...a.notifications]})),markAsRead:b=>a(a=>({notifications:a.notifications.map(a=>a.id===b?{...a,isRead:!0}:a)})),markAllAsRead:()=>a(a=>({notifications:a.notifications.map(a=>({...a,isRead:!0}))})),deleteNotification:b=>a(a=>({notifications:a.notifications.filter(a=>a.id!==b)})),getUnread:()=>b().notifications.filter(a=>!a.isRead),getUnreadCount:()=>b().notifications.filter(a=>!a.isRead).length}),{name:"notification-store"}));var eG=a.i(19979);let eH=["lead-in","contato-feito","reuniao-agendada","proposta-enviada","negociacao","fechamento"];function eI(){let{drawerType:a,drawerData:d,closeDrawer:e}=(0,bE.useUIStore)(),{addOpportunity:f}=(0,cK.useOpportunityStore)(),{addNotification:g}=eF(),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),l="new-opportunity"===a,m=eH.includes(d?.initialStage)?d?.initialStage:"lead-in",n="string"==typeof d?.source?d.source:"",o=dh.mockUsers.filter(a=>a.isActive&&"leitura"!==a.role),p=o.reduce((a,b)=>(a[b.id]=b.name,a),{}),{register:q,handleSubmit:r,setValue:s,watch:t,reset:u,formState:{errors:v}}=(0,cL.useForm)({resolver:(0,cM.zodResolver)(eG.newOpportunitySchema),defaultValues:{temperature:"warm",tags:[],source:n}}),w=t("source");async function x(a){i(!0);try{f({title:a.title,clientName:a.clientName,value:a.value,monthlyValue:a.monthlyValue||0,stage:m,temperature:a.temperature||"warm",responsibleId:a.responsibleId,responsibleName:p[a.responsibleId]||"Não atribuído",tags:a.tags||[],source:a.source,notes:a.notes}),g({type:"system",title:"Nova oportunidade criada",message:`"${a.title}" (${(0,bF.formatCurrencyBRL)(a.value)}) foi adicionada ao pipeline.`,link:"/pipes"}),k({type:"success",message:"Oportunidade criada com sucesso!"}),setTimeout(()=>{k(null),u({temperature:"warm",tags:[],source:n}),e()},1500)}catch{k({type:"error",message:"Erro ao criar oportunidade. Tente novamente."})}finally{i(!1)}}return(0,c.useEffect)(()=>{l&&u({temperature:"warm",tags:[],source:n})},[n,l,u]),(0,b.jsx)(bC.Dialog,{open:l,onOpenChange:()=>{k(null),u({temperature:"warm",tags:[],source:n}),e()},children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-[480px] rounded-[20px] p-8",children:[(0,b.jsx)(bC.DialogHeader,{children:(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Nova Oportunidade"})}),(0,b.jsxs)("form",{onSubmit:r(x),className:"mt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Título"}),(0,b.jsx)(a_.Input,{placeholder:"Nome da oportunidade",className:"h-10 rounded-[15px] font-body text-sm",...q("title")}),v.title&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:v.title.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Cliente"}),(0,b.jsx)(a_.Input,{placeholder:"Nome do cliente",className:"h-10 rounded-[15px] font-body text-sm",...q("clientName")}),v.clientName&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:v.clientName.message})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor Total (R$)"}),(0,b.jsx)(a2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:a=>s("value",a)}),v.value&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:v.value.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor Mensal (R$)"}),(0,b.jsx)(a2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:a=>s("monthlyValue",a)})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Temperatura"}),(0,b.jsxs)(bz.Select,{defaultValue:"warm",onValueChange:a=>s("temperature",a),children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{})}),(0,b.jsxs)(bz.SelectContent,{className:"rounded-[15px]",children:[(0,b.jsx)(bz.SelectItem,{value:"hot",children:"Quente"}),(0,b.jsx)(bz.SelectItem,{value:"warm",children:"Morna"}),(0,b.jsx)(bz.SelectItem,{value:"cold",children:"Fria"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Origem"}),(0,b.jsxs)(bz.Select,{value:w||void 0,onValueChange:a=>s("source",a),children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:n||"Selecione"})}),(0,b.jsxs)(bz.SelectContent,{className:"rounded-[15px]",children:[(0,b.jsx)(bz.SelectItem,{value:"indicacao",children:"Indicação"}),(0,b.jsx)(bz.SelectItem,{value:"site",children:"Site"}),(0,b.jsx)(bz.SelectItem,{value:"rede-social",children:"Rede Social"}),(0,b.jsx)(bz.SelectItem,{value:"cold-call",children:"Cold Call"}),(0,b.jsx)(bz.SelectItem,{value:"evento",children:"Evento"}),(0,b.jsx)(bz.SelectItem,{value:"outro",children:"Outro"})]})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Responsável"}),(0,b.jsxs)(bz.Select,{onValueChange:a=>s("responsibleId",a),children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione um responsável"})}),(0,b.jsx)(bz.SelectContent,{className:"rounded-[15px]",children:o.map(a=>(0,b.jsx)(bz.SelectItem,{value:a.id,children:a.name},a.id))})]}),v.responsibleId&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:v.responsibleId.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Observações"}),(0,b.jsx)(bA.Textarea,{placeholder:"Notas sobre a oportunidade...",className:"rounded-[15px] font-body text-sm",rows:3,...q("notes")})]}),j&&(0,b.jsx)(dV.InlineFeedback,{type:j.type,message:j.message,onClose:()=>k(null)}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,b.jsx)(ad.Button,{type:"button",variant:"secondary",onClick:()=>{u(),e()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,b.jsxs)(ad.Button,{type:"submit",disabled:h,className:"rounded-full bg-black font-heading text-sm text-white hover:bg-zinc-800",children:[h?(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Criar oportunidade"]})]})]})]})})}var eJ=a.i(83077);function eK(){let{modalType:a,modalData:d,closeModal:e}=(0,bE.useUIStore)(),{winOpportunity:f,getById:g}=(0,cK.useOpportunityStore)(),{addClient:h}=(0,c7.useClientStore)(),{addNotification:i}=eF(),[j,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)(null),n=d?.opportunityId,{register:o,handleSubmit:p,reset:q,setValue:r,formState:{errors:s}}=(0,cL.useForm)({resolver:(0,cM.zodResolver)(eG.winOpportunitySchema)});async function t(a){k(!0);try{(0,bF.calculateProjectedCommission)(a.contractValue);let b=n?g(n):null;n&&f(n),b&&h({companyName:b.clientName,cnpj:"",contactName:b.clientName,contactEmail:"",contactPhone:"",stage:"onboarding",healthScore:"good",monthlyRevenue:a.monthlyValue,contractStart:a.contractStart,contractEnd:void 0,responsibleId:b.responsibleId,responsibleName:b.responsibleName,tags:b.tags||[],lastInteraction:new Date().toISOString().split("T")[0]}),i({type:"opportunity-won",title:"Oportunidade ganha!",message:`"${b?.title||"Oportunidade"}" foi marcada como ganha! Contrato: ${(0,bF.formatCurrencyBRL)(a.contractValue)}. Cliente criado no pipeline de CS.`,link:"/clients"}),m({type:"success",message:"Oportunidade marcada como Ganha!"}),setTimeout(()=>{m(null),q(),e()},1500)}catch{m({type:"error",message:"Erro ao registrar ganho. Tente novamente."})}finally{k(!1)}}return(0,b.jsx)(bC.Dialog,{open:"win-opportunity"===a,onOpenChange:()=>{m(null),q(),e()},children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-[480px] rounded-[20px] p-8",children:[(0,b.jsx)(bC.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-status-success-light",children:(0,b.jsx)(eJ.Trophy,{className:"h-5 w-5 text-status-success"})}),(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Marcar como Ganho"})]})}),(0,b.jsxs)("form",{onSubmit:p(t),className:"mt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor do Contrato (R$)"}),(0,b.jsx)(a2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:a=>r("contractValue",a)}),s.contractValue&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:s.contractValue.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Valor Mensal (R$)"}),(0,b.jsx)(a2.CurrencyInput,{className:"h-10 rounded-[15px] font-body text-sm",onValueChange:a=>r("monthlyValue",a)}),s.monthlyValue&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:s.monthlyValue.message})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Início do Contrato"}),(0,b.jsx)(a_.Input,{type:"date",className:"h-10 rounded-[15px] font-body text-sm",...o("contractStart")}),s.contractStart&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:s.contractStart.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Prazo (meses)"}),(0,b.jsx)(a2.IntegerInput,{className:"h-10 rounded-[15px] font-body text-sm",placeholder:"12",onValueChange:a=>r("contractMonths",a)}),s.contractMonths&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:s.contractMonths.message})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(a0.Label,{className:"font-body text-sm text-zinc-600",children:["Observações ",(0,b.jsx)("span",{className:"text-zinc-400",children:"(opcional)"})]}),(0,b.jsx)(bA.Textarea,{placeholder:"Detalhes do fechamento...",className:"rounded-[15px] font-body text-sm",rows:3,...o("notes")})]}),l&&(0,b.jsx)(dV.InlineFeedback,{type:l.type,message:l.message,onClose:()=>m(null)}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,b.jsx)(ad.Button,{type:"button",variant:"secondary",onClick:()=>{q(),e()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,b.jsxs)(ad.Button,{type:"submit",disabled:j,className:"rounded-full bg-status-success font-heading text-sm text-white hover:bg-status-success/90",children:[j?(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirmar Ganho"]})]})]})]})})}let eL={preco:"Preço",concorrente:"Concorrente",timing:"Timing","sem-budget":"Sem budget","sem-necessidade":"Sem necessidade","sem-resposta":"Sem resposta",outro:"Outro"};function eM(){let{modalType:a,modalData:d,closeModal:e}=(0,bE.useUIStore)(),{loseOpportunity:f,getById:g}=(0,cK.useOpportunityStore)(),{addNotification:h}=eF(),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),m=d?.opportunityId,{register:n,handleSubmit:o,setValue:p,reset:q,formState:{errors:r}}=(0,cL.useForm)({resolver:(0,cM.zodResolver)(eG.loseOpportunitySchema)});async function s(a){j(!0);try{if(m){let b=g(m);f(m,a.reason,a.competitor,a.notes),h({type:"opportunity-lost",title:"Oportunidade perdida",message:`A oportunidade "${b?.title||"Sem título"}" foi marcada como perdida. Motivo: ${eL[a.reason]||a.reason}.`,link:"/pipes"})}l({type:"success",message:"Oportunidade marcada como Perdida."}),setTimeout(()=>{l(null),q(),e()},1500)}catch{l({type:"error",message:"Erro ao registrar perda. Tente novamente."})}finally{j(!1)}}return(0,b.jsx)(bC.Dialog,{open:"lose-opportunity"===a,onOpenChange:()=>{l(null),q(),e()},children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-[440px] rounded-[20px] p-8",children:[(0,b.jsx)(bC.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-status-danger-light",children:(0,b.jsx)(ce.XCircle,{className:"h-5 w-5 text-status-danger"})}),(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Marcar como Perdido"})]})}),(0,b.jsxs)("form",{onSubmit:o(s),className:"mt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Motivo da perda"}),(0,b.jsxs)(bz.Select,{onValueChange:a=>p("reason",a),children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione o motivo"})}),(0,b.jsxs)(bz.SelectContent,{className:"rounded-[15px]",children:[(0,b.jsx)(bz.SelectItem,{value:"preco",children:"Preço"}),(0,b.jsx)(bz.SelectItem,{value:"concorrente",children:"Concorrente"}),(0,b.jsx)(bz.SelectItem,{value:"timing",children:"Timing"}),(0,b.jsx)(bz.SelectItem,{value:"sem-budget",children:"Sem budget"}),(0,b.jsx)(bz.SelectItem,{value:"sem-necessidade",children:"Sem necessidade"}),(0,b.jsx)(bz.SelectItem,{value:"sem-resposta",children:"Sem resposta"}),(0,b.jsx)(bz.SelectItem,{value:"outro",children:"Outro"})]})]}),r.reason&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:r.reason.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(a0.Label,{className:"font-body text-sm text-zinc-600",children:["Concorrente ",(0,b.jsx)("span",{className:"text-zinc-400",children:"(opcional)"})]}),(0,b.jsx)(a_.Input,{placeholder:"Nome do concorrente",className:"h-10 rounded-[15px] font-body text-sm",...n("competitor")})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(a0.Label,{className:"font-body text-sm text-zinc-600",children:["Observações ",(0,b.jsx)("span",{className:"text-zinc-400",children:"(opcional)"})]}),(0,b.jsx)(bA.Textarea,{placeholder:"Detalhes sobre a perda...",className:"rounded-[15px] font-body text-sm",rows:3,...n("notes")})]}),k&&(0,b.jsx)(dV.InlineFeedback,{type:k.type,message:k.message,onClose:()=>l(null)}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,b.jsx)(ad.Button,{type:"button",variant:"secondary",onClick:()=>{q(),e()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,b.jsxs)(ad.Button,{type:"submit",disabled:i,variant:"destructive",className:"rounded-full font-heading text-sm",children:[i?(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirmar Perda"]})]})]})]})})}let eN=(0,j.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var eO=a.i(51204);let eP={1:"Matriz",2:"Filial SP"};function eQ(){let{modalType:a,closeModal:d}=(0,bE.useUIStore)(),{addUser:e}=(0,eO.useUserStore)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),{register:j,handleSubmit:k,setValue:l,reset:m,formState:{errors:n}}=(0,cL.useForm)({resolver:(0,cM.zodResolver)(eG.inviteUserSchema)});async function o(a){g(!0);try{e({name:a.email.split("@")[0],email:a.email,role:a.role,isActive:!0,unitId:`unit-${a.unitId}`,unitName:eP[a.unitId]||"Matriz"}),i({type:"success",message:"Convite enviado com sucesso!"}),setTimeout(()=>{i(null),m(),d()},1500)}catch{i({type:"error",message:"Erro ao enviar convite. Tente novamente."})}finally{g(!1)}}return(0,b.jsx)(bC.Dialog,{open:"invite-user"===a,onOpenChange:()=>{i(null),m(),d()},children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-[440px] rounded-[20px] p-8",children:[(0,b.jsx)(bC.DialogHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-brand-light",children:(0,b.jsx)(eN,{className:"h-5 w-5 text-brand"})}),(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Convidar Usuário"})]})}),(0,b.jsxs)("form",{onSubmit:k(o),className:"mt-4 space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"E-mail"}),(0,b.jsx)(a_.Input,{type:"email",placeholder:"email@empresa.com",className:"h-10 rounded-[15px] font-body text-sm",...j("email")}),n.email&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:n.email.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Papel"}),(0,b.jsxs)(bz.Select,{onValueChange:a=>l("role",a),children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione o papel"})}),(0,b.jsxs)(bz.SelectContent,{className:"rounded-[15px]",children:[(0,b.jsx)(bz.SelectItem,{value:"admin",children:"Admin"}),(0,b.jsx)(bz.SelectItem,{value:"comercial",children:"Comercial"}),(0,b.jsx)(bz.SelectItem,{value:"cs",children:"CS (Customer Success)"}),(0,b.jsx)(bz.SelectItem,{value:"leitura",children:"Somente Leitura"})]})]}),n.role&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:n.role.message})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(a0.Label,{className:"font-body text-sm text-zinc-600",children:"Unidade"}),(0,b.jsxs)(bz.Select,{onValueChange:a=>l("unitId",a),children:[(0,b.jsx)(bz.SelectTrigger,{className:"h-10 rounded-[15px] font-body text-sm",children:(0,b.jsx)(bz.SelectValue,{placeholder:"Selecione a unidade"})}),(0,b.jsxs)(bz.SelectContent,{className:"rounded-[15px]",children:[(0,b.jsx)(bz.SelectItem,{value:"1",children:"Matriz"}),(0,b.jsx)(bz.SelectItem,{value:"2",children:"Filial SP"})]})]}),n.unitId&&(0,b.jsx)("p",{className:"text-xs text-status-danger",children:n.unitId.message})]}),h&&(0,b.jsx)(dV.InlineFeedback,{type:h.type,message:h.message,onClose:()=>i(null)}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-2",children:[(0,b.jsx)(ad.Button,{type:"button",variant:"secondary",onClick:()=>{m(),d()},className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,b.jsxs)(ad.Button,{type:"submit",disabled:f,className:"rounded-full bg-black font-heading text-sm text-white hover:bg-zinc-800",children:[f?(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Enviar convite"]})]})]})]})})}function eR(){let{modalType:a,modalData:d,closeModal:e}=(0,bE.useUIStore)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),j=d?.description||"Esta ação não pode ser desfeita. O item será removido permanentemente.";return(0,b.jsx)(bC.Dialog,{open:"confirm-delete"===a,onOpenChange:()=>{i(null),e()},children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-[400px] rounded-[20px] p-8",children:[(0,b.jsxs)(bC.DialogHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-red-50",children:(0,b.jsx)(I.AlertTriangle,{className:"h-5 w-5 text-status-danger"})}),(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Tem certeza?"})]}),(0,b.jsx)(bC.DialogDescription,{className:"mt-3 font-body text-sm text-zinc-500",children:j})]}),h&&(0,b.jsx)(dV.InlineFeedback,{type:h.type,message:h.message,onClose:()=>i(null)}),(0,b.jsxs)(bC.DialogFooter,{className:"mt-4",children:[(0,b.jsx)(ad.Button,{type:"button",variant:"secondary",onClick:()=>e(),disabled:f,className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,b.jsxs)(ad.Button,{type:"button",onClick:async()=>{g(!0);try{d?.onConfirm&&"function"==typeof d.onConfirm&&await Promise.resolve(d.onConfirm()),e()}catch{i({type:"error",message:"Erro ao excluir. Tente novamente."})}finally{g(!1)}},disabled:f,className:"rounded-full bg-status-danger font-heading text-sm text-white hover:bg-red-700",children:[f&&(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),f?"Excluindo...":"Excluir"]})]})]})})}function eS(){let{modalType:a,modalData:d,closeModal:e}=(0,bE.useUIStore)(),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(null),j=d?.description||"O usuário perderá acesso ao sistema. Você poderá reativá-lo posteriormente.";return(0,b.jsx)(bC.Dialog,{open:"confirm-deactivate"===a,onOpenChange:()=>{i(null),e()},children:(0,b.jsxs)(bC.DialogContent,{className:"max-w-[400px] rounded-[20px] p-8",children:[(0,b.jsxs)(bC.DialogHeader,{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-amber-50",children:(0,b.jsx)(I.AlertTriangle,{className:"h-5 w-5 text-status-warning"})}),(0,b.jsx)(bC.DialogTitle,{className:"font-heading text-xl font-semibold text-black",children:"Desativar usuário?"})]}),(0,b.jsx)(bC.DialogDescription,{className:"mt-3 font-body text-sm text-zinc-500",children:j})]}),h&&(0,b.jsx)(dV.InlineFeedback,{type:h.type,message:h.message,onClose:()=>i(null)}),(0,b.jsxs)(bC.DialogFooter,{className:"mt-4",children:[(0,b.jsx)(ad.Button,{type:"button",variant:"secondary",onClick:()=>e(),disabled:f,className:"rounded-full font-heading text-sm",children:"Cancelar"}),(0,b.jsxs)(ad.Button,{type:"button",onClick:async()=>{g(!0);try{d?.onConfirm&&"function"==typeof d.onConfirm&&await Promise.resolve(d.onConfirm()),e()}catch{i({type:"error",message:"Erro ao desativar. Tente novamente."})}finally{g(!1)}},disabled:f,className:"rounded-full bg-status-warning font-heading text-sm text-white hover:bg-amber-600",children:[f&&(0,b.jsx)(K.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),f?"Desativando...":"Desativar"]})]})]})})}var eT=a.i(81584),eU=a.i(66206);function eV(){let{modalData:a,drawerData:c,drawerType:d,closeDrawer:e}=(0,bE.useUIStore)(),{addActivity:f}=(0,eT.useActivityStore)(),{user:g}=(0,eU.useAuthStore)(),h=`lead-${String(a?.id??"default")}`,i=`client-${String(c?.id??"default")}`;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(d9,{},i),(0,b.jsx)(eD,{context:"pipes"}),(0,b.jsx)(dR,{},h),(0,b.jsx)(eI,{}),(0,b.jsx)(dc,{isOpen:"new-activity"===d,onClose:e,onSave:a=>{if(!g?.id)throw Error("Usuário não autenticado para criar atividade.");f({title:a.title,type:a.type,status:"pending",description:a.description||"",dueDate:a.date,dueTime:a.time,responsibleId:g.id,responsibleName:g.name,opportunityId:a.opportunityId||void 0,opportunityTitle:a.opportunityTitle||void 0,clientId:a.clientId||void 0,clientName:a.clientName||void 0,contactIds:a.contactIds?.length?a.contactIds:void 0,contactNames:a.contactNames?.length?a.contactNames:void 0})},initialType:c?.type||void 0,initialClientId:"string"==typeof c?.clientId?c.clientId:void 0,initialClientName:"string"==typeof c?.clientName?c.clientName:void 0,initialContactIds:Array.isArray(c?.contactIds)?c.contactIds:void 0,initialContactNames:Array.isArray(c?.contactNames)?c.contactNames:void 0,initialOpportunityId:"string"==typeof c?.opportunityId?c.opportunityId:void 0,initialOpportunityTitle:"string"==typeof c?.opportunityTitle?c.opportunityTitle:void 0,lockClient:c?.lockClient===!0,requireClient:c?.requireClient===!0}),(0,b.jsx)(eK,{}),(0,b.jsx)(eM,{}),(0,b.jsx)(eQ,{}),(0,b.jsx)(eR,{}),(0,b.jsx)(eS,{})]})}a.s(["GlobalDrawers",()=>eV],78020)},76486,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(30617),f=a.i(27999),g=a.i(24679),h=a.i(60246),i=a.i(90166),j=a.i(21161),k=a.i(46842),l=a.i(50429),m=a.i(39761),n=a.i(4416),o=a.i(67900),p=a.i(15171),q=a.i(85930),r=a.i(86304),s=a.i(30455),t=a.i(66206),u=a.i(9392);let v=[{type:"opportunity",name:"Restaurante Bela Vista",razaoSocial:"Restaurante Bela Vista Ltda ME",cnpj:"12.345.678/0001-00",phone:"(11) 99999-1234",email:"contato@belavista.com",contact:"João Silva",city:"São Paulo",stage:"Contato Feito",responsible:"Maria Silva"},{type:"opportunity",name:"Pizzaria Don Corleone",razaoSocial:"Don Corleone Alimentos Ltda",cnpj:"23.456.789/0001-11",phone:"(11) 98765-4321",email:"contato@doncorleone.com",contact:"Pedro Oliveira",city:"São Paulo",stage:"Proposta Enviada",responsible:"Pedro Santos"},{type:"opportunity",name:"Bistrô La Maison",razaoSocial:"La Maison Gastronomia Ltda",cnpj:"34.567.890/0001-22",phone:"(21) 97654-3210",email:"contato@lamaison.com",contact:"Ana Costa",city:"Rio de Janeiro",stage:"Negociação",responsible:"Maria Silva"},{type:"opportunity",name:"Churrascaria Fogo de Chão",razaoSocial:"Fogo de Chão Restaurantes SA",cnpj:"45.678.901/0001-33",phone:"(11) 96543-2109",email:"contato@fogodechao.com",contact:"Carlos Santos",city:"São Paulo",stage:"Lead-In",responsible:"Julia Fernandes"},{type:"opportunity",name:"Sushi Yamamoto",razaoSocial:"Yamamoto Culinária Japonesa Ltda",cnpj:"56.789.012/0001-44",phone:"(11) 95432-1098",email:"contato@sushiyamamoto.com",contact:"Yuki Yamamoto",city:"São Paulo",stage:"Reunião Agendada",responsible:"Rafael Costa"},{type:"opportunity",name:"Café Colonial Oma",razaoSocial:"Oma Café Colonial Eireli",cnpj:"67.890.123/0001-55",phone:"(41) 94321-0987",email:"contato@cafeoma.com",contact:"Klaus Schmidt",city:"Curitiba",stage:"Qualificação",responsible:"Maria Silva"},{type:"opportunity",name:"Cantina Famiglia Mancini",razaoSocial:"Famiglia Mancini Restaurante Ltda",cnpj:"11.222.333/0001-66",phone:"(11) 93210-9876",email:"contato@famigliamancini.com",contact:"Marco Mancini",city:"São Paulo",stage:"Contato Feito",responsible:"Pedro Santos"},{type:"opportunity",name:"Doceria Amor aos Pedaços",razaoSocial:"Amor aos Pedaços Doces Ltda",cnpj:"22.333.444/0001-77",phone:"(11) 92109-8765",email:"contato@amorpedacos.com",contact:"Lucia Ferreira",city:"São Paulo",stage:"Proposta Enviada",responsible:"Julia Fernandes"},{type:"client",name:"Restaurante Panorâmico",razaoSocial:"Restaurante Panorâmico Ltda ME",cnpj:"78.901.234/0001-66",phone:"(11) 3456-7890",email:"contato@panoramico.com",contact:"Ana Costa",city:"São Paulo",healthScore:"Saudável",responsible:"Maria Silva"},{type:"client",name:"Hotel Fazenda Serra Azul",razaoSocial:"Serra Azul Hotelaria Ltda",cnpj:"89.012.345/0001-77",phone:"(35) 3456-7891",email:"contato@serraazul.com",contact:"Fernando Lima",city:"Monte Verde",healthScore:"Atenção",responsible:"Pedro Santos"},{type:"client",name:"Padaria Pão de Ouro",razaoSocial:"Pão de Ouro Panificação Ltda",cnpj:"90.123.456/0001-88",phone:"(11) 2345-6789",email:"contato@paodeouro.com",contact:"Rosa Mendes",city:"São Paulo",healthScore:"Saudável",responsible:"Julia Fernandes"},{type:"client",name:"Bar do Zé",razaoSocial:"José da Silva Bebidas ME",cnpj:"01.234.567/0001-99",phone:"(21) 1234-5678",email:"contato@bardoze.com",contact:"José da Silva",city:"Rio de Janeiro",healthScore:"Crítico",responsible:"Rafael Costa"},{type:"client",name:"Confeitaria Colombo",razaoSocial:"Confeitaria Colombo SA",cnpj:"33.444.555/0001-00",phone:"(21) 2345-9876",email:"contato@colombo.com",contact:"Helena Oliveira",city:"Rio de Janeiro",healthScore:"Saudável",responsible:"Maria Silva"},{type:"client",name:"Empório Santa Maria",razaoSocial:"Empório Santa Maria Alimentos Ltda",cnpj:"44.555.666/0001-11",phone:"(11) 3456-1234",email:"contato@emporiosantamaria.com",contact:"Roberto Almeida",city:"São Paulo",healthScore:"Atenção",responsible:"Rafael Costa"}],w=[{path:"/dashboard",label:"Dashboard",icon:e.LayoutDashboard},{path:"/activities",label:"Atividades",icon:f.CalendarCheck},{path:"/pipes",label:"Pipeline de Vendas",icon:g.Kanban},{path:"/clients",label:"Clientes",icon:h.Users}],x=[{path:"/reports",label:"Relatórios",icon:m.BarChart3},{path:"/audit",label:"Auditoria",icon:n.ShieldCheck},{path:"/settings/general",label:"Configurações",icon:j.Settings},{path:"/settings/users",label:"Gestão de Usuários",icon:k.User},{path:"/settings/profile",label:"Meu Perfil",icon:k.User}];function y(a){return a.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function z(a,b){let c=y(b);return y(a.name).includes(c)||y(a.razaoSocial).includes(c)||y(a.cnpj).includes(c)||y(a.phone).includes(c)||y(a.email).includes(c)||y(a.contact).includes(c)||y(a.city).includes(c)}function A(){let{isSearchOpen:a,setSearchOpen:e,openDrawer:f,openModal:g}=(0,s.useUIStore)(),{user:h,permissions:j}=(0,t.useAuthStore)(),k=(0,d.useRouter)(),[m,n]=(0,c.useState)(""),y=function(a,b){let[d,e]=(0,c.useState)(a);return(0,c.useEffect)(()=>{let b=setTimeout(()=>e(a),300);return()=>clearTimeout(b)},[a,300]),d}(m,0),A=(0,c.useRef)(null);(0,c.useEffect)(()=>{a||(0,c.startTransition)(()=>{n("")})},[a]),(0,c.useEffect)(()=>{function a(a){(a.metaKey||a.ctrlKey)&&"k"===a.key&&(a.preventDefault(),e(!s.useUIStore.getState().isSearchOpen))}return document.addEventListener("keydown",a),()=>document.removeEventListener("keydown",a)},[e]);let B=y.trim().length>=2,C=(0,c.useMemo)(()=>{let a=h?.name?.trim();return a&&v.some(b=>b.responsible===a)?a:"Maria Silva"},[h?.name]),D=!j?.canViewAllUnits,E=(0,c.useMemo)(()=>D?v.filter(a=>a.responsible===C):v,[C,D]),F=!!h?.role&&(0,u.canAccessIntelligence)(h.role),G=(0,c.useMemo)(()=>{let a=[...w];return j?.canViewFinance&&a.push({path:"/finance",label:"Financeiro",icon:i.DollarSign}),j?.canManageGoals&&a.push({path:"/goals",label:"Metas",icon:l.Target}),F&&a.push({path:"/intelligence",label:"Menux Intelligence",icon:p.Handshake}),j?.canViewReports&&a.push(...x.filter(a=>a.path.startsWith("/reports"))),j?.canManageSettings&&a.push(...x.filter(a=>a.path.startsWith("/settings"))),j?.canViewAllUnits&&a.push(...x.filter(a=>a.path.startsWith("/audit"))),a},[F,j?.canManageSettings,j?.canManageGoals,j?.canViewFinance,j?.canViewAllUnits,j?.canViewReports]),H=(0,c.useMemo)(()=>B?E.filter(a=>"opportunity"===a.type&&z(a,y)).slice(0,5):[],[y,B,E]),I=(0,c.useMemo)(()=>B?E.filter(a=>"client"===a.type&&z(a,y)).slice(0,5):[],[y,B,E]),J=H.length>0||I.length>0,K=B&&!J,L=(0,c.useCallback)(a=>{k.push(a),e(!1)},[k,e]),M=(0,c.useCallback)(a=>{g("lead-card",{name:a.name,razaoSocial:a.razaoSocial,cnpj:a.cnpj,phone:a.phone,email:a.email,contact:a.contact,city:a.city,stage:a.stage,responsible:a.responsible}),e(!1)},[g,e]),N=(0,c.useCallback)(a=>{f("client-card",{name:a.name,razaoSocial:a.razaoSocial,cnpj:a.cnpj,phone:a.phone,email:a.email,contact:a.contact,city:a.city,healthScore:a.healthScore,responsible:a.responsible}),e(!1)},[f,e]),O=a=>`${a.type}-${a.cnpj}-${a.name}`;return(0,b.jsxs)(q.CommandDialog,{open:a,onOpenChange:a=>{e(a),a||n("")},title:"Busca Global",description:"Busque por páginas, oportunidades e clientes",showCloseButton:!1,children:[(0,b.jsx)(q.CommandInput,{ref:A,placeholder:"Buscar páginas, oportunidades, clientes...",className:"font-body",value:m,onValueChange:n}),(0,b.jsxs)(q.CommandList,{className:"max-h-[420px]",children:[K&&(0,b.jsx)("div",{className:"py-8 text-center",children:(0,b.jsxs)("p",{className:"font-body text-sm text-zinc-500",children:["Nenhum resultado para"," ",(0,b.jsxs)("span",{className:"font-medium text-zinc-700 dark:text-zinc-300",children:["“",y,"”"]})]})}),H.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.CommandGroup,{heading:(0,b.jsx)("span",{className:"font-heading text-xs font-semibold uppercase tracking-wider text-brand",children:"Oportunidades"}),children:H.map(a=>(0,b.jsxs)(q.CommandItem,{value:O(a),onSelect:()=>M(a),className:"flex items-center gap-3 rounded-[10px] px-3 py-2.5",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-[10px] bg-amber-100 dark:bg-amber-900/40",children:(0,b.jsx)(p.Handshake,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"})}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-0.5",children:[(0,b.jsx)("span",{className:"font-body text-sm font-medium truncate",children:a.name}),(0,b.jsxs)("span",{className:"font-body text-xs text-muted-foreground truncate",children:[a.contact," · ",a.city]})]}),(0,b.jsx)(r.Badge,{variant:"secondary",className:"rounded-[10px] text-[10px] font-body shrink-0",children:a.stage})]},O(a)))}),(0,b.jsx)(q.CommandSeparator,{})]}),I.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.CommandGroup,{heading:(0,b.jsx)("span",{className:"font-heading text-xs font-semibold uppercase tracking-wider text-brand",children:"Clientes"}),children:I.map(a=>(0,b.jsxs)(q.CommandItem,{value:O(a),onSelect:()=>N(a),className:"flex items-center gap-3 rounded-[10px] px-3 py-2.5",children:[(0,b.jsx)("div",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-[10px] bg-blue-100 dark:bg-blue-900/40",children:(0,b.jsx)(o.Building2,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"})}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-0.5",children:[(0,b.jsx)("span",{className:"font-body text-sm font-medium truncate",children:a.name}),(0,b.jsxs)("span",{className:"font-body text-xs text-muted-foreground truncate",children:[a.contact," · ",a.city]})]}),(0,b.jsx)(r.Badge,{variant:"secondary",className:`rounded-[10px] text-[10px] font-body shrink-0 border-0 ${function(a){switch(a){case"Saudável":return"bg-emerald-100 text-emerald-700 dark:bg-emerald-900/40 dark:text-emerald-400";case"Atenção":return"bg-amber-100 text-amber-700 dark:bg-amber-900/40 dark:text-amber-400";case"Crítico":return"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-400";default:return""}}(a.healthScore)}`,children:a.healthScore})]},O(a)))}),(0,b.jsx)(q.CommandSeparator,{})]}),(0,b.jsx)(q.CommandGroup,{heading:(0,b.jsx)("span",{className:"font-heading text-xs font-semibold uppercase tracking-wider text-muted-foreground",children:"Páginas"}),children:G.map(a=>{let c=a.icon;return(0,b.jsxs)(q.CommandItem,{value:`page-${a.label}`,onSelect:()=>L(a.path),className:"rounded-[10px] px-3 py-2",children:[(0,b.jsx)(c,{className:"mr-2 h-4 w-4"}),(0,b.jsx)("span",{className:"font-body",children:a.label})]},a.path)})})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between border-t px-3 py-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 font-body text-[11px] text-muted-foreground",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"↑↓"}),"navegar"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"↵"}),"selecionar"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"esc"}),"fechar"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 font-body text-[11px] text-muted-foreground",children:[(0,b.jsx)("kbd",{className:"rounded-[5px] border bg-muted px-1.5 py-0.5 text-[10px] font-medium",children:"⌘K"}),"busca rápida"]})]})]})}a.s(["GlobalSearch",()=>A])},5494,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(38246),f=a.i(30617),g=a.i(27999),h=a.i(24679),i=a.i(60246),j=a.i(17755),k=a.i(90166),l=a.i(21161),m=a.i(8406),n=a.i(20005),o=a.i(57061),p=a.i(68114),q=a.i(66206),r=a.i(9392);let s=[{label:"Dashboard",href:"/dashboard",icon:f.LayoutDashboard},{label:"Atividades",href:"/activities",icon:g.CalendarCheck},{label:"Pipeline",href:"/pipes",icon:h.Kanban},{label:"Clientes",href:"/clients",icon:i.Users}],t=[{label:"Financeiro",href:"/finance",icon:k.DollarSign}];function u(){let a=(0,d.usePathname)(),f=(0,d.useRouter)(),g=(0,q.useAuthStore)(a=>a.permissions),h=(0,q.useAuthStore)(a=>a.user),i=(0,q.useAuthStore)(a=>a.logout),[k,u]=(0,c.useState)(!1),v=a.startsWith("/intelligence"),w=!!h?.role&&(0,r.canAccessIntelligence)(h.role),x=(0,c.useMemo)(()=>{let a=g?.canViewFinance?[...t]:t.filter(a=>"/finance"!==a.href);return g?.canManageSettings&&a.splice(1,0,{label:"Configurações",href:"/settings/general",matchPrefix:"/settings",icon:l.Settings}),w&&a.push({label:"Menux Intelligence",href:"/intelligence",icon:m.Sparkles}),a},[w,g?.canManageSettings,g?.canViewFinance]),y=b=>{let c=b.matchPrefix??b.href;return a.startsWith(c)},z=x.some(a=>y(a));return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("nav",{className:"premium-grain fixed bottom-0 left-0 right-0 z-50 h-16 border-t border-zinc-200/75 bg-white/90 backdrop-blur-xl md:hidden",children:[(0,b.jsx)("div",{className:"pointer-events-none absolute inset-x-0 top-0 h-px bg-linear-to-r from-transparent via-brand/35 to-transparent"}),(0,b.jsxs)("div",{className:"flex items-center justify-around h-full px-2",children:[s.map(a=>{let c=a.icon,d=y(a);return(0,b.jsxs)(e.default,{href:a.href,className:(0,p.cn)("premium-shine flex h-full flex-1 flex-col items-center justify-center gap-1 rounded-xl transition-colors",d?"bg-brand/10 text-brand-strong":"text-zinc-400 hover:text-zinc-600"),children:[(0,b.jsx)(c,{className:"size-5"}),(0,b.jsx)("span",{className:"text-[10px] font-heading font-medium",children:a.label})]},a.href)}),(0,b.jsxs)("button",{type:"button",onClick:()=>u(!0),className:(0,p.cn)("premium-shine flex h-full flex-1 flex-col items-center justify-center gap-1 rounded-xl transition-colors",v?"menux-intelligence-btn-soft text-slate-100":z?"bg-brand/10 text-brand-strong":"text-zinc-400 hover:text-zinc-600"),children:[(0,b.jsx)(j.MoreHorizontal,{className:"size-5"}),(0,b.jsx)("span",{className:"text-[10px] font-heading font-medium",children:"Mais"})]})]})]}),(0,b.jsx)(o.Sheet,{open:k,onOpenChange:u,children:(0,b.jsxs)(o.SheetContent,{side:"bottom",className:"rounded-t-[15px] premium-panel",children:[(0,b.jsx)(o.SheetHeader,{children:(0,b.jsx)(o.SheetTitle,{className:"font-heading",children:"Mais opções"})}),(0,b.jsxs)("div",{className:"flex flex-col gap-1 py-2",children:[x.map(a=>{let c=a.icon,d=y(a),f="/intelligence"===a.href;return(0,b.jsxs)(e.default,{href:a.href,onClick:()=>u(!1),className:(0,p.cn)("flex items-center gap-3 px-4 py-3 rounded-[10px] transition-colors",f&&(d?"menux-intelligence-btn":"menux-intelligence-btn-soft"),!f&&(d?"bg-brand/10 text-brand":"text-zinc-700 hover:bg-zinc-100")),children:[(0,b.jsx)(c,{className:(0,p.cn)("size-5",f&&"text-cyan-100")}),(0,b.jsx)("span",{className:"font-body text-sm font-medium",children:a.label})]},a.href)}),(0,b.jsx)("div",{className:"h-px bg-zinc-200 my-2"}),(0,b.jsxs)("button",{type:"button",className:"flex items-center gap-3 px-4 py-3 rounded-[10px] text-status-danger hover:bg-status-danger-light transition-colors",onClick:()=>{i(),u(!1),f.replace("/login")},children:[(0,b.jsx)(n.LogOut,{className:"size-5"}),(0,b.jsx)("span",{className:"font-body text-sm font-medium",children:"Sair"})]})]})]})})]})}a.s(["MobileBottomNav",()=>u])},23711,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(93817),e=a.i(66206),f=a.i(9392),g=a.i(55007),h=a.i(50944),i=a.i(46271),j=a.i(62036),k=a.i(8406),l=a.i(45113);function m(){let a=(0,h.useRouter)(),g=(0,h.usePathname)(),{proactiveSuggestions:m}=(0,d.useIntelligenceStore)(),n=(0,e.useAuthStore)(a=>a.user),o=!!n?.role&&(0,f.canAccessIntelligence)(n.role),p=(0,c.useCallback)(b=>{o&&(b.ctrlKey||b.metaKey)&&"i"===b.key&&(b.preventDefault(),a.push("/intelligence"))},[o,a]);if((0,c.useEffect)(()=>(window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)),[p]),!o)return null;let q=m.filter(a=>!a.dismissed),r=q.length>0,s=q.some(a=>"high"===a.priority);return"/intelligence"===g?null:(0,b.jsx)(j.AnimatePresence,{children:(0,b.jsxs)(i.motion.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{type:"spring",stiffness:300,damping:25},className:"fixed bottom-6 right-6 z-50 md:block",children:[(0,b.jsxs)("button",{onClick:()=>a.push("/intelligence"),className:(0,l.cn)("group relative flex h-14 w-14 items-center justify-center rounded-full border border-white/18 bg-slate-950/94 text-cyan-100 shadow-[0_18px_34px_-18px_rgba(2,6,23,0.9)] transition-all hover:scale-105 hover:border-cyan-300/40 hover:shadow-[0_22px_36px_-16px_rgba(34,211,238,0.34)] active:scale-95","focus:outline-none focus:ring-2 focus:ring-cyan-300/40 focus:ring-offset-2"),"aria-label":"Abrir Menux Intelligence",title:"Menux Intelligence",children:[(0,b.jsx)("span",{className:"absolute inset-0 animate-ping rounded-full bg-cyan-400 opacity-15"}),(0,b.jsx)(k.Sparkles,{className:"relative z-10 h-5 w-5 transition-transform group-hover:rotate-12"}),r&&(0,b.jsxs)(i.motion.span,{initial:{scale:0},animate:{scale:1},className:(0,l.cn)("absolute -right-1 -top-1 z-20 flex items-center justify-center rounded-full text-[10px] font-bold text-white","ring-2 ring-white",q.length>9?"h-5 w-5":"h-4.5 w-4.5 min-w-[18px]",s?"bg-red-500":"bg-blue-500"),children:[s&&(0,b.jsx)("span",{className:"absolute inset-0 rounded-full bg-red-500 animate-ping opacity-75"}),q.length>99?"99+":q.length]})]}),(0,b.jsx)("div",{className:"pointer-events-none absolute -left-[140px] top-1/2 -translate-y-1/2 opacity-0 transition-opacity group-hover:opacity-100",children:(0,b.jsx)("div",{className:"rounded-lg bg-slate-900 px-3 py-1.5 text-xs font-medium text-white shadow-lg whitespace-nowrap",children:"Menux Intelligence"})})]})})}function n(){let a=(0,e.useAuthStore)(a=>a.user),h=!!a?.role&&(0,f.canAccessIntelligence)(a.role);return((0,g.useProactiveEngine)(),(0,c.useEffect)(()=>{let a=setInterval(()=>{let{rateLimitResetAt:a,resetRateLimit:b}=d.useIntelligenceStore.getState();a&&new Date(a)<=new Date&&b()},6e4);return()=>clearInterval(a)},[]),h)?(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(m,{})}):null}a.s(["IntelligenceProvider",()=>n],23711)},90706,a=>{"use strict";var b=a.i(87924),c=a.i(62036),d=a.i(46271),e=a.i(50944),f=a.i(48282);function g({children:a}){let g=(0,e.usePathname)();return(0,b.jsx)(c.AnimatePresence,{mode:"wait",initial:!1,children:(0,b.jsx)(d.motion.div,{variants:f.pageSlideFade,initial:"hidden",animate:"show",exit:"exit",className:"h-full",children:a},g)})}a.s(["RouteTransition",()=>g])},53668,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(73570),e=a.i(87654),f=a.i(99570);function g({error:a,onRetry:c}){return(0,b.jsxs)("div",{className:"flex min-h-[200px] flex-col items-center justify-center gap-4 rounded-xl border border-zinc-200 bg-white p-6 text-center",children:[(0,b.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-red-50",children:(0,b.jsx)(d.AlertTriangle,{className:"h-6 w-6 text-red-500"})}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h3",{className:"font-heading text-sm font-semibold text-zinc-900",children:"Algo deu errado"}),(0,b.jsx)("p",{className:"max-w-sm font-body text-xs text-zinc-500",children:a?.message||"Ocorreu um erro inesperado. Tente novamente."})]}),c&&(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:c,className:"gap-1.5",children:[(0,b.jsx)(e.RotateCcw,{className:"h-3.5 w-3.5"}),"Tentar novamente"]})]})}class h extends c.default.Component{constructor(a){super(a),this.state={hasError:!1,error:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a}}componentDidCatch(a,b){console.error(`[ErrorBoundary${this.props.name?`: ${this.props.name}`:""}]`,a,b),this.props.onError?.(a,b)}handleReset=()=>{this.setState({hasError:!1,error:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,b.jsx)(g,{error:this.state.error,onRetry:this.handleReset}):this.props.children}}a.s(["ErrorBoundary",()=>h],53668)}];

//# sourceMappingURL=_c117af21._.js.map