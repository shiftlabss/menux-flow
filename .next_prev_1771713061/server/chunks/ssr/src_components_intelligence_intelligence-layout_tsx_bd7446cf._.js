module.exports=[37165,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(62036),e=a.i(46271),f=a.i(70106);let g=(0,f.default)("message-square-text",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7 11h10",key:"1twpyw"}],["path",{d:"M7 15h6",key:"d9of3u"}],["path",{d:"M7 7h8",key:"af5zfr"}]]);var h=a.i(8406),i=a.i(60246),j=a.i(33508),k=a.i(45113),l=a.i(91965),m=a.i(15618);let n=(0,f.default)("command",[["path",{d:"M15 6v12a3 3 0 1 0 3-3H6a3 3 0 1 0 3 3V6a3 3 0 1 0-3 3h12a3 3 0 1 0-3-3",key:"11bfej"}]]);var o=a.i(21161),p=a.i(50429),q=a.i(87532),r=a.i(63588),s=a.i(1027),t=a.i(210),u=a.i(99570),v=a.i(50944),w=a.i(93817),x=a.i(85259),y=a.i(48282);let z=[{id:"focus",label:"Foco Cliente",icon:(0,b.jsx)(p.Target,{className:"h-4 w-4"})},{id:"audit",label:"Auditoria",icon:(0,b.jsx)(q.Search,{className:"h-4 w-4"})},{id:"reply",label:"Responder",icon:(0,b.jsx)(r.MessageSquare,{className:"h-4 w-4"})},{id:"proposal",label:"Proposta",icon:(0,b.jsx)(h.Sparkles,{className:"h-4 w-4"})}];function A(){let a=(0,v.useRouter)(),{menuxIntelligenceMode:c,setMenuxIntelligenceMode:d,toggleHistory:f,startNewConversation:g,remainingQueries:h}=(0,w.useIntelligenceStore)();return(0,b.jsxs)(e.motion.header,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},transition:y.transition.panel,className:"sticky top-0 z-[100] flex flex-col border-b border-white/12 bg-slate-950/35 px-6 py-3 backdrop-blur-xl",children:[(0,b.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(u.Button,{variant:"ghost",size:"icon",className:"h-8 w-8 text-slate-400 hover:bg-white/8 hover:text-slate-200 md:hidden",onClick:()=>a.back(),children:(0,b.jsx)(t.ArrowLeft,{className:"h-4 w-4"})}),(0,b.jsx)("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-gradient-to-br from-cyan-500/80 to-blue-500/85 text-white shadow-sm ring-1 ring-white/20",children:(0,b.jsx)(s.Zap,{className:"premium-float h-5 w-5 fill-white text-white"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"font-heading text-lg font-bold text-slate-100 leading-tight",children:"Menux Intelligence"}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsxs)("span",{className:"relative flex h-2 w-2",children:[(0,b.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-emerald-400 opacity-75"}),(0,b.jsx)("span",{className:"premium-glow-dot relative inline-flex h-2 w-2 rounded-full bg-emerald-500"})]}),(0,b.jsxs)("span",{className:"font-body text-xs font-medium text-emerald-300",children:["Online Â· ",h," consultas"]})]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)(x.TooltipProvider,{children:[(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(u.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:f,children:(0,b.jsx)(l.History,{className:"h-4 w-4"})})}),(0,b.jsx)(x.TooltipContent,{children:"Historico"})]}),(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(u.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:g,children:(0,b.jsx)(m.Plus,{className:"h-4 w-4"})})}),(0,b.jsx)(x.TooltipContent,{children:"Nova Conversa"})]}),(0,b.jsx)("div",{className:"ml-2 h-4 w-px bg-white/15"}),(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(u.Button,{variant:"ghost",size:"icon",className:"ml-2 h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:()=>{w.useIntelligenceStore.getState().executeSlashCommand("/ajuda")},children:(0,b.jsx)(n,{className:"h-4 w-4"})})}),(0,b.jsx)(x.TooltipContent,{children:"Ver Comandos"})]}),(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(u.Button,{variant:"ghost",size:"icon",className:"h-9 w-9 text-slate-400 hover:bg-white/8 hover:text-slate-100",onClick:()=>{w.useIntelligenceStore.getState().openSettings()},children:(0,b.jsx)(o.Settings,{className:"h-4 w-4"})})}),(0,b.jsx)(x.TooltipContent,{children:"ConfiguraÃ§Ãµes"})]})]})})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:z.map(a=>(0,b.jsx)(B,{active:c===a.id,onClick:()=>d(a.id),label:a.label,icon:a.icon},a.id))})]})}function B({active:a,onClick:c,label:d,icon:f}){return(0,b.jsxs)("button",{onClick:c,className:(0,k.cn)("group relative flex items-center gap-2 rounded-full border px-4 py-1.5 text-sm font-medium transition-all duration-200 ease-out",a?"border-cyan-300/30 bg-white/10 text-slate-50 shadow-sm":"border-transparent text-slate-300 hover:bg-white/7 hover:text-slate-100"),children:[a&&(0,b.jsx)(e.motion.span,{layoutId:"menux-intelligence-mode-pill",className:"absolute inset-0 rounded-full bg-cyan-400/16",transition:y.transition.quick}),(0,b.jsx)("span",{className:(0,k.cn)("relative z-10 transition-colors",a?"text-cyan-200":"text-slate-400 group-hover:text-slate-200"),children:f}),(0,b.jsx)("span",{className:"relative z-10",children:d})]})}var C=a.i(41710),D=a.i(66718),E=a.i(86304),F=a.i(2789),G=a.i(66206);let H={"lead-in":"Lead In","contato-feito":"Contato Feito","reuniao-agendada":"Reuniao Agendada","proposta-enviada":"Proposta Enviada",negociacao:"Negociacao",fechamento:"Fechamento"};function I(){let[a,d]=(0,c.useState)(""),[f,g]=(0,c.useState)(!1),{contextCard:h,selectClient:l,setContextCard:m,openClientPicker:n}=(0,w.useIntelligenceStore)(),{opportunities:o}=(0,F.useOpportunityStore)(),p=(0,G.useAuthStore)(a=>a.user),r=(0,c.useMemo)(()=>o.filter(a=>p?.role!=="comercial"&&p?.role!=="cs"||a.responsibleId===p.id).map(a=>({id:a.id,entityId:a.id,entityType:"opportunity",companyName:a.clientName??a.title,segment:a.tags?.[0],stage:a.stage,stageLabel:H[a.stage]??a.stage,temperature:a.temperature,lastContact:a.updatedAt,value:a.monthlyValue,tags:a.tags})),[o,p]),s=(0,c.useMemo)(()=>r.filter(a=>"hot"===a.temperature).slice(0,5),[r]),t=(0,c.useMemo)(()=>[...r].sort((a,b)=>{let c=a.lastContact?new Date(a.lastContact).getTime():0;return(b.lastContact?new Date(b.lastContact).getTime():0)-c}).slice(0,8),[r]),v=(0,c.useMemo)(()=>{if(!a.trim())return null;let b=a.toLowerCase();return r.filter(a=>a.companyName.toLowerCase().includes(b)||a.segment?.toLowerCase().includes(b)||a.tags?.some(a=>a.toLowerCase().includes(b)))},[r,a]),x=a=>{l(a)},y=a=>{let b=a.split(" ");return b.length>1?`${b[0][0]}${b[1][0]}`.toUpperCase():a.slice(0,2).toUpperCase()},z=a=>{let b=["bg-blue-400/18 text-blue-100","bg-emerald-400/18 text-emerald-100","bg-amber-400/18 text-amber-100","bg-indigo-400/18 text-indigo-100","bg-rose-400/18 text-rose-100","bg-cyan-400/18 text-cyan-100"];return b[a%b.length]};return(0,b.jsxs)("div",{className:"flex h-full flex-col bg-transparent text-slate-200",children:[(0,b.jsx)("div",{className:(0,k.cn)("sticky top-0 z-10 shrink-0 border-b border-white/10 bg-slate-950/36 p-4 backdrop-blur-sm transition-shadow duration-120 ease-out",f&&"shadow-[0_14px_22px_-18px_rgba(2,6,23,0.9)]"),children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,b.jsx)(D.Input,{placeholder:"Buscar cliente, deal ou tag...",value:a,onChange:a=>d(a.target.value),className:"h-10 rounded-xl border-white/16 bg-slate-900/55 pl-9 font-body text-sm text-slate-100 placeholder:text-slate-400 transition-all focus:bg-slate-900/70"}),a&&(0,b.jsx)("button",{onClick:()=>d(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-100",children:(0,b.jsx)(j.X,{className:"h-3.5 w-3.5"})})]})}),(0,b.jsx)("div",{className:"min-h-0 flex-1 overflow-y-auto",onScroll:a=>{g(a.currentTarget.scrollTop>6)},children:(0,b.jsxs)("div",{className:"flex flex-col p-2 gap-6 pb-20",children:[h&&(0,b.jsxs)(e.motion.div,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},className:"mx-2 mt-2 rounded-xl border border-cyan-300/22 bg-cyan-400/12 p-4 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-cyan-500/70 text-sm font-bold text-white",children:y(h.cardName)}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-heading font-semibold text-slate-100 leading-tight",children:h.cardName}),(0,b.jsxs)("p",{className:"flex items-center gap-1 text-xs text-slate-300",children:[K(h.temperature),h.stageLabel,h.leadScore?` \xb7 ${h.leadScore} pts`:""]})]})]}),(0,b.jsx)(u.Button,{variant:"ghost",size:"icon",className:"h-6 w-6 -mr-2 text-slate-400 hover:text-slate-100",onClick:()=>m(null),children:(0,b.jsx)(j.X,{className:"h-4 w-4"})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[(0,b.jsxs)("div",{className:"rounded-lg border border-white/14 bg-slate-950/42 p-2",children:[(0,b.jsx)("span",{className:"text-[10px] uppercase font-semibold text-slate-400",children:"Fase"}),(0,b.jsx)("p",{className:"text-xs font-medium text-slate-200",children:h.stageLabel})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-white/14 bg-slate-950/42 p-2",children:[(0,b.jsx)("span",{className:"text-[10px] uppercase font-semibold text-slate-400",children:"Tags"}),(0,b.jsx)("p",{className:"text-xs font-medium text-slate-200",children:h.tags.length>0?h.tags.join(", "):"â€”"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(u.Button,{size:"sm",variant:"outline",className:"h-8 flex-1 border-white/14 bg-white/6 text-xs text-slate-100 hover:bg-white/10",onClick:()=>{w.useIntelligenceStore.getState().executeSlashCommand("/briefing")},children:"ðŸ“‹ Briefing"}),(0,b.jsx)(u.Button,{size:"sm",variant:"outline",className:"h-8 flex-1 border-white/14 bg-white/6 text-xs text-slate-100 hover:bg-white/10",onClick:()=>{w.useIntelligenceStore.getState().executeSlashCommand("/analise")},children:"ðŸ” Analisar"})]})]}),null!==v?(0,b.jsxs)("div",{className:"px-2",children:[(0,b.jsxs)("h4",{className:"font-heading text-xs uppercase tracking-wider text-slate-400 font-semibold mb-2 px-2",children:["Resultados (",v.length,")"]}),v.length>0?(0,b.jsx)("div",{className:"space-y-1",children:v.map((a,c)=>(0,b.jsx)(J,{item:a,initials:y(a.companyName),color:z(c),isSelected:h?.cardId===a.entityId,onClick:()=>x(a)},a.id))}):(0,b.jsxs)("p",{className:"text-xs text-slate-400 px-2",children:["Nenhum resultado para â€œ",a,"â€"]})]}):(0,b.jsxs)(b.Fragment,{children:[s.length>0&&(0,b.jsxs)("div",{className:"px-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2 px-2",children:[(0,b.jsx)("h4",{className:"font-heading text-xs uppercase tracking-wider text-slate-400 font-semibold",children:"Prioridades"}),(0,b.jsx)(E.Badge,{variant:"secondary",className:"text-[10px] h-4 px-1",children:s.length})]}),(0,b.jsx)("div",{className:"space-y-1",children:s.map(a=>(0,b.jsxs)(e.motion.button,{onClick:()=>x(a),whileHover:{y:-1,scale:1.005},whileTap:{y:0,scale:.992},className:(0,k.cn)("w-full text-left flex items-start gap-3 p-2.5 rounded-lg transition-all group",h?.cardId===a.entityId?"border-brand/20 bg-brand/10 shadow-sm ring-1 ring-brand/20":"border border-transparent hover:bg-white/6"),children:[(0,b.jsx)("div",{className:"mt-0.5 h-2 w-2 shrink-0 rounded-full bg-amber-400 shadow-amber-300/40"}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"mb-1 text-sm leading-none font-medium text-slate-100 group-hover:text-cyan-200",children:a.companyName}),(0,b.jsx)("p",{className:"line-clamp-1 text-xs text-slate-400",children:a.stageLabel}),a.lastContact&&(0,b.jsxs)("div",{className:"mt-1.5 flex items-center gap-1 text-[10px] text-slate-400",children:[(0,b.jsx)(C.Clock,{className:"h-3 w-3"}),function(a){if(!a)return"â€”";let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/864e5);return 0===c?"hoje":1===c?"ha 1 dia":c<7?`ha ${c} dias`:c<30?`ha ${Math.floor(c/7)} semana(s)`:`ha ${Math.floor(c/30)} mes(es)`}(a.lastContact)]})]})]},a.id))})]}),t.length>0&&(0,b.jsxs)("div",{className:"px-2",children:[(0,b.jsx)("h4",{className:"font-heading text-xs uppercase tracking-wider text-slate-400 font-semibold mb-2 px-2",children:"Recentes"}),(0,b.jsx)("div",{className:"space-y-1",children:t.map((a,c)=>(0,b.jsx)(J,{item:a,initials:y(a.companyName),color:z(c),isSelected:h?.cardId===a.entityId,onClick:()=>x(a)},a.id))})]}),0===r.length&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[(0,b.jsx)(i.Users,{className:"mb-3 h-8 w-8 text-slate-500"}),(0,b.jsx)("p",{className:"mb-2 text-sm text-slate-300",children:"Nenhum cliente encontrado"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Seus leads e oportunidades aparecerÃ£o aqui automaticamente."})]}),r.length>0&&(0,b.jsx)("div",{className:"px-2",children:(0,b.jsxs)("button",{onClick:n,className:"flex w-full items-center gap-2 p-2 text-xs font-medium text-cyan-200 transition-colors hover:text-cyan-100",children:[(0,b.jsx)(i.Users,{className:"h-3.5 w-3.5"}),"Ver todos os clientes (",r.length,")"]})})]})]})})]})}function J({item:a,initials:c,color:d,isSelected:f,onClick:g}){return(0,b.jsxs)(e.motion.button,{onClick:g,whileHover:{y:-1,scale:1.008},whileTap:{y:0,scale:.992},className:(0,k.cn)("w-full text-left flex items-center gap-3 p-2 rounded-lg transition-all group",f?"border-brand/20 bg-brand/10 shadow-sm ring-1 ring-brand/20":"border border-transparent hover:bg-white/6"),children:[(0,b.jsx)("div",{className:(0,k.cn)("h-8 w-8 rounded-full flex items-center justify-center font-bold text-xs shrink-0",d),children:c}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"truncate text-sm font-medium text-slate-100 group-hover:text-cyan-200",children:a.companyName}),(0,b.jsxs)("p",{className:"flex items-center gap-1 truncate text-xs text-slate-400",children:[K(a.temperature)," ",a.stageLabel]})]})]})}function K(a){return"hot"===a?"ðŸ”¥":"warm"===a?"ðŸŒ¡ï¸":"â„ï¸"}var L=a.i(92759),M=a.i(73570);let N=(0,f.default)("lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);var O=a.i(24669),P=a.i(5151),Q=a.i(33441),R=a.i(41675),S=a.i(4720),T=a.i(69520),U=a.i(77156),V=a.i(92258),W=a.i(63519),X=a.i(30455);function Y({badge:a}){let c="hot"===a.temperature?"ðŸ”¥":"warm"===a.temperature?"ðŸŒ¡ï¸":"â„ï¸",d="hot"===a.temperature?"Quente":"warm"===a.temperature?"Morno":"Frio";return(0,b.jsxs)("div",{className:"mb-2 inline-flex items-center gap-1.5 rounded-full border border-white/14 bg-white/8 px-2.5 py-1 text-[11px] font-medium text-slate-300",children:[(0,b.jsx)("span",{children:"ðŸ“‹"}),(0,b.jsxs)("span",{children:["Baseado no card: ",(0,b.jsx)("strong",{children:a.cardName})," (",a.stage," Â·"," ",c," ",d,")"]})]})}function Z({block:a}){let[d,e]=(0,c.useState)(!1),[f,g]=(0,c.useState)(!1),[h,i]=(0,c.useState)(a.content),[l,m]=(0,c.useState)(!1),n=h.length,o=!!a.charLimit&&n>a.charLimit,p="whatsapp"===a.channel?(0,b.jsx)(r.MessageSquare,{className:"h-3.5 w-3.5"}):"email"===a.channel?(0,b.jsx)(V.Mail,{className:"h-3.5 w-3.5"}):"call"===a.channel?(0,b.jsx)(W.Phone,{className:"h-3.5 w-3.5"}):null,q=(0,c.useCallback)(async()=>{try{await navigator.clipboard.writeText(h),e(!0),setTimeout(()=>e(!1),2e3)}catch{g(!0),setTimeout(()=>g(!1),2e3)}},[h]);return(0,b.jsxs)("div",{className:"mt-2 overflow-hidden rounded-xl border border-white/14 bg-slate-900/58 shadow-lg shadow-black/25",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-3 py-1.5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 text-[11px] font-medium text-slate-300",children:[p,(0,b.jsx)("span",{children:a.label??"Mensagem"})]}),(0,b.jsx)("button",{onClick:q,className:(0,k.cn)("flex items-center gap-1 rounded-lg px-2 py-0.5 text-[11px] font-medium transition-all duration-[120ms]",d?"bg-emerald-500/20 text-emerald-100":f?"bg-red-500/20 text-red-100":"text-slate-300 hover:bg-white/9"),children:d?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Q.Check,{className:"h-3 w-3"}),"Copiado"]}):f?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j.X,{className:"h-3 w-3"}),"Erro"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(P.Copy,{className:"h-3 w-3"}),"Copiar"]})})]}),(0,b.jsx)("div",{className:"p-3",children:l?(0,b.jsx)("textarea",{value:h,onChange:a=>i(a.target.value),onBlur:()=>m(!1),className:"w-full resize-none rounded border-none bg-transparent font-body text-sm text-slate-200 outline-none",rows:Math.min(h.split("\n").length+1,8),autoFocus:!0}):(0,b.jsx)("p",{onClick:()=>m(!0),className:"cursor-text whitespace-pre-wrap font-body text-sm leading-relaxed text-slate-200",children:h})}),a.charLimit&&(0,b.jsx)("div",{className:"border-t border-white/10 px-3 py-1",children:(0,b.jsxs)("p",{className:(0,k.cn)("text-right text-[10px] font-medium",o?"text-red-200":"text-slate-400"),children:[n,"/",a.charLimit," caracteres"]})})]})}function $({action:a,messageId:c}){let{markActionExecuted:d,openClientPicker:e,contextCard:f}=(0,w.useIntelligenceStore)(),{openDrawer:g,openModal:h}=(0,X.useUIStore)(),i={calendar:(0,b.jsx)(R.Calendar,{className:"h-3.5 w-3.5"}),"file-text":(0,b.jsx)(S.FileText,{className:"h-3.5 w-3.5"}),"refresh-cw":(0,b.jsx)(T.RefreshCw,{className:"h-3.5 w-3.5"}),eye:(0,b.jsx)(U.Eye,{className:"h-3.5 w-3.5"}),users:(0,b.jsx)(r.MessageSquare,{className:"h-3.5 w-3.5"})};return(0,b.jsxs)(u.Button,{variant:"open-card"===a.type?"ghost":"secondary",size:"sm",onClick:()=>{if(a.executed)return;let b=!1;if(a.payload?.action==="open-client-picker")e(),b=!0;else{let c=a.payload??{};switch(a.type){case"create-activity":var i;g("new-activity",{...c,type:"followup"===(i=c.type)||"follow-up"===i?"follow-up":"call"===i||"email"===i||"meeting"===i||"visit"===i||"task"===i||"whatsapp"===i?i:"task",fromIntelligence:!0}),b=!0;break;case"schedule-followup":g("new-activity",{...c,type:"follow-up",fromIntelligence:!0}),b=!0;break;case"save-note":{let a=("string"==typeof c.cardId?c.cardId:f?.cardId)??null,d="string"==typeof c.noteText?c.noteText:void 0,i="client"===c.entityType?"client":f?.entityType??"opportunity";if(!a){e(),b=!0;break}if("client"===i){g("client-card",{id:a,initialTab:"notes",prefillNote:d,fromIntelligence:!0}),b=!0;break}h("lead-card",{id:a,initialTab:"anotacoes",prefillNote:d,fromIntelligence:!0}),b=!0;break}case"open-card":{let a=("string"==typeof c.cardId?c.cardId:f?.cardId)??null,d="client"===c.entityType?"client":f?.entityType??"opportunity";if(!a){e(),b=!0;break}"client"===d?g("client-card",{id:a}):h("lead-card",{id:a}),b=!0}}}b&&d(c,a.id)},disabled:a.executed,className:(0,k.cn)("h-7 gap-1.5 rounded-lg text-xs transition-all duration-[120ms]",a.executed&&"opacity-50",!a.executed&&"hover:translate-y-[-1px] hover:shadow-sm"),children:[a.executed?(0,b.jsx)(Q.Check,{className:"h-3.5 w-3.5 text-green-500"}):i[a.icon]??null,a.label]})}let _=(0,c.memo)(function({message:a,isReadOnly:c=!1,isGrouped:d=!1,isLastInGroup:f=!0}){let g="user"===a.role;return(0,b.jsx)(e.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},transition:{duration:.14,ease:[0,0,.2,1]},className:(0,k.cn)("flex w-full",g?"justify-end":"justify-start",d?"mt-0.5":"mt-2"),children:(0,b.jsxs)("div",{className:(0,k.cn)("px-3.5 py-2.5",g?(0,k.cn)("max-w-[80%]","bg-gradient-to-br from-cyan-600 to-blue-700 text-white","shadow-lg shadow-cyan-900/30","rounded-[18px] rounded-tr-[6px]"):(0,k.cn)("max-w-[90%]","border border-white/12 bg-slate-900/58 text-slate-200","shadow-lg shadow-black/25","rounded-[18px] rounded-tl-[6px]")),children:[!g&&a.contextBadge&&(0,b.jsx)(Y,{badge:a.contextBadge}),(0,b.jsx)("div",{className:(0,k.cn)("font-body text-[13px] leading-relaxed",g?"[&_strong]:font-semibold":"[&_strong]:font-semibold [&_code]:text-cyan-200"),children:g?a.content:function(a){let c=a.split("\n"),d=[],e=!1,f=[],g=0,h=(a,c)=>a.split(/(\*\*\*[^*]+\*\*\*|\*\*[^*]+\*\*|\*[^*]+\*|`[^`]+`|\[[^\]]+\]\([^)]+\))/g).map((a,d)=>{if(a.startsWith("***")&&a.endsWith("***"))return(0,b.jsx)("strong",{className:"italic",children:a.slice(3,-3)},`${c}-${d}`);if(a.startsWith("**")&&a.endsWith("**"))return(0,b.jsx)("strong",{children:a.slice(2,-2)},`${c}-${d}`);if(a.startsWith("*")&&a.endsWith("*"))return(0,b.jsx)("em",{children:a.slice(1,-1)},`${c}-${d}`);if(a.startsWith("`")&&a.endsWith("`"))return(0,b.jsx)("code",{className:"rounded border border-white/10 bg-white/8 px-1 py-0.5 font-mono text-[11px] text-cyan-200",children:a.slice(1,-1)},`${c}-${d}`);let e=a.match(/^\[([^\]]+)\]\(([^)]+)\)$/);return e?(0,b.jsx)("a",{href:e[2],target:"_blank",rel:"noopener noreferrer",className:"font-medium text-cyan-200 underline underline-offset-2 hover:text-cyan-100",children:e[1]},`${c}-${d}`):a});for(let a=0;a<c.length;a++){let i=c[a],j=i.trim();if(j.startsWith("|")&&j.endsWith("|")){if(e||(e=!0,f=[]),/^\|[\s\-:|]+\|$/.test(j))continue;let a=j.split("|").slice(1,-1).map(a=>a.trim());f.push(a);continue}if(e){e=!1;let[a,...c]=f;d.push((0,b.jsx)("div",{className:"my-2 overflow-x-auto rounded-xl border border-white/12 shadow-lg shadow-black/20",children:(0,b.jsxs)("table",{className:"w-full text-xs",children:[a&&(0,b.jsx)("thead",{children:(0,b.jsx)("tr",{className:"border-b border-white/12 bg-white/8",children:a.map((a,c)=>(0,b.jsx)("th",{className:"px-2.5 py-1.5 text-left font-semibold text-slate-200",children:h(a,`th-${g}-${c}`)},c))})}),(0,b.jsx)("tbody",{children:c.map((a,c)=>(0,b.jsx)("tr",{className:"border-b border-white/8 last:border-0",children:a.map((a,d)=>(0,b.jsx)("td",{className:"px-2.5 py-1.5 text-slate-300",children:h(a,`td-${g}-${c}-${d}`)},d))},c))})]})},`table-${g++}`)),f=[]}if(j.startsWith("### "))d.push((0,b.jsx)("h4",{className:"mb-1 mt-3 font-heading text-xs font-bold text-slate-100",children:h(j.slice(4),`h4i-${a}`)},`h4-${a}`));else if(j.startsWith("## "))d.push((0,b.jsx)("h3",{className:"mb-1 mt-3 font-heading text-sm font-bold text-slate-100",children:h(j.slice(3),`h3i-${a}`)},`h3-${a}`));else if(j.startsWith("# "))d.push((0,b.jsx)("h2",{className:"mb-1.5 mt-3 font-heading text-sm font-bold text-slate-50",children:h(j.slice(2),`h2i-${a}`)},`h2-${a}`));else if(j.startsWith("- ")||j.startsWith("â€¢ ")){let c=i.search(/\S/);d.push((0,b.jsxs)("div",{className:"flex gap-1.5",style:{paddingLeft:`${Math.max(0,4*c)}px`},children:[(0,b.jsx)("span",{className:"mt-1 shrink-0 text-slate-500",children:"â€¢"}),(0,b.jsx)("span",{children:h(j.slice(2),`lii-${a}`)})]},`li-${a}`))}else if(/^\d+\.\s/.test(j)){let c=j.match(/^(\d+)\.\s(.*)$/);c&&d.push((0,b.jsxs)("div",{className:"flex gap-1.5",children:[(0,b.jsxs)("span",{className:"shrink-0 font-medium text-slate-400",children:[c[1],"."]}),(0,b.jsx)("span",{children:h(c[2],`oli-${a}`)})]},`ol-${a}`))}else"---"===j||"***"===j?d.push((0,b.jsx)("hr",{className:"my-2 border-white/12"},`hr-${a}`)):""===j?d.push((0,b.jsx)("div",{className:"h-1.5"},`br-${a}`)):d.push((0,b.jsx)("p",{children:h(j,`pi-${a}`)},`p-${a}`))}if(e&&f.length>0){let[a,...c]=f;d.push((0,b.jsx)("div",{className:"my-2 overflow-x-auto rounded-xl border border-white/12 shadow-lg shadow-black/20",children:(0,b.jsxs)("table",{className:"w-full text-xs",children:[a&&(0,b.jsx)("thead",{children:(0,b.jsx)("tr",{className:"border-b border-white/12 bg-white/8",children:a.map((a,c)=>(0,b.jsx)("th",{className:"px-2.5 py-1.5 text-left font-semibold text-slate-200",children:h(a,`thf-${c}`)},c))})}),(0,b.jsx)("tbody",{children:c.map((a,c)=>(0,b.jsx)("tr",{className:"border-b border-white/8 last:border-0",children:a.map((a,d)=>(0,b.jsx)("td",{className:"px-2.5 py-1.5 text-slate-300",children:h(a,`tdf-${c}-${d}`)},d))},c))})]})},"table-final"))}return d}(a.content)}),!g&&a.copyableBlocks&&a.copyableBlocks.length>0&&(0,b.jsx)("div",{className:"mt-2 space-y-2",children:a.copyableBlocks.map(a=>(0,b.jsx)(Z,{block:a},a.id))}),!g&&!c&&a.suggestedActions&&a.suggestedActions.length>0&&(0,b.jsx)("div",{className:"mt-2.5 flex flex-wrap gap-1.5",children:a.suggestedActions.map(c=>(0,b.jsx)($,{action:c,messageId:a.id},c.id))}),f&&(0,b.jsx)("p",{className:(0,k.cn)("mt-1 text-[10px]",g?"text-cyan-100/90":"text-slate-400"),children:new Date(a.timestamp).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})})});var aa=a.i(74802);function ab({inputText:a,isVisible:f,onSelect:g,onClose:h}){let i=(0,G.useAuthStore)(a=>a.user),{contextCard:j}=(0,w.useIntelligenceStore)(),[l,m]=(0,c.useState)(0),n=(0,c.useRef)(null),o=i?.role??"comercial",p=!!j,q=(0,c.useMemo)(()=>(0,aa.getAvailableCommands)(o),[o]),r=(0,c.useMemo)(()=>(0,aa.filterCommands)(q,a),[q,a]);(0,c.useEffect)(()=>{(0,c.startTransition)(()=>{m(0)})},[a]);let s=(0,c.useCallback)(a=>{if(f&&0!==r.length)switch(a.key){case"ArrowDown":a.preventDefault(),m(a=>a<r.length-1?a+1:0);break;case"ArrowUp":a.preventDefault(),m(a=>a>0?a-1:r.length-1);break;case"Enter":case"Tab":a.preventDefault(),r[l]&&g(r[l]);break;case"Escape":a.preventDefault(),h()}},[f,r,l,g,h]);return((0,c.useEffect)(()=>(window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)),[s]),(0,c.useEffect)(()=>{if(n.current){let a=n.current.querySelector(`[data-index="${l}"]`);a?.scrollIntoView({block:"nearest"})}},[l]),f&&0!==r.length)?(0,b.jsx)(d.AnimatePresence,{children:(0,b.jsxs)(e.motion.div,{ref:n,initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.15},className:(0,k.cn)("absolute bottom-full left-0 right-0 mb-2 max-h-[320px] overflow-y-auto","rounded-xl border border-white/14 bg-slate-950/96 shadow-2xl shadow-black/35 backdrop-blur-xl"),children:[(0,b.jsx)("div",{className:"sticky top-0 border-b border-white/10 bg-slate-950/92 px-3 py-2 backdrop-blur-sm",children:(0,b.jsx)("p",{className:"text-[10px] font-semibold uppercase tracking-wider text-slate-400",children:"Comandos rÃ¡pidos"})}),(0,b.jsx)("div",{className:"p-1",children:r.map((a,c)=>{let d=a.requiresCard&&!p;return(0,b.jsxs)("button",{"data-index":c,onClick:()=>{d||g(a)},onMouseEnter:()=>m(c),className:(0,k.cn)("flex w-full items-center gap-3 rounded-lg px-3 py-2 text-left transition-colors",c===l?"bg-white/10":"hover:bg-white/7",d&&"opacity-50 cursor-not-allowed"),disabled:d,title:d?"Requer card aberto":`${a.command} â€” ${a.description}`,children:[(0,b.jsx)("span",{className:"flex h-8 w-8 shrink-0 items-center justify-center rounded-lg border border-white/10 bg-white/8 text-base",children:a.icon}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-body text-sm font-medium text-slate-100",children:a.label}),(0,b.jsx)("code",{className:"rounded border border-white/10 bg-white/8 px-1.5 py-0.5 font-mono text-[10px] text-slate-300",children:a.command})]}),(0,b.jsx)("p",{className:"truncate text-[11px] text-slate-400",children:a.description})]}),a.requiresCard&&(0,b.jsx)("span",{className:(0,k.cn)("shrink-0 rounded-full px-1.5 py-0.5 text-[9px] font-medium",p?"bg-emerald-500/18 text-emerald-100":"bg-amber-500/18 text-amber-100"),children:p?"âœ… Card":"âš ï¸ Requer card"})]},a.command)})})]})}):null}var ac=a.i(69876);function ad(){let{history:a,isHistoryOpen:f,toggleHistory:g,loadConversation:h}=(0,w.useIntelligenceStore)(),[i,k]=(0,c.useState)(""),l=(0,c.useMemo)(()=>{if(!i.trim())return a;let b=i.toLowerCase();return a.filter(a=>a.preview.toLowerCase().includes(b)||a.relatedCardName?.toLowerCase().includes(b)||a.messages.some(a=>a.content.toLowerCase().includes(b)))},[a,i]);return(0,b.jsx)(d.AnimatePresence,{children:f&&(0,b.jsxs)(e.motion.div,{initial:{opacity:0,x:-16},animate:{opacity:1,x:0},exit:{opacity:0,x:-16},transition:{duration:.2},className:"absolute inset-0 z-20 flex flex-col border-r border-white/12 bg-slate-950/94 backdrop-blur-xl",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 border-b border-white/10 px-4 py-3",children:[(0,b.jsx)("button",{onClick:g,className:"flex h-7 w-7 items-center justify-center rounded-lg text-slate-400 transition-colors hover:bg-white/8 hover:text-slate-100",children:(0,b.jsx)(t.ArrowLeft,{className:"h-4 w-4"})}),(0,b.jsx)(C.Clock,{className:"h-4 w-4 text-slate-400"}),(0,b.jsx)("h3",{className:"flex-1 font-heading text-sm font-semibold text-slate-100",children:"HistÃ³rico de conversas"}),(0,b.jsx)("button",{onClick:g,className:"flex h-7 w-7 items-center justify-center rounded-lg text-slate-400 transition-colors hover:bg-white/8 hover:text-slate-100",children:(0,b.jsx)(j.X,{className:"h-4 w-4"})})]}),(0,b.jsx)("div",{className:"px-4 py-2",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Search,{className:"absolute left-3 top-1/2 h-3.5 w-3.5 -translate-y-1/2 text-slate-400"}),(0,b.jsx)(D.Input,{placeholder:"Buscar no histÃ³rico...",value:i,onChange:a=>k(a.target.value),className:"h-8 border-white/16 bg-white/7 pl-8 text-xs text-slate-100 placeholder:text-slate-400"})]})}),(0,b.jsx)(ac.ScrollArea,{className:"flex-1",children:(0,b.jsx)("div",{className:"p-2",children:l.length>0?l.map(a=>{let c,d;return(0,b.jsxs)("button",{onClick:()=>h(a.id),className:"flex w-full flex-col gap-1 rounded-xl border border-transparent px-3 py-2.5 text-left transition-colors hover:border-white/12 hover:bg-white/7",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(r.MessageSquare,{className:"h-3.5 w-3.5 shrink-0 text-slate-400"}),(0,b.jsx)("span",{className:"truncate text-xs font-medium text-slate-100",children:a.preview||"Conversa sem preview"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 pl-5",children:[(0,b.jsx)("span",{className:"text-[10px] text-slate-400",children:(c=new Date(a.createdAt),0===(d=Math.floor((new Date().getTime()-c.getTime())/864e5))?"Hoje":1===d?"Ontem":d<7?`${d} dias atr\xe1s`:c.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"}))}),a.relatedCardName&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-[10px] text-slate-500",children:"Â·"}),(0,b.jsx)("span",{className:"text-[10px] text-cyan-200",children:a.relatedCardName})]}),(0,b.jsx)("span",{className:"text-[10px] text-slate-500",children:"Â·"}),(0,b.jsxs)("span",{className:"text-[10px] text-slate-400",children:[a.messageCount," msgs"]})]})]},a.id)}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(C.Clock,{className:"mb-2 h-6 w-6 text-slate-500"}),(0,b.jsx)("p",{className:"text-center text-xs text-slate-400",children:i?"Nenhuma conversa encontrada.":"Sem conversas anteriores. Inicie uma conversa com a Menux Intelligence!"})]})})})]})})}var ae=a.i(14574),af=a.i(31791);function ag({temp:a}){let c={hot:{emoji:"ðŸ”¥",label:"Quente",cls:"bg-red-500/18 text-red-100"},warm:{emoji:"ðŸŒ¡ï¸",label:"Morno",cls:"bg-amber-500/18 text-amber-100"},cold:{emoji:"â„ï¸",label:"Frio",cls:"bg-cyan-500/18 text-cyan-100"}}[a];return(0,b.jsxs)("span",{className:(0,k.cn)("inline-flex items-center gap-1 rounded-full px-2 py-0.5 text-[10px] font-medium",c.cls),children:[c.emoji," ",c.label]})}function ah({label:a}){return(0,b.jsx)("span",{className:"inline-flex items-center rounded-full bg-indigo-500/18 px-2 py-0.5 text-[10px] font-medium text-indigo-100",children:a})}let ai={"lead-in":"Lead In","contato-feito":"Contato Feito","reuniao-agendada":"ReuniÃ£o Agendada","proposta-enviada":"Proposta Enviada",negociacao:"NegociaÃ§Ã£o",fechamento:"Fechamento"};function aj(){let{isClientPickerOpen:a,closeClientPicker:d,clientPickerSearch:e,setClientPickerSearch:f,clientPickerFilters:g,setClientPickerFilters:h,selectClient:l}=(0,w.useIntelligenceStore)(),{opportunities:m}=(0,F.useOpportunityStore)(),n=(0,G.useAuthStore)(a=>a.user),[o,p]=(0,c.useState)(e);(0,c.useEffect)(()=>{let a=setTimeout(()=>p(e),300);return()=>clearTimeout(a)},[e]);let r=(0,c.useMemo)(()=>m.filter(a=>n?.role!=="comercial"&&n?.role!=="cs"||a.responsibleId===n.id).map(a=>({id:a.id,entityId:a.id,entityType:"opportunity",companyName:a.clientName??a.title,segment:a.tags?.[0],stage:a.stage,stageLabel:ai[a.stage]??a.stage,temperature:a.temperature,lastContact:a.updatedAt,value:a.monthlyValue,tags:a.tags})),[m,n]),s=(0,c.useMemo)(()=>{let a=r;if(o.trim()){let b=o.toLowerCase();a=a.filter(a=>a.companyName.toLowerCase().includes(b)||a.segment?.toLowerCase().includes(b)||a.tags?.some(a=>a.toLowerCase().includes(b)))}return g.temperature?.length&&(a=a.filter(a=>g.temperature.includes(a.temperature))),a.sort((a,b)=>{let c={hot:0,warm:1,cold:2},d=c[a.temperature]-c[b.temperature];return 0!==d?d:a.lastContact&&b.lastContact?new Date(b.lastContact).getTime()-new Date(a.lastContact).getTime():a.companyName.localeCompare(b.companyName)}),a},[r,o,g]),t=(0,c.useCallback)(a=>{let b=g.temperature??[],c=b.includes(a)?b.filter(b=>b!==a):[...b,a];h({...g,temperature:c.length?c:void 0})},[g,h]),u=(0,c.useCallback)(()=>{f(""),h({})},[f,h]);return(0,b.jsx)(ae.Dialog,{open:a,onOpenChange:a=>!a&&d(),children:(0,b.jsxs)(ae.DialogContent,{className:"max-w-[520px] gap-0 border-white/14 bg-slate-950/92 p-0 text-slate-100 shadow-2xl shadow-black/40 backdrop-blur-xl sm:max-w-[520px]",children:[(0,b.jsx)(ae.DialogHeader,{className:"border-b border-white/10 px-5 py-4",children:(0,b.jsxs)(ae.DialogTitle,{className:"flex items-center gap-2 font-heading text-base text-slate-100",children:[(0,b.jsx)(i.Users,{className:"h-4.5 w-4.5 text-cyan-200"}),"Selecionar cliente"]})}),(0,b.jsx)("div",{className:"border-b border-white/10 px-5 py-3",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(q.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),(0,b.jsx)(D.Input,{placeholder:"Buscar por nome, segmento ou tag...",value:e,onChange:a=>f(a.target.value),className:"border-white/16 bg-white/7 pl-9 text-sm text-slate-100 placeholder:text-slate-400",autoFocus:!0}),e&&(0,b.jsx)("button",{onClick:()=>f(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-100",children:(0,b.jsx)(j.X,{className:"h-3.5 w-3.5"})})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2 border-b border-white/10 px-5 py-2.5",children:[["hot","warm","cold"].map(a=>{let c=g.temperature?.includes(a),d="hot"===a?"ðŸ”¥":"warm"===a?"ðŸŒ¡ï¸":"â„ï¸",e="hot"===a?"Quente":"warm"===a?"Morno":"Frio";return(0,b.jsxs)("button",{onClick:()=>t(a),className:(0,k.cn)("inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium transition-colors",c?"bg-cyan-500/20 text-cyan-100 ring-1 ring-cyan-300/35":"bg-white/8 text-slate-300 hover:bg-white/12"),children:[d," ",e]},a)}),(g.temperature?.length||e)&&(0,b.jsx)("button",{onClick:u,className:"ml-auto text-[11px] font-medium text-cyan-200 hover:text-cyan-100",children:"Limpar filtros"})]}),(0,b.jsx)(ac.ScrollArea,{className:"max-h-[70vh]",children:(0,b.jsx)("div",{className:"p-2",children:s.length>0?s.map(a=>(0,b.jsxs)("button",{onClick:()=>l(a),className:"flex w-full items-start gap-3 rounded-xl border border-transparent px-3 py-3 text-left transition-colors hover:border-white/12 hover:bg-white/7",children:[(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"truncate font-body text-sm font-semibold text-slate-100",children:a.companyName}),a.segment&&(0,b.jsx)("span",{className:"shrink-0 text-[11px] text-slate-400",children:a.segment})]}),(0,b.jsxs)("div",{className:"mt-1 flex flex-wrap items-center gap-1.5",children:[(0,b.jsx)(ah,{label:a.stageLabel}),(0,b.jsx)(ag,{temp:a.temperature}),a.lastContact&&(0,b.jsxs)("span",{className:"text-[10px] text-slate-400",children:["Ãšltimo contato: ",function(a){if(!a)return"â€”";let b=new Date(a),c=Math.floor((new Date().getTime()-b.getTime())/864e5);return 0===c?"hoje":1===c?"hÃ¡ 1 dia":c<7?`h\xe1 ${c} dias`:c<30?`h\xe1 ${Math.floor(c/7)} semana(s)`:`h\xe1 ${Math.floor(c/30)} m\xeas(es)`}(a.lastContact)]})]})]}),a.value&&a.value>0&&(0,b.jsxs)("div",{className:"shrink-0 text-right",children:[(0,b.jsx)("p",{className:"text-xs font-semibold text-slate-200",children:(0,af.formatCurrencyBRL)(a.value)}),(0,b.jsx)("p",{className:"text-[10px] text-slate-400",children:"/mÃªs"})]})]},a.id)):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,b.jsx)(i.Users,{className:"mb-3 h-8 w-8 text-slate-500"}),(0,b.jsx)("p",{className:"font-body text-sm text-slate-400",children:e?`Nenhum cliente encontrado para "${e}". Tente outro nome ou limpe os filtros.`:"VocÃª ainda nÃ£o tem clientes neste pipe. Pode me fazer perguntas gerais ou consultar a base Menux."}),e&&(0,b.jsx)("button",{onClick:u,className:"mt-2 text-sm font-medium text-cyan-200 hover:text-cyan-100",children:"Limpar filtros"})]})})}),(0,b.jsx)("div",{className:"border-t border-white/10 px-5 py-2.5",children:(0,b.jsxs)("p",{className:"text-[11px] text-slate-400",children:["Mostrando ",s.length," de ",r.length," clientes"]})})]})})}var ak=a.i(80701),al=a.i(63658);let am=[{value:"formal",label:"Formal"},{value:"neutral",label:"Neutro"},{value:"casual",label:"Casual"}],an=[{value:5,label:"A cada 5 minutos"},{value:15,label:"A cada 15 minutos"},{value:30,label:"A cada 30 minutos"}];function ao(){let{isSettingsOpen:a,closeSettings:c,aiTone:d,setAiTone:e,proactiveFrequency:f,setProactiveFrequency:g,proactiveNotifications:h,setProactiveNotifications:i}=(0,w.useIntelligenceStore)();return(0,b.jsx)(ae.Dialog,{open:a,onOpenChange:a=>!a&&c(),children:(0,b.jsxs)(ae.DialogContent,{className:"border-white/12 bg-slate-950 text-slate-100 sm:max-w-md",children:[(0,b.jsx)(ae.DialogHeader,{children:(0,b.jsx)(ae.DialogTitle,{className:"font-heading text-lg",children:"ConfiguraÃ§Ãµes da Intelligence"})}),(0,b.jsxs)("div",{className:"space-y-6 py-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-200",children:"Tom da IA"}),(0,b.jsxs)(ak.Select,{value:d,onValueChange:a=>e(a),children:[(0,b.jsx)(ak.SelectTrigger,{className:"border-white/12 bg-white/7",children:(0,b.jsx)(ak.SelectValue,{})}),(0,b.jsx)(ak.SelectContent,{className:"border-white/12 bg-slate-900",children:am.map(a=>(0,b.jsx)(ak.SelectItem,{value:a.value,children:a.label},a.value))})]}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Define o estilo de comunicaÃ§Ã£o nas respostas."})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-200",children:"FrequÃªncia de sugestÃµes"}),(0,b.jsxs)(ak.Select,{value:String(f),onValueChange:a=>g(Number(a)),children:[(0,b.jsx)(ak.SelectTrigger,{className:"border-white/12 bg-white/7",children:(0,b.jsx)(ak.SelectValue,{})}),(0,b.jsx)(ak.SelectContent,{className:"border-white/12 bg-slate-900",children:an.map(a=>(0,b.jsx)(ak.SelectItem,{value:String(a.value),children:a.label},a.value))})]}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Com que frequÃªncia o motor proativo verifica novas oportunidades."})]}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-0.5",children:[(0,b.jsx)("label",{className:"text-sm font-medium text-slate-200",children:"NotificaÃ§Ãµes proativas"}),(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"Receber alertas sobre oportunidades e riscos."})]}),(0,b.jsx)(al.Switch,{checked:h,onCheckedChange:i})]})]})]})})}var ap=a.i(50489);function aq(){let[a,f]=(0,c.useState)(""),[g,i]=(0,c.useState)(!1),[j,l]=(0,c.useState)(null),m=(0,c.useRef)(null),o=(0,c.useRef)(null),[p,q]=(0,c.useState)(!0),{messages:r,isTyping:s,greetingSent:t,contextCard:v,remainingQueries:x,viewingHistoryConversation:y,sendMessage:z,executeSlashCommand:A,open:B}=(0,w.useIntelligenceStore)();(0,c.useEffect)(()=>{t||B()},[t,B]);let C=(0,c.useCallback)((a="smooth")=>{let b=m.current;b&&b.scrollTo({top:b.scrollHeight,behavior:a})},[]),D=(0,c.useCallback)(()=>{let a=m.current;a&&q(a.scrollHeight-a.scrollTop-a.clientHeight<=36)},[]);(0,c.useEffect)(()=>{if(!p)return;let a=requestAnimationFrame(()=>C("smooth"));return()=>cancelAnimationFrame(a)},[r,s,p,C]);let E=y?y.messages:r,F=!!y,G=!p&&E.length>0;(0,c.useEffect)(()=>{D()},[E.length,D]),(0,c.useEffect)(()=>{(0,c.startTransition)(()=>{a.startsWith("/")&&!j?i(!0):a.startsWith("/")||i(!1)})},[a,j]);let H=(0,c.useCallback)(async()=>{if(!a.trim()||F)return;let b=a.trim();if(f(""),i(!1),j)await A(j.command,b),l(null);else if(b.startsWith("/")){let a=b.split(" ")[0],c=b.slice(a.length).trim();await A(a,c||void 0)}else await z(b)},[a,j,F,z,A]),I=(0,c.useCallback)(a=>{i(!1),a.requiresInput?(l(a),f(""),o.current?.focus()):(f(""),A(a.command))},[A]),J=(0,c.useMemo)(()=>E.map((a,b)=>{let c=E[b-1],d=E[b+1],e=c?.role===a.role,f=!d||d.role!==a.role;return{message:a,isGrouped:e,isLastInGroup:f}}),[E]),K=j?j.inputPlaceholder??"Digite o complemento...":v?`Pergunte sobre ${v.cardName}...`:"Digite uma mensagem ou /comando...";return(0,b.jsxs)("div",{className:"relative flex h-full flex-col bg-transparent",children:[(0,b.jsx)(ad,{}),(0,b.jsx)(aj,{}),(0,b.jsx)(ao,{}),(0,b.jsx)(d.AnimatePresence,{children:F&&(0,b.jsxs)(e.motion.div,{initial:{opacity:0,y:-8},animate:{opacity:1,y:0},exit:{opacity:0,y:-8},className:"flex items-center justify-between border-b border-amber-300/25 bg-amber-500/12 px-4 py-2 backdrop-blur-sm",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-amber-200",children:"Visualizando conversa do historico (somente leitura)"}),(0,b.jsx)("button",{onClick:()=>w.useIntelligenceStore.getState().exitHistoryView(),className:"text-xs font-semibold text-amber-100 underline hover:text-amber-50",children:"Voltar para conversa ativa"})]})}),(0,b.jsx)(ar,{}),(0,b.jsx)("div",{ref:m,onScroll:D,className:"flex-1 overflow-y-auto p-4",children:(0,b.jsxs)("div",{className:"flex flex-col pb-4 max-w-3xl mx-auto w-full",children:[(0,b.jsx)("div",{className:"flex justify-center my-4",children:(0,b.jsx)("span",{className:"rounded-full border border-white/18 bg-white/8 px-3 py-1 text-[10px] font-medium uppercase tracking-wide text-slate-300 shadow-sm",children:new Date().toLocaleDateString("pt-BR",{weekday:"short",day:"2-digit",month:"short"})})}),J.map(({message:a,isGrouped:c,isLastInGroup:d})=>(0,b.jsx)(_,{message:a,isReadOnly:F,isGrouped:c,isLastInGroup:d},a.id)),s&&(0,b.jsxs)("div",{className:"flex gap-3 mt-2",children:[(0,b.jsx)("div",{className:"mt-1 flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-gradient-to-br from-cyan-500/80 to-blue-500/85 text-white shadow-sm ring-2 ring-white/20",children:(0,b.jsx)(h.Sparkles,{className:"h-4 w-4"})}),(0,b.jsxs)("div",{className:"flex h-10 items-center gap-1.5 rounded-2xl rounded-tl-sm border border-white/12 bg-slate-900/55 px-4 shadow-sm",children:[(0,b.jsx)("span",{className:"premium-glow-dot h-2 w-2 animate-bounce rounded-full bg-slate-300 [animation-delay:-0.3s]"}),(0,b.jsx)("span",{className:"premium-glow-dot h-2 w-2 animate-bounce rounded-full bg-slate-300 [animation-delay:-0.15s]"}),(0,b.jsx)("span",{className:"premium-glow-dot h-2 w-2 animate-bounce rounded-full bg-slate-300"})]})]}),0===E.length&&!s&&(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 text-center",children:[(0,b.jsx)("div",{className:"mb-4 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-cyan-500/80 to-blue-500/85 text-white shadow-lg",children:(0,b.jsx)(h.Sparkles,{className:"h-8 w-8"})}),(0,b.jsx)("h3",{className:"mb-1 font-heading text-lg font-bold text-slate-100",children:"Menux Intelligence"}),(0,b.jsxs)("p",{className:"max-w-sm text-sm text-slate-300",children:["Seu assistente de vendas inteligente. FaÃ§a perguntas, use comandos com ",(0,b.jsx)("kbd",{className:"rounded border border-white/18 bg-white/8 px-1 text-xs text-slate-100",children:"/"})," ou selecione um cliente para comecar."]})]})]})}),(0,b.jsx)(d.AnimatePresence,{children:G&&(0,b.jsx)(e.motion.button,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},exit:{opacity:0,y:8},transition:{duration:.18,ease:"easeOut"},onClick:()=>{C("smooth"),q(!0)},className:"absolute bottom-[104px] right-6 z-20 rounded-full border border-cyan-300/25 bg-slate-950/92 px-3 py-1.5 text-xs font-medium text-cyan-100 shadow-lg shadow-black/35 transition-colors hover:bg-slate-900",children:"Nova mensagem"})}),!F&&(0,b.jsx)(e.motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.28,ease:[.22,.61,.36,1]},className:"border-t border-white/10 bg-slate-950/28 p-4 pt-2 backdrop-blur-sm",children:(0,b.jsxs)("div",{className:"max-w-3xl mx-auto relative",children:[(0,b.jsx)(ab,{inputText:a,isVisible:g,onSelect:I,onClose:()=>{i(!1),f("")}}),j&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2 px-2",children:[(0,b.jsxs)("span",{className:"inline-flex items-center gap-1.5 rounded-full border border-cyan-300/30 bg-cyan-300/14 px-3 py-1 text-xs font-medium text-cyan-100",children:[(0,b.jsx)(n,{className:"h-3 w-3"}),j.command]}),(0,b.jsx)("button",{onClick:()=>{l(null),f(""),i(!1)},className:"text-[10px] text-slate-400 hover:text-slate-100",children:"Cancelar"})]}),v&&!j&&(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2 px-2",children:[(0,b.jsxs)("span",{className:"inline-flex items-center gap-1.5 rounded-full border border-emerald-300/25 bg-emerald-400/14 px-3 py-1 text-xs font-medium text-emerald-100",children:["hot"===v.temperature?"ðŸ”¥":"warm"===v.temperature?"ðŸŒ¡ï¸":"â„ï¸",v.cardName," Â· ",v.stageLabel]}),(0,b.jsx)("button",{onClick:()=>w.useIntelligenceStore.getState().setContextCard(null),className:"text-[10px] text-slate-400 hover:text-slate-100",children:"Remover"})]}),(0,b.jsxs)("div",{className:(0,k.cn)("relative flex items-end gap-2 rounded-[26px] border border-white/12 bg-slate-900/58 p-2 shadow-xl shadow-black/35 transition-all duration-200","focus-within:border-cyan-300/35 focus-within:ring-2 focus-within:ring-cyan-300/20"),children:[(0,b.jsx)("div",{className:"flex-1 py-3 min-h-[44px]",children:(0,b.jsx)("input",{ref:o,type:"text",value:a,onChange:a=>{let b=a.target.value;f(b),j||i(b.startsWith("/"))},onKeyDown:a=>{"Enter"===a.key&&!a.shiftKey&&(a.preventDefault(),g||H()),"Escape"===a.key&&j&&(l(null),f(""))},placeholder:K,maxLength:ap.INTELLIGENCE_LIMITS.MAX_USER_MESSAGE_LENGTH,className:"w-full border-none bg-transparent pl-2 text-sm font-medium text-slate-100 outline-none placeholder:text-slate-400",disabled:s})}),(0,b.jsx)("div",{className:"flex items-center gap-1 mb-0.5",children:(0,b.jsx)(u.Button,{size:"icon",className:(0,k.cn)("h-10 w-10 rounded-full shadow-md transition-all duration-200",a?"bg-brand text-white shadow-brand/20 hover:bg-brand-strong":"bg-slate-700/70 text-slate-300 hover:bg-slate-700"),disabled:!a.trim()||s,onClick:H,children:(0,b.jsx)(L.Send,{className:"h-4 w-4 ml-0.5"})})})]}),(0,b.jsxs)("div",{className:"mt-3 flex justify-between px-4",children:[(0,b.jsxs)("div",{className:"flex gap-4 text-[10px] font-medium text-slate-400",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("kbd",{className:"flex h-[18px] min-w-[18px] items-center justify-center rounded border border-white/16 bg-white/8 px-1 font-sans",children:"â†µ"}),"Enviar"]}),(0,b.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,b.jsx)("kbd",{className:"flex h-[18px] min-w-[18px] items-center justify-center rounded border border-white/16 bg-white/8 px-1 font-sans",children:"/"}),"Comandos"]}),x<10&&(0,b.jsxs)("span",{className:"text-amber-300",children:[x," consultas restantes"]})]}),(0,b.jsx)("p",{className:"text-[10px] text-slate-500",children:"Menux Intelligence pode cometer erros. Verifique as informacoes."})]})]})})]})}function ar(){let{proactiveSuggestions:a,dismissSuggestion:f,sendMessage:g}=(0,w.useIntelligenceStore)(),h=(0,c.useMemo)(()=>{let b=a.filter(a=>!a.dismissed);if(0===b.length)return null;let c={high:0,medium:1,low:2};return[...b].sort((a,b)=>c[a.priority]-c[b.priority])[0]},[a]);if(!h)return null;let i={high:{bg:"border-red-300/30 bg-red-500/12",text:"text-red-100",icon:(0,b.jsx)(M.AlertTriangle,{className:"h-4 w-4 text-red-200"})},medium:{bg:"border-amber-300/30 bg-amber-500/12",text:"text-amber-100",icon:(0,b.jsx)(O.TrendingUp,{className:"h-4 w-4 text-amber-200"})},low:{bg:"border-cyan-300/30 bg-cyan-500/12",text:"text-cyan-100",icon:(0,b.jsx)(N,{className:"h-4 w-4 text-cyan-200"})}}[h.priority];return(0,b.jsx)(d.AnimatePresence,{children:(0,b.jsxs)(e.motion.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.98},transition:{duration:.24,ease:[.22,.61,.36,1]},className:(0,k.cn)("flex items-center gap-3 border-b px-4 py-2.5",i.bg),children:[i.icon,(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:(0,k.cn)("text-xs font-semibold truncate",i.text),children:h.cardName?`${h.cardName} â€” ${h.message}`:h.message}),(0,b.jsx)("p",{className:"truncate text-[10px] capitalize text-slate-400",children:h.type.replace(/-/g," ")})]}),(0,b.jsx)("button",{onClick:()=>{g(h.cardName?`Analisar: ${h.cardName}`:`Analisar: ${h.message}`),f(h.id)},className:(0,k.cn)("shrink-0 rounded-full px-3 py-1 text-[10px] font-semibold transition-colors","high"===h.priority?"bg-red-500/20 text-red-100 hover:bg-red-500/28":"medium"===h.priority?"bg-amber-500/20 text-amber-100 hover:bg-amber-500/28":"bg-cyan-500/20 text-cyan-100 hover:bg-cyan-500/28"),children:"Investigar"}),(0,b.jsx)("button",{onClick:()=>f(h.id),className:"shrink-0 rounded-full p-1 text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-100",title:"Dispensar",children:(0,b.jsx)(j.X,{className:"h-3.5 w-3.5"})})]},h.id)})}var as=a.i(32860),at=a.i(66384),au=a.i(83077),av=a.i(5784),aw=a.i(67552),ax=a.i(39761);let ay=(0,f.default)("sunrise",[["path",{d:"M12 2v8",key:"1q4o3n"}],["path",{d:"m4.93 10.93 1.41 1.41",key:"2a7f42"}],["path",{d:"M2 18h2",key:"j10viu"}],["path",{d:"M20 18h2",key:"wocana"}],["path",{d:"m19.07 10.93-1.41 1.41",key:"15zs5n"}],["path",{d:"M22 22H2",key:"19qnx5"}],["path",{d:"m8 6 4-4 4 4",key:"ybng9g"}],["path",{d:"M16 18a4 4 0 0 0-8 0",key:"1lzouq"}]]);var az=a.i(58438);function aA(){let{contextCard:a,executeSlashCommand:f,proactiveSuggestions:g,dismissSuggestion:h,menuxIntelligenceMode:i}=(0,w.useIntelligenceStore)(),{opportunities:j}=(0,F.useOpportunityStore)(),l=(0,G.useAuthStore)(a=>a.user?.role),{priorities:m,insights:n,quickWins:o,riskAlerts:q}=(0,az.useExecutionPanelData)(),t=!!a,u=g.filter(a=>!a.dismissed),v={focus:{suggestions:!0,priorities:!0,actions:!0,insights:!1,quickWins:!1,risks:!1},audit:{suggestions:!1,priorities:!1,actions:!0,insights:!0,quickWins:!0,risks:!0},reply:{suggestions:!0,priorities:!0,actions:!0,insights:!1,quickWins:!1,risks:!1},proposal:{suggestions:!1,priorities:!1,actions:!0,insights:!0,quickWins:!0,risks:!1}},y=v[i]??v.focus,z={focus:["whatsapp","email","agendar","proposta","resumo","funil","riscos","planos"],audit:["resumo","funil","riscos","planos"],reply:["whatsapp","email","agendar"],proposal:["proposta","planos"]},A=z[i]??z.focus,B=(0,c.useMemo)(()=>"master"!==l&&"admin"!==l&&"comercial"!==l&&"cs"!==l?new Set:new Set((0,aa.getAvailableCommands)(l).map(a=>a.command)),[l]),D=[{key:"whatsapp",command:"/mensagem",icon:(0,b.jsx)(r.MessageSquare,{className:"h-3.5 w-3.5"}),label:"WhatsApp",color:"border-emerald-300/25 bg-emerald-400/12 text-emerald-100 hover:bg-emerald-400/18 hover:border-emerald-300/40",needsClient:!0},{key:"email",command:"/mensagem",icon:(0,b.jsx)(V.Mail,{className:"h-3.5 w-3.5"}),label:"Email",color:"border-cyan-300/25 bg-cyan-400/12 text-cyan-100 hover:bg-cyan-400/18 hover:border-cyan-300/40",needsClient:!0},{key:"agendar",command:"/followup",icon:(0,b.jsx)(R.Calendar,{className:"h-3.5 w-3.5"}),label:"Follow-up",color:"border-violet-300/25 bg-violet-400/12 text-violet-100 hover:bg-violet-400/18 hover:border-violet-300/40",needsClient:!0},{key:"proposta",command:"/pitch",icon:(0,b.jsx)(p.Target,{className:"h-3.5 w-3.5"}),label:"Pitch",color:"border-amber-300/25 bg-amber-400/12 text-amber-100 hover:bg-amber-400/18 hover:border-amber-300/40",needsClient:!0},{key:"resumo",command:"/resumo",icon:(0,b.jsx)(ay,{className:"h-3.5 w-3.5"}),label:"Resumo",color:"border-indigo-300/25 bg-indigo-400/12 text-indigo-100 hover:bg-indigo-400/18 hover:border-indigo-300/40",needsClient:!1},{key:"funil",command:"/funil",icon:(0,b.jsx)(O.TrendingUp,{className:"h-3.5 w-3.5"}),label:"Funil",color:"border-blue-300/25 bg-blue-400/12 text-blue-100 hover:bg-blue-400/18 hover:border-blue-300/40",needsClient:!1},{key:"riscos",command:"/riscos",icon:(0,b.jsx)(at.ShieldAlert,{className:"h-3.5 w-3.5"}),label:"Riscos",color:"border-rose-300/25 bg-rose-400/12 text-rose-100 hover:bg-rose-400/18 hover:border-rose-300/40",needsClient:!1},{key:"planos",command:"/planos",icon:(0,b.jsx)(S.FileText,{className:"h-3.5 w-3.5"}),label:"Planos",color:"border-slate-300/25 bg-slate-400/12 text-slate-100 hover:bg-slate-400/18 hover:border-slate-200/35",needsClient:!1}].filter(a=>A.includes(a.key)&&B.has(a.command)),[E,H]=(0,c.useState)({priorities:!0,actions:!0,insights:!0,quickWins:!1,risks:!0,suggestions:!0}),I=a=>{H(b=>({...b,[a]:!b[a]}))};return(0,b.jsx)("div",{className:"flex h-full flex-col overflow-y-auto bg-transparent",children:(0,b.jsxs)("div",{className:"p-5 space-y-6",children:[y.suggestions&&u.length>0&&(0,b.jsxs)("section",{children:[(0,b.jsx)(aB,{icon:(0,b.jsx)(ay,{className:"h-4 w-4 text-violet-500"}),title:"Sugestoes da Menux Intelligence",count:u.length,expanded:E.suggestions,onToggle:()=>I("suggestions"),accentColor:"violet"}),(0,b.jsx)(d.AnimatePresence,{children:E.suggestions&&(0,b.jsx)(e.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"space-y-2 mt-3",children:u.slice(0,5).map(a=>(0,b.jsxs)(e.motion.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:(0,k.cn)("rounded-lg border p-3 text-xs","high"===a.priority?"border-red-300/35 bg-red-500/12":"medium"===a.priority?"border-amber-300/35 bg-amber-500/12":"border-white/14 bg-white/7"),children:[(0,b.jsx)("p",{className:(0,k.cn)("leading-relaxed","high"===a.priority?"text-red-100":"medium"===a.priority?"text-amber-100":"text-slate-200"),children:a.message}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[a.cardName&&(0,b.jsx)("button",{onClick:()=>{let b=j.find(b=>b.id===a.cardId||b.clientName===a.cardName);b&&w.useIntelligenceStore.getState().selectClient({id:b.id,entityId:b.id,entityType:"opportunity",companyName:b.clientName??b.title,stage:b.stage,stageLabel:b.stage,temperature:b.temperature,lastContact:b.updatedAt,value:b.monthlyValue,tags:b.tags})},className:"text-[10px] font-medium text-cyan-200 hover:text-cyan-100",children:"Investigar â†’"}),(0,b.jsx)("button",{onClick:()=>h(a.id),className:"ml-auto text-[10px] text-slate-400 hover:text-slate-200",children:"Dispensar"})]})]},a.id))})})})]}),y.priorities&&(0,b.jsxs)("section",{children:[(0,b.jsx)(aB,{icon:(0,b.jsx)(C.Clock,{className:"h-4 w-4 text-red-500"}),title:"Prioridades de Hoje",count:m.length,expanded:E.priorities,onToggle:()=>I("priorities"),accentColor:"red"}),(0,b.jsx)(d.AnimatePresence,{children:E.priorities&&(0,b.jsx)(e.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:m.length>0?(0,b.jsx)("div",{className:"space-y-2 mt-3",children:m.map(a=>(0,b.jsx)(aC,{severity:a.severity,title:a.title,subtitle:a.subtitle,type:a.type,onClick:()=>{if(a.linkedEntityId){let b=j.find(b=>b.id===a.linkedEntityId);b&&w.useIntelligenceStore.getState().selectClient({id:b.id,entityId:b.id,entityType:"opportunity",companyName:b.clientName??b.title,stage:b.stage,stageLabel:b.stage,temperature:b.temperature,lastContact:b.updatedAt,value:b.monthlyValue,tags:b.tags})}}},a.id))}):(0,b.jsx)("div",{className:"rounded-lg border border-white/14 bg-slate-900/55 p-3 text-center mt-3",children:(0,b.jsx)("p",{className:"text-xs text-slate-400",children:"âœ… Nenhuma prioridade urgente."})})})})]}),y.actions&&(0,b.jsxs)("section",{children:[(0,b.jsx)(aB,{icon:(0,b.jsx)(s.Zap,{className:"h-4 w-4 text-amber-500 fill-amber-500"}),title:"Acoes Rapidas",expanded:E.actions,onToggle:()=>I("actions"),accentColor:"amber"}),(0,b.jsx)(d.AnimatePresence,{children:E.actions&&(0,b.jsx)(e.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,b.jsx)(x.TooltipProvider,{children:(0,b.jsx)("div",{className:"mt-3 grid grid-cols-1 gap-2 [@media(min-width:1200px)]:grid-cols-2",children:D.map(a=>(0,b.jsx)(aD,{icon:a.icon,label:a.label,color:a.color,onClick:()=>(a=>{switch(a){case"whatsapp":f("/mensagem","WhatsApp");break;case"email":f("/mensagem","email");break;case"agendar":f("/followup");break;case"proposta":f("/pitch");break;case"funil":f("/funil");break;case"planos":f("/planos");break;case"resumo":f("/resumo");break;case"riscos":f("/riscos")}})(a.key),disabled:a.needsClient&&!t,tooltip:a.needsClient&&!t?"Selecione um cliente primeiro":void 0},a.key))})})})})]}),y.insights&&n.length>0&&(0,b.jsxs)("section",{children:[(0,b.jsx)(aB,{icon:(0,b.jsx)(ax.BarChart3,{className:"h-4 w-4 text-indigo-500"}),title:"Insights Inteligentes",count:n.length,expanded:E.insights,onToggle:()=>I("insights"),accentColor:"indigo"}),(0,b.jsx)(d.AnimatePresence,{children:E.insights&&(0,b.jsx)(e.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"space-y-2 mt-3",children:n.map(a=>(0,b.jsx)(aE,{title:a.title,description:a.description,metric:a.metric,actionLabel:a.actionLabel,onAction:a.actionCommand?()=>f(a.actionCommand):void 0},a.id))})})})]}),y.quickWins&&o.length>0&&(0,b.jsxs)("section",{children:[(0,b.jsx)(aB,{icon:(0,b.jsx)(au.Trophy,{className:"h-4 w-4 text-emerald-500"}),title:"Ganhos Rapidos",count:o.length,expanded:E.quickWins,onToggle:()=>I("quickWins"),accentColor:"emerald"}),(0,b.jsx)(d.AnimatePresence,{children:E.quickWins&&(0,b.jsx)(e.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"space-y-2 mt-3",children:o.map(a=>(0,b.jsxs)("div",{onClick:()=>{let b=j.find(b=>b.id===a.opportunityId);b&&w.useIntelligenceStore.getState().selectClient({id:b.id,entityId:b.id,entityType:"opportunity",companyName:b.clientName??b.title,stage:b.stage,stageLabel:b.stage,temperature:b.temperature,lastContact:b.updatedAt,value:b.monthlyValue,tags:b.tags})},className:"group flex cursor-pointer items-center gap-3 rounded-lg border border-emerald-300/24 bg-emerald-400/8 p-3 transition-all hover:border-emerald-300/38 hover:shadow-sm",children:[(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"line-clamp-1 text-xs font-medium text-slate-100 transition-colors group-hover:text-emerald-100",children:a.clientName}),(0,b.jsxs)("p",{className:"text-[10px] text-slate-400 mt-0.5",children:[a.reason," Â· ",(0,af.formatCurrencyBRL)(a.value),"/mes"]})]}),(0,b.jsx)("div",{className:"shrink-0 flex items-center gap-1.5",children:(0,b.jsxs)("div",{className:(0,k.cn)("h-7 w-7 rounded-full flex items-center justify-center text-[10px] font-bold",a.probability>=70?"bg-emerald-400/20 text-emerald-100":a.probability>=50?"bg-amber-400/20 text-amber-100":"bg-slate-700/70 text-slate-200"),children:[a.probability,"%"]})})]},a.id))})})})]}),y.risks&&q.length>0&&(0,b.jsxs)("section",{children:[(0,b.jsx)(aB,{icon:(0,b.jsx)(at.ShieldAlert,{className:"h-4 w-4 text-red-500"}),title:"Alertas de Risco",count:q.length,expanded:E.risks,onToggle:()=>I("risks"),accentColor:"red"}),(0,b.jsx)(d.AnimatePresence,{children:E.risks&&(0,b.jsx)(e.motion.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:(0,b.jsx)("div",{className:"space-y-2 mt-3",children:q.map(a=>(0,b.jsxs)("div",{onClick:()=>{if(a.linkedEntityId){let b=j.find(b=>b.id===a.linkedEntityId);b&&w.useIntelligenceStore.getState().selectClient({id:b.id,entityId:b.id,entityType:"opportunity",companyName:b.clientName??b.title,stage:b.stage,stageLabel:b.stage,temperature:b.temperature,lastContact:b.updatedAt,value:b.monthlyValue,tags:b.tags})}},className:(0,k.cn)("rounded-lg border p-3 cursor-pointer transition-all","critical"===a.severity?"border-red-300/35 bg-red-500/12 hover:border-red-300/50":"border-amber-300/35 bg-amber-500/12 hover:border-amber-300/50"),children:[(0,b.jsx)("p",{className:(0,k.cn)("font-medium text-xs","critical"===a.severity?"text-red-100":"text-amber-100"),children:a.title}),(0,b.jsx)("p",{className:(0,k.cn)("text-[10px] mt-0.5","critical"===a.severity?"text-red-200":"text-amber-200"),children:a.description})]},a.id))})})})]}),a&&(0,b.jsxs)("section",{children:[(0,b.jsx)(aB,{icon:(0,b.jsx)(p.Target,{className:"h-4 w-4 text-violet-500"}),title:`Contexto: ${a.cardName}`,accentColor:"violet"}),(0,b.jsxs)("div",{className:"space-y-2 mt-3",children:[(0,b.jsx)(aE,{title:"hot"===a.temperature?"Lead quente!":"cold"===a.temperature?"Lead frio":"Lead morno",description:"hot"===a.temperature?"Momento ideal para avancar com proposta ou demonstracao.":"cold"===a.temperature?"Considere reengajamento antes de oferecer algo.":"Mantenha contato e identifique gatilhos de decisao.",actionLabel:"Analise completa",onAction:()=>f("/analise")}),a.registeredObjections.length>0&&(0,b.jsx)(aE,{title:`${a.registeredObjections.length} objecao(oes)`,description:"Use /objecao para preparar contra-argumentos personalizados.",actionLabel:"Quebrar objecao",onAction:()=>f("/objecao",a.registeredObjections[0])})]})]})]})})}function aB({icon:a,title:c,count:d,expanded:e,onToggle:f,accentColor:g="zinc"}){let h=(0,b.jsxs)(b.Fragment,{children:[a,(0,b.jsx)("h3",{className:"font-heading text-xs font-bold uppercase tracking-wider text-slate-400 flex-1 text-left",children:c}),"number"==typeof d&&d>0&&(0,b.jsx)("span",{className:(0,k.cn)("text-[10px] font-bold px-1.5 py-0.5 rounded-full","red"===g?"bg-red-500/22 text-red-100":"amber"===g?"bg-amber-500/22 text-amber-100":"emerald"===g?"bg-emerald-500/22 text-emerald-100":"violet"===g?"bg-violet-500/22 text-violet-100":"bg-indigo-500/22 text-indigo-100"),children:d})]});return f?(0,b.jsxs)("button",{type:"button",onClick:f,className:"flex items-center gap-2 w-full px-1 group",children:[h,(0,b.jsx)("span",{className:"text-slate-500 group-hover:text-slate-300 transition-colors",children:e?(0,b.jsx)(aw.ChevronUp,{className:"h-3.5 w-3.5"}):(0,b.jsx)(av.ChevronDown,{className:"h-3.5 w-3.5"})})]}):(0,b.jsx)("div",{className:"flex items-center gap-2 w-full px-1",children:h})}function aC({severity:a,title:c,subtitle:d,type:e,onClick:f}){return(0,b.jsxs)("div",{onClick:f,className:(0,k.cn)("group flex items-start gap-3 p-3 rounded-lg border transition-all cursor-pointer","critical"===a?"border-red-300/30 bg-red-500/11 hover:border-red-300/45":"warning"===a?"border-amber-300/30 bg-amber-500/11 hover:border-amber-300/45":"border-white/14 bg-white/7 hover:border-cyan-300/30"),children:[(0,b.jsx)("div",{className:(0,k.cn)("h-6 w-6 shrink-0 rounded-full flex items-center justify-center mt-0.5","critical"===a?"bg-red-400/20":"warning"===a?"bg-amber-400/20":"bg-slate-700/65"),children:"overdue"===e?(0,b.jsx)(M.AlertTriangle,{className:(0,k.cn)("h-3 w-3","critical"===a?"text-red-100":"text-amber-100")}):"sla-warning"===e?(0,b.jsx)(C.Clock,{className:"h-3 w-3 text-red-100"}):"hot-idle"===e?(0,b.jsx)(s.Zap,{className:"h-3 w-3 fill-amber-100 text-amber-100"}):(0,b.jsx)(R.Calendar,{className:"h-3 w-3 text-slate-200"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"font-medium text-xs text-slate-100 line-clamp-1",children:c}),(0,b.jsx)("p",{className:"text-[10px] text-slate-400 mt-0.5 line-clamp-1",children:d})]}),(0,b.jsx)(as.ArrowRight,{className:"h-3 w-3 text-slate-500 group-hover:text-slate-300 group-hover:translate-x-0.5 transition-all shrink-0 mt-1"})]})}function aD({label:a,icon:c,color:d,onClick:e,disabled:f,tooltip:g}){let h=(0,b.jsxs)("button",{onClick:f?void 0:e,disabled:f,className:(0,k.cn)("flex h-20 flex-col items-center justify-center gap-1.5 rounded-lg border p-2.5 text-sm font-medium transition-all",f?"cursor-not-allowed border-white/10 bg-slate-900/35 text-slate-500 opacity-50":d),children:[c,(0,b.jsx)("span",{className:"text-[10px]",children:a})]});return g?(0,b.jsxs)(x.Tooltip,{children:[(0,b.jsx)(x.TooltipTrigger,{asChild:!0,children:h}),(0,b.jsx)(x.TooltipContent,{side:"top",children:g})]}):h}function aE({title:a,description:c,metric:d,actionLabel:e,onAction:f}){return(0,b.jsxs)("div",{className:"group relative overflow-hidden rounded-lg border border-indigo-300/22 bg-indigo-400/8 p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("span",{className:"font-semibold text-xs text-slate-100",children:a}),d&&(0,b.jsxs)("span",{className:(0,k.cn)("text-xs font-bold","up"===d.trend?"text-emerald-200":"down"===d.trend?"text-red-200":"text-slate-400"),children:[d.value," ","up"===d.trend?"â†‘":"down"===d.trend?"â†“":"â†’"]})]}),(0,b.jsx)("p",{className:"text-[10px] text-slate-300 leading-relaxed",children:c}),e&&f&&(0,b.jsxs)(u.Button,{variant:"link",className:"mt-1 h-auto p-0 text-[10px] text-cyan-200 hover:text-cyan-100",onClick:f,children:[e," ",(0,b.jsx)(as.ArrowRight,{className:"h-2.5 w-2.5 ml-0.5"})]})]})}let aF={xl:"XL Â· 3 colunas",lg:"LG Â· Insights colapsÃ¡vel",md:"MD Â· 2 colunas + drawer",sm:"SM Â· Console + drawers",xs:"XS Â· Tabs internas"},aG=[{id:"client",label:"Cliente",icon:(0,b.jsx)(i.Users,{className:"h-3.5 w-3.5"})},{id:"console",label:"Console",icon:(0,b.jsx)(g,{className:"h-3.5 w-3.5"})},{id:"insights",label:"Insights",icon:(0,b.jsx)(h.Sparkles,{className:"h-3.5 w-3.5"})}];function aH(){let[a,f]=(0,c.useState)(()=>"xl"),[g,j]=(0,c.useState)("console"),[l,m]=(0,c.useState)({xl:{left:!0,right:!0},lg:{left:!0,right:!1},md:{left:!0,right:!1},sm:{left:!1,right:!1},xs:{left:!1,right:!1}});(0,c.useEffect)(()=>{let a=()=>{var a;return f((a=window.innerWidth)>=1440?"xl":a>=1200?"lg":a>=900?"md":a>=600?"sm":"xs")};return window.addEventListener("resize",a,{passive:!0}),()=>window.removeEventListener("resize",a)},[]);let n=l[a]?.left??!1,o=l[a]?.right??!1,p="xs"===a,q="xl"===a||"lg"===a||"md"===a&&n,r="xl"===a||"lg"===a&&o,s="sm"===a&&n,t=("md"===a||"sm"===a)&&o,u=(0,c.useMemo)(()=>{let a=[];return q&&a.push("minmax(280px, 360px)"),a.push("minmax(0, 1fr)"),r&&a.push("minmax(300px, 380px)"),a.join(" ")},[q,r]);return(0,b.jsxs)("div",{className:"menux-intelligence-theme menux-intelligence-theme-full dark flex h-full min-h-0 w-full flex-col overflow-hidden",children:[(0,b.jsx)(A,{}),!p&&"xl"!==a&&(0,b.jsxs)("div",{className:"z-[95] flex shrink-0 items-center gap-2 border-b border-white/10 bg-slate-950/30 px-4 py-2 backdrop-blur-sm",children:[("md"===a||"sm"===a)&&(0,b.jsx)(aI,{active:n,label:"Clientes",icon:(0,b.jsx)(i.Users,{className:"h-3.5 w-3.5"}),onClick:()=>{m(b=>{let c=b[a],d=!c.left;return{...b,[a]:{left:d,right:("sm"!==a||!d)&&c.right}}})}}),("lg"===a||"md"===a||"sm"===a)&&(0,b.jsx)(aI,{active:o,label:"Insights",icon:(0,b.jsx)(h.Sparkles,{className:"h-3.5 w-3.5"}),onClick:()=>{m(b=>{let c=b[a],d=!c.right;return{...b,[a]:{left:("sm"!==a||!d)&&c.left,right:d}}})}}),(0,b.jsx)("span",{className:"ml-auto text-[10px] font-semibold uppercase tracking-wide text-slate-400",children:aF[a]})]}),p?(0,b.jsxs)("div",{className:"flex min-h-0 flex-1 flex-col overflow-hidden",children:[(0,b.jsx)("div",{className:"z-[95] shrink-0 border-b border-white/10 bg-slate-950/28 p-3 backdrop-blur-sm",children:(0,b.jsx)("div",{className:"grid grid-cols-3 gap-1 rounded-full border border-white/12 bg-white/6 p-1",children:aG.map(a=>{let c=a.id===g;return(0,b.jsxs)("button",{onClick:()=>j(a.id),className:(0,k.cn)("relative flex items-center justify-center gap-1.5 rounded-full px-3 py-2 text-xs font-medium transition-colors",c?"bg-white/12 text-slate-100":"text-slate-300 hover:bg-white/8 hover:text-slate-100"),children:[a.icon,(0,b.jsx)("span",{children:a.label})]},a.id)})})}),(0,b.jsx)("div",{className:"relative min-h-0 flex-1 overflow-hidden",children:(0,b.jsx)(d.AnimatePresence,{mode:"wait",children:(0,b.jsxs)(e.motion.div,{initial:{opacity:0,y:6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},transition:{duration:.18,ease:"easeOut"},className:"h-full min-h-0 overflow-hidden",children:["client"===g&&(0,b.jsx)("section",{className:"menux-intelligence-surface h-full min-h-0 overflow-hidden",children:(0,b.jsx)(I,{})}),"console"===g&&(0,b.jsx)("section",{className:"h-full min-h-0 overflow-hidden",children:(0,b.jsx)(aq,{})}),"insights"===g&&(0,b.jsx)("section",{className:"menux-intelligence-surface h-full min-h-0 overflow-hidden",children:(0,b.jsx)(aA,{})})]},g)})})]}):(0,b.jsxs)("div",{className:"relative min-h-0 flex-1 overflow-hidden",children:[(0,b.jsxs)("div",{className:"grid h-full min-h-0 w-full overflow-hidden",style:{gridTemplateColumns:u},children:[q&&(0,b.jsx)("aside",{className:"menux-intelligence-surface min-h-0 min-w-0 overflow-hidden border-r border-white/10",children:(0,b.jsx)(I,{})}),(0,b.jsx)("main",{className:"relative min-h-0 min-w-0 overflow-hidden bg-transparent",children:(0,b.jsx)(aq,{})}),r&&(0,b.jsx)("aside",{className:"menux-intelligence-surface min-h-0 min-w-0 overflow-hidden border-l border-white/10 xl:sticky xl:top-0",children:(0,b.jsx)(aA,{})})]}),(0,b.jsx)(aJ,{open:s,side:"left",title:"Clientes",onClose:()=>m(b=>({...b,[a]:{...b[a],left:!1}})),children:(0,b.jsx)(I,{})}),(0,b.jsx)(aJ,{open:t,side:"right",title:"Insights",onClose:()=>m(b=>({...b,[a]:{...b[a],right:!1}})),children:(0,b.jsx)(aA,{})})]})]})}function aI({active:a,label:c,icon:d,onClick:e}){return(0,b.jsxs)("button",{onClick:e,className:(0,k.cn)("inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-xs font-medium transition-colors",a?"border-cyan-300/26 bg-cyan-500/16 text-cyan-100":"border-white/14 bg-white/7 text-slate-300 hover:bg-white/10 hover:text-slate-100"),children:[d,c]})}function aJ({open:a,side:c,title:f,onClose:g,children:h}){return(0,b.jsx)(d.AnimatePresence,{children:a&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.motion.button,{type:"button","aria-label":"Fechar painel",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.18,ease:"easeOut"},onClick:g,className:"absolute inset-0 z-[190] bg-black/46 backdrop-blur-[2px]"}),(0,b.jsx)(e.motion.aside,{initial:{x:"left"===c?"-100%":"100%"},animate:{x:0,transition:{duration:.22,ease:[.22,.61,.36,1]}},exit:{x:"left"===c?"-100%":"100%",transition:{duration:.18,ease:[.4,0,1,1]}},className:(0,k.cn)("absolute inset-y-0 z-[200] w-[min(88vw,420px)] overflow-hidden","left"===c?"left-0 border-r border-white/10":"right-0 border-l border-white/10"),children:(0,b.jsxs)("div",{className:"menux-intelligence-surface flex h-full min-h-0 flex-col",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between border-b border-white/10 px-4 py-3",children:[(0,b.jsx)("p",{className:"font-heading text-sm font-semibold text-slate-100",children:f}),(0,b.jsx)("button",{onClick:g,className:"rounded-lg p-1 text-slate-400 transition-colors hover:bg-white/10 hover:text-slate-100",children:(0,b.jsx)(j.X,{className:"h-4 w-4"})})]}),(0,b.jsx)("div",{className:"min-h-0 flex-1 overflow-hidden",children:h})]})})]})})}a.s(["IntelligenceLayout",()=>aH],37165)}];

//# sourceMappingURL=src_components_intelligence_intelligence-layout_tsx_bd7446cf._.js.map