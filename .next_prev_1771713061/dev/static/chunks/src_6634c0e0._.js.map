{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"skeleton\"\n      className={cn(\n        \"relative overflow-hidden rounded-md bg-slate-200/75\",\n        \"before:absolute before:inset-0 before:animate-pulse\",\n        \"before:bg-linear-to-r before:from-transparent before:via-white/70 before:to-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;;AAAA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAoC;IACpE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,uDACA,uDACA,2FACA;QAED,GAAG,KAAK;;;;;;AAGf;KAbS"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/shared/module-command-header.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport type { ReactNode } from \"react\";\nimport { cn } from \"@/lib/cn\";\n\ntype ChipTone = \"neutral\" | \"info\" | \"warning\" | \"danger\" | \"success\";\n\nexport interface ModuleCommandHeaderChip {\n  id: string;\n  label: string;\n  icon?: ReactNode;\n  tone?: ChipTone;\n  onClick?: () => void;\n  href?: string;\n}\n\ninterface ModuleCommandHeaderProps {\n  title: ReactNode;\n  titleAccessory?: ReactNode;\n  description?: string;\n  actions?: ReactNode;\n  actionsClassName?: string;\n  meta?: ReactNode;\n  chips?: ModuleCommandHeaderChip[];\n  fallbackChip?: ModuleCommandHeaderChip;\n  children?: ReactNode;\n  className?: string;\n  sticky?: boolean;\n}\n\nconst chipToneStyles: Record<ChipTone, string> = {\n  neutral: \"border-zinc-200 bg-white/92 text-zinc-700\",\n  info: \"border-sky-200 bg-sky-50/88 text-sky-700\",\n  warning: \"border-amber-200 bg-amber-50/88 text-amber-700\",\n  danger: \"border-red-200 bg-red-50/88 text-red-700\",\n  success: \"border-emerald-200 bg-emerald-50/88 text-emerald-700\",\n};\n\nfunction renderChip(chip: ModuleCommandHeaderChip) {\n  const isInteractive = Boolean(chip.href || chip.onClick);\n  const classes = cn(\n    \"premium-shine inline-flex h-8 shrink-0 items-center justify-center gap-1.5 rounded-full border px-3 text-[12px] font-semibold tracking-tight whitespace-nowrap\",\n    isInteractive\n      ? \"cursor-pointer transition-all duration-150 ease-out hover:bg-white/75 hover:-translate-y-[1px] active:scale-[0.99] active:translate-y-0\"\n      : \"cursor-default select-none opacity-90\",\n    chipToneStyles[chip.tone ?? \"neutral\"]\n  );\n\n  const content = (\n    <>\n      {chip.icon ? <span className=\"shrink-0\">{chip.icon}</span> : null}\n      <span>{chip.label}</span>\n    </>\n  );\n\n  if (chip.href) {\n    return (\n      <Link key={chip.id} href={chip.href} className={classes}>\n        {content}\n      </Link>\n    );\n  }\n\n  if (chip.onClick) {\n    return (\n      <button key={chip.id} type=\"button\" onClick={chip.onClick} className={classes}>\n        {content}\n      </button>\n    );\n  }\n\n  return (\n    <span key={chip.id} className={classes}>\n      {content}\n    </span>\n  );\n}\n\nexport function ModuleCommandHeader({\n  title,\n  titleAccessory,\n  description,\n  actions,\n  actionsClassName,\n  meta,\n  chips = [],\n  fallbackChip,\n  children,\n  className,\n  sticky = false,\n}: ModuleCommandHeaderProps) {\n  const hasChildrenRow = Boolean(children);\n  const hasMeta = Boolean(meta);\n  const hasChips = Boolean(chips.length > 0 || fallbackChip);\n  const hasLowerSection = hasChildrenRow || hasMeta || hasChips;\n  const hasLeftBlock = hasChildrenRow || hasMeta;\n\n  return (\n    <section\n      className={cn(\n        \"relative overflow-hidden rounded-[20px] border border-zinc-200/85 bg-zinc-50/88 px-5 pb-4 pt-3\",\n        \"shadow-[0_10px_24px_-20px_rgba(15,23,42,0.34)] backdrop-blur-sm\",\n        sticky && \"sticky top-4 z-30\",\n        className\n      )}\n    >\n      <div className=\"pointer-events-none absolute inset-0\">\n        <div className=\"absolute inset-x-0 top-0 h-14 bg-linear-to-b from-white/72 to-transparent\" />\n      </div>\n\n      <div className=\"relative z-10 space-y-3\">\n        <div className=\"flex flex-col gap-4 xl:flex-row xl:items-start xl:justify-between\">\n          <div className=\"min-w-0 flex-1 max-w-[600px]\">\n            <div className=\"flex min-w-0 items-center gap-2\">\n              <h1 className=\"min-w-0 font-heading text-2xl font-bold tracking-tight text-zinc-950 sm:text-3xl\">\n                {title}\n              </h1>\n              {titleAccessory ? <div className=\"shrink-0\">{titleAccessory}</div> : null}\n            </div>\n            {description ? (\n              <p className=\"mt-1 font-body text-[13.5px] text-zinc-600/90 leading-relaxed\">{description}</p>\n            ) : null}\n          </div>\n          {actions ? (\n            <div\n              className={cn(\n                \"flex w-full min-w-0 shrink-0 flex-wrap items-center gap-2 rounded-[20px] border border-zinc-200/85 bg-white/95 px-2 py-1.5 shadow-[0_8px_16px_-16px_rgba(15,23,42,0.36)]\",\n                \"xl:w-auto xl:max-w-full xl:justify-end\",\n                actionsClassName\n              )}\n            >\n              {actions}\n            </div>\n          ) : null}\n        </div>\n\n        {hasLowerSection ? (\n          <div className=\"border-t border-zinc-200/75 pt-3\">\n            <div className=\"flex flex-col gap-3 xl:flex-row xl:items-start xl:justify-between\">\n              {hasLeftBlock ? (\n                <div className=\"min-w-0 flex-1 space-y-2\">\n                  {meta ? <div className=\"text-xs text-zinc-500/80\">{meta}</div> : null}\n                  {hasChildrenRow ? <div>{children}</div> : null}\n                </div>\n              ) : null}\n\n              {hasChips ? (\n                <div\n                  className={cn(\n                    \"flex flex-wrap items-center gap-2 shrink-0 max-w-full\",\n                    hasLeftBlock ? \"xl:justify-end\" : \"justify-end\"\n                  )}\n                >\n                  {chips.length > 0 ? chips.map((chip) => renderChip(chip)) : null}\n                  {chips.length === 0 && fallbackChip ? renderChip(fallbackChip) : null}\n                </div>\n              ) : null}\n            </div>\n          </div>\n        ) : null}\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAJA;;;;AA+BA,MAAM,iBAA2C;IAC/C,SAAS;IACT,MAAM;IACN,SAAS;IACT,QAAQ;IACR,SAAS;AACX;AAEA,SAAS,WAAW,IAA6B;IAC/C,MAAM,gBAAgB,QAAQ,KAAK,IAAI,IAAI,KAAK,OAAO;IACvD,MAAM,UAAU,IAAA,yHAAE,EAChB,kKACA,gBACI,4IACA,yCACJ,cAAc,CAAC,KAAK,IAAI,IAAI,UAAU;IAGxC,MAAM,wBACJ;;YACG,KAAK,IAAI,iBAAG,6LAAC;gBAAK,WAAU;0BAAY,KAAK,IAAI;;;;;uBAAW;0BAC7D,6LAAC;0BAAM,KAAK,KAAK;;;;;;;;IAIrB,IAAI,KAAK,IAAI,EAAE;QACb,qBACE,6LAAC,0KAAI;YAAe,MAAM,KAAK,IAAI;YAAE,WAAW;sBAC7C;WADQ,KAAK,EAAE;;;;;IAItB;IAEA,IAAI,KAAK,OAAO,EAAE;QAChB,qBACE,6LAAC;YAAqB,MAAK;YAAS,SAAS,KAAK,OAAO;YAAE,WAAW;sBACnE;WADU,KAAK,EAAE;;;;;IAIxB;IAEA,qBACE,6LAAC;QAAmB,WAAW;kBAC5B;OADQ,KAAK,EAAE;;;;;AAItB;AAEO,SAAS,oBAAoB,EAClC,KAAK,EACL,cAAc,EACd,WAAW,EACX,OAAO,EACP,gBAAgB,EAChB,IAAI,EACJ,QAAQ,EAAE,EACV,YAAY,EACZ,QAAQ,EACR,SAAS,EACT,SAAS,KAAK,EACW;IACzB,MAAM,iBAAiB,QAAQ;IAC/B,MAAM,UAAU,QAAQ;IACxB,MAAM,WAAW,QAAQ,MAAM,MAAM,GAAG,KAAK;IAC7C,MAAM,kBAAkB,kBAAkB,WAAW;IACrD,MAAM,eAAe,kBAAkB;IAEvC,qBACE,6LAAC;QACC,WAAW,IAAA,yHAAE,EACX,kGACA,mEACA,UAAU,qBACV;;0BAGF,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;;;;;;;;;;0BAGjB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAG,WAAU;0DACX;;;;;;4CAEF,+BAAiB,6LAAC;gDAAI,WAAU;0DAAY;;;;;uDAAwB;;;;;;;oCAEtE,4BACC,6LAAC;wCAAE,WAAU;kDAAiE;;;;;+CAC5E;;;;;;;4BAEL,wBACC,6LAAC;gCACC,WAAW,IAAA,yHAAE,EACX,4KACA,0CACA;0CAGD;;;;;uCAED;;;;;;;oBAGL,gCACC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;gCACZ,6BACC,6LAAC;oCAAI,WAAU;;wCACZ,qBAAO,6LAAC;4CAAI,WAAU;sDAA4B;;;;;mDAAc;wCAChE,+BAAiB,6LAAC;sDAAK;;;;;mDAAkB;;;;;;2CAE1C;gCAEH,yBACC,6LAAC;oCACC,WAAW,IAAA,yHAAE,EACX,yDACA,eAAe,mBAAmB;;wCAGnC,MAAM,MAAM,GAAG,IAAI,MAAM,GAAG,CAAC,CAAC,OAAS,WAAW,SAAS;wCAC3D,MAAM,MAAM,KAAK,KAAK,eAAe,WAAW,gBAAgB;;;;;;2CAEjE;;;;;;;;;;;+BAGN;;;;;;;;;;;;;AAIZ;KArFgB"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/dashboard-store.ts"],"sourcesContent":["import { create } from 'zustand'\n\nexport type Period = 'today' | '7d' | '30d' | 'quarter'\nexport type Context = 'me' | 'team'\n\ninterface DashboardState {\n  period: Period\n  context: Context\n  setPeriod: (period: Period) => void\n  setContext: (context: Context) => void\n}\n\nexport const useDashboardStore = create<DashboardState>((set) => ({\n  period: 'today',\n  context: 'me',\n  setPeriod: (period) => set({ period }),\n  setContext: (context) => set({ context }),\n}))\n\n// ─── Pure utility: convert Period into a date range ────────────────────────\n\nexport function getPeriodDateRange(\n  period: Period,\n  now: Date\n): { start: Date; end: Date } {\n  const end = new Date(\n    now.getFullYear(),\n    now.getMonth(),\n    now.getDate(),\n    23, 59, 59, 999,\n  );\n\n  let start: Date;\n\n  switch (period) {\n    case \"today\":\n      start = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      break;\n    case \"7d\":\n      start = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 7);\n      break;\n    case \"30d\":\n      start = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 30);\n      break;\n    case \"quarter\": {\n      const quarterMonth = Math.floor(now.getMonth() / 3) * 3;\n      start = new Date(now.getFullYear(), quarterMonth, 1);\n      break;\n    }\n  }\n\n  return { start, end };\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAYO,MAAM,oBAAoB,IAAA,qJAAM,EAAiB,CAAC,MAAQ,CAAC;QAChE,QAAQ;QACR,SAAS;QACT,WAAW,CAAC,SAAW,IAAI;gBAAE;YAAO;QACpC,YAAY,CAAC,UAAY,IAAI;gBAAE;YAAQ;IACzC,CAAC;AAIM,SAAS,mBACd,MAAc,EACd,GAAS;IAET,MAAM,MAAM,IAAI,KACd,IAAI,WAAW,IACf,IAAI,QAAQ,IACZ,IAAI,OAAO,IACX,IAAI,IAAI,IAAI;IAGd,IAAI;IAEJ,OAAQ;QACN,KAAK;YACH,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO;YAC/D;QACF,KAAK;YACH,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO,KAAK;YACpE;QACF,KAAK;YACH,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO,KAAK;YACpE;QACF,KAAK;YAAW;gBACd,MAAM,eAAe,KAAK,KAAK,CAAC,IAAI,QAAQ,KAAK,KAAK;gBACtD,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,cAAc;gBAClD;YACF;IACF;IAEA,OAAO;QAAE;QAAO;IAAI;AACtB"}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-now.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\n\n/**\n * Hook that returns a reactive `Date` instance.\n * Updates automatically at the given interval (default: 60 seconds).\n * Ensures date-dependent logic (overdue, today, SLA risk) stays fresh\n * even if the user keeps the tab open across midnight.\n */\nexport function useNow(intervalMs = 60_000): Date {\n  const [now, setNow] = useState(() => new Date());\n\n  useEffect(() => {\n    const id = window.setInterval(() => setNow(new Date()), intervalMs);\n    return () => window.clearInterval(id);\n  }, [intervalMs]);\n\n  return now;\n}\n"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAUO,SAAS,OAAO,aAAa,MAAM;;IACxC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ;2BAAC,IAAM,IAAI;;IAEzC,IAAA,0KAAS;4BAAC;YACR,MAAM,KAAK,OAAO,WAAW;uCAAC,IAAM,OAAO,IAAI;sCAAS;YACxD;oCAAO,IAAM,OAAO,aAAa,CAAC;;QACpC;2BAAG;QAAC;KAAW;IAEf,OAAO;AACT;GATgB"}},
    {"offset": {"line": 350, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-dashboard-filters.ts"],"sourcesContent":["\"use client\";\n\n// ============================================================================\n// Hook centralizado de filtros do Dashboard\n// Todas as sections usam este hook para receber dados filtrados por\n// período (today/7d/30d/quarter) e contexto (me/team).\n// ============================================================================\n\nimport { useMemo } from \"react\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport {\n  useDashboardStore,\n  getPeriodDateRange,\n  type Period,\n  type Context,\n} from \"@/stores/dashboard-store\";\nimport { useNow } from \"@/hooks/use-now\";\nimport { getEffectiveActivityStatus } from \"@/lib/business-rules\";\nimport { filterByUser } from \"@/lib/proactive-engine/helpers\";\nimport type { Opportunity, Activity } from \"@/types\";\n\nexport interface DashboardFilters {\n  /** Opportunities filtered by period + context */\n  filteredOpportunities: Opportunity[];\n  /** Activities with effective status, filtered by period + context */\n  filteredActivities: (Activity & { effectiveStatus: Activity[\"status\"] })[];\n  /** All open opportunities (ignores period, respects context) */\n  openOpportunities: Opportunity[];\n  /** Reactive date that ticks every 60s */\n  now: Date;\n  period: Period;\n  context: Context;\n  userId: string;\n  userRole: string;\n}\n\nexport function useDashboardFilters(): DashboardFilters {\n  const opportunities = useOpportunityStore((s) => s.opportunities);\n  const activities = useActivityStore((s) => s.activities);\n  const user = useAuthStore((s) => s.user);\n  const period = useDashboardStore((s) => s.period);\n  const context = useDashboardStore((s) => s.context);\n  const now = useNow();\n\n  const userId = user?.id ?? \"\";\n  const userRole = user?.role ?? \"comercial\";\n\n  return useMemo(() => {\n    const { start, end } = getPeriodDateRange(period, now);\n\n    // ── Context filter ──────────────────────────────────────────────\n    const ctxOpps =\n      context === \"me\"\n        ? filterByUser(opportunities, userId, userRole)\n        : opportunities;\n\n    const ctxActs =\n      context === \"me\"\n        ? filterByUser(activities, userId, userRole)\n        : activities;\n\n    // ── Open opportunities (cumulative, no period filter) ───────────\n    const openOpportunities = ctxOpps.filter((o) => o.status === \"open\");\n\n    // ── Period filter for opportunities ─────────────────────────────\n    // Pipeline Total & SLA are cumulative; won/lost are period-scoped\n    const filteredOpportunities = ctxOpps.filter((o) => {\n      // Open opportunities always included (they are live)\n      if (o.status === \"open\") return true;\n      // Won/lost filtered by updatedAt within period\n      const ts = new Date(o.updatedAt);\n      return ts >= start && ts <= end;\n    });\n\n    // ── Period filter for activities + effective status ──────────────\n    const filteredActivities = ctxActs\n      .map((a) => ({\n        ...a,\n        effectiveStatus: getEffectiveActivityStatus(a, now),\n      }))\n      .filter((a) => {\n        // Pending/overdue always included\n        if (a.effectiveStatus === \"pending\" || a.effectiveStatus === \"overdue\")\n          return true;\n        // Completed/cancelled filtered by dueDate within period\n        const ts = new Date(a.dueDate);\n        return ts >= start && ts <= end;\n      });\n\n    return {\n      filteredOpportunities,\n      filteredActivities,\n      openOpportunities,\n      now,\n      period,\n      context,\n      userId,\n      userRole,\n    };\n  }, [opportunities, activities, period, context, now, userId, userRole]);\n}\n"],"names":[],"mappings":";;;;AAEA,+EAA+E;AAC/E,4CAA4C;AAC5C,oEAAoE;AACpE,uDAAuD;AACvD,+EAA+E;AAE/E;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;;AApBA;;;;;;;;;AAsCO,SAAS;;IACd,MAAM,gBAAgB,IAAA,+JAAmB;kEAAC,CAAC,IAAM,EAAE,aAAa;;IAChE,MAAM,aAAa,IAAA,yJAAgB;4DAAC,CAAC,IAAM,EAAE,UAAU;;IACvD,MAAM,OAAO,IAAA,iJAAY;kDAAC,CAAC,IAAM,EAAE,IAAI;;IACvC,MAAM,SAAS,IAAA,2JAAiB;yDAAC,CAAC,IAAM,EAAE,MAAM;;IAChD,MAAM,UAAU,IAAA,2JAAiB;0DAAC,CAAC,IAAM,EAAE,OAAO;;IAClD,MAAM,MAAM,IAAA,uIAAM;IAElB,MAAM,SAAS,MAAM,MAAM;IAC3B,MAAM,WAAW,MAAM,QAAQ;IAE/B,OAAO,IAAA,wKAAO;uCAAC;YACb,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,IAAA,4JAAkB,EAAC,QAAQ;YAElD,mEAAmE;YACnE,MAAM,UACJ,YAAY,OACR,IAAA,+JAAY,EAAC,eAAe,QAAQ,YACpC;YAEN,MAAM,UACJ,YAAY,OACR,IAAA,+JAAY,EAAC,YAAY,QAAQ,YACjC;YAEN,mEAAmE;YACnE,MAAM,oBAAoB,QAAQ,MAAM;iEAAC,CAAC,IAAM,EAAE,MAAM,KAAK;;YAE7D,mEAAmE;YACnE,kEAAkE;YAClE,MAAM,wBAAwB,QAAQ,MAAM;qEAAC,CAAC;oBAC5C,qDAAqD;oBACrD,IAAI,EAAE,MAAM,KAAK,QAAQ,OAAO;oBAChC,+CAA+C;oBAC/C,MAAM,KAAK,IAAI,KAAK,EAAE,SAAS;oBAC/B,OAAO,MAAM,SAAS,MAAM;gBAC9B;;YAEA,oEAAoE;YACpE,MAAM,qBAAqB,QACxB,GAAG;kEAAC,CAAC,IAAM,CAAC;wBACX,GAAG,CAAC;wBACJ,iBAAiB,IAAA,gKAA0B,EAAC,GAAG;oBACjD,CAAC;iEACA,MAAM;kEAAC,CAAC;oBACP,kCAAkC;oBAClC,IAAI,EAAE,eAAe,KAAK,aAAa,EAAE,eAAe,KAAK,WAC3D,OAAO;oBACT,wDAAwD;oBACxD,MAAM,KAAK,IAAI,KAAK,EAAE,OAAO;oBAC7B,OAAO,MAAM,SAAS,MAAM;gBAC9B;;YAEF,OAAO;gBACL;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;YACF;QACF;sCAAG;QAAC;QAAe;QAAY;QAAQ;QAAS;QAAK;QAAQ;KAAS;AACxE;GAhEgB;;QACQ,+JAAmB;QACtB,yJAAgB;QACtB,iJAAY;QACV,2JAAiB;QAChB,2JAAiB;QACrB,uIAAM"}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/header.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport type { LucideIcon } from \"lucide-react\";\nimport {\n  AlertTriangle,\n  Calendar,\n  ChevronDown,\n  LayoutGrid,\n  ShieldAlert,\n  User,\n  Users,\n  Wallet,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  ModuleCommandHeader,\n  type ModuleCommandHeaderChip,\n} from \"@/components/shared/module-command-header\";\nimport { cn } from \"@/lib/cn\";\nimport { useDashboardStore, type Period, type Context } from \"@/stores/dashboard-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport { formatCurrencyBRL } from \"@/lib/business-rules\";\nimport { usePathname, useRouter } from \"next/navigation\";\n\nconst periodLabels: Record<Period, string> = {\n  today: \"Hoje\",\n  \"7d\": \"7 dias\",\n  \"30d\": \"30 dias\",\n  quarter: \"Trimestre\",\n};\n\nconst contextLabels: Record<Context, { label: string; icon: typeof User }> = {\n  me: { label: \"Eu\", icon: User },\n  team: { label: \"Time\", icon: Users },\n};\n\ntype IndicatorTone = \"danger\" | \"warning\" | \"info\";\ntype IndicatorId = \"overdue\" | \"sla\" | \"risk\";\n\ninterface IndicatorChip {\n  id: IndicatorId;\n  value: string;\n  label: string;\n  icon: LucideIcon;\n  tone: IndicatorTone;\n}\n\nfunction toPtBrCompactDate(date: Date): string {\n  const formatter = new Intl.DateTimeFormat(\"pt-BR\", {\n    weekday: \"short\",\n    day: \"2-digit\",\n    month: \"short\",\n    timeZone: \"America/Sao_Paulo\",\n  });\n  const parts = formatter.formatToParts(date);\n  const weekdayRaw = parts.find((part) => part.type === \"weekday\")?.value ?? \"\";\n  const day = parts.find((part) => part.type === \"day\")?.value ?? \"\";\n  const monthRaw = parts.find((part) => part.type === \"month\")?.value ?? \"\";\n  const weekday = weekdayRaw.replaceAll(\".\", \"\").trim();\n  const month = monthRaw.replaceAll(\".\", \"\").trim();\n  const weekdayCapitalized = weekday.charAt(0).toUpperCase() + weekday.slice(1);\n  return `${weekdayCapitalized}, ${day} ${month}`;\n}\n\nexport function DashboardHeader() {\n  const router = useRouter();\n  const pathname = usePathname();\n  const { period, setPeriod, context, setContext } = useDashboardStore();\n  const { user, isLoading } = useAuthStore();\n  const [retryingIndicators, setRetryingIndicators] = useState(false);\n\n  const {\n    filteredActivities,\n    openOpportunities,\n    now,\n  } = useDashboardFilters();\n\n  const firstName = user?.name?.trim().split(\" \")[0] ?? \"Admin\";\n  const userRole = user?.role ?? \"comercial\";\n  const isBroadRole = userRole === \"master\" || userRole === \"admin\";\n\n  // ── Compute indicators from real store data ─────────────────────\n  const overdueCount = filteredActivities.filter(\n    (a) => a.effectiveStatus === \"overdue\"\n  ).length;\n\n  const slaBreachedOpps = openOpportunities.filter(\n    (o) => o.slaDeadline && new Date(o.slaDeadline) < now\n  );\n  const slaBreaches = slaBreachedOpps.length;\n  const riskValue = slaBreachedOpps.reduce((sum, o) => sum + (o.value || 0), 0);\n\n  const hasIndicatorsError =\n    !Number.isFinite(overdueCount) ||\n    !Number.isFinite(slaBreaches) ||\n    !Number.isFinite(riskValue);\n\n  const indicators: IndicatorChip[] = [\n    overdueCount > 0\n      ? {\n          id: \"overdue\",\n          value: `${overdueCount}`,\n          label: \"atrasadas\",\n          icon: AlertTriangle,\n          tone: \"danger\",\n        }\n      : null,\n    slaBreaches > 0\n      ? {\n          id: \"sla\",\n          value: `${slaBreaches}`,\n          label: \"SLAs estourados\",\n          icon: ShieldAlert,\n          tone: \"warning\",\n        }\n      : null,\n    riskValue > 0\n      ? {\n          id: \"risk\",\n          value: formatCurrencyBRL(riskValue),\n          label: \"valor em risco\",\n          icon: Wallet,\n          tone: \"info\",\n        }\n      : null,\n  ].filter((chip): chip is IndicatorChip => Boolean(chip)).slice(0, 3);\n\n  const compactDateText = `${toPtBrCompactDate(now)} · Olá, ${firstName}`;\n\n  const handleIndicatorClick = (id: IndicatorId) => {\n    if (id === \"overdue\") {\n      router.push(\"/activities?status=overdue\");\n      return;\n    }\n\n    const targetId = id === \"sla\" ? \"dashboard-execution\" : \"dashboard-funnel\";\n    const target = document.getElementById(targetId);\n    if (target) {\n      target.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n      return;\n    }\n    if (pathname !== \"/dashboard\") {\n      router.push(`/dashboard#${targetId}`);\n    }\n  };\n\n  const handleRetryIndicators = () => {\n    setRetryingIndicators(true);\n    router.refresh();\n    window.setTimeout(() => setRetryingIndicators(false), 220);\n  };\n\n  const indicatorChips: ModuleCommandHeaderChip[] = hasIndicatorsError\n    ? []\n    : indicators.map((chip) => {\n        const Icon = chip.icon;\n        return {\n          id: chip.id,\n          label: `${chip.value} ${chip.label}`,\n          icon: <Icon className=\"h-3.5 w-3.5\" />,\n          tone:\n            chip.tone === \"danger\"\n              ? \"danger\"\n              : chip.tone === \"warning\"\n                ? \"warning\"\n                : \"info\",\n          onClick: () => handleIndicatorClick(chip.id),\n        };\n      });\n\n  const fallbackChip: ModuleCommandHeaderChip = {\n    id: \"dashboard-empty\",\n    label: \"Sem dados do dia · Ver pipeline\",\n    icon: <LayoutGrid className=\"h-3.5 w-3.5 text-zinc-500\" />,\n    onClick: () => router.push(\"/pipes\"),\n    tone: \"neutral\",\n  };\n\n  const ContextIcon = contextLabels[context].icon;\n\n  const actions = (\n    <div\n      className={cn(\n        \"flex w-full flex-wrap items-center justify-end gap-2\",\n        isLoading && \"pointer-events-none opacity-60\"\n      )}\n    >\n      {/* Context toggle (Eu / Time) */}\n      {isBroadRole && (\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button\n              variant=\"outline\"\n              className=\"premium-shine h-8 gap-1.5 rounded-full border-zinc-200 bg-white/90 px-3 text-sm font-medium hover:bg-zinc-100/80 active:scale-[0.99]\"\n            >\n              <ContextIcon className=\"h-3.5 w-3.5 text-zinc-500\" />\n              {contextLabels[context].label}\n              <ChevronDown className=\"h-3.5 w-3.5 text-zinc-400\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\" className=\"w-36 rounded-xl\">\n            {(Object.keys(contextLabels) as Context[]).map((value) => {\n              const Ic = contextLabels[value].icon;\n              return (\n                <DropdownMenuItem\n                  key={value}\n                  onClick={() => setContext(value)}\n                  className=\"gap-2\"\n                >\n                  {context === value ? (\n                    <div className=\"h-1.5 w-1.5 rounded-full bg-brand\" />\n                  ) : (\n                    <Ic className=\"h-3.5 w-3.5 text-zinc-400\" />\n                  )}\n                  <span className={context === value ? \"font-medium\" : \"\"}>\n                    {contextLabels[value].label}\n                  </span>\n                </DropdownMenuItem>\n              );\n            })}\n          </DropdownMenuContent>\n        </DropdownMenu>\n      )}\n\n      {/* Period selector */}\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button\n            variant=\"outline\"\n            className=\"premium-shine h-8 gap-1.5 rounded-full border-zinc-200 bg-white/90 px-3 text-sm font-medium hover:bg-zinc-100/80 active:scale-[0.99]\"\n          >\n            <LayoutGrid className=\"h-3.5 w-3.5 text-zinc-500\" />\n            {periodLabels[period]}\n            <ChevronDown className=\"h-3.5 w-3.5 text-zinc-400\" />\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent align=\"end\" className=\"w-40 rounded-xl\">\n          {(Object.keys(periodLabels) as Period[]).map((value) => (\n            <DropdownMenuItem\n              key={value}\n              onClick={() => setPeriod(value)}\n              className=\"gap-2\"\n            >\n              {period === value ? (\n                <div className=\"h-1.5 w-1.5 rounded-full bg-brand\" />\n              ) : null}\n              <span className={period === value ? \"font-medium\" : \"\"}>\n                {periodLabels[value]}\n              </span>\n            </DropdownMenuItem>\n          ))}\n        </DropdownMenuContent>\n      </DropdownMenu>\n\n    </div>\n  );\n\n  return (\n    <ModuleCommandHeader\n      title=\"Dashboard\"\n      description=\"Raio X do comercial\"\n      sticky\n      actions={actions}\n      meta={\n        <span className=\"inline-flex items-center gap-1.5\">\n          <Calendar className=\"h-3.5 w-3.5\" />\n          {compactDateText}\n        </span>\n      }\n      chips={indicatorChips}\n      fallbackChip={fallbackChip}\n      className=\"premium-panel\"\n    >\n      {isLoading ? (\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <Skeleton className=\"h-8 w-[110px] rounded-full\" />\n          <Skeleton className=\"h-8 w-[128px] rounded-full\" />\n          <Skeleton className=\"h-8 w-[142px] rounded-full\" />\n        </div>\n      ) : null}\n\n      {hasIndicatorsError ? (\n        <div className=\"inline-flex items-center gap-2 rounded-full border border-red-200 bg-red-50/90 px-3 py-1.5 text-xs text-red-700\">\n          <AlertTriangle className=\"h-3.5 w-3.5\" />\n          Falha ao carregar indicadores.\n          <button\n            type=\"button\"\n            onClick={handleRetryIndicators}\n            className=\"font-semibold underline underline-offset-4\"\n          >\n            {retryingIndicators ? \"Tentando...\" : \"Tentar novamente\"}\n          </button>\n        </div>\n      ) : null}\n    </ModuleCommandHeader>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 909, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/kpi-section.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { motion, animate, useMotionValue } from \"framer-motion\";\nimport {\n  ChevronRight,\n  Clock3,\n  Gauge,\n  ShieldAlert,\n  TrendingUp\n} from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { cn } from \"@/lib/utils\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport { getPeriodDateRange } from \"@/stores/dashboard-store\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { filterByUser } from \"@/lib/proactive-engine/helpers\";\nimport type { Opportunity } from \"@/types\";\nimport { cardStaggerContainer, listItemReveal } from \"@/lib/motion\";\n\ntype KPIState = \"default\" | \"loading\" | \"error\";\ntype ChipTone = \"neutral\" | \"info\" | \"warning\" | \"danger\" | \"success\";\n\nconst STALE_ACTIVITY_DAYS = 5;\nconst SLA_RISK_WINDOW_HOURS = 24;\nconst DAY_MS = 24 * 60 * 60 * 1000;\n\ninterface KPIChip {\n  id: string;\n  label: string;\n  tone: ChipTone;\n}\n\ninterface KPIAction {\n  label: string;\n  targetPath: string;\n}\n\ninterface KPIData {\n  label: string;\n  value: number;\n  valueFormat: \"currency\" | \"percent\" | \"integer\";\n  valueSuffix?: string;\n  subtext: string;\n  chips: KPIChip[];\n  line4Text?: string;\n  detailAction?: KPIAction;\n  microText?: string;\n  targetPath: string;\n  disabled?: boolean;\n  state?: KPIState;\n}\n\nfunction isSlaBreached(slaDeadline: string | undefined, now: Date): boolean {\n  return Boolean(slaDeadline) && new Date(slaDeadline as string) < now;\n}\n\nfunction isSlaAtRisk(slaDeadline: string | undefined, now: Date): boolean {\n  if (!slaDeadline) return false;\n  const deadline = new Date(slaDeadline);\n  const hoursLeft = (deadline.getTime() - now.getTime()) / (1000 * 60 * 60);\n  return hoursLeft > 0 && hoursLeft <= SLA_RISK_WINDOW_HOURS;\n}\n\nfunction calculateConversionInRange(\n  opportunities: Opportunity[],\n  start: Date,\n  end: Date\n): { won: number; total: number; rate: number } {\n  const closed = opportunities.filter((opportunity) => {\n    if (opportunity.status !== \"won\" && opportunity.status !== \"lost\") return false;\n    const updatedAt = new Date(opportunity.updatedAt);\n    return updatedAt >= start && updatedAt <= end;\n  });\n\n  const won = closed.filter((opportunity) => opportunity.status === \"won\").length;\n  const total = closed.length;\n  const rate = total > 0 ? (won / total) * 100 : 0;\n\n  return { won, total, rate };\n}\n\nfunction useKpiData(): Record<\"pipeline\" | \"conversion\" | \"activities\" | \"sla\", KPIData> {\n  const {\n    filteredActivities,\n    openOpportunities,\n    now,\n    period,\n    context,\n    userId,\n    userRole,\n  } = useDashboardFilters();\n  const opportunities = useOpportunityStore((state) => state.opportunities);\n\n  return useMemo(() => {\n    const openOpps = openOpportunities;\n    const scopedOpportunities =\n      context === \"me\"\n        ? filterByUser(opportunities, userId, userRole)\n        : opportunities;\n\n    const { start, end } = getPeriodDateRange(period, now);\n    const rangeSizeMs = end.getTime() - start.getTime() + 1;\n    const previousEnd = new Date(start.getTime() - 1);\n    const previousStart = new Date(previousEnd.getTime() - rangeSizeMs + 1);\n\n    const currentConversion = calculateConversionInRange(scopedOpportunities, start, end);\n    const previousConversion = calculateConversionInRange(\n      scopedOpportunities,\n      previousStart,\n      previousEnd\n    );\n    const hasCurrentConversionData = currentConversion.total > 0;\n    const hasPreviousBase = previousConversion.total > 0;\n    const conversionDelta = hasPreviousBase\n      ? currentConversion.rate - previousConversion.rate\n      : null;\n\n    const pipelineTotal = openOpps.reduce((sum, o) => sum + (o.value || 0), 0);\n\n    const pendingActivities = filteredActivities.filter(\n      (a) => a.effectiveStatus === \"pending\" || a.effectiveStatus === \"overdue\"\n    );\n    const overdueActivityCount = filteredActivities.filter(\n      (a) => a.effectiveStatus === \"overdue\"\n    ).length;\n\n    const todayIso = now.toISOString().slice(0, 10);\n    const todayPendingCount = filteredActivities.filter(\n      (a) => a.effectiveStatus === \"pending\" && a.dueDate === todayIso\n    ).length;\n\n    const staleThreshold = now.getTime() - STALE_ACTIVITY_DAYS * DAY_MS;\n    const staleCount = openOpps.filter(\n      (opportunity) => new Date(opportunity.updatedAt).getTime() < staleThreshold\n    ).length;\n\n    const slaBreachedCount = openOpps.filter((o) => isSlaBreached(o.slaDeadline, now)).length;\n    const slaRiskCount = openOpps.filter((o) => isSlaAtRisk(o.slaDeadline, now)).length;\n    const riskPct =\n      openOpps.length > 0\n        ? Math.round(((slaBreachedCount + slaRiskCount) / openOpps.length) * 100)\n        : 0;\n\n    const conversionChips: KPIChip[] = [];\n    if (hasCurrentConversionData && conversionDelta !== null) {\n      if (conversionDelta > 0) {\n        conversionChips.push({\n          id: \"conversion-up\",\n          label: `Alta +${conversionDelta.toFixed(1)} p.p.`,\n          tone: \"success\",\n        });\n      } else if (conversionDelta < 0) {\n        conversionChips.push({\n          id: \"conversion-down\",\n          label: `Queda ${Math.abs(conversionDelta).toFixed(1)} p.p.`,\n          tone: \"danger\",\n        });\n      } else {\n        conversionChips.push({\n          id: \"conversion-flat\",\n          label: \"Estavel 0.0 p.p.\",\n          tone: \"neutral\",\n        });\n      }\n    }\n\n    const activityChips: KPIChip[] = [];\n    if (overdueActivityCount > 0) {\n      activityChips.push({\n        id: \"activities-overdue\",\n        label: `Atrasadas: ${overdueActivityCount}`,\n        tone: \"danger\",\n      });\n    }\n    if (todayPendingCount > 0) {\n      activityChips.push({\n        id: \"activities-today\",\n        label: `Hoje: ${todayPendingCount}`,\n        tone: \"warning\",\n      });\n    }\n    if (activityChips.length === 0) {\n      activityChips.push({\n        id: \"activities-ok\",\n        label: \"OK\",\n        tone: \"success\",\n      });\n    }\n\n    const slaChips: KPIChip[] = [];\n    if (slaBreachedCount > 0) {\n      slaChips.push({\n        id: \"sla-overdue\",\n        label: `Estourados: ${slaBreachedCount}`,\n        tone: \"danger\",\n      });\n    }\n    if (slaRiskCount > 0) {\n      slaChips.push({\n        id: \"sla-risk\",\n        label: `Em risco: ${slaRiskCount}`,\n        tone: \"warning\",\n      });\n    }\n    if (slaChips.length === 0) {\n      slaChips.push({\n        id: \"sla-ok\",\n        label: \"OK\",\n        tone: \"success\",\n      });\n    }\n\n    const pipelineChips: KPIChip[] = [];\n    if (slaBreachedCount > 0) {\n      pipelineChips.push({\n        id: \"pipeline-overdue\",\n        label: `Estourados: ${slaBreachedCount}`,\n        tone: \"danger\",\n      });\n    }\n\n    const slaTargetPath = slaBreachedCount > 0\n      ? \"/pipes?filter=sla_overdue\"\n      : \"/pipes?filter=sla_risk\";\n\n    return {\n      pipeline: {\n        label: \"Pipeline Total\",\n        value: pipelineTotal,\n        valueFormat: \"currency\",\n        subtext: `${openOpps.length} oportunidades abertas`,\n        chips: pipelineChips,\n        line4Text: pipelineChips.length === 0 && staleCount === 0 ? \"Sem alertas hoje\" : undefined,\n        detailAction:\n          staleCount > 0\n            ? { label: \"Ver sem atividade\", targetPath: \"/pipes?filter=stale\" }\n            : undefined,\n        targetPath: \"/pipes\",\n        state: \"default\",\n      },\n      conversion: {\n        label: \"Conversão Global\",\n        value: currentConversion.rate,\n        valueFormat: \"percent\",\n        subtext: hasCurrentConversionData\n          ? `Ganhos no período: ${currentConversion.won}`\n          : \"Sem dados no período\",\n        chips: conversionChips,\n        line4Text: hasCurrentConversionData\n          ? hasPreviousBase\n            ? undefined\n            : \"Sem base comparável\"\n          : \"Ajuste o período para comparar.\",\n        disabled: !hasCurrentConversionData,\n        targetPath: \"/dashboard?view=conversion\",\n        state: \"default\",\n      },\n      activities: {\n        label: \"Atividades\",\n        value: pendingActivities.length,\n        valueFormat: \"integer\",\n        subtext: `${overdueActivityCount} atrasadas · ${todayPendingCount} para hoje`,\n        chips: activityChips.slice(0, 2),\n        targetPath: \"/activities?statuses=pending,overdue\",\n        state: \"default\",\n      },\n      sla: {\n        label: \"SLA Crítico\",\n        value: slaBreachedCount,\n        valueFormat: \"integer\",\n        valueSuffix: \"estourados\",\n        subtext: `${slaRiskCount} em risco`,\n        chips: slaChips.slice(0, 2),\n        detailAction:\n          slaBreachedCount > 0 || slaRiskCount > 0\n            ? { label: \"Ver deals\", targetPath: slaTargetPath }\n            : undefined,\n        microText: `${riskPct}% da carteira em risco`,\n        targetPath: slaTargetPath,\n        state: \"default\",\n      },\n    };\n  }, [\n    filteredActivities,\n    openOpportunities,\n    now,\n    period,\n    context,\n    userId,\n    userRole,\n    opportunities,\n  ]);\n}\n\nfunction formatKpiValue(value: number, format: KPIData[\"valueFormat\"]): string {\n  if (format === \"currency\") {\n    return new Intl.NumberFormat(\"pt-BR\", {\n      style: \"currency\",\n      currency: \"BRL\",\n      maximumFractionDigits: 0,\n    }).format(value);\n  }\n\n  if (format === \"percent\") {\n    return `${value.toFixed(1)}%`;\n  }\n\n  return Math.round(value).toString();\n}\n\nfunction AnimatedKpiValue({\n  value,\n  format,\n}: {\n  value: number;\n  format: KPIData[\"valueFormat\"];\n}) {\n  const motionValue = useMotionValue(value);\n  const [displayValue, setDisplayValue] = useState(value);\n\n  useEffect(() => {\n    const unsubscribe = motionValue.on(\"change\", (latest) => {\n      setDisplayValue(latest);\n    });\n    return unsubscribe;\n  }, [motionValue]);\n\n  useEffect(() => {\n    const controls = animate(motionValue, value, {\n      duration: 0.22,\n      ease: [0.22, 0.61, 0.36, 1],\n    });\n    return controls.stop;\n  }, [motionValue, value]);\n\n  return <>{formatKpiValue(displayValue, format)}</>;\n}\n\nfunction KpiChipBadge({ chip }: { chip: KPIChip }) {\n  return (\n    <span\n      className={cn(\n        \"inline-flex h-[24px] max-w-full items-center rounded-full border px-2.5 text-[11px] font-semibold tracking-tight whitespace-nowrap\",\n        chip.tone === \"neutral\" && \"border-zinc-200 bg-zinc-100 text-zinc-700\",\n        chip.tone === \"info\" && \"border-blue-200 bg-blue-50 text-blue-700\",\n        chip.tone === \"warning\" && \"border-amber-200 bg-amber-50 text-amber-700\",\n        chip.tone === \"danger\" && \"border-red-200 bg-red-50 text-red-700\",\n        chip.tone === \"success\" && \"border-emerald-200 bg-emerald-50 text-emerald-700\"\n      )}\n      title={chip.label}\n    >\n      <span className=\"truncate\">{chip.label}</span>\n    </span>\n  );\n}\n\nfunction KPITemplateCard({\n  icon,\n  data,\n  onNavigate,\n  onRetry,\n}: {\n  icon: React.ReactNode;\n  data: KPIData;\n  onNavigate: (path: string) => void;\n  onRetry: () => void;\n}) {\n  const state = data.state ?? \"default\";\n  const isInteractive = state === \"default\" && !data.disabled;\n  const chips = data.chips.slice(0, 2);\n  const hasOverflow = data.chips.length > 2;\n  const detailAction = hasOverflow\n    ? { label: \"Ver detalhes\", targetPath: data.targetPath }\n    : data.detailAction;\n\n  function handleCardAction() {\n    if (!isInteractive) return;\n    onNavigate(data.targetPath);\n  }\n\n  function handleCardKeyDown(event: React.KeyboardEvent<HTMLElement>) {\n    if (!isInteractive) return;\n    if (event.key === \"Enter\" || event.key === \" \") {\n      event.preventDefault();\n      onNavigate(data.targetPath);\n    }\n  }\n\n  return (\n    <motion.article\n      onClick={handleCardAction}\n      onKeyDown={handleCardKeyDown}\n      role={isInteractive ? \"button\" : undefined}\n      tabIndex={isInteractive ? 0 : -1}\n      aria-disabled={!isInteractive}\n      whileTap={isInteractive ? { scale: 0.99 } : undefined}\n      transition={{ duration: 0.09, ease: \"easeInOut\" }}\n      className={cn(\n        \"premium-shine group flex min-h-[178px] w-full flex-col rounded-[24px] border border-zinc-200/80 bg-white/90 p-5 text-left\",\n        \"shadow-(--shadow-bento-sm) transition-[transform,box-shadow,border-color] duration-150 ease-out\",\n        isInteractive && \"cursor-pointer hover:-translate-y-[2px] hover:shadow-(--shadow-bento-sm-hover)\",\n        \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/25\"\n      )}\n    >\n      {state === \"loading\" ? (\n        <div className=\"flex h-full flex-col gap-4\">\n          <Skeleton className=\"h-4 w-28 rounded-md before:animation-duration-[900ms]\" />\n          <Skeleton className=\"h-10 w-36 rounded-lg before:animation-duration-[900ms]\" />\n        </div>\n      ) : state === \"error\" ? (\n        <div className=\"flex h-full flex-col justify-between gap-3\">\n          <div>\n            <p className=\"text-[13px] font-semibold text-zinc-900\">{data.label}</p>\n            <p className=\"mt-2 text-xs text-red-700\">Erro ao carregar métrica.</p>\n          </div>\n          <button\n            type=\"button\"\n            onClick={(event) => {\n              event.stopPropagation();\n              onRetry();\n            }}\n            className=\"w-fit text-xs font-semibold text-brand underline underline-offset-4\"\n          >\n            Tentar novamente\n          </button>\n        </div>\n      ) : (\n        <>\n          <header className=\"flex items-center justify-between gap-3\">\n            <div className=\"flex min-w-0 items-center gap-2.5\">\n              <div className=\"flex h-8 w-8 shrink-0 items-center justify-center rounded-[10px] bg-zinc-100 text-zinc-700\">\n                {icon}\n              </div>\n              <p className=\"truncate text-[13px] font-medium text-zinc-600\">\n                {data.label}\n              </p>\n            </div>\n            {isInteractive ? (\n              <ChevronRight className=\"h-4 w-4 shrink-0 text-zinc-400 transition-colors group-hover:text-zinc-600\" />\n            ) : null}\n          </header>\n\n          <div className=\"mt-3 flex items-baseline gap-1.5\">\n            <p className=\"text-[46px] leading-none font-bold tracking-tight text-zinc-900\">\n              <AnimatedKpiValue value={data.value} format={data.valueFormat} />\n            </p>\n            {data.valueSuffix ? (\n              <p className=\"truncate text-[13px] font-semibold text-zinc-500\">{data.valueSuffix}</p>\n            ) : null}\n          </div>\n\n          <p className=\"mt-2 truncate text-[13px] font-medium text-zinc-500\">{data.subtext}</p>\n\n          <footer className=\"mt-auto pt-4\">\n            <div className=\"flex min-h-[24px] items-center gap-2 overflow-hidden\">\n              {chips.map((chip) => (\n                <KpiChipBadge key={chip.id} chip={chip} />\n              ))}\n\n              {chips.length === 0 && !detailAction ? (\n                <p className=\"truncate text-[12px] text-zinc-500\" title={data.line4Text || \"Sem alertas hoje\"}>\n                  {data.line4Text || \"Sem alertas hoje\"}\n                </p>\n              ) : null}\n\n              {detailAction ? (\n                <button\n                  type=\"button\"\n                  onClick={(event) => {\n                    event.stopPropagation();\n                    onNavigate(detailAction.targetPath);\n                  }}\n                  className=\"inline-flex h-[24px] shrink-0 items-center text-[12px] font-semibold text-brand underline underline-offset-4 hover:text-brand/80\"\n                >\n                  {detailAction.label}\n                </button>\n              ) : null}\n            </div>\n\n            {data.microText ? (\n              <p className=\"mt-1.5 text-[11px] text-zinc-500\">{data.microText}</p>\n            ) : null}\n          </footer>\n        </>\n      )}\n    </motion.article>\n  );\n}\n\nexport function KpiSection() {\n  const router = useRouter();\n  const baseData = useKpiData();\n  const [cardState, setCardState] = useState<Record<keyof typeof baseData, KPIState>>({\n    pipeline: \"default\",\n    conversion: \"default\",\n    activities: \"default\",\n    sla: \"default\",\n  });\n\n  const kpis = useMemo(\n    () => ({\n      pipeline: { ...baseData.pipeline, state: cardState.pipeline },\n      conversion: { ...baseData.conversion, state: cardState.conversion },\n      activities: { ...baseData.activities, state: cardState.activities },\n      sla: { ...baseData.sla, state: cardState.sla },\n    }),\n    [baseData, cardState]\n  );\n\n  function retryCard(card: keyof typeof kpis) {\n    setCardState((prev) => ({ ...prev, [card]: \"loading\" }));\n    window.setTimeout(() => {\n      setCardState((prev) => ({ ...prev, [card]: \"default\" }));\n    }, 240);\n  }\n\n  return (\n    <motion.div\n      variants={cardStaggerContainer}\n      initial=\"hidden\"\n      animate=\"show\"\n      className=\"grid grid-cols-1 gap-4 sm:grid-cols-2 xl:grid-cols-4\"\n    >\n      <motion.div custom={0} variants={listItemReveal}>\n        <KPITemplateCard\n          icon={<Gauge className=\"h-4 w-4\" />}\n          data={kpis.pipeline}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"pipeline\")}\n        />\n      </motion.div>\n\n      <motion.div custom={1} variants={listItemReveal}>\n        <KPITemplateCard\n          icon={<TrendingUp className=\"h-4 w-4\" />}\n          data={kpis.conversion}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"conversion\")}\n        />\n      </motion.div>\n\n      <motion.div custom={2} variants={listItemReveal}>\n        <KPITemplateCard\n          icon={<Clock3 className=\"h-4 w-4\" />}\n          data={kpis.activities}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"activities\")}\n        />\n      </motion.div>\n\n      <motion.div custom={3} variants={listItemReveal}>\n        <KPITemplateCard\n          icon={<ShieldAlert className=\"h-4 w-4\" />}\n          data={kpis.sla}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"sla\")}\n        />\n      </motion.div>\n    </motion.div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1655, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/ui/bento-card.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { motion } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\nimport { premiumPressMotion } from \"@/lib/motion\";\n\nexport interface BentoCardProps {\n  title?: string;\n  description?: string;\n  actions?: React.ReactNode;\n  children: React.ReactNode;\n  size?: \"sm\" | \"md\" | \"lg\" | \"tall\" | \"wide\";\n  state?: \"default\" | \"loading\" | \"error\" | \"empty\";\n  className?: string;\n  noPadding?: boolean;\n  elevated?: boolean;\n  hoverable?: boolean;\n  shine?: boolean;\n}\n\nconst BentoCard = React.forwardRef<HTMLDivElement, BentoCardProps>(\n  (\n    {\n      title,\n      description,\n      actions,\n      children,\n      size = \"md\",\n      state = \"default\",\n      className,\n      noPadding = false,\n      elevated = false,\n      hoverable = false,\n      shine = true,\n      ...props\n    },\n    ref\n  ) => {\n    const hasHeader = title || description || actions;\n    const sizeClass =\n      size === \"sm\"\n        ? \"min-h-[140px]\"\n        : size === \"lg\"\n          ? \"min-h-[260px]\"\n          : size === \"tall\"\n            ? \"min-h-[340px]\"\n            : size === \"wide\"\n              ? \"min-h-[200px]\"\n              : \"min-h-[180px]\";\n\n    return (\n      <motion.div\n        ref={ref}\n        whileHover={hoverable ? premiumPressMotion.whileHover : undefined}\n        whileTap={hoverable ? premiumPressMotion.whileTap : undefined}\n        transition={\n          hoverable\n            ? { duration: 0.22, ease: [0.22, 0.61, 0.36, 1] }\n            : undefined\n        }\n        className={cn(\n          // Base styles\n          \"group/card relative overflow-hidden\",\n          \"bento-card-base premium-panel\",\n          \"rounded-[var(--radius-bento-card)]\",\n          \"border border-[var(--border-bento-default)]\",\n          \"focus-within:ring-2 focus-within:ring-brand/20\",\n\n          // Shadow elevation\n          elevated && \"bento-card-elevated\",\n          !elevated && \"shadow-[var(--shadow-bento-sm)]\",\n\n          // Hover state\n          hoverable && elevated && \"bento-card-elevated-hover\",\n          hoverable && !elevated && \"bento-card-hover\",\n          hoverable && \"premium-lift\",\n          hoverable && shine && \"premium-shine\",\n\n          // Size\n          sizeClass,\n\n          // State-specific styles\n          state === \"error\" && \"border-[var(--border-bento-error)]\",\n          state === \"loading\" && \"pointer-events-none opacity-80\",\n\n          className\n        )}\n        {...props}\n      >\n        {shine && (\n          <>\n            <div\n              aria-hidden\n              className=\"pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-300 ease-out group-hover/card:opacity-100\"\n            >\n              <div className=\"absolute -top-16 right-[-12%] h-40 w-40 rounded-full bg-brand/15 blur-3xl\" />\n              <div className=\"absolute -bottom-16 left-[-10%] h-36 w-36 rounded-full bg-cyan-300/15 blur-3xl\" />\n            </div>\n            <div\n              aria-hidden\n              className=\"pointer-events-none absolute inset-x-0 top-0 h-px bg-linear-to-r from-transparent via-white/90 to-transparent opacity-70\"\n            />\n          </>\n        )}\n\n        {/* Header */}\n        {hasHeader && (\n          <div\n            className={cn(\n              \"flex items-start justify-between gap-4\",\n              noPadding ? \"px-6 pt-6\" : \"px-6 pt-6 pb-4\"\n            )}\n          >\n            <div className=\"min-w-0 flex-1\">\n              {title && (\n                <h3 className=\"font-heading text-lg font-semibold text-black\">\n                  {title}\n                </h3>\n              )}\n              {description && (\n                <p className=\"mt-1 font-body text-sm text-zinc-500\">\n                  {description}\n                </p>\n              )}\n            </div>\n            {actions && <div className=\"flex shrink-0 gap-2\">{actions}</div>}\n          </div>\n        )}\n\n        {/* Content */}\n        <div className={cn(!noPadding && (hasHeader ? \"px-6 pb-6\" : \"p-6\"))}>\n          {children}\n        </div>\n      </motion.div>\n    );\n  }\n);\n\nBentoCard.displayName = \"BentoCard\";\n\nexport { BentoCard };\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;AAgBA,MAAM,0BAAY,2KAAgB,MAChC,CACE,EACE,KAAK,EACL,WAAW,EACX,OAAO,EACP,QAAQ,EACR,OAAO,IAAI,EACX,QAAQ,SAAS,EACjB,SAAS,EACT,YAAY,KAAK,EACjB,WAAW,KAAK,EAChB,YAAY,KAAK,EACjB,QAAQ,IAAI,EACZ,GAAG,OACJ,EACD;IAEA,MAAM,YAAY,SAAS,eAAe;IAC1C,MAAM,YACJ,SAAS,OACL,kBACA,SAAS,OACP,kBACA,SAAS,SACP,kBACA,SAAS,SACP,kBACA;IAEZ,qBACE,6LAAC,uMAAM,CAAC,GAAG;QACT,KAAK;QACL,YAAY,YAAY,6IAAkB,CAAC,UAAU,GAAG;QACxD,UAAU,YAAY,6IAAkB,CAAC,QAAQ,GAAG;QACpD,YACE,YACI;YAAE,UAAU;YAAM,MAAM;gBAAC;gBAAM;gBAAM;gBAAM;aAAE;QAAC,IAC9C;QAEN,WAAW,IAAA,4HAAE,EACX,cAAc;QACd,uCACA,iCACA,sCACA,+CACA,kDAEA,mBAAmB;QACnB,YAAY,uBACZ,CAAC,YAAY,mCAEb,cAAc;QACd,aAAa,YAAY,6BACzB,aAAa,CAAC,YAAY,oBAC1B,aAAa,gBACb,aAAa,SAAS,iBAEtB,OAAO;QACP,WAEA,wBAAwB;QACxB,UAAU,WAAW,sCACrB,UAAU,aAAa,kCAEvB;QAED,GAAG,KAAK;;YAER,uBACC;;kCACE,6LAAC;wBACC,aAAW;wBACX,WAAU;;0CAEV,6LAAC;gCAAI,WAAU;;;;;;0CACf,6LAAC;gCAAI,WAAU;;;;;;;;;;;;kCAEjB,6LAAC;wBACC,aAAW;wBACX,WAAU;;;;;;;;YAMf,2BACC,6LAAC;gBACC,WAAW,IAAA,4HAAE,EACX,0CACA,YAAY,cAAc;;kCAG5B,6LAAC;wBAAI,WAAU;;4BACZ,uBACC,6LAAC;gCAAG,WAAU;0CACX;;;;;;4BAGJ,6BACC,6LAAC;gCAAE,WAAU;0CACV;;;;;;;;;;;;oBAIN,yBAAW,6LAAC;wBAAI,WAAU;kCAAuB;;;;;;;;;;;;0BAKtD,6LAAC;gBAAI,WAAW,IAAA,4HAAE,EAAC,CAAC,aAAa,CAAC,YAAY,cAAc,KAAK;0BAC9D;;;;;;;;;;;;AAIT;;AAGF,UAAU,WAAW,GAAG"}},
    {"offset": {"line": 1799, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/funnel-config.ts"],"sourcesContent":["import type { Opportunity } from \"@/types\";\n\ntype FlowStageId = \"lead\" | \"contact\" | \"meeting\" | \"proposal\" | \"negotiation\" | \"won\";\ntype FunnelXRayState = \"ready\" | \"loading\" | \"error\";\ntype ActionState = \"idle\" | \"loading\" | \"success\" | \"error\";\n\ninterface FlowStage {\n  id: FlowStageId;\n  label: string;\n  volume: number;\n  value: number;\n  stalledCount: number;\n  stalledDays: number;\n}\n\ninterface FlowTransition {\n  from: FlowStage;\n  to: FlowStage;\n  conversion: number;\n  advanced: number;\n  base: number;\n}\n\ninterface StageInsight {\n  riskDeals: string[];\n  highlight: string;\n  recommendation: string;\n}\n\nconst STAGE_TO_PIPELINE: Record<FlowStageId, string> = {\n  lead: \"lead-in\",\n  contact: \"contato-feito\",\n  meeting: \"reuniao-agendada\",\n  proposal: \"proposta-enviada\",\n  negotiation: \"negociacao\",\n  won: \"fechamento\",\n};\n\nconst PIPELINE_TO_FLOW: Record<string, FlowStageId> = {\n  \"lead-in\": \"lead\",\n  \"contato-feito\": \"contact\",\n  \"reuniao-agendada\": \"meeting\",\n  \"proposta-enviada\": \"proposal\",\n  \"negociacao\": \"negotiation\",\n  \"fechamento\": \"won\",\n};\n\nconst FLOW_STAGE_LABELS: Record<FlowStageId, string> = {\n  lead: \"Leads\",\n  contact: \"Contato\",\n  meeting: \"Reunião\",\n  proposal: \"Proposta\",\n  negotiation: \"Negociação\",\n  won: \"Fechamento\",\n};\n\nconst FLOW_STAGE_ORDER: FlowStageId[] = [\n  \"lead\",\n  \"contact\",\n  \"meeting\",\n  \"proposal\",\n  \"negotiation\",\n  \"won\",\n];\n\n// ── Dynamic builders ────────────────────────────────────────────────\n\n/**\n * Build FlowStage[] from real opportunity data.\n * Groups open opportunities by pipeline stage and computes volume, value,\n * stalled count & average stalled days.\n */\nfunction buildStagesFromOpportunities(\n  opportunities: Opportunity[],\n  now: Date\n): FlowStage[] {\n  const openOpps = opportunities.filter((o) => o.status === \"open\");\n\n  return FLOW_STAGE_ORDER.map((flowId) => {\n    const pipelineStage = STAGE_TO_PIPELINE[flowId];\n    const stageOpps = openOpps.filter((o) => o.stage === pipelineStage);\n\n    const volume = stageOpps.length;\n    const value = stageOpps.reduce((sum, o) => sum + (o.value || 0), 0);\n\n    // Stalled = not updated in 5+ days\n    const stalledThreshold = 5 * 24 * 60 * 60 * 1000;\n    const stalledOpps = stageOpps.filter(\n      (o) => now.getTime() - new Date(o.updatedAt).getTime() > stalledThreshold\n    );\n    const stalledCount = stalledOpps.length;\n\n    let stalledDays = 0;\n    if (stalledOpps.length > 0) {\n      const totalDays = stalledOpps.reduce((sum, o) => {\n        return sum + Math.round(\n          (now.getTime() - new Date(o.updatedAt).getTime()) / (1000 * 60 * 60 * 24)\n        );\n      }, 0);\n      stalledDays = Math.round(totalDays / stalledOpps.length);\n    }\n\n    return {\n      id: flowId,\n      label: FLOW_STAGE_LABELS[flowId],\n      volume,\n      value,\n      stalledCount,\n      stalledDays,\n    };\n  });\n}\n\n/**\n * Build contextual insights from real data.\n * riskDeals = top 3 stalled opportunity titles per stage.\n * highlight = dynamic text comparing stage performance.\n * recommendation = contextual action based on stage state.\n */\nfunction buildInsightsFromData(\n  stages: FlowStage[],\n  opportunities: Opportunity[],\n  now: Date\n): Record<FlowStageId, StageInsight> {\n  const openOpps = opportunities.filter((o) => o.status === \"open\");\n  const stalledThreshold = 5 * 24 * 60 * 60 * 1000;\n\n  const result = {} as Record<FlowStageId, StageInsight>;\n\n  for (const stage of stages) {\n    const pipelineStage = STAGE_TO_PIPELINE[stage.id];\n    const stageOpps = openOpps.filter((o) => o.stage === pipelineStage);\n\n    // Top 3 stalled deals by days stalled (desc)\n    const stalledOpps = stageOpps\n      .filter((o) => now.getTime() - new Date(o.updatedAt).getTime() > stalledThreshold)\n      .sort(\n        (a, b) =>\n          new Date(a.updatedAt).getTime() - new Date(b.updatedAt).getTime()\n      )\n      .slice(0, 3);\n\n    const riskDeals =\n      stalledOpps.length > 0\n        ? stalledOpps.map((o) => o.title || o.clientName)\n        : stageOpps.slice(0, 3).map((o) => o.title || o.clientName);\n\n    // Dynamic highlight\n    const stalledPct =\n      stage.volume > 0\n        ? Math.round((stage.stalledCount / stage.volume) * 100)\n        : 0;\n    const highlight =\n      stage.stalledCount > 0\n        ? `${stalledPct}% parados há +${stage.stalledDays} dias`\n        : stage.volume > 0\n          ? `${stage.volume} oportunidades ativas`\n          : \"Nenhuma oportunidade nesta etapa\";\n\n    // Context-aware recommendation\n    let recommendation: string;\n    if (stage.stalledCount > 0 && stage.stalledCount >= stage.volume * 0.5) {\n      recommendation = `Atenção: ${stage.stalledCount} oportunidades paradas. Priorizar follow-up urgente.`;\n    } else if (stage.id === \"lead\") {\n      recommendation = \"Priorizar contato inicial com leads das últimas 24h.\";\n    } else if (stage.id === \"contact\") {\n      recommendation = \"Escalar follow-up com decisores sem retorno há 3 dias.\";\n    } else if (stage.id === \"meeting\") {\n      recommendation = \"Fechar agenda com prova de valor em até 48h.\";\n    } else if (stage.id === \"proposal\") {\n      recommendation = \"Cobrar feedbacks das propostas paradas para destravar fechamento.\";\n    } else if (stage.id === \"negotiation\") {\n      recommendation = \"Alinhar objeções e preparar última contraproposta.\";\n    } else {\n      recommendation = \"Subir ticket com pacote premium na reta final.\";\n    }\n\n    result[stage.id] = { riskDeals, highlight, recommendation };\n  }\n\n  return result;\n}\n\nexport type {\n  FlowStageId,\n  FunnelXRayState,\n  ActionState,\n  FlowStage,\n  FlowTransition,\n  StageInsight,\n};\nexport {\n  STAGE_TO_PIPELINE,\n  PIPELINE_TO_FLOW,\n  FLOW_STAGE_ORDER,\n  FLOW_STAGE_LABELS,\n  buildStagesFromOpportunities,\n  buildInsightsFromData,\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1929, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/funnel-utils.ts"],"sourcesContent":["import type { FlowStage, FlowTransition } from \"./funnel-config\";\n\nexport function buildTransitions(stages: FlowStage[]): FlowTransition[] {\n  return stages.slice(0, -1).map((from, index) => {\n    const to = stages[index + 1];\n    const conversion =\n      from.volume > 0 ? Math.round((to.volume / from.volume) * 100) : 0;\n    return {\n      from,\n      to,\n      conversion,\n      advanced: to.volume,\n      base: from.volume,\n    };\n  });\n}\n\nexport function formatCurrencyCompact(value: number): string {\n  if (value >= 1_000_000) return `R$ ${(value / 1_000_000).toFixed(1)}M`;\n  if (value >= 1_000) return `R$ ${(value / 1_000).toFixed(0)}k`;\n  return `R$ ${value}`;\n}\n\nexport function formatCurrencyBRL(value: number): string {\n  return new Intl.NumberFormat(\"pt-BR\", {\n    style: \"currency\",\n    currency: \"BRL\",\n    maximumFractionDigits: 0,\n  }).format(value);\n}\n"],"names":[],"mappings":";;;;;;;;AAEO,SAAS,iBAAiB,MAAmB;IAClD,OAAO,OAAO,KAAK,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC,MAAM;QACpC,MAAM,KAAK,MAAM,CAAC,QAAQ,EAAE;QAC5B,MAAM,aACJ,KAAK,MAAM,GAAG,IAAI,KAAK,KAAK,CAAC,AAAC,GAAG,MAAM,GAAG,KAAK,MAAM,GAAI,OAAO;QAClE,OAAO;YACL;YACA;YACA;YACA,UAAU,GAAG,MAAM;YACnB,MAAM,KAAK,MAAM;QACnB;IACF;AACF;AAEO,SAAS,sBAAsB,KAAa;IACjD,IAAI,SAAS,WAAW,OAAO,CAAC,GAAG,EAAE,CAAC,QAAQ,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IACtE,IAAI,SAAS,OAAO,OAAO,CAAC,GAAG,EAAE,CAAC,QAAQ,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IAC9D,OAAO,CAAC,GAAG,EAAE,OAAO;AACtB;AAEO,SAAS,kBAAkB,KAAa;IAC7C,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ"}},
    {"offset": {"line": 1969, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/flow-step-card.tsx"],"sourcesContent":["\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\nimport type { FlowStageId, FlowStage } from \"./funnel-config\";\nimport { formatCurrencyCompact } from \"./funnel-utils\";\n\nexport function FlowStepCard({\n  stage,\n  selected,\n  onSelectStage,\n  compact,\n}: {\n  stage: FlowStage;\n  selected: boolean;\n  onSelectStage: (stageId: FlowStageId) => void;\n  compact: boolean;\n}) {\n  return (\n    <motion.button\n      type=\"button\"\n      onClick={() => onSelectStage(stage.id)}\n      whileTap={{ scale: 0.99 }}\n      transition={{ duration: 0.14, ease: \"easeOut\" }}\n      className={cn(\n        \"group/step min-w-0 rounded-xl border px-3 py-3 text-left transition-[background-color,border-color,box-shadow,opacity] duration-[140ms] ease-out\",\n        \"shadow-[0_8px_22px_-18px_rgba(15,23,42,0.45)] hover:shadow-[0_10px_26px_-16px_rgba(15,23,42,0.5)]\",\n        compact ? \"w-full\" : \"flex-[1_1_148px]\",\n        selected\n          ? \"border-brand/40 bg-brand/10 shadow-[0_0_0_1px_rgba(29,78,216,0.14),0_10px_26px_-16px_rgba(29,78,216,0.55)]\"\n          : \"border-zinc-200/85 bg-white/90 hover:border-zinc-300/90\"\n      )}\n      aria-pressed={selected}\n    >\n      <p className=\"truncate text-[11px] font-semibold uppercase tracking-[0.07em] text-zinc-500\">\n        {stage.label}\n      </p>\n      <p className=\"mt-1 text-xl font-bold leading-none text-zinc-900\">\n        {stage.volume}\n      </p>\n      <p className=\"mt-1 text-[11px] text-zinc-500\">{formatCurrencyCompact(stage.value)}</p>\n    </motion.button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOO,SAAS,aAAa,EAC3B,KAAK,EACL,QAAQ,EACR,aAAa,EACb,OAAO,EAMR;IACC,qBACE,6LAAC,uMAAM,CAAC,MAAM;QACZ,MAAK;QACL,SAAS,IAAM,cAAc,MAAM,EAAE;QACrC,UAAU;YAAE,OAAO;QAAK;QACxB,YAAY;YAAE,UAAU;YAAM,MAAM;QAAU;QAC9C,WAAW,IAAA,4HAAE,EACX,oJACA,qGACA,UAAU,WAAW,oBACrB,WACI,+GACA;QAEN,gBAAc;;0BAEd,6LAAC;gBAAE,WAAU;0BACV,MAAM,KAAK;;;;;;0BAEd,6LAAC;gBAAE,WAAU;0BACV,MAAM,MAAM;;;;;;0BAEf,6LAAC;gBAAE,WAAU;0BAAkC,IAAA,mMAAqB,EAAC,MAAM,KAAK;;;;;;;;;;;;AAGtF;KApCgB"}},
    {"offset": {"line": 2037, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/flow-connector.tsx"],"sourcesContent":["\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { ArrowDown, ArrowRight } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport type { FlowTransition } from \"./funnel-config\";\n\nexport function FlowConnector({\n  transition,\n  isBottleneck,\n  orientation,\n  delay,\n}: {\n  transition: FlowTransition;\n  isBottleneck: boolean;\n  orientation: \"horizontal\" | \"vertical\";\n  delay: number;\n}) {\n  const lineClass = isBottleneck ? \"bg-amber-300/80\" : \"bg-zinc-300/85\";\n  const pillClass = isBottleneck\n    ? \"border-amber-300/80 bg-amber-50 text-amber-700\"\n    : \"border-zinc-200 bg-white text-zinc-600\";\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <motion.div\n          className={cn(\n            \"group/connector relative flex shrink-0 items-center justify-center\",\n            orientation === \"horizontal\"\n              ? \"min-w-[46px] flex-1 md:max-w-[64px]\"\n              : \"h-6 w-full\"\n          )}\n        >\n          {orientation === \"horizontal\" ? (\n            <>\n              <motion.div\n                initial={{ scaleX: 0 }}\n                animate={{ scaleX: 1 }}\n                transition={{ duration: 0.22, delay, ease: \"easeOut\" }}\n                className={cn(\n                  \"h-px w-full origin-left transition-opacity duration-[120ms] group-hover/connector:opacity-100\",\n                  lineClass,\n                  isBottleneck ? \"opacity-95\" : \"opacity-70\"\n                )}\n              />\n              <ArrowRight className=\"ml-1 h-3 w-3 text-zinc-400 transition-opacity duration-[120ms] group-hover/connector:opacity-100\" />\n            </>\n          ) : (\n            <>\n              <motion.div\n                initial={{ scaleY: 0 }}\n                animate={{ scaleY: 1 }}\n                transition={{ duration: 0.22, delay, ease: \"easeOut\" }}\n                className={cn(\n                  \"h-full w-px origin-top transition-opacity duration-[120ms] group-hover/connector:opacity-100\",\n                  lineClass,\n                  isBottleneck ? \"opacity-95\" : \"opacity-70\"\n                )}\n              />\n              <ArrowDown className=\"absolute bottom-[-3px] h-3 w-3 text-zinc-400 transition-opacity duration-[120ms] group-hover/connector:opacity-100\" />\n            </>\n          )}\n\n          <span\n            className={cn(\n              \"absolute rounded-full border px-1.5 py-0.5 text-[10px] font-semibold shadow-sm transition-opacity duration-[120ms] group-hover/connector:opacity-100\",\n              orientation === \"horizontal\" ? \"top-[-11px]\" : \"right-2 top-[2px]\",\n              pillClass,\n              isBottleneck ? \"opacity-100\" : \"opacity-85\"\n            )}\n          >\n            {transition.conversion}%\n          </span>\n        </motion.div>\n      </TooltipTrigger>\n      <TooltipContent side=\"top\" className=\"text-[11px]\">\n        {transition.advanced} de {transition.base} avançaram\n      </TooltipContent>\n    </Tooltip>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AALA;;;;;;AAQO,SAAS,cAAc,EAC5B,UAAU,EACV,YAAY,EACZ,WAAW,EACX,KAAK,EAMN;IACC,MAAM,YAAY,eAAe,oBAAoB;IACrD,MAAM,YAAY,eACd,mDACA;IAEJ,qBACE,6LAAC,iJAAO;;0BACN,6LAAC,wJAAc;gBAAC,OAAO;0BACrB,cAAA,6LAAC,uMAAM,CAAC,GAAG;oBACT,WAAW,IAAA,4HAAE,EACX,sEACA,gBAAgB,eACZ,wCACA;;wBAGL,gBAAgB,6BACf;;8CACE,6LAAC,uMAAM,CAAC,GAAG;oCACT,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,YAAY;wCAAE,UAAU;wCAAM;wCAAO,MAAM;oCAAU;oCACrD,WAAW,IAAA,4HAAE,EACX,iGACA,WACA,eAAe,eAAe;;;;;;8CAGlC,6LAAC,mOAAU;oCAAC,WAAU;;;;;;;yDAGxB;;8CACE,6LAAC,uMAAM,CAAC,GAAG;oCACT,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,YAAY;wCAAE,UAAU;wCAAM;wCAAO,MAAM;oCAAU;oCACrD,WAAW,IAAA,4HAAE,EACX,gGACA,WACA,eAAe,eAAe;;;;;;8CAGlC,6LAAC,gOAAS;oCAAC,WAAU;;;;;;;;sCAIzB,6LAAC;4BACC,WAAW,IAAA,4HAAE,EACX,wJACA,gBAAgB,eAAe,gBAAgB,qBAC/C,WACA,eAAe,gBAAgB;;gCAGhC,WAAW,UAAU;gCAAC;;;;;;;;;;;;;;;;;;0BAI7B,6LAAC,wJAAc;gBAAC,MAAK;gBAAM,WAAU;;oBAClC,WAAW,QAAQ;oBAAC;oBAAK,WAAW,IAAI;oBAAC;;;;;;;;;;;;;AAIlD;KA1EgB"}},
    {"offset": {"line": 2173, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/flow-steps-connected.tsx"],"sourcesContent":["\"use client\";\n\nimport { Fragment } from \"react\";\nimport type { FlowStageId, FlowStage, FlowTransition } from \"./funnel-config\";\nimport { FlowStepCard } from \"./flow-step-card\";\nimport { FlowConnector } from \"./flow-connector\";\n\nexport function FlowStepsConnected({\n  stages,\n  transitions,\n  selectedStageId,\n  bottleneckToStageId,\n  onSelectStage,\n}: {\n  stages: FlowStage[];\n  transitions: FlowTransition[];\n  selectedStageId: FlowStageId | null;\n  bottleneckToStageId: FlowStageId | null;\n  onSelectStage: (stageId: FlowStageId) => void;\n}) {\n  return (\n    <>\n      <div className=\"hidden items-stretch gap-2 md:flex md:flex-wrap xl:flex-nowrap\">\n        {stages.map((stage, index) => (\n          <Fragment key={stage.id}>\n            <FlowStepCard\n              stage={stage}\n              selected={selectedStageId === stage.id}\n              onSelectStage={onSelectStage}\n              compact={false}\n            />\n            {index < transitions.length && (\n              <FlowConnector\n                transition={transitions[index]}\n                isBottleneck={bottleneckToStageId === transitions[index].to.id}\n                orientation=\"horizontal\"\n                delay={index * 0.03}\n              />\n            )}\n          </Fragment>\n        ))}\n      </div>\n\n      <div className=\"space-y-2 md:hidden\">\n        {stages.map((stage, index) => (\n          <Fragment key={`mobile-${stage.id}`}>\n            <FlowStepCard\n              stage={stage}\n              selected={selectedStageId === stage.id}\n              onSelectStage={onSelectStage}\n              compact\n            />\n            {index < transitions.length && (\n              <FlowConnector\n                transition={transitions[index]}\n                isBottleneck={bottleneckToStageId === transitions[index].to.id}\n                orientation=\"vertical\"\n                delay={index * 0.03}\n              />\n            )}\n          </Fragment>\n        ))}\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AALA;;;;;AAOO,SAAS,mBAAmB,EACjC,MAAM,EACN,WAAW,EACX,eAAe,EACf,mBAAmB,EACnB,aAAa,EAOd;IACC,qBACE;;0BACE,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,OAAO,sBAClB,6LAAC,yKAAQ;;0CACP,6LAAC,gMAAY;gCACX,OAAO;gCACP,UAAU,oBAAoB,MAAM,EAAE;gCACtC,eAAe;gCACf,SAAS;;;;;;4BAEV,QAAQ,YAAY,MAAM,kBACzB,6LAAC,8LAAa;gCACZ,YAAY,WAAW,CAAC,MAAM;gCAC9B,cAAc,wBAAwB,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;gCAC9D,aAAY;gCACZ,OAAO,QAAQ;;;;;;;uBAZN,MAAM,EAAE;;;;;;;;;;0BAmB3B,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,OAAO,sBAClB,6LAAC,yKAAQ;;0CACP,6LAAC,gMAAY;gCACX,OAAO;gCACP,UAAU,oBAAoB,MAAM,EAAE;gCACtC,eAAe;gCACf,OAAO;;;;;;4BAER,QAAQ,YAAY,MAAM,kBACzB,6LAAC,8LAAa;gCACZ,YAAY,WAAW,CAAC,MAAM;gCAC9B,cAAc,wBAAwB,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;gCAC9D,aAAY;gCACZ,OAAO,QAAQ;;;;;;;uBAZN,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;;;;;;;;;;;;AAoB7C;KA1DgB"}},
    {"offset": {"line": 2272, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/summary-mini-card.tsx"],"sourcesContent":["\"use client\";\n\nimport { motion } from \"framer-motion\";\n\nexport function SummaryMiniCard({\n  icon,\n  label,\n  value,\n  helper,\n  onClick,\n}: {\n  icon: React.ReactNode;\n  label: string;\n  value: string;\n  helper: string;\n  onClick?: () => void;\n}) {\n  return (\n    <motion.button\n      type=\"button\"\n      whileTap={{ scale: 0.99 }}\n      transition={{ duration: 0.09, ease: \"easeOut\" }}\n      className=\"rounded-xl border border-zinc-200/80 bg-white/80 px-3 py-2.5 text-left transition-colors duration-[120ms] ease-out hover:bg-zinc-100/60\"\n      onClick={onClick}\n    >\n      <div className=\"mb-1 flex items-center gap-1.5 text-zinc-500\">{icon}</div>\n      <p className=\"text-[11px] font-semibold uppercase tracking-[0.07em] text-zinc-500\">\n        {label}\n      </p>\n      <p className=\"mt-1 text-sm font-bold text-zinc-900\">{value}</p>\n      <p className=\"mt-0.5 text-[10px] text-zinc-500\">{helper}</p>\n    </motion.button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAIO,SAAS,gBAAgB,EAC9B,IAAI,EACJ,KAAK,EACL,KAAK,EACL,MAAM,EACN,OAAO,EAOR;IACC,qBACE,6LAAC,uMAAM,CAAC,MAAM;QACZ,MAAK;QACL,UAAU;YAAE,OAAO;QAAK;QACxB,YAAY;YAAE,UAAU;YAAM,MAAM;QAAU;QAC9C,WAAU;QACV,SAAS;;0BAET,6LAAC;gBAAI,WAAU;0BAAgD;;;;;;0BAC/D,6LAAC;gBAAE,WAAU;0BACV;;;;;;0BAEH,6LAAC;gBAAE,WAAU;0BAAwC;;;;;;0BACrD,6LAAC;gBAAE,WAAU;0BAAoC;;;;;;;;;;;;AAGvD;KA7BgB"}},
    {"offset": {"line": 2343, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/funnel-x-ray-skeleton.tsx"],"sourcesContent":["\"use client\";\n\nimport { Fragment } from \"react\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nexport function FunnelXRaySkeleton() {\n  return (\n    <div className=\"grid grid-cols-1 gap-4 p-5 lg:grid-cols-12\">\n      <div className=\"space-y-3 lg:col-span-7\">\n        <div className=\"hidden items-stretch gap-2 md:flex md:flex-wrap xl:flex-nowrap\">\n          {Array.from({ length: 5 }).map((_, index) => (\n            <Fragment key={`sk-flow-${index}`}>\n              <Skeleton className=\"h-[86px] flex-[1_1_148px] rounded-xl before:[animation-duration:900ms]\" />\n              {index < 4 && (\n                <Skeleton className=\"h-3 min-w-[46px] flex-1 rounded-full before:[animation-duration:900ms] md:max-w-[64px]\" />\n              )}\n            </Fragment>\n          ))}\n        </div>\n\n        <div className=\"space-y-2 md:hidden\">\n          {Array.from({ length: 5 }).map((_, index) => (\n            <Fragment key={`sk-flow-mobile-${index}`}>\n              <Skeleton className=\"h-[84px] rounded-xl before:[animation-duration:900ms]\" />\n              {index < 4 && (\n                <div className=\"flex justify-center\">\n                  <Skeleton className=\"h-6 w-2 rounded-full before:[animation-duration:900ms]\" />\n                </div>\n              )}\n            </Fragment>\n          ))}\n        </div>\n\n        <div className=\"grid grid-cols-1 gap-2 sm:grid-cols-3\">\n          {Array.from({ length: 3 }).map((_, index) => (\n            <Skeleton\n              key={`sk-summary-${index}`}\n              className=\"h-20 rounded-xl before:[animation-duration:900ms]\"\n            />\n          ))}\n        </div>\n        <Skeleton className=\"h-32 rounded-xl before:[animation-duration:900ms]\" />\n      </div>\n\n      <div className=\"space-y-3 lg:col-span-5\">\n        {Array.from({ length: 3 }).map((_, index) => (\n          <Skeleton\n            key={`sk-diagnostic-${index}`}\n            className=\"h-32 rounded-xl before:[animation-duration:900ms]\"\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAKO,SAAS;IACd,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;kCACZ,MAAM,IAAI,CAAC;4BAAE,QAAQ;wBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,sBACjC,6LAAC,yKAAQ;;kDACP,6LAAC,mJAAQ;wCAAC,WAAU;;;;;;oCACnB,QAAQ,mBACP,6LAAC,mJAAQ;wCAAC,WAAU;;;;;;;+BAHT,CAAC,QAAQ,EAAE,OAAO;;;;;;;;;;kCASrC,6LAAC;wBAAI,WAAU;kCACZ,MAAM,IAAI,CAAC;4BAAE,QAAQ;wBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,sBACjC,6LAAC,yKAAQ;;kDACP,6LAAC,mJAAQ;wCAAC,WAAU;;;;;;oCACnB,QAAQ,mBACP,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC,mJAAQ;4CAAC,WAAU;;;;;;;;;;;;+BAJX,CAAC,eAAe,EAAE,OAAO;;;;;;;;;;kCAW5C,6LAAC;wBAAI,WAAU;kCACZ,MAAM,IAAI,CAAC;4BAAE,QAAQ;wBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,sBACjC,6LAAC,mJAAQ;gCAEP,WAAU;+BADL,CAAC,WAAW,EAAE,OAAO;;;;;;;;;;kCAKhC,6LAAC,mJAAQ;wBAAC,WAAU;;;;;;;;;;;;0BAGtB,6LAAC;gBAAI,WAAU;0BACZ,MAAM,IAAI,CAAC;oBAAE,QAAQ;gBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,sBACjC,6LAAC,mJAAQ;wBAEP,WAAU;uBADL,CAAC,cAAc,EAAE,OAAO;;;;;;;;;;;;;;;;AAOzC;KAjDgB"}},
    {"offset": {"line": 2492, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/funnel-x-ray.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport {\n  AlertTriangle,\n  ArrowRight,\n  ArrowUpRight,\n  Gauge,\n  Lightbulb,\n  Loader2,\n  Sparkles,\n  TrendingDown,\n} from \"lucide-react\";\nimport { usePathname, useRouter, useSearchParams } from \"next/navigation\";\nimport { BentoCard } from \"@/components/ui/bento-card\";\nimport { Button } from \"@/components/ui/button\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport type { FlowStageId, FunnelXRayState, ActionState } from \"./funnel-config\";\nimport {\n  FLOW_STAGE_ORDER,\n  PIPELINE_TO_FLOW,\n  STAGE_TO_PIPELINE,\n  buildStagesFromOpportunities,\n  buildInsightsFromData,\n} from \"./funnel-config\";\nimport { buildTransitions, formatCurrencyBRL } from \"./funnel-utils\";\nimport { FlowStepsConnected } from \"./flow-steps-connected\";\nimport { SummaryMiniCard } from \"./summary-mini-card\";\nimport { FunnelXRaySkeleton } from \"./funnel-x-ray-skeleton\";\n\nconst STALLED_OPPORTUNITY_DAYS = 5;\nconst DAY_MS = 24 * 60 * 60 * 1000;\n\ninterface RiskDealEntry {\n  id: string;\n  label: string;\n  stalledDays: number;\n}\n\nfunction parseDashboardStageParam(stageParam: string | null): FlowStageId | null {\n  if (!stageParam) return null;\n\n  if (FLOW_STAGE_ORDER.includes(stageParam as FlowStageId)) {\n    return stageParam as FlowStageId;\n  }\n\n  return PIPELINE_TO_FLOW[stageParam] ?? null;\n}\n\nexport function FunnelXRay({ state = \"ready\" }: { state?: FunnelXRayState }) {\n  const router = useRouter();\n  const pathname = usePathname();\n  const searchParams = useSearchParams();\n  const addActivity = useActivityStore((s) => s.addActivity);\n  const [viewState, setViewState] = useState<FunnelXRayState>(state);\n  const [actionState, setActionState] = useState<ActionState>(\"idle\");\n  const [createdCount, setCreatedCount] = useState(0);\n\n  const {\n    filteredOpportunities,\n    openOpportunities,\n    now,\n    userId,\n  } = useDashboardFilters();\n\n  const stages = useMemo(\n    () => buildStagesFromOpportunities(filteredOpportunities, now),\n    [filteredOpportunities, now]\n  );\n\n  const insights = useMemo(\n    () => buildInsightsFromData(stages, filteredOpportunities, now),\n    [stages, filteredOpportunities, now]\n  );\n\n  const { riskValue, averageSpeedDays } = useMemo(() => {\n    const fiveDaysAgo = new Date(now.getTime() - STALLED_OPPORTUNITY_DAYS * DAY_MS);\n\n    const stalledOpps = openOpportunities.filter((opportunity) => {\n      return new Date(opportunity.updatedAt) < fiveDaysAgo;\n    });\n    const computedRiskValue = stalledOpps.reduce(\n      (sum, opportunity) => sum + (opportunity.value || 0),\n      0\n    );\n\n    const wonOpps = filteredOpportunities.filter((opportunity) => opportunity.status === \"won\");\n    let totalDays = 0;\n    wonOpps.forEach((opportunity) => {\n      const created = new Date(opportunity.createdAt).getTime();\n      const closed = new Date(opportunity.updatedAt).getTime();\n      totalDays += Math.max(1, Math.round((closed - created) / DAY_MS));\n    });\n    const computedAvgDays = wonOpps.length > 0 ? Math.round(totalDays / wonOpps.length) : 0;\n\n    return { riskValue: computedRiskValue, averageSpeedDays: computedAvgDays };\n  }, [filteredOpportunities, openOpportunities, now]);\n\n  const transitions = useMemo(() => buildTransitions(stages), [stages]);\n  const hasEnoughData = stages.length >= 2 && stages.some((stage) => stage.volume > 0);\n\n  const bottleneck = useMemo(() => {\n    if (transitions.length === 0) return null;\n    return transitions.reduce((min, current) =>\n      current.conversion < min.conversion ? current : min\n    );\n  }, [transitions]);\n\n  const criticalStageId = bottleneck?.to.id ?? stages[0]?.id ?? null;\n  const criticalStage = stages.find((stage) => stage.id === criticalStageId) ?? null;\n\n  const selectedStageId = useMemo(\n    () => parseDashboardStageParam(searchParams.get(\"stage\")),\n    [searchParams]\n  );\n\n  const selectedStage = useMemo(() => {\n    if (!selectedStageId) return null;\n    return stages.find((stage) => stage.id === selectedStageId) ?? null;\n  }, [selectedStageId, stages]);\n\n  const scopeStage = selectedStage ?? criticalStage;\n  const scopeInsight = scopeStage ? insights[scopeStage.id] : null;\n  const insightScopeKey = selectedStage?.id ?? \"all\";\n\n  const highlightText =\n    scopeInsight?.highlight ??\n    (selectedStage ? \"Sem destaque para a etapa selecionada\" : \"Sem destaque para o funil\");\n  const recommendationText =\n    scopeInsight?.recommendation ??\n    (selectedStage\n      ? \"Sem recomendação disponível para a etapa selecionada.\"\n      : \"Sem recomendação disponível para o funil.\");\n\n  const bottleneckDrop = bottleneck ? Math.max(0, 100 - bottleneck.conversion) : 0;\n  const bottleneckStalledCount = bottleneck?.to.stalledCount ?? 0;\n  const bottleneckStalledDays = bottleneck?.to.stalledDays ?? 0;\n\n  const bestStage = useMemo(() => {\n    if (transitions.length === 0) return null;\n    return transitions.reduce((best, current) =>\n      current.conversion > best.conversion ? current : best\n    );\n  }, [transitions]);\n\n  const highlightConversion = bestStage ? bestStage.conversion : 0;\n  const highlightStageName = bestStage?.from.label ?? \"—\";\n\n  const riskDealEntries = useMemo<RiskDealEntry[]>(() => {\n    const stalledThreshold = now.getTime() - STALLED_OPPORTUNITY_DAYS * DAY_MS;\n    const selectedPipelineStage = selectedStage\n      ? STAGE_TO_PIPELINE[selectedStage.id]\n      : null;\n\n    const stalledInScope = openOpportunities\n      .filter((opportunity) => {\n        if (selectedPipelineStage && opportunity.stage !== selectedPipelineStage) {\n          return false;\n        }\n        return new Date(opportunity.updatedAt).getTime() < stalledThreshold;\n      })\n      .sort(\n        (first, second) =>\n          new Date(first.updatedAt).getTime() - new Date(second.updatedAt).getTime()\n      )\n      .slice(0, 3)\n      .map((opportunity) => ({\n        id: opportunity.id,\n        label: opportunity.title || opportunity.clientName,\n        stalledDays: Math.max(\n          1,\n          Math.round((now.getTime() - new Date(opportunity.updatedAt).getTime()) / DAY_MS)\n        ),\n      }));\n\n    if (stalledInScope.length > 0) {\n      return stalledInScope;\n    }\n\n    if (selectedStage) {\n      return (insights[selectedStage.id]?.riskDeals ?? []).slice(0, 3).map((deal, index) => ({\n        id: `${selectedStage.id}-${index}-${deal}`,\n        label: deal,\n        stalledDays: selectedStage.stalledDays,\n      }));\n    }\n\n    if (criticalStage) {\n      return (insights[criticalStage.id]?.riskDeals ?? []).slice(0, 3).map((deal, index) => ({\n        id: `${criticalStage.id}-${index}-${deal}`,\n        label: deal,\n        stalledDays: criticalStage.stalledDays,\n      }));\n    }\n\n    return [];\n  }, [openOpportunities, now, selectedStage, insights, criticalStage]);\n\n  useEffect(() => {\n    setViewState(state);\n  }, [state]);\n\n  useEffect(() => {\n    if (actionState !== \"success\") return;\n    const timer = window.setTimeout(() => setActionState(\"idle\"), 2400);\n    return () => window.clearTimeout(timer);\n  }, [actionState]);\n\n  function setStageSelection(nextStageId: FlowStageId | null) {\n    const currentStage = selectedStage?.id ?? null;\n    if (currentStage === nextStageId) return;\n\n    const params = new URLSearchParams(searchParams.toString());\n    if (nextStageId) {\n      params.set(\"stage\", STAGE_TO_PIPELINE[nextStageId]);\n    } else {\n      params.delete(\"stage\");\n    }\n\n    const serialized = params.toString();\n    const nextUrl = serialized ? `${pathname}?${serialized}` : pathname;\n    router.replace(nextUrl, { scroll: false });\n  }\n\n  function openPipeline({\n    stageId,\n    filter,\n  }: {\n    stageId?: FlowStageId;\n    filter?: \"risk\" | \"no_activity\" | \"sla_overdue\" | \"sla_risk\";\n  } = {}) {\n    const params = new URLSearchParams();\n\n    if (stageId) {\n      params.set(\"stage\", STAGE_TO_PIPELINE[stageId]);\n    }\n\n    if (filter) {\n      params.set(\"filter\", filter);\n    }\n\n    const serialized = params.toString();\n    router.push(serialized ? `/pipes?${serialized}` : \"/pipes\");\n  }\n\n  function handleRecommendedAction() {\n    if (actionState === \"loading\" || !scopeStage) return;\n    setActionState(\"loading\");\n\n    const pipelineStage = STAGE_TO_PIPELINE[scopeStage.id];\n    const stalledThreshold = STALLED_OPPORTUNITY_DAYS * DAY_MS;\n    const stalledOpps = openOpportunities\n      .filter(\n        (opportunity) =>\n          opportunity.stage === pipelineStage &&\n          now.getTime() - new Date(opportunity.updatedAt).getTime() > stalledThreshold\n      )\n      .slice(0, 3);\n\n    const tomorrow = new Date(now);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    const tomorrowStr = tomorrow.toISOString().split(\"T\")[0];\n\n    let count = 0;\n    for (const opportunity of stalledOpps) {\n      addActivity({\n        title: `Follow-up: ${opportunity.title || opportunity.clientName}`,\n        description: `Cobrar feedback — oportunidade parada há +${Math.round(\n          (now.getTime() - new Date(opportunity.updatedAt).getTime()) / DAY_MS\n        )} dias`,\n        type: \"call\",\n        status: \"pending\",\n        dueDate: tomorrowStr,\n        dueTime: \"10:00\",\n        opportunityId: opportunity.id,\n        clientId: opportunity.clientId || \"\",\n        responsibleId: userId || opportunity.responsibleId,\n        responsibleName: opportunity.responsibleName,\n      });\n      count += 1;\n    }\n\n    if (count === 0 && openOpportunities.some((opportunity) => opportunity.stage === pipelineStage)) {\n      const firstOpportunity = openOpportunities.find(\n        (opportunity) => opportunity.stage === pipelineStage\n      );\n\n      if (firstOpportunity) {\n        addActivity({\n          title: `Follow-up: ${firstOpportunity.title || firstOpportunity.clientName}`,\n          description: `Follow-up gerado automaticamente para etapa ${scopeStage.label}`,\n          type: \"call\",\n          status: \"pending\",\n          dueDate: tomorrowStr,\n          dueTime: \"10:00\",\n          opportunityId: firstOpportunity.id,\n          clientId: firstOpportunity.clientId || \"\",\n          responsibleId: userId || firstOpportunity.responsibleId,\n          responsibleName: firstOpportunity.responsibleName,\n        });\n        count = 1;\n      }\n    }\n\n    setCreatedCount(count);\n    setActionState(count > 0 ? \"success\" : \"error\");\n  }\n\n  function handleRetry() {\n    setViewState(\"loading\");\n    window.setTimeout(() => {\n      setViewState(\"ready\");\n    }, 220);\n  }\n\n  return (\n    <BentoCard\n      noPadding\n      elevated\n      className=\"premium-panel min-h-0 overflow-hidden border-zinc-200/80 bg-white/86 shadow-[0_20px_32px_-28px_rgba(15,23,42,0.45)]\"\n    >\n      <div className=\"border-b border-zinc-200/75 bg-white/85 px-3.5 py-3 backdrop-blur-sm\">\n        <div className=\"flex items-start justify-between gap-3\">\n          <div className=\"min-w-0\">\n            <h3 className=\"font-heading text-[1.02rem] font-semibold text-zinc-900\">\n              Raio X do Funil\n            </h3>\n            <p className=\"truncate text-xs text-zinc-500\">\n              Fluxo de conversão, gargalos e ação recomendada para hoje\n            </p>\n          </div>\n          <motion.button\n            type=\"button\"\n            onClick={() => openPipeline({ stageId: selectedStage?.id })}\n            whileTap={{ scale: 0.99 }}\n            transition={{ duration: 0.09, ease: \"easeOut\" }}\n            className=\"group inline-flex shrink-0 items-center gap-1.5 rounded-full px-2 py-1 text-xs font-semibold text-zinc-700 transition-[background-color,color,border-color,opacity] duration-120 ease-out hover:bg-zinc-100 hover:text-zinc-900\"\n          >\n            <span className=\"underline-offset-4 transition-colors duration-120 group-hover:underline\">\n              Ver Pipeline\n            </span>\n            <ArrowRight className=\"h-3.5 w-3.5\" />\n          </motion.button>\n        </div>\n      </div>\n\n      {viewState === \"error\" && (\n        <div className=\"mx-5 mt-4 rounded-xl border border-red-200/80 bg-red-50/70 px-3 py-2.5\">\n          <div className=\"flex items-center justify-between gap-2\">\n            <p className=\"flex items-center gap-1.5 text-xs font-medium text-red-700\">\n              <AlertTriangle className=\"h-3.5 w-3.5\" />\n              Não foi possível carregar o Raio X agora.\n            </p>\n            <button\n              type=\"button\"\n              onClick={handleRetry}\n              className=\"text-xs font-semibold text-red-700 underline underline-offset-4 transition-colors hover:text-red-800\"\n            >\n              Tentar novamente\n            </button>\n          </div>\n        </div>\n      )}\n\n      {viewState === \"loading\" && <FunnelXRaySkeleton />}\n\n      {viewState === \"ready\" && !hasEnoughData && (\n        <div className=\"p-5\">\n          <div className=\"rounded-xl border border-dashed border-zinc-300 bg-zinc-50/70 p-4\">\n            <p className=\"text-sm font-semibold text-zinc-900\">\n              Sem dados suficientes para o Raio X\n            </p>\n            <p className=\"mt-1 text-xs text-zinc-500\">\n              Cadastre oportunidades para gerar conversão e gargalos acionáveis.\n            </p>\n            <Button\n              size=\"sm\"\n              className=\"mt-3 h-8 rounded-full bg-zinc-900 text-xs text-white hover:bg-zinc-800\"\n              onClick={() => openPipeline()}\n            >\n              Ver pipeline\n            </Button>\n          </div>\n        </div>\n      )}\n\n      {viewState === \"ready\" && hasEnoughData && (\n        <motion.div\n          initial={{ opacity: 0, y: 6 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.18, ease: \"easeOut\" }}\n          className=\"flex flex-col gap-5 p-5\"\n        >\n          <div className=\"w-full space-y-4\">\n            <TooltipProvider delayDuration={80}>\n              <FlowStepsConnected\n                stages={stages}\n                transitions={transitions}\n                selectedStageId={selectedStage?.id ?? null}\n                bottleneckToStageId={bottleneck?.to.id ?? null}\n                onSelectStage={setStageSelection}\n              />\n            </TooltipProvider>\n\n            {selectedStage ? (\n              <div className=\"flex flex-wrap items-center justify-between gap-2 rounded-xl border border-zinc-200/80 bg-zinc-50/70 px-3 py-2\">\n                <p className=\"text-xs text-zinc-600\">\n                  Exibindo insights da etapa:{\" \"}\n                  <span className=\"font-semibold text-zinc-900\">{selectedStage.label}</span>\n                </p>\n                <button\n                  type=\"button\"\n                  onClick={() => setStageSelection(null)}\n                  className=\"text-xs font-semibold text-brand underline underline-offset-4\"\n                >\n                  Limpar seleção\n                </button>\n              </div>\n            ) : null}\n\n            <AnimatePresence mode=\"wait\">\n              <motion.div\n                key={insightScopeKey}\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                transition={{ duration: 0.14 }}\n                className=\"space-y-3\"\n              >\n                <div className=\"grid grid-cols-1 gap-2 sm:grid-cols-3\">\n                  <SummaryMiniCard\n                    icon={<Gauge className=\"h-3.5 w-3.5 text-brand\" />}\n                    label=\"Velocidade média\"\n                    value={averageSpeedDays > 0 ? `${averageSpeedDays} dias` : \"—\"}\n                    helper=\"Da entrada ao fechamento\"\n                    onClick={() => openPipeline()}\n                  />\n                  <SummaryMiniCard\n                    icon={<AlertTriangle className=\"h-3.5 w-3.5 text-amber-600\" />}\n                    label=\"Valor em risco\"\n                    value={formatCurrencyBRL(riskValue)}\n                    helper=\"Deals sem retorno > 5 dias\"\n                    onClick={() =>\n                      openPipeline({\n                        stageId: selectedStage?.id,\n                        filter: \"risk\",\n                      })\n                    }\n                  />\n                  <SummaryMiniCard\n                    icon={<Lightbulb className=\"h-3.5 w-3.5 text-emerald-600\" />}\n                    label=\"Etapa crítica hoje\"\n                    value={bottleneck?.to.label ?? \"—\"}\n                    helper={`${bottleneckDrop}% de queda`}\n                    onClick={() => openPipeline({ stageId: bottleneck?.to.id })}\n                  />\n                </div>\n\n                <div className=\"rounded-xl border border-zinc-200/80 bg-white/80 p-3.5\">\n                  <div className=\"mb-2 flex items-center justify-between\">\n                    <p className=\"text-xs font-semibold uppercase tracking-wide text-zinc-500\">\n                      Oportunidades em risco\n                    </p>\n                    <button\n                      type=\"button\"\n                      onClick={() =>\n                        selectedStage\n                          ? openPipeline({ stageId: selectedStage.id, filter: \"risk\" })\n                          : openPipeline({ filter: \"risk\" })\n                      }\n                      className=\"text-[11px] font-semibold text-brand underline-offset-4 transition-colors hover:text-brand-strong hover:underline\"\n                    >\n                      {selectedStage ? \"Ver etapa\" : \"Ver risco\"}\n                    </button>\n                  </div>\n                  <div className=\"space-y-1.5\">\n                    {riskDealEntries.length > 0 ? (\n                      riskDealEntries.map((deal) => (\n                        <div\n                          key={deal.id}\n                          className=\"flex items-center justify-between rounded-lg border border-zinc-200/70 bg-zinc-50/70 px-2.5 py-2\"\n                        >\n                          <span className=\"truncate text-xs font-medium text-zinc-700\">\n                            {deal.label}\n                          </span>\n                          <span className=\"ml-3 text-[10px] text-zinc-500\">\n                            +{deal.stalledDays} dias\n                          </span>\n                        </div>\n                      ))\n                    ) : (\n                      <p className=\"py-2 text-center text-xs text-zinc-400\">\n                        Nenhuma oportunidade em risco nesta visão\n                      </p>\n                    )}\n                  </div>\n                </div>\n              </motion.div>\n            </AnimatePresence>\n          </div>\n\n          <div className=\"grid grid-cols-1 gap-4 lg:grid-cols-3\">\n            <div className=\"flex flex-col rounded-xl border border-red-200/75 bg-red-50/60 p-4\">\n              <div className=\"mb-2 flex items-start justify-between gap-2\">\n                <span className=\"rounded-full bg-red-100 px-2 py-0.5 text-[10px] font-bold uppercase tracking-[0.08em] text-red-700\">\n                  TOP GARGALO\n                </span>\n                <TrendingDown className=\"h-4 w-4 text-red-600\" />\n              </div>\n              <p className=\"text-[1rem] font-semibold text-zinc-900\">\n                Queda de <span className=\"text-red-600\">{bottleneckDrop}%</span> em{\" \"}\n                {bottleneck?.to.label ?? \"—\"}\n              </p>\n              <p className=\"mt-1 text-xs text-zinc-600\">\n                {bottleneckStalledCount > 0\n                  ? `${bottleneckStalledCount} oportunidades paradas há +${bottleneckStalledDays} dias.`\n                  : \"Sem oportunidades paradas nesta etapa.\"}\n              </p>\n              <button\n                type=\"button\"\n                onClick={() =>\n                  openPipeline({\n                    stageId: bottleneck?.to.id,\n                    filter: \"risk\",\n                  })\n                }\n                className=\"mt-2 inline-flex items-center gap-1 text-xs font-semibold text-red-700 underline-offset-4 transition-colors hover:text-red-800 hover:underline\"\n              >\n                Ver lista\n                <ArrowRight className=\"h-3 w-3\" />\n              </button>\n            </div>\n\n            <div className=\"flex flex-col rounded-xl border border-emerald-200/75 bg-emerald-50/65 p-4\">\n              <div className=\"mb-2 flex items-start justify-between gap-2\">\n                <span className=\"rounded-full bg-emerald-100 px-2 py-0.5 text-[10px] font-bold uppercase tracking-[0.08em] text-emerald-700\">\n                  DESTAQUE\n                </span>\n                <ArrowUpRight className=\"h-4 w-4 text-emerald-600\" />\n              </div>\n              <p className=\"text-[1rem] font-semibold text-zinc-900\">\n                {highlightConversion > 0 ? (\n                  <>\n                    Melhor conversão:{\" \"}\n                    <span className=\"text-emerald-600\">{highlightConversion}%</span> em{\" \"}\n                    {highlightStageName}\n                  </>\n                ) : (\n                  \"Sem dados de conversão suficientes\"\n                )}\n              </p>\n              <p className=\"mt-1 text-xs text-zinc-600\">{highlightText}</p>\n              <button\n                type=\"button\"\n                onClick={() => openPipeline({ stageId: bestStage?.from.id })}\n                className=\"mt-2 inline-flex items-center gap-1 text-xs font-semibold text-emerald-700 underline-offset-4 transition-colors hover:text-emerald-800 hover:underline\"\n              >\n                Ver motivo\n                <ArrowRight className=\"h-3 w-3\" />\n              </button>\n            </div>\n\n            <div className=\"flex flex-col rounded-xl border border-zinc-200/80 bg-white/85 p-4\">\n              <div className=\"mb-2 flex items-center justify-between\">\n                <h4 className=\"text-sm font-semibold text-zinc-900\">\n                  Ação recomendada\n                </h4>\n                <Sparkles className=\"h-4 w-4 text-brand\" />\n              </div>\n\n              <AnimatePresence mode=\"wait\">\n                <motion.p\n                  key={insightScopeKey}\n                  initial={{ opacity: 0 }}\n                  animate={{ opacity: 1 }}\n                  exit={{ opacity: 0 }}\n                  transition={{ duration: 0.14 }}\n                  className=\"text-xs leading-relaxed text-zinc-600\"\n                >\n                  {recommendationText}\n                </motion.p>\n              </AnimatePresence>\n\n              <div className=\"mt-3 space-y-2\">\n                <Button\n                  onClick={handleRecommendedAction}\n                  disabled={actionState === \"loading\"}\n                  className=\"h-9 w-full rounded-full bg-zinc-900 text-xs font-semibold text-white hover:bg-zinc-800\"\n                >\n                  {actionState === \"loading\" ? (\n                    <>\n                      <Loader2 className=\"mr-1.5 h-3.5 w-3.5 animate-spin\" />\n                      Criando atividades...\n                    </>\n                  ) : (\n                    \"Cobrar feedbacks\"\n                  )}\n                </Button>\n                <button\n                  type=\"button\"\n                  onClick={() => router.push(\"/intelligence\")}\n                  className=\"w-full text-center text-xs font-semibold text-zinc-600 underline-offset-4 transition-colors hover:text-zinc-800 hover:underline\"\n                >\n                  Gerar mensagens via IA\n                </button>\n              </div>\n\n              <AnimatePresence>\n                {actionState === \"success\" && (\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                    transition={{ duration: 0.09 }}\n                    className=\"mt-2 inline-flex rounded-full bg-emerald-100 px-2.5 py-1 text-[11px] font-semibold text-emerald-700\"\n                  >\n                    {createdCount} atividade{createdCount !== 1 ? \"s\" : \"\"} criada{createdCount !== 1 ? \"s\" : \"\"}\n                  </motion.div>\n                )}\n              </AnimatePresence>\n\n              <AnimatePresence>\n                {actionState === \"error\" && (\n                  <motion.div\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                    transition={{ duration: 0.12 }}\n                    className=\"mt-2 rounded-lg border border-red-200 bg-red-50 px-2.5 py-2 text-xs text-red-700\"\n                  >\n                    Nenhuma oportunidade parada encontrada nesta etapa.\n                    <button\n                      type=\"button\"\n                      onClick={() => openPipeline({ stageId: scopeStage?.id })}\n                      className=\"ml-1.5 font-semibold underline underline-offset-4\"\n                    >\n                      Ver pipeline\n                    </button>\n                  </motion.div>\n                )}\n              </AnimatePresence>\n            </div>\n          </div>\n        </motion.div>\n      )}\n    </BentoCard>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3622, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/index.ts"],"sourcesContent":["export { FunnelXRay } from \"./funnel-x-ray\";\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 3632, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-execution-panel-data.ts"],"sourcesContent":["\"use client\";\n\n// ============================================================================\n// Hook que computa dados em tempo real para o Execution Panel\n// ============================================================================\n\nimport { useMemo } from \"react\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useClientStore } from \"@/stores/client-store\";\nimport { useGoalStore } from \"@/stores/goal-store\";\nimport { usePipelineStore } from \"@/stores/pipeline-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport {\n  computeTodaysPriorities,\n  computeSmartInsights,\n  computeQuickWins,\n  computeRiskAlerts,\n} from \"@/lib/proactive-engine\";\nimport type {\n  ProactiveEngineInput,\n  ExecutionPanelData,\n} from \"@/lib/proactive-engine\";\n\nexport function useExecutionPanelData(): ExecutionPanelData {\n  const opportunities = useOpportunityStore((s) => s.opportunities);\n  const activities = useActivityStore((s) => s.activities);\n  const clients = useClientStore((s) => s.clients);\n  const goals = useGoalStore((s) => s.goals);\n  const pipelines = usePipelineStore((s) => s.pipelines);\n  const user = useAuthStore((s) => s.user);\n\n  return useMemo(() => {\n    const empty: ExecutionPanelData = { priorities: [], insights: [], quickWins: [], riskAlerts: [] };\n    if (!user) return empty;\n\n    try {\n      const input: ProactiveEngineInput = {\n        opportunities,\n        activities,\n        clients,\n        goals,\n        pipelines,\n        userId: user.id,\n        userRole: user.role,\n      };\n\n      return {\n        priorities: computeTodaysPriorities(input),\n        insights: computeSmartInsights(input),\n        quickWins: computeQuickWins(input),\n        riskAlerts: computeRiskAlerts(input),\n      };\n    } catch (err) {\n      console.error(\"[ExecutionPanelData] Erro ao computar dados:\", err);\n      return empty;\n    }\n  }, [opportunities, activities, clients, goals, pipelines, user]);\n}\n"],"names":[],"mappings":";;;;AAEA,+EAA+E;AAC/E,8DAA8D;AAC9D,+EAA+E;AAE/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAbA;;;;;;;;;AAwBO,SAAS;;IACd,MAAM,gBAAgB,IAAA,+JAAmB;oEAAC,CAAC,IAAM,EAAE,aAAa;;IAChE,MAAM,aAAa,IAAA,yJAAgB;8DAAC,CAAC,IAAM,EAAE,UAAU;;IACvD,MAAM,UAAU,IAAA,qJAAc;yDAAC,CAAC,IAAM,EAAE,OAAO;;IAC/C,MAAM,QAAQ,IAAA,iJAAY;qDAAC,CAAC,IAAM,EAAE,KAAK;;IACzC,MAAM,YAAY,IAAA,yJAAgB;6DAAC,CAAC,IAAM,EAAE,SAAS;;IACrD,MAAM,OAAO,IAAA,iJAAY;oDAAC,CAAC,IAAM,EAAE,IAAI;;IAEvC,OAAO,IAAA,wKAAO;yCAAC;YACb,MAAM,QAA4B;gBAAE,YAAY,EAAE;gBAAE,UAAU,EAAE;gBAAE,WAAW,EAAE;gBAAE,YAAY,EAAE;YAAC;YAChG,IAAI,CAAC,MAAM,OAAO;YAElB,IAAI;gBACF,MAAM,QAA8B;oBAClC;oBACA;oBACA;oBACA;oBACA;oBACA,QAAQ,KAAK,EAAE;oBACf,UAAU,KAAK,IAAI;gBACrB;gBAEA,OAAO;oBACL,YAAY,IAAA,2KAAuB,EAAC;oBACpC,UAAU,IAAA,wKAAoB,EAAC;oBAC/B,WAAW,IAAA,oKAAgB,EAAC;oBAC5B,YAAY,IAAA,mKAAiB,EAAC;gBAChC;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,gDAAgD;gBAC9D,OAAO;YACT;QACF;wCAAG;QAAC;QAAe;QAAY;QAAS;QAAO;QAAW;KAAK;AACjE;GAlCgB;;QACQ,+JAAmB;QACtB,yJAAgB;QACnB,qJAAc;QAChB,iJAAY;QACR,yJAAgB;QACrB,iJAAY"}},
    {"offset": {"line": 3735, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/execution-section.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { motion, AnimatePresence } from \"framer-motion\";\nimport {\n  AlertTriangle,\n  AlertCircle,\n  Info,\n  CheckCircle2,\n  Phone,\n  Mail,\n  Calendar,\n  MoreHorizontal,\n  ExternalLink,\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { BentoCard } from \"@/components/ui/bento-card\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useExecutionPanelData } from \"@/hooks/use-execution-panel-data\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport type { RiskAlert } from \"@/lib/proactive-engine\";\n\n// --- Critical Alerts Component ---\n\ntype AlertSeverity = \"critical\" | \"warning\" | \"info\";\n\ninterface DisplayAlert {\n  id: string;\n  severity: AlertSeverity;\n  title: string;\n  consequence: string;\n  type: RiskAlert[\"type\"] | \"overdue-activities\";\n  linkedEntityId?: string;\n}\n\nexport function CriticalAlerts() {\n  const router = useRouter();\n  const { riskAlerts } = useExecutionPanelData();\n  const {\n    filteredActivities,\n    openOpportunities,\n    now,\n    userId,\n  } = useDashboardFilters();\n  const updateOpportunity = useOpportunityStore((s) => s.updateOpportunity);\n  const addActivity = useActivityStore((s) => s.addActivity);\n  const completeActivity = useActivityStore((s) => s.completeActivity);\n  const dismissedIds = useMemo(() => new Set<string>(), []);\n  const [resolvedIds, setResolvedIds] = useState<Set<string>>(new Set());\n\n  // Map proactive engine alerts to display alerts\n  const alerts: DisplayAlert[] = useMemo(() => {\n    const result: DisplayAlert[] = [];\n\n    // Add proactive engine risk alerts\n    for (const alert of riskAlerts) {\n      result.push({\n        id: alert.id,\n        severity: alert.severity === \"critical\" ? \"critical\" : \"warning\",\n        title: alert.title,\n        consequence: alert.description,\n        type: alert.type,\n        linkedEntityId: alert.linkedEntityId,\n      });\n    }\n\n    // Add overdue activities alert if not already covered\n    const overdueCount = filteredActivities.filter(\n      (a) => a.effectiveStatus === \"overdue\"\n    ).length;\n    if (\n      overdueCount > 0 &&\n      !result.some((a) => a.type === \"sla-breach\")\n    ) {\n      result.push({\n        id: \"overdue-activities\",\n        severity: \"info\",\n        title: `${overdueCount} atividade${overdueCount > 1 ? \"s\" : \"\"} atrasada${overdueCount > 1 ? \"s\" : \"\"}`,\n        consequence: \"Impacto no pipeline da semana\",\n        type: \"overdue-activities\",\n      });\n    }\n\n    return result;\n  }, [riskAlerts, filteredActivities]);\n\n  const visibleAlerts = alerts.filter(\n    (a) => !dismissedIds.has(a.id) && !resolvedIds.has(a.id)\n  );\n\n  function resolveAlert(alert: DisplayAlert) {\n    const tomorrow = new Date(now);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    const tomorrowStr = tomorrow.toISOString().split(\"T\")[0];\n\n    switch (alert.type) {\n      case \"sla-breach\":\n      case \"stale\": {\n        // Reset the opportunity's updatedAt + create a follow-up activity\n        if (alert.linkedEntityId) {\n          updateOpportunity(alert.linkedEntityId, {});\n          const opp = openOpportunities.find((o) => o.id === alert.linkedEntityId);\n          if (opp) {\n            addActivity({\n              title: `Follow-up urgente: ${opp.title || opp.clientName}`,\n              description: `Gerado ao resolver alerta: ${alert.title}`,\n              type: \"call\",\n              status: \"pending\",\n              dueDate: tomorrowStr,\n              dueTime: \"09:00\",\n              opportunityId: opp.id,\n              clientId: opp.clientId || \"\",\n              responsibleId: userId || opp.responsibleId,\n              responsibleName: opp.responsibleName,\n            });\n          }\n        }\n        break;\n      }\n\n      case \"overdue-activities\": {\n        // Complete the first overdue activity\n        const firstOverdue = filteredActivities.find(\n          (a) => a.effectiveStatus === \"overdue\"\n        );\n        if (firstOverdue) {\n          completeActivity(firstOverdue.id, \"Resolvido via dashboard\");\n        }\n        break;\n      }\n\n      case \"contract-expiring\": {\n        // Create a renewal task\n        if (alert.linkedEntityId) {\n          addActivity({\n            title: `Renovação de contrato`,\n            description: `Gerado ao resolver alerta: ${alert.title}`,\n            type: \"meeting\",\n            status: \"pending\",\n            dueDate: tomorrowStr,\n            dueTime: \"14:00\",\n            opportunityId: \"\",\n            clientId: alert.linkedEntityId,\n            responsibleId: userId,\n            responsibleName: \"\",\n          });\n        }\n        break;\n      }\n\n      case \"goal-risk\": {\n        router.push(\"/goals\");\n        break;\n      }\n\n      case \"health-drop\": {\n        // Create follow-up activity for client health\n        if (alert.linkedEntityId) {\n          addActivity({\n            title: `Acompanhamento de saúde do cliente`,\n            description: `Gerado ao resolver alerta: ${alert.title}`,\n            type: \"call\",\n            status: \"pending\",\n            dueDate: tomorrowStr,\n            dueTime: \"10:00\",\n            opportunityId: \"\",\n            clientId: alert.linkedEntityId,\n            responsibleId: userId,\n            responsibleName: \"\",\n          });\n        }\n        break;\n      }\n    }\n\n    setResolvedIds((prev) => new Set(prev).add(alert.id));\n  }\n\n  return (\n    <BentoCard className=\"premium-panel flex flex-col gap-4 border-zinc-200/80 bg-white/86 p-5 shadow-[0_16px_28px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"font-semibold text-zinc-900\">Alertas Críticos</h3>\n        <span className=\"flex h-5 w-5 items-center justify-center rounded-full bg-red-100 text-[10px] font-bold text-red-600\">\n          {visibleAlerts.length}\n        </span>\n      </div>\n\n      <div className=\"flex flex-col gap-3\">\n        <AnimatePresence>\n          {visibleAlerts.length === 0 && (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              className=\"flex flex-col items-center justify-center py-8 text-center\"\n            >\n              <CheckCircle2 className=\"mb-2 h-8 w-8 text-emerald-500\" />\n              <p className=\"text-sm font-medium text-zinc-900\">Tudo limpo!</p>\n              <p className=\"text-xs text-zinc-500\">Sem alertas pendentes.</p>\n            </motion.div>\n          )}\n          {visibleAlerts.map((alert) => (\n            <motion.div\n              key={alert.id}\n              layout\n              initial={{ opacity: 0, scale: 0.95 }}\n              animate={{ opacity: 1, scale: 1 }}\n              exit={{ opacity: 0, height: 0, marginTop: 0, marginBottom: 0 }}\n              className={cn(\n                \"group relative flex flex-col gap-2 rounded-xl border bg-zinc-50/70 p-3 transition-all duration-140 ease-out hover:-translate-y-[1px] hover:bg-white hover:shadow-[0_14px_24px_-20px_rgba(15,23,42,0.45)]\",\n                alert.severity === \"critical\"\n                  ? \"border-red-200/85\"\n                  : alert.severity === \"warning\"\n                    ? \"border-amber-200/85\"\n                    : \"border-blue-200/85\"\n              )}\n            >\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-start gap-3\">\n                  {alert.severity === \"critical\" ? (\n                    <AlertCircle className=\"mt-0.5 h-4 w-4 text-red-600\" />\n                  ) : alert.severity === \"warning\" ? (\n                    <AlertTriangle className=\"mt-0.5 h-4 w-4 text-amber-600\" />\n                  ) : (\n                    <Info className=\"mt-0.5 h-4 w-4 text-blue-600\" />\n                  )}\n\n                  <div>\n                    <p className=\"text-sm font-medium text-zinc-900\">{alert.title}</p>\n                    <p className=\"mt-0.5 text-xs text-zinc-500\">\n                      Impacto: <span className=\"font-medium\">{alert.consequence}</span>\n                    </p>\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"mt-1 flex justify-end opacity-0 transition-opacity group-hover:opacity-100\">\n                <Button\n                  size=\"sm\"\n                  variant=\"ghost\"\n                  className=\"h-6 text-xs hover:bg-white hover:text-emerald-600\"\n                  onClick={() => resolveAlert(alert)}\n                >\n                  Resolver <CheckCircle2 className=\"ml-1 h-3 w-3\" />\n                </Button>\n              </div>\n            </motion.div>\n          ))}\n        </AnimatePresence>\n      </div>\n    </BentoCard>\n  );\n}\n\n// --- Today Activities Component ---\n\ninterface ActivityDisplay {\n  id: string;\n  time: string;\n  title: string;\n  details: string;\n  type: \"call\" | \"email\" | \"meeting\";\n  status: \"pending\" | \"overdue\" | \"done\";\n}\n\nfunction mapActivityType(type: string): ActivityDisplay[\"type\"] {\n  if (type === \"call\" || type === \"email\" || type === \"meeting\") return type;\n  return \"meeting\";\n}\n\nexport function TodayActivities() {\n  const router = useRouter();\n  const { filteredActivities } = useDashboardFilters();\n  const completeStoreActivity = useActivityStore((s) => s.completeActivity);\n\n  const pendingActivities: ActivityDisplay[] = useMemo(() => {\n    return filteredActivities\n      .filter((a) => a.effectiveStatus === \"pending\" || a.effectiveStatus === \"overdue\")\n      .slice(0, 5)\n      .map((a) => ({\n        id: a.id,\n        time: a.dueTime || \"—\",\n        title: a.title,\n        details: a.description || a.opportunityId || \"—\",\n        type: mapActivityType(a.type),\n        status: a.effectiveStatus === \"overdue\" ? (\"overdue\" as const) : (\"pending\" as const),\n      }));\n  }, [filteredActivities]);\n\n  const completeActivityHandler = (id: string) => {\n    completeStoreActivity(id);\n  };\n\n  return (\n    <BentoCard className=\"premium-panel flex min-h-[300px] flex-col gap-4 border-zinc-200/80 bg-white/86 p-5 shadow-[0_16px_28px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"font-semibold text-zinc-900\">Agenda de Hoje</h3>\n        <DropdownMenu>\n          <DropdownMenuTrigger asChild>\n            <Button variant=\"ghost\" size=\"icon\" className=\"h-6 w-6\">\n              <MoreHorizontal className=\"h-4 w-4 text-zinc-400\" />\n            </Button>\n          </DropdownMenuTrigger>\n          <DropdownMenuContent align=\"end\" className=\"w-48 rounded-xl\">\n            <DropdownMenuItem onClick={() => router.push(\"/activities\")}>\n              <ExternalLink className=\"mr-2 h-3.5 w-3.5\" />\n              Ver todas atividades\n            </DropdownMenuItem>\n            <DropdownMenuItem\n              onClick={() => router.push(\"/activities?status=overdue\")}\n            >\n              <AlertCircle className=\"mr-2 h-3.5 w-3.5 text-red-500\" />\n              Ver atrasadas\n            </DropdownMenuItem>\n          </DropdownMenuContent>\n        </DropdownMenu>\n      </div>\n\n      <div className=\"relative space-y-0\">\n        {/* Timeline Line */}\n        <div className=\"absolute bottom-2 left-[3.25rem] top-2 w-px bg-zinc-100\" />\n\n        <AnimatePresence>\n          {pendingActivities.length === 0 && (\n            <div className=\"py-8 text-center text-sm text-zinc-500\">\n              Agenda livre! Bom descanso.\n            </div>\n          )}\n          {pendingActivities.map((activity) => (\n            <motion.div\n              key={activity.id}\n              initial={{ opacity: 0, x: -10 }}\n              animate={{ opacity: 1, x: 0 }}\n              exit={{ opacity: 0, height: 0, marginBottom: 0 }}\n              className=\"group relative flex items-center gap-4 py-3 first:pt-0\"\n            >\n              <div className=\"w-10 text-right font-mono text-xs font-semibold text-zinc-400\">\n                {activity.time}\n              </div>\n\n              <div\n                className={cn(\n                  \"relative z-10 flex h-3 w-3 items-center justify-center rounded-full ring-4 ring-white\",\n                  activity.status === \"overdue\" ? \"bg-red-500\" : \"bg-zinc-300\"\n                )}\n              />\n\n              <div className=\"flex-1 rounded-lg border border-transparent p-2 transition-all group-hover:border-zinc-100 group-hover:bg-zinc-50/50\">\n                <div className=\"flex items-start justify-between\">\n                  <div>\n                    <p\n                      className={cn(\n                        \"text-sm font-medium\",\n                        activity.status === \"overdue\"\n                          ? \"text-red-600\"\n                          : \"text-zinc-900\"\n                      )}\n                    >\n                      {activity.title}\n                    </p>\n                    <div className=\"flex items-center gap-1.5 text-xs text-zinc-500\">\n                      {activity.type === \"meeting\" && (\n                        <Calendar className=\"h-3 w-3\" />\n                      )}\n                      {activity.type === \"call\" && <Phone className=\"h-3 w-3\" />}\n                      {activity.type === \"email\" && <Mail className=\"h-3 w-3\" />}\n                      <span>{activity.details}</span>\n                    </div>\n                    {activity.status === \"overdue\" && (\n                      <span className=\"mt-1 inline-block rounded-sm bg-red-100 px-1.5 py-0.5 text-[10px] font-bold text-red-600\">\n                        ATRASADO\n                      </span>\n                    )}\n                  </div>\n\n                  <Button\n                    size=\"icon\"\n                    variant=\"ghost\"\n                    className=\"h-6 w-6 text-zinc-400 opacity-0 hover:bg-emerald-50 hover:text-emerald-600 group-hover:opacity-100\"\n                    onClick={() => completeActivityHandler(activity.id)}\n                  >\n                    <CheckCircle2 className=\"h-4 w-4\" />\n                  </Button>\n                </div>\n              </div>\n            </motion.div>\n          ))}\n        </AnimatePresence>\n      </div>\n    </BentoCard>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4451, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/ui/avatar.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport { Avatar as AvatarPrimitive } from \"radix-ui\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Avatar({\n  className,\n  size = \"default\",\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Root> & {\n  size?: \"default\" | \"sm\" | \"lg\"\n}) {\n  return (\n    <AvatarPrimitive.Root\n      data-slot=\"avatar\"\n      data-size={size}\n      className={cn(\n        \"group/avatar relative flex size-8 shrink-0 overflow-hidden rounded-full select-none data-[size=lg]:size-10 data-[size=sm]:size-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarImage({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Image>) {\n  return (\n    <AvatarPrimitive.Image\n      data-slot=\"avatar-image\"\n      className={cn(\"aspect-square size-full\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarFallback({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {\n  return (\n    <AvatarPrimitive.Fallback\n      data-slot=\"avatar-fallback\"\n      className={cn(\n        \"bg-muted text-muted-foreground flex size-full items-center justify-center rounded-full text-sm group-data-[size=sm]/avatar:text-xs\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarBadge({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      data-slot=\"avatar-badge\"\n      className={cn(\n        \"bg-primary text-primary-foreground ring-background absolute right-0 bottom-0 z-10 inline-flex items-center justify-center rounded-full ring-2 select-none\",\n        \"group-data-[size=sm]/avatar:size-2 group-data-[size=sm]/avatar:[&>svg]:hidden\",\n        \"group-data-[size=default]/avatar:size-2.5 group-data-[size=default]/avatar:[&>svg]:size-2\",\n        \"group-data-[size=lg]/avatar:size-3 group-data-[size=lg]/avatar:[&>svg]:size-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"avatar-group\"\n      className={cn(\n        \"*:data-[slot=avatar]:ring-background group/avatar-group flex -space-x-2 *:data-[slot=avatar]:ring-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarGroupCount({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"avatar-group-count\"\n      className={cn(\n        \"bg-muted text-muted-foreground ring-background relative flex size-8 shrink-0 items-center justify-center rounded-full text-sm ring-2 group-has-data-[size=lg]/avatar-group:size-10 group-has-data-[size=sm]/avatar-group:size-6 [&>svg]:size-4 group-has-data-[size=lg]/avatar-group:[&>svg]:size-5 group-has-data-[size=sm]/avatar-group:[&>svg]:size-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Avatar,\n  AvatarImage,\n  AvatarFallback,\n  AvatarBadge,\n  AvatarGroup,\n  AvatarGroupCount,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,OAAO,SAAS,EAChB,GAAG,OAGJ;IACC,qBACE,6LAAC,iNAAe,CAAC,IAAI;QACnB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,4HAAE,EACX,oIACA;QAED,GAAG,KAAK;;;;;;AAGf;KAlBS;AAoBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,iNAAe,CAAC,KAAK;QACpB,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,2BAA2B;QACxC,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,6LAAC,iNAAe,CAAC,QAAQ;QACvB,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,sIACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAqC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,6JACA,iFACA,6FACA,iFACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,4VACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS"}},
    {"offset": {"line": 4560, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/performance-section.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { useRouter } from \"next/navigation\";\nimport { Users, ThermometerSun, ChevronRight } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { BentoCard } from \"@/components/ui/bento-card\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport {\n  calculateTemperature,\n  calculateProjectedCommission,\n  formatCurrencyBRL,\n} from \"@/lib/business-rules\";\nimport { mockUsers } from \"@/lib/mock-data\";\n\n// --- Pipeline Health Component ---\nexport function PipelineHealth() {\n  const router = useRouter();\n  const {\n    openOpportunities,\n    filteredOpportunities,\n    now,\n  } = useDashboardFilters();\n\n  const { healthMetrics, temperature, avgDays } = useMemo(() => {\n    const openOpps = openOpportunities;\n\n    const stalledCount = openOpps.filter((o) => {\n      const daysSinceUpdate = Math.round(\n        (now.getTime() - new Date(o.updatedAt).getTime()) / (1000 * 60 * 60 * 24)\n      );\n      return daysSinceUpdate > 30;\n    }).length;\n\n    const activities = useActivityStore.getState().activities;\n    const oppsWithoutAction = openOpps.filter((o) => {\n      const oppActivities = activities.filter(\n        (a) =>\n          a.opportunityId === o.id &&\n          (a.status === \"pending\" || a.status === \"overdue\")\n      );\n      return oppActivities.length === 0;\n    }).length;\n\n    const noValueCount = openOpps.filter((o) => !o.value || o.value === 0).length;\n\n    const maxDenominator = Math.max(openOpps.length, 1);\n\n    // Calculate temperature using business rules\n    const avgValue =\n      openOpps.length > 0\n        ? openOpps.reduce((sum, o) => sum + (o.value || 0), 0) / openOpps.length\n        : 10000;\n\n    let hotCount = 0;\n    let coldCount = 0;\n    for (const opp of openOpps) {\n      const temp = calculateTemperature(opp, avgValue, now);\n      if (temp === \"hot\") hotCount++;\n      else if (temp === \"cold\") coldCount++;\n    }\n    const computedTemp =\n      hotCount > coldCount ? \"Quente\" : coldCount > hotCount ? \"Frio\" : \"Morno\";\n\n    const wonOpps = filteredOpportunities.filter((o) => o.status === \"won\");\n    let totalDays = 0;\n    wonOpps.forEach((o) => {\n      const created = new Date(o.createdAt).getTime();\n      const closed = new Date(o.updatedAt).getTime();\n      totalDays += Math.max(\n        1,\n        Math.round((closed - created) / (1000 * 60 * 60 * 24))\n      );\n    });\n    const computedAvgDays =\n      wonOpps.length > 0 ? Math.round(totalDays / wonOpps.length) : 0;\n\n    return {\n      healthMetrics: [\n        {\n          label: \"Estagnados (+30 dias)\",\n          value: stalledCount,\n          color: \"bg-red-500\",\n          filter: \"stalled\",\n          max: maxDenominator,\n        },\n        {\n          label: \"Sem próxima ação\",\n          value: oppsWithoutAction,\n          color: \"bg-amber-500\",\n          filter: \"no-action\",\n          max: maxDenominator,\n        },\n        {\n          label: \"Valor vazio\",\n          value: noValueCount,\n          color: \"bg-zinc-400\",\n          filter: \"no-value\",\n          max: maxDenominator,\n        },\n      ],\n      temperature: computedTemp,\n      avgDays: computedAvgDays,\n    };\n  }, [openOpportunities, filteredOpportunities, now]);\n\n  const tempColor =\n    temperature === \"Quente\"\n      ? \"text-emerald-600\"\n      : temperature === \"Frio\"\n        ? \"text-red-600\"\n        : \"text-amber-600\";\n\n  return (\n    <BentoCard className=\"premium-panel flex flex-col gap-4 border-zinc-200/80 bg-white/86 p-5 shadow-[0_16px_28px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"flex items-center gap-2 font-semibold text-zinc-900\">\n          <ThermometerSun className=\"h-4 w-4 text-orange-500\" />\n          Saúde do Pipeline\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {healthMetrics.map((metric) => (\n          <div\n            key={metric.label}\n            className=\"group cursor-pointer\"\n            onClick={() => router.push(`/pipes?health=${metric.filter}`)}\n            role=\"button\"\n            tabIndex={0}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\")\n                router.push(`/pipes?health=${metric.filter}`);\n            }}\n          >\n            <div className=\"mb-1.5 flex items-center justify-between\">\n              <span className=\"text-xs font-medium text-zinc-600 transition-colors group-hover:text-zinc-900\">\n                {metric.label}\n              </span>\n              <span className=\"text-xs font-bold text-zinc-900\">\n                {metric.value} deals\n              </span>\n            </div>\n            <div className=\"h-2 w-full overflow-hidden rounded-full bg-zinc-100\">\n              <motion.div\n                initial={{ width: 0 }}\n                animate={{\n                  width: `${Math.min(\n                    (metric.value / Math.max(metric.max, 1)) * 100,\n                    100\n                  )}%`,\n                }}\n                transition={{ duration: 0.24, ease: \"easeOut\" }}\n                className={cn(\n                  \"h-full rounded-full transition-all group-hover:brightness-110\",\n                  metric.color\n                )}\n              />\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"mt-auto border-t border-zinc-100 pt-4\">\n        <div className=\"flex items-center justify-center gap-6\">\n          <div className=\"text-center\">\n            <p className=\"text-[10px] font-semibold uppercase tracking-wider text-zinc-400\">\n              Temperatura\n            </p>\n            <p className={cn(\"text-lg font-bold\", tempColor)}>{temperature}</p>\n          </div>\n          <div className=\"h-8 w-px bg-zinc-100\" />\n          <div className=\"text-center\">\n            <p className=\"text-[10px] font-semibold uppercase tracking-wider text-zinc-400\">\n              Velocidade\n            </p>\n            <p className=\"text-lg font-bold text-zinc-900\">\n              {avgDays > 0 ? `${avgDays} dias` : \"—\"}\n            </p>\n          </div>\n        </div>\n      </div>\n    </BentoCard>\n  );\n}\n\n// --- Performance Component ---\nexport function TeamPerformance() {\n  const router = useRouter();\n  const { filteredOpportunities, context, userId, userRole } = useDashboardFilters();\n\n  const isBroadRole = userRole === \"master\" || userRole === \"admin\";\n\n  const teamData = useMemo(() => {\n    // filteredOpportunities already respects context via useDashboardFilters:\n    // - context \"me\" + role master/admin → returns ALL items\n    // - context \"me\" + role comercial → returns only own items\n    // So we only need the extra responsibleId filter for non-admin roles\n    const allOpps = filteredOpportunities.filter(\n      (o) => o.status === \"won\" || o.status === \"lost\"\n    );\n\n    const byUser: Record<\n      string,\n      {\n        name: string;\n        role: string;\n        revenue: number;\n        won: number;\n        total: number;\n      }\n    > = {};\n\n    for (const opp of allOpps) {\n      if (!opp.responsibleId) continue;\n      // When context is \"me\" for non-admin roles, only show own data\n      if (context === \"me\" && !isBroadRole && opp.responsibleId !== userId) continue;\n\n      if (!byUser[opp.responsibleId]) {\n        const user = mockUsers.find((u) => u.id === opp.responsibleId);\n        byUser[opp.responsibleId] = {\n          name: user?.name ?? opp.responsibleName ?? \"—\",\n          role: user?.role ?? \"comercial\",\n          revenue: 0,\n          won: 0,\n          total: 0,\n        };\n      }\n      byUser[opp.responsibleId].total += 1;\n      if (opp.status === \"won\") {\n        byUser[opp.responsibleId].revenue += opp.value || 0;\n        byUser[opp.responsibleId].won += 1;\n      }\n    }\n\n    return Object.entries(byUser)\n      .map(([id, data]) => {\n        const commission = calculateProjectedCommission(data.revenue);\n        return {\n          id,\n          name: data.name,\n          role: data.role,\n          revenue: data.revenue,\n          commission: commission.commissionValue,\n          conversion:\n            data.total > 0 ? Math.round((data.won / data.total) * 100) : 0,\n          won: data.won,\n          isMe: id === userId,\n        };\n      })\n      .sort((a, b) => b.revenue - a.revenue)\n      .slice(0, 3);\n  }, [filteredOpportunities, context, userId, isBroadRole]);\n\n  return (\n    <BentoCard className=\"premium-panel flex flex-col gap-4 border-zinc-200/80 bg-white/86 p-5 shadow-[0_16px_28px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"flex items-center gap-2 font-semibold text-zinc-900\">\n          <Users className=\"h-4 w-4 text-blue-500\" />\n          Performance pessoal\n        </h3>\n        <button\n          className=\"text-xs font-medium text-zinc-500 transition-colors hover:text-zinc-900\"\n          onClick={() => router.push(\"/goals\")}\n        >\n          Ver metas\n        </button>\n      </div>\n\n      {teamData.length === 0 ? (\n        <div className=\"py-6 text-center text-sm text-zinc-500\">\n          Sem dados de performance ainda.\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {teamData.map((member, i) => (\n            <div\n              key={member.id}\n              className=\"flex cursor-pointer items-center justify-between rounded-lg p-2 transition-colors hover:bg-zinc-50\"\n              onClick={() => router.push(\"/goals\")}\n              role=\"button\"\n              tabIndex={0}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") router.push(\"/goals\");\n              }}\n            >\n              <div className=\"flex items-center gap-3\">\n                <span\n                  className={cn(\n                    \"flex h-5 w-5 items-center justify-center rounded text-[10px] font-bold\",\n                    i === 0\n                      ? \"bg-amber-100 text-amber-700\"\n                      : i === 1\n                        ? \"bg-zinc-100 text-zinc-600\"\n                        : \"bg-zinc-100 text-zinc-400\"\n                  )}\n                >\n                  {i + 1}\n                </span>\n                <Avatar className=\"h-8 w-8 border border-zinc-100\">\n                  <AvatarFallback className=\"bg-zinc-100 text-[10px]\">\n                    {member.name.substring(0, 2)}\n                  </AvatarFallback>\n                </Avatar>\n                <div>\n                  <p className=\"text-xs font-bold text-zinc-900\">{member.name}</p>\n                  <p className=\"text-[10px] text-zinc-500\">{member.role}</p>\n                </div>\n              </div>\n\n              <div className=\"text-right\">\n                <p className=\"text-xs font-bold text-zinc-900\">\n                  {member.isMe || isBroadRole\n                    ? formatCurrencyBRL(member.revenue)\n                    : `${member.won} ganhos`}\n                </p>\n                <div className=\"flex items-center justify-end gap-1.5\">\n                  <span className=\"text-[10px] text-zinc-500\">\n                    {member.conversion}% conv.\n                  </span>\n                  {(member.isMe || isBroadRole) && member.commission > 0 && (\n                    <span className=\"text-[10px] font-medium text-emerald-600\">\n                      +{formatCurrencyBRL(member.commission)}\n                    </span>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      <button\n        className=\"mt-auto flex w-full items-center justify-center gap-1 rounded-lg border border-zinc-100 py-2 text-xs font-medium text-zinc-600 transition-colors hover:bg-zinc-50\"\n        onClick={() => router.push(\"/finance\")}\n      >\n        Ver relatório de comissão <ChevronRight className=\"h-3 w-3\" />\n      </button>\n    </BentoCard>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5141, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/app/%28auth%29/dashboard/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { Suspense, useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { useSearchParams } from \"next/navigation\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { DashboardHeader } from \"@/components/dashboard/header\";\nimport { KpiSection } from \"@/components/dashboard/kpi-section\";\nimport { FunnelXRay } from \"@/components/dashboard/funnel-x-ray\";\nimport { CriticalAlerts, TodayActivities } from \"@/components/dashboard/execution-section\";\nimport { PipelineHealth, TeamPerformance } from \"@/components/dashboard/performance-section\";\nimport { useProactiveEngine } from \"@/hooks/use-proactive-engine\";\nimport { screenContainer, sectionEnter } from \"@/lib/motion\";\n\nfunction DashboardLoadingSkeleton() {\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex items-center justify-between\">\n        <Skeleton className=\"h-8 w-56\" />\n        <Skeleton className=\"h-9 w-36 rounded-full\" />\n      </div>\n      <div className=\"grid grid-cols-2 gap-4 md:grid-cols-4\">\n        {Array.from({ length: 4 }).map((_, i) => (\n          <Skeleton key={i} className=\"h-24 rounded-xl\" />\n        ))}\n      </div>\n      <Skeleton className=\"h-64 rounded-xl\" />\n      <div className=\"grid grid-cols-1 gap-6 lg:grid-cols-12\">\n        <div className=\"lg:col-span-8 flex flex-col gap-6\">\n          <Skeleton className=\"h-48 rounded-xl\" />\n          <Skeleton className=\"h-48 rounded-xl\" />\n        </div>\n        <div className=\"lg:col-span-4 flex flex-col gap-6\">\n          <Skeleton className=\"h-48 rounded-xl\" />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction DashboardContent() {\n  // Activate proactive engine in background — feeds alerts & suggestions\n  useProactiveEngine();\n  const searchParams = useSearchParams();\n  const viewParam = searchParams.get(\"view\");\n\n  const [isLoading, setIsLoading] = useState(true);\n  useEffect(() => { const t = setTimeout(() => setIsLoading(false), 800); return () => clearTimeout(t); }, []);\n\n  useEffect(() => {\n    if (viewParam !== \"conversion\") return;\n    const target = document.getElementById(\"dashboard-funnel\");\n    if (!target) return;\n    target.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n  }, [viewParam]);\n\n  if (isLoading) {\n    return <DashboardLoadingSkeleton />;\n  }\n\n  return (\n    <motion.div\n      variants={screenContainer}\n      initial=\"hidden\"\n      animate=\"show\"\n      className=\"w-full max-w-full space-y-6\"\n    >\n      {/* Header */}\n      <motion.div variants={sectionEnter}>\n        <DashboardHeader />\n      </motion.div>\n\n      {/* Faixa B: KPIs */}\n      <motion.section id=\"dashboard-kpis\" variants={sectionEnter} className=\"scroll-mt-44\">\n        <KpiSection />\n      </motion.section>\n\n      {/* Faixa C: Funnel X-Ray */}\n      <motion.section id=\"dashboard-funnel\" variants={sectionEnter} className=\"scroll-mt-44\">\n        <FunnelXRay />\n      </motion.section>\n\n      {/* Faixa D: Execução */}\n      <motion.section\n        id=\"dashboard-execution\"\n        variants={sectionEnter}\n        className=\"grid grid-cols-1 gap-6 scroll-mt-44 lg:grid-cols-12\"\n      >\n         {/* Left Column: Alerts & Activities (8 cols) */}\n         <div className=\"lg:col-span-8 flex flex-col gap-6\">\n            <CriticalAlerts />\n            <TodayActivities />\n         </div>\n         \n         {/* Right Column: Health + Performance (4 cols) */}\n         <div className=\"lg:col-span-4 flex flex-col gap-6\">\n            <PipelineHealth />\n            <TeamPerformance />\n         </div>\n      </motion.section>\n    </motion.div>\n  );\n}\n\nexport default function Dashboard() {\n  return (\n    <Suspense fallback={<DashboardLoadingSkeleton />}>\n      <DashboardContent />\n    </Suspense>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;AAZA;;;;;;;;;;;;AAcA,SAAS;IACP,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,mJAAQ;wBAAC,WAAU;;;;;;kCACpB,6LAAC,mJAAQ;wBAAC,WAAU;;;;;;;;;;;;0BAEtB,6LAAC;gBAAI,WAAU;0BACZ,MAAM,IAAI,CAAC;oBAAE,QAAQ;gBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBACjC,6LAAC,mJAAQ;wBAAS,WAAU;uBAAb;;;;;;;;;;0BAGnB,6LAAC,mJAAQ;gBAAC,WAAU;;;;;;0BACpB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;;;;;;;kCAEtB,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,mJAAQ;4BAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK9B;KAxBS;AA0BT,SAAS;;IACP,uEAAuE;IACvE,IAAA,mKAAkB;IAClB,MAAM,eAAe,IAAA,wJAAe;IACpC,MAAM,YAAY,aAAa,GAAG,CAAC;IAEnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,IAAA,0KAAS;sCAAC;YAAQ,MAAM,IAAI;gDAAW,IAAM,aAAa;+CAAQ;YAAM;8CAAO,IAAM,aAAa;;QAAI;qCAAG,EAAE;IAE3G,IAAA,0KAAS;sCAAC;YACR,IAAI,cAAc,cAAc;YAChC,MAAM,SAAS,SAAS,cAAc,CAAC;YACvC,IAAI,CAAC,QAAQ;YACb,OAAO,cAAc,CAAC;gBAAE,UAAU;gBAAU,OAAO;YAAQ;QAC7D;qCAAG;QAAC;KAAU;IAEd,IAAI,WAAW;QACb,qBAAO,6LAAC;;;;;IACV;IAEA,qBACE,6LAAC,uMAAM,CAAC,GAAG;QACT,UAAU,0IAAe;QACzB,SAAQ;QACR,SAAQ;QACR,WAAU;;0BAGV,6LAAC,uMAAM,CAAC,GAAG;gBAAC,UAAU,uIAAY;0BAChC,cAAA,6LAAC,+JAAe;;;;;;;;;;0BAIlB,6LAAC,uMAAM,CAAC,OAAO;gBAAC,IAAG;gBAAiB,UAAU,uIAAY;gBAAE,WAAU;0BACpE,cAAA,6LAAC,kKAAU;;;;;;;;;;0BAIb,6LAAC,uMAAM,CAAC,OAAO;gBAAC,IAAG;gBAAmB,UAAU,uIAAY;gBAAE,WAAU;0BACtE,cAAA,6LAAC,4LAAU;;;;;;;;;;0BAIb,6LAAC,uMAAM,CAAC,OAAO;gBACb,IAAG;gBACH,UAAU,uIAAY;gBACtB,WAAU;;kCAGT,6LAAC;wBAAI,WAAU;;0CACZ,6LAAC,4KAAc;;;;;0CACf,6LAAC,6KAAe;;;;;;;;;;;kCAInB,6LAAC;wBAAI,WAAU;;0CACZ,6LAAC,8KAAc;;;;;0CACf,6LAAC,+KAAe;;;;;;;;;;;;;;;;;;;;;;;AAK5B;GA9DS;;QAEP,mKAAkB;QACG,wJAAe;;;MAH7B;AAgEM,SAAS;IACtB,qBACE,6LAAC,yKAAQ;QAAC,wBAAU,6LAAC;;;;;kBACnB,cAAA,6LAAC;;;;;;;;;;AAGP;MANwB"}}]
}