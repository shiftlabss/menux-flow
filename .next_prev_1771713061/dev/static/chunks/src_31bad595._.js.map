{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/ui/skeleton.tsx"],"sourcesContent":["import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"skeleton\"\n      className={cn(\n        \"relative overflow-hidden rounded-md bg-slate-200/75\",\n        \"before:absolute before:inset-0 before:animate-pulse\",\n        \"before:bg-linear-to-r before:from-transparent before:via-white/70 before:to-transparent\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n"],"names":[],"mappings":";;;;;AAAA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAoC;IACpE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,uDACA,uDACA,2FACA;QAED,GAAG,KAAK;;;;;;AAGf;KAbS"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/shared/module-command-header.tsx"],"sourcesContent":["\"use client\";\n\nimport Link from \"next/link\";\nimport type { ReactNode } from \"react\";\nimport { cn } from \"@/lib/cn\";\n\ntype ChipTone = \"neutral\" | \"info\" | \"warning\" | \"danger\" | \"success\";\n\nexport interface ModuleCommandHeaderChip {\n  id: string;\n  label: string;\n  icon?: ReactNode;\n  tone?: ChipTone;\n  onClick?: () => void;\n  href?: string;\n}\n\ninterface ModuleCommandHeaderProps {\n  title: ReactNode;\n  titleAccessory?: ReactNode;\n  description?: string;\n  actions?: ReactNode;\n  actionsClassName?: string;\n  meta?: ReactNode;\n  chips?: ModuleCommandHeaderChip[];\n  fallbackChip?: ModuleCommandHeaderChip;\n  children?: ReactNode;\n  className?: string;\n  sticky?: boolean;\n}\n\nconst chipToneStyles: Record<ChipTone, string> = {\n  neutral: \"border-zinc-200 bg-white/92 text-zinc-700\",\n  info: \"border-sky-200 bg-sky-50/88 text-sky-700\",\n  warning: \"border-amber-200 bg-amber-50/88 text-amber-700\",\n  danger: \"border-red-200 bg-red-50/88 text-red-700\",\n  success: \"border-emerald-200 bg-emerald-50/88 text-emerald-700\",\n};\n\nfunction renderChip(chip: ModuleCommandHeaderChip) {\n  const isInteractive = Boolean(chip.href || chip.onClick);\n  const classes = cn(\n    \"premium-shine inline-flex h-8 shrink-0 items-center justify-center gap-1.5 rounded-full border px-3 text-[12px] font-semibold tracking-tight whitespace-nowrap\",\n    isInteractive\n      ? \"cursor-pointer transition-all duration-150 ease-out hover:bg-white/75 hover:-translate-y-[1px] active:scale-[0.99] active:translate-y-0\"\n      : \"cursor-default select-none opacity-90\",\n    chipToneStyles[chip.tone ?? \"neutral\"]\n  );\n\n  const content = (\n    <>\n      {chip.icon ? <span className=\"shrink-0\">{chip.icon}</span> : null}\n      <span>{chip.label}</span>\n    </>\n  );\n\n  if (chip.href) {\n    return (\n      <Link key={chip.id} href={chip.href} className={classes}>\n        {content}\n      </Link>\n    );\n  }\n\n  if (chip.onClick) {\n    return (\n      <button key={chip.id} type=\"button\" onClick={chip.onClick} className={classes}>\n        {content}\n      </button>\n    );\n  }\n\n  return (\n    <span key={chip.id} className={classes}>\n      {content}\n    </span>\n  );\n}\n\nexport function ModuleCommandHeader({\n  title,\n  titleAccessory,\n  description,\n  actions,\n  actionsClassName,\n  meta,\n  chips = [],\n  fallbackChip,\n  children,\n  className,\n  sticky = false,\n}: ModuleCommandHeaderProps) {\n  const hasChildrenRow = Boolean(children);\n  const hasMeta = Boolean(meta);\n  const hasChips = Boolean(chips.length > 0 || fallbackChip);\n  const hasLowerSection = hasChildrenRow || hasMeta || hasChips;\n  const hasLeftBlock = hasChildrenRow || hasMeta;\n\n  return (\n    <section\n      className={cn(\n        \"relative overflow-hidden rounded-[20px] border border-zinc-200/85 bg-zinc-50/88 px-5 pb-4 pt-3\",\n        \"shadow-[0_10px_24px_-20px_rgba(15,23,42,0.34)] backdrop-blur-sm\",\n        sticky && \"sticky top-4 z-30\",\n        className\n      )}\n    >\n      <div className=\"pointer-events-none absolute inset-0\">\n        <div className=\"absolute inset-x-0 top-0 h-14 bg-linear-to-b from-white/72 to-transparent\" />\n      </div>\n\n      <div className=\"relative z-10 space-y-3\">\n        <div className=\"flex flex-col gap-4 xl:flex-row xl:items-start xl:justify-between\">\n          <div className=\"min-w-0 flex-1 max-w-[600px]\">\n            <div className=\"flex min-w-0 items-center gap-2\">\n              <h1 className=\"min-w-0 font-heading text-2xl font-bold tracking-tight text-zinc-950 sm:text-3xl\">\n                {title}\n              </h1>\n              {titleAccessory ? <div className=\"shrink-0\">{titleAccessory}</div> : null}\n            </div>\n            {description ? (\n              <p className=\"mt-1 font-body text-[13.5px] text-zinc-600/90 leading-relaxed\">{description}</p>\n            ) : null}\n          </div>\n          {actions ? (\n            <div\n              className={cn(\n                \"flex w-full min-w-0 shrink-0 flex-wrap items-center gap-2 rounded-[20px] border border-zinc-200/85 bg-white/95 px-2 py-1.5 shadow-[0_8px_16px_-16px_rgba(15,23,42,0.36)]\",\n                \"xl:w-auto xl:max-w-full xl:justify-end\",\n                actionsClassName\n              )}\n            >\n              {actions}\n            </div>\n          ) : null}\n        </div>\n\n        {hasLowerSection ? (\n          <div className=\"border-t border-zinc-200/75 pt-3\">\n            <div className=\"flex flex-col gap-3 xl:flex-row xl:items-start xl:justify-between\">\n              {hasLeftBlock ? (\n                <div className=\"min-w-0 flex-1 space-y-2\">\n                  {meta ? <div className=\"text-xs text-zinc-500/80\">{meta}</div> : null}\n                  {hasChildrenRow ? <div>{children}</div> : null}\n                </div>\n              ) : null}\n\n              {hasChips ? (\n                <div\n                  className={cn(\n                    \"flex flex-wrap items-center gap-2 shrink-0 max-w-full\",\n                    hasLeftBlock ? \"xl:justify-end\" : \"justify-end\"\n                  )}\n                >\n                  {chips.length > 0 ? chips.map((chip) => renderChip(chip)) : null}\n                  {chips.length === 0 && fallbackChip ? renderChip(fallbackChip) : null}\n                </div>\n              ) : null}\n            </div>\n          </div>\n        ) : null}\n      </div>\n    </section>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AAJA;;;;AA+BA,MAAM,iBAA2C;IAC/C,SAAS;IACT,MAAM;IACN,SAAS;IACT,QAAQ;IACR,SAAS;AACX;AAEA,SAAS,WAAW,IAA6B;IAC/C,MAAM,gBAAgB,QAAQ,KAAK,IAAI,IAAI,KAAK,OAAO;IACvD,MAAM,UAAU,IAAA,yHAAE,EAChB,kKACA,gBACI,4IACA,yCACJ,cAAc,CAAC,KAAK,IAAI,IAAI,UAAU;IAGxC,MAAM,wBACJ;;YACG,KAAK,IAAI,iBAAG,6LAAC;gBAAK,WAAU;0BAAY,KAAK,IAAI;;;;;uBAAW;0BAC7D,6LAAC;0BAAM,KAAK,KAAK;;;;;;;;IAIrB,IAAI,KAAK,IAAI,EAAE;QACb,qBACE,6LAAC,0KAAI;YAAe,MAAM,KAAK,IAAI;YAAE,WAAW;sBAC7C;WADQ,KAAK,EAAE;;;;;IAItB;IAEA,IAAI,KAAK,OAAO,EAAE;QAChB,qBACE,6LAAC;YAAqB,MAAK;YAAS,SAAS,KAAK,OAAO;YAAE,WAAW;sBACnE;WADU,KAAK,EAAE;;;;;IAIxB;IAEA,qBACE,6LAAC;QAAmB,WAAW;kBAC5B;OADQ,KAAK,EAAE;;;;;AAItB;AAEO,SAAS,oBAAoB,EAClC,KAAK,EACL,cAAc,EACd,WAAW,EACX,OAAO,EACP,gBAAgB,EAChB,IAAI,EACJ,QAAQ,EAAE,EACV,YAAY,EACZ,QAAQ,EACR,SAAS,EACT,SAAS,KAAK,EACW;IACzB,MAAM,iBAAiB,QAAQ;IAC/B,MAAM,UAAU,QAAQ;IACxB,MAAM,WAAW,QAAQ,MAAM,MAAM,GAAG,KAAK;IAC7C,MAAM,kBAAkB,kBAAkB,WAAW;IACrD,MAAM,eAAe,kBAAkB;IAEvC,qBACE,6LAAC;QACC,WAAW,IAAA,yHAAE,EACX,kGACA,mEACA,UAAU,qBACV;;0BAGF,6LAAC;gBAAI,WAAU;0BACb,cAAA,6LAAC;oBAAI,WAAU;;;;;;;;;;;0BAGjB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAG,WAAU;0DACX;;;;;;4CAEF,+BAAiB,6LAAC;gDAAI,WAAU;0DAAY;;;;;uDAAwB;;;;;;;oCAEtE,4BACC,6LAAC;wCAAE,WAAU;kDAAiE;;;;;+CAC5E;;;;;;;4BAEL,wBACC,6LAAC;gCACC,WAAW,IAAA,yHAAE,EACX,4KACA,0CACA;0CAGD;;;;;uCAED;;;;;;;oBAGL,gCACC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;gCACZ,6BACC,6LAAC;oCAAI,WAAU;;wCACZ,qBAAO,6LAAC;4CAAI,WAAU;sDAA4B;;;;;mDAAc;wCAChE,+BAAiB,6LAAC;sDAAK;;;;;mDAAkB;;;;;;2CAE1C;gCAEH,yBACC,6LAAC;oCACC,WAAW,IAAA,yHAAE,EACX,yDACA,eAAe,mBAAmB;;wCAGnC,MAAM,MAAM,GAAG,IAAI,MAAM,GAAG,CAAC,CAAC,OAAS,WAAW,SAAS;wCAC3D,MAAM,MAAM,KAAK,KAAK,eAAe,WAAW,gBAAgB;;;;;;2CAEjE;;;;;;;;;;;+BAGN;;;;;;;;;;;;;AAIZ;KArFgB"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/dashboard-store.ts"],"sourcesContent":["import { create } from 'zustand'\n\nexport type Period = 'today' | '7d' | '30d' | 'quarter'\nexport type Context = 'me' | 'team'\n\ninterface DashboardState {\n  period: Period\n  context: Context\n  setPeriod: (period: Period) => void\n  setContext: (context: Context) => void\n}\n\nexport const useDashboardStore = create<DashboardState>((set) => ({\n  period: 'today',\n  context: 'me',\n  setPeriod: (period) => set({ period }),\n  setContext: (context) => set({ context }),\n}))\n\n// ─── Pure utility: convert Period into a date range ────────────────────────\n\nexport function getPeriodDateRange(\n  period: Period,\n  now: Date\n): { start: Date; end: Date } {\n  const end = new Date(\n    now.getFullYear(),\n    now.getMonth(),\n    now.getDate(),\n    23, 59, 59, 999,\n  );\n\n  let start: Date;\n\n  switch (period) {\n    case \"today\":\n      start = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n      break;\n    case \"7d\":\n      start = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 7);\n      break;\n    case \"30d\":\n      start = new Date(now.getFullYear(), now.getMonth(), now.getDate() - 30);\n      break;\n    case \"quarter\": {\n      const quarterMonth = Math.floor(now.getMonth() / 3) * 3;\n      start = new Date(now.getFullYear(), quarterMonth, 1);\n      break;\n    }\n  }\n\n  return { start, end };\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AAYO,MAAM,oBAAoB,IAAA,qJAAM,EAAiB,CAAC,MAAQ,CAAC;QAChE,QAAQ;QACR,SAAS;QACT,WAAW,CAAC,SAAW,IAAI;gBAAE;YAAO;QACpC,YAAY,CAAC,UAAY,IAAI;gBAAE;YAAQ;IACzC,CAAC;AAIM,SAAS,mBACd,MAAc,EACd,GAAS;IAET,MAAM,MAAM,IAAI,KACd,IAAI,WAAW,IACf,IAAI,QAAQ,IACZ,IAAI,OAAO,IACX,IAAI,IAAI,IAAI;IAGd,IAAI;IAEJ,OAAQ;QACN,KAAK;YACH,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO;YAC/D;QACF,KAAK;YACH,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO,KAAK;YACpE;QACF,KAAK;YACH,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI,IAAI,OAAO,KAAK;YACpE;QACF,KAAK;YAAW;gBACd,MAAM,eAAe,KAAK,KAAK,CAAC,IAAI,QAAQ,KAAK,KAAK;gBACtD,QAAQ,IAAI,KAAK,IAAI,WAAW,IAAI,cAAc;gBAClD;YACF;IACF;IAEA,OAAO;QAAE;QAAO;IAAI;AACtB"}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-now.ts"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\n\n/**\n * Hook that returns a reactive `Date` instance.\n * Updates automatically at the given interval (default: 60 seconds).\n * Ensures date-dependent logic (overdue, today, SLA risk) stays fresh\n * even if the user keeps the tab open across midnight.\n */\nexport function useNow(intervalMs = 60_000): Date {\n  const [now, setNow] = useState(() => new Date());\n\n  useEffect(() => {\n    const id = window.setInterval(() => setNow(new Date()), intervalMs);\n    return () => window.clearInterval(id);\n  }, [intervalMs]);\n\n  return now;\n}\n"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAUO,SAAS,OAAO,aAAa,MAAM;;IACxC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ;2BAAC,IAAM,IAAI;;IAEzC,IAAA,0KAAS;4BAAC;YACR,MAAM,KAAK,OAAO,WAAW;uCAAC,IAAM,OAAO,IAAI;sCAAS;YACxD;oCAAO,IAAM,OAAO,aAAa,CAAC;;QACpC;2BAAG;QAAC;KAAW;IAEf,OAAO;AACT;GATgB"}},
    {"offset": {"line": 350, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-dashboard-filters.ts"],"sourcesContent":["\"use client\";\n\n// ============================================================================\n// Hook centralizado de filtros do Dashboard\n// Todas as sections usam este hook para receber dados filtrados por\n// período (today/7d/30d/quarter) e contexto (me/team).\n// ============================================================================\n\nimport { useMemo } from \"react\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport {\n  useDashboardStore,\n  getPeriodDateRange,\n  type Period,\n  type Context,\n} from \"@/stores/dashboard-store\";\nimport { useNow } from \"@/hooks/use-now\";\nimport { getEffectiveActivityStatus } from \"@/lib/business-rules\";\nimport { filterByUser } from \"@/lib/proactive-engine/helpers\";\nimport type { Opportunity, Activity } from \"@/types\";\n\nexport interface DashboardFilters {\n  /** Opportunities filtered by period + context */\n  filteredOpportunities: Opportunity[];\n  /** Activities with effective status, filtered by period + context */\n  filteredActivities: (Activity & { effectiveStatus: Activity[\"status\"] })[];\n  /** All open opportunities (ignores period, respects context) */\n  openOpportunities: Opportunity[];\n  /** Reactive date that ticks every 60s */\n  now: Date;\n  period: Period;\n  context: Context;\n  userId: string;\n  userRole: string;\n}\n\nexport function useDashboardFilters(): DashboardFilters {\n  const opportunities = useOpportunityStore((s) => s.opportunities);\n  const activities = useActivityStore((s) => s.activities);\n  const user = useAuthStore((s) => s.user);\n  const period = useDashboardStore((s) => s.period);\n  const context = useDashboardStore((s) => s.context);\n  const now = useNow();\n\n  const userId = user?.id ?? \"\";\n  const userRole = user?.role ?? \"comercial\";\n\n  return useMemo(() => {\n    const { start, end } = getPeriodDateRange(period, now);\n\n    // ── Context filter ──────────────────────────────────────────────\n    const ctxOpps =\n      context === \"me\"\n        ? filterByUser(opportunities, userId, userRole)\n        : opportunities;\n\n    const ctxActs =\n      context === \"me\"\n        ? filterByUser(activities, userId, userRole)\n        : activities;\n\n    // ── Open opportunities (cumulative, no period filter) ───────────\n    const openOpportunities = ctxOpps.filter((o) => o.status === \"open\");\n\n    // ── Period filter for opportunities ─────────────────────────────\n    // Pipeline Total & SLA are cumulative; won/lost are period-scoped\n    const filteredOpportunities = ctxOpps.filter((o) => {\n      // Open opportunities always included (they are live)\n      if (o.status === \"open\") return true;\n      // Won/lost filtered by updatedAt within period\n      const ts = new Date(o.updatedAt);\n      return ts >= start && ts <= end;\n    });\n\n    // ── Period filter for activities + effective status ──────────────\n    const filteredActivities = ctxActs\n      .map((a) => ({\n        ...a,\n        effectiveStatus: getEffectiveActivityStatus(a, now),\n      }))\n      .filter((a) => {\n        // Pending/overdue always included\n        if (a.effectiveStatus === \"pending\" || a.effectiveStatus === \"overdue\")\n          return true;\n        // Completed/cancelled filtered by dueDate within period\n        const ts = new Date(a.dueDate);\n        return ts >= start && ts <= end;\n      });\n\n    return {\n      filteredOpportunities,\n      filteredActivities,\n      openOpportunities,\n      now,\n      period,\n      context,\n      userId,\n      userRole,\n    };\n  }, [opportunities, activities, period, context, now, userId, userRole]);\n}\n"],"names":[],"mappings":";;;;AAEA,+EAA+E;AAC/E,4CAA4C;AAC5C,oEAAoE;AACpE,uDAAuD;AACvD,+EAA+E;AAE/E;AACA;AACA;AACA;AACA;AAMA;AACA;AACA;;AApBA;;;;;;;;;AAsCO,SAAS;;IACd,MAAM,gBAAgB,IAAA,+JAAmB;kEAAC,CAAC,IAAM,EAAE,aAAa;;IAChE,MAAM,aAAa,IAAA,yJAAgB;4DAAC,CAAC,IAAM,EAAE,UAAU;;IACvD,MAAM,OAAO,IAAA,iJAAY;kDAAC,CAAC,IAAM,EAAE,IAAI;;IACvC,MAAM,SAAS,IAAA,2JAAiB;yDAAC,CAAC,IAAM,EAAE,MAAM;;IAChD,MAAM,UAAU,IAAA,2JAAiB;0DAAC,CAAC,IAAM,EAAE,OAAO;;IAClD,MAAM,MAAM,IAAA,uIAAM;IAElB,MAAM,SAAS,MAAM,MAAM;IAC3B,MAAM,WAAW,MAAM,QAAQ;IAE/B,OAAO,IAAA,wKAAO;uCAAC;YACb,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,IAAA,4JAAkB,EAAC,QAAQ;YAElD,mEAAmE;YACnE,MAAM,UACJ,YAAY,OACR,IAAA,+JAAY,EAAC,eAAe,QAAQ,YACpC;YAEN,MAAM,UACJ,YAAY,OACR,IAAA,+JAAY,EAAC,YAAY,QAAQ,YACjC;YAEN,mEAAmE;YACnE,MAAM,oBAAoB,QAAQ,MAAM;iEAAC,CAAC,IAAM,EAAE,MAAM,KAAK;;YAE7D,mEAAmE;YACnE,kEAAkE;YAClE,MAAM,wBAAwB,QAAQ,MAAM;qEAAC,CAAC;oBAC5C,qDAAqD;oBACrD,IAAI,EAAE,MAAM,KAAK,QAAQ,OAAO;oBAChC,+CAA+C;oBAC/C,MAAM,KAAK,IAAI,KAAK,EAAE,SAAS;oBAC/B,OAAO,MAAM,SAAS,MAAM;gBAC9B;;YAEA,oEAAoE;YACpE,MAAM,qBAAqB,QACxB,GAAG;kEAAC,CAAC,IAAM,CAAC;wBACX,GAAG,CAAC;wBACJ,iBAAiB,IAAA,gKAA0B,EAAC,GAAG;oBACjD,CAAC;iEACA,MAAM;kEAAC,CAAC;oBACP,kCAAkC;oBAClC,IAAI,EAAE,eAAe,KAAK,aAAa,EAAE,eAAe,KAAK,WAC3D,OAAO;oBACT,wDAAwD;oBACxD,MAAM,KAAK,IAAI,KAAK,EAAE,OAAO;oBAC7B,OAAO,MAAM,SAAS,MAAM;gBAC9B;;YAEF,OAAO;gBACL;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;gBACA;YACF;QACF;sCAAG;QAAC;QAAe;QAAY;QAAQ;QAAS;QAAK;QAAQ;KAAS;AACxE;GAhEgB;;QACQ,+JAAmB;QACtB,yJAAgB;QACtB,iJAAY;QACV,2JAAiB;QAChB,2JAAiB;QACrB,uIAAM"}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/header.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport type { LucideIcon } from \"lucide-react\";\nimport {\n  AlertTriangle,\n  Calendar,\n  ChevronDown,\n  LayoutGrid,\n  ShieldAlert,\n  Wallet,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  ModuleCommandHeader,\n  type ModuleCommandHeaderChip,\n} from \"@/components/shared/module-command-header\";\nimport { cn } from \"@/lib/cn\";\nimport { useDashboardStore, type Period } from \"@/stores/dashboard-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport { formatCurrencyBRL } from \"@/lib/business-rules\";\nimport { usePathname, useRouter } from \"next/navigation\";\n\nconst periodLabels: Record<Period, string> = {\n  today: \"Hoje\",\n  \"7d\": \"7 dias\",\n  \"30d\": \"30 dias\",\n  quarter: \"Trimestre\",\n};\n\ntype IndicatorTone = \"danger\" | \"warning\" | \"info\";\ntype IndicatorId = \"overdue\" | \"sla\" | \"risk\";\n\ninterface IndicatorChip {\n  id: IndicatorId;\n  value: string;\n  label: string;\n  icon: LucideIcon;\n  tone: IndicatorTone;\n}\n\nfunction toPtBrCompactDate(date: Date): string {\n  const formatter = new Intl.DateTimeFormat(\"pt-BR\", {\n    weekday: \"short\",\n    day: \"2-digit\",\n    month: \"short\",\n    timeZone: \"America/Sao_Paulo\",\n  });\n  const parts = formatter.formatToParts(date);\n  const weekdayRaw = parts.find((part) => part.type === \"weekday\")?.value ?? \"\";\n  const day = parts.find((part) => part.type === \"day\")?.value ?? \"\";\n  const monthRaw = parts.find((part) => part.type === \"month\")?.value ?? \"\";\n  const weekday = weekdayRaw.replaceAll(\".\", \"\").trim();\n  const month = monthRaw.replaceAll(\".\", \"\").trim();\n  const weekdayCapitalized = weekday.charAt(0).toUpperCase() + weekday.slice(1);\n  return `${weekdayCapitalized}, ${day} ${month}`;\n}\n\nexport function DashboardHeader() {\n  const router = useRouter();\n  const pathname = usePathname();\n  const { period, setPeriod } = useDashboardStore();\n  const { user, isLoading } = useAuthStore();\n  const [retryingIndicators, setRetryingIndicators] = useState(false);\n\n  const {\n    filteredActivities,\n    openOpportunities,\n    now,\n  } = useDashboardFilters();\n\n  const firstName = user?.name?.trim().split(\" \")[0] ?? \"Admin\";\n\n  // ── Compute indicators from real store data ─────────────────────\n  const overdueCount = filteredActivities.filter(\n    (a) => a.effectiveStatus === \"overdue\"\n  ).length;\n\n  const slaBreachedOpps = openOpportunities.filter(\n    (o) => o.slaDeadline && new Date(o.slaDeadline) < now\n  );\n  const slaBreaches = slaBreachedOpps.length;\n  const riskValue = slaBreachedOpps.reduce((sum, o) => sum + (o.value || 0), 0);\n\n  const hasIndicatorsError =\n    !Number.isFinite(overdueCount) ||\n    !Number.isFinite(slaBreaches) ||\n    !Number.isFinite(riskValue);\n\n  const indicators: IndicatorChip[] = [\n    overdueCount > 0\n      ? {\n          id: \"overdue\",\n          value: `${overdueCount}`,\n          label: \"atrasadas\",\n          icon: AlertTriangle,\n          tone: \"danger\",\n        }\n      : null,\n    slaBreaches > 0\n      ? {\n          id: \"sla\",\n          value: `${slaBreaches}`,\n          label: \"SLAs estourados\",\n          icon: ShieldAlert,\n          tone: \"warning\",\n        }\n      : null,\n    riskValue > 0\n      ? {\n          id: \"risk\",\n          value: formatCurrencyBRL(riskValue),\n          label: \"valor em risco\",\n          icon: Wallet,\n          tone: \"info\",\n        }\n      : null,\n  ].filter((chip): chip is IndicatorChip => Boolean(chip)).slice(0, 3);\n\n  const compactDateText = `${toPtBrCompactDate(now)} · Olá, ${firstName}`;\n\n  const handleIndicatorClick = (id: IndicatorId) => {\n    if (id === \"overdue\") {\n      router.push(\"/activities?status=overdue\");\n      return;\n    }\n\n    const targetId = id === \"sla\" ? \"dashboard-execution\" : \"dashboard-funnel\";\n    const target = document.getElementById(targetId);\n    if (target) {\n      target.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n      return;\n    }\n    if (pathname !== \"/dashboard\") {\n      router.push(`/dashboard#${targetId}`);\n    }\n  };\n\n  const handleRetryIndicators = () => {\n    setRetryingIndicators(true);\n    router.refresh();\n    window.setTimeout(() => setRetryingIndicators(false), 220);\n  };\n\n  const indicatorChips: ModuleCommandHeaderChip[] = hasIndicatorsError\n    ? []\n    : indicators.map((chip) => {\n        const Icon = chip.icon;\n        return {\n          id: chip.id,\n          label: `${chip.value} ${chip.label}`,\n          icon: <Icon className=\"h-3.5 w-3.5\" />,\n          tone:\n            chip.tone === \"danger\"\n              ? \"danger\"\n              : chip.tone === \"warning\"\n                ? \"warning\"\n                : \"info\",\n          onClick: () => handleIndicatorClick(chip.id),\n        };\n      });\n\n  const fallbackChip: ModuleCommandHeaderChip = {\n    id: \"dashboard-empty\",\n    label: \"Sem dados do dia · Ver pipeline\",\n    icon: <LayoutGrid className=\"h-3.5 w-3.5 text-zinc-500\" />,\n    onClick: () => router.push(\"/pipes\"),\n    tone: \"neutral\",\n  };\n\n  const actions = (\n    <div\n      className={cn(\n        \"flex w-full flex-wrap items-center justify-end gap-2\",\n        isLoading && \"pointer-events-none opacity-60\"\n      )}\n    >\n      {/* Period selector */}\n      <DropdownMenu>\n        <DropdownMenuTrigger asChild>\n          <Button\n            variant=\"outline\"\n            className=\"premium-shine h-8 gap-1.5 rounded-full border-zinc-200 bg-white/90 px-3 text-sm font-medium hover:bg-zinc-100/80 active:scale-[0.99]\"\n          >\n            <LayoutGrid className=\"h-3.5 w-3.5 text-zinc-500\" />\n            {periodLabels[period]}\n            <ChevronDown className=\"h-3.5 w-3.5 text-zinc-400\" />\n          </Button>\n        </DropdownMenuTrigger>\n        <DropdownMenuContent align=\"end\" className=\"w-40 rounded-xl\">\n          {(Object.keys(periodLabels) as Period[]).map((value) => (\n            <DropdownMenuItem\n              key={value}\n              onClick={() => setPeriod(value)}\n              className=\"gap-2\"\n            >\n              {period === value ? (\n                <div className=\"h-1.5 w-1.5 rounded-full bg-brand\" />\n              ) : null}\n              <span className={period === value ? \"font-medium\" : \"\"}>\n                {periodLabels[value]}\n              </span>\n            </DropdownMenuItem>\n          ))}\n        </DropdownMenuContent>\n      </DropdownMenu>\n\n    </div>\n  );\n\n  return (\n    <ModuleCommandHeader\n      title=\"Dashboard\"\n      description=\"Raio X do comercial\"\n      sticky\n      actions={actions}\n      meta={\n        <span className=\"inline-flex items-center gap-1.5\">\n          <Calendar className=\"h-3.5 w-3.5\" />\n          {compactDateText}\n        </span>\n      }\n      chips={indicatorChips}\n      fallbackChip={fallbackChip}\n      className=\"premium-panel\"\n    >\n      {isLoading ? (\n        <div className=\"flex flex-wrap items-center gap-2\">\n          <Skeleton className=\"h-8 w-[110px] rounded-full\" />\n          <Skeleton className=\"h-8 w-[128px] rounded-full\" />\n          <Skeleton className=\"h-8 w-[142px] rounded-full\" />\n        </div>\n      ) : null}\n\n      {hasIndicatorsError ? (\n        <div className=\"inline-flex items-center gap-2 rounded-full border border-red-200 bg-red-50/90 px-3 py-1.5 text-xs text-red-700\">\n          <AlertTriangle className=\"h-3.5 w-3.5\" />\n          Falha ao carregar indicadores.\n          <button\n            type=\"button\"\n            onClick={handleRetryIndicators}\n            className=\"font-semibold underline underline-offset-4\"\n          >\n            {retryingIndicators ? \"Tentando...\" : \"Tentar novamente\"}\n          </button>\n        </div>\n      ) : null}\n    </ModuleCommandHeader>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 810, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/kpi-section.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { motion, animate, useMotionValue } from \"framer-motion\";\nimport {\n  ChevronRight,\n  Clock3,\n  Gauge,\n  ShieldAlert,\n  TrendingUp\n} from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { cn } from \"@/lib/utils\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport { getPeriodDateRange } from \"@/stores/dashboard-store\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { filterByUser } from \"@/lib/proactive-engine/helpers\";\nimport type { Opportunity } from \"@/types\";\nimport { cardStaggerContainer, listItemReveal } from \"@/lib/motion\";\n\ntype KPIState = \"default\" | \"loading\" | \"error\";\ntype ChipTone = \"neutral\" | \"info\" | \"warning\" | \"danger\" | \"success\";\n\nconst STALE_ACTIVITY_DAYS = 5;\nconst SLA_RISK_WINDOW_HOURS = 24;\nconst DAY_MS = 24 * 60 * 60 * 1000;\n\ninterface KPIChip {\n  id: string;\n  label: string;\n  tone: ChipTone;\n}\n\ninterface KPIAction {\n  label: string;\n  targetPath: string;\n}\n\ninterface KPIData {\n  label: string;\n  value: number;\n  valueFormat: \"currency\" | \"percent\" | \"integer\";\n  valueSuffix?: string;\n  subtext: string;\n  chips: KPIChip[];\n  line4Text?: string;\n  detailAction?: KPIAction;\n  microText?: string;\n  targetPath: string;\n  disabled?: boolean;\n  state?: KPIState;\n}\n\nfunction isSlaBreached(slaDeadline: string | undefined, now: Date): boolean {\n  return Boolean(slaDeadline) && new Date(slaDeadline as string) < now;\n}\n\nfunction isSlaAtRisk(slaDeadline: string | undefined, now: Date): boolean {\n  if (!slaDeadline) return false;\n  const deadline = new Date(slaDeadline);\n  const hoursLeft = (deadline.getTime() - now.getTime()) / (1000 * 60 * 60);\n  return hoursLeft > 0 && hoursLeft <= SLA_RISK_WINDOW_HOURS;\n}\n\nfunction calculateConversionInRange(\n  opportunities: Opportunity[],\n  start: Date,\n  end: Date\n): { won: number; total: number; rate: number } {\n  const closed = opportunities.filter((opportunity) => {\n    if (opportunity.status !== \"won\" && opportunity.status !== \"lost\") return false;\n    const updatedAt = new Date(opportunity.updatedAt);\n    return updatedAt >= start && updatedAt <= end;\n  });\n\n  const won = closed.filter((opportunity) => opportunity.status === \"won\").length;\n  const total = closed.length;\n  const rate = total > 0 ? (won / total) * 100 : 0;\n\n  return { won, total, rate };\n}\n\nfunction useKpiData(): Record<\"pipeline\" | \"conversion\" | \"activities\" | \"sla\", KPIData> {\n  const {\n    filteredActivities,\n    openOpportunities,\n    now,\n    period,\n    context,\n    userId,\n    userRole,\n  } = useDashboardFilters();\n  const opportunities = useOpportunityStore((state) => state.opportunities);\n\n  return useMemo(() => {\n    const openOpps = openOpportunities;\n    const scopedOpportunities =\n      context === \"me\"\n        ? filterByUser(opportunities, userId, userRole)\n        : opportunities;\n\n    const { start, end } = getPeriodDateRange(period, now);\n    const rangeSizeMs = end.getTime() - start.getTime() + 1;\n    const previousEnd = new Date(start.getTime() - 1);\n    const previousStart = new Date(previousEnd.getTime() - rangeSizeMs + 1);\n\n    const currentConversion = calculateConversionInRange(scopedOpportunities, start, end);\n    const previousConversion = calculateConversionInRange(\n      scopedOpportunities,\n      previousStart,\n      previousEnd\n    );\n    const hasCurrentConversionData = currentConversion.total > 0;\n    const hasPreviousBase = previousConversion.total > 0;\n    const conversionDelta = hasPreviousBase\n      ? currentConversion.rate - previousConversion.rate\n      : null;\n\n    const pipelineTotal = openOpps.reduce((sum, o) => sum + (o.value || 0), 0);\n\n    const pendingActivities = filteredActivities.filter(\n      (a) => a.effectiveStatus === \"pending\" || a.effectiveStatus === \"overdue\"\n    );\n    const overdueActivityCount = filteredActivities.filter(\n      (a) => a.effectiveStatus === \"overdue\"\n    ).length;\n\n    const todayIso = now.toISOString().slice(0, 10);\n    const todayPendingCount = filteredActivities.filter(\n      (a) => a.effectiveStatus === \"pending\" && a.dueDate === todayIso\n    ).length;\n\n    const staleThreshold = now.getTime() - STALE_ACTIVITY_DAYS * DAY_MS;\n    const staleCount = openOpps.filter(\n      (opportunity) => new Date(opportunity.updatedAt).getTime() < staleThreshold\n    ).length;\n\n    const slaBreachedCount = openOpps.filter((o) => isSlaBreached(o.slaDeadline, now)).length;\n    const slaRiskCount = openOpps.filter((o) => isSlaAtRisk(o.slaDeadline, now)).length;\n    const riskPct =\n      openOpps.length > 0\n        ? Math.round(((slaBreachedCount + slaRiskCount) / openOpps.length) * 100)\n        : 0;\n\n    const conversionChips: KPIChip[] = [];\n    if (hasCurrentConversionData && conversionDelta !== null) {\n      if (conversionDelta > 0) {\n        conversionChips.push({\n          id: \"conversion-up\",\n          label: `Alta +${conversionDelta.toFixed(1)} p.p.`,\n          tone: \"success\",\n        });\n      } else if (conversionDelta < 0) {\n        conversionChips.push({\n          id: \"conversion-down\",\n          label: `Queda ${Math.abs(conversionDelta).toFixed(1)} p.p.`,\n          tone: \"danger\",\n        });\n      } else {\n        conversionChips.push({\n          id: \"conversion-flat\",\n          label: \"Estavel 0.0 p.p.\",\n          tone: \"neutral\",\n        });\n      }\n    }\n\n    const activityChips: KPIChip[] = [];\n    if (overdueActivityCount > 0) {\n      activityChips.push({\n        id: \"activities-overdue\",\n        label: `Atrasadas: ${overdueActivityCount}`,\n        tone: \"danger\",\n      });\n    }\n    if (todayPendingCount > 0) {\n      activityChips.push({\n        id: \"activities-today\",\n        label: `Hoje: ${todayPendingCount}`,\n        tone: \"warning\",\n      });\n    }\n    if (activityChips.length === 0) {\n      activityChips.push({\n        id: \"activities-ok\",\n        label: \"OK\",\n        tone: \"success\",\n      });\n    }\n\n    const slaChips: KPIChip[] = [];\n    if (slaBreachedCount > 0) {\n      slaChips.push({\n        id: \"sla-overdue\",\n        label: `Estourados: ${slaBreachedCount}`,\n        tone: \"danger\",\n      });\n    }\n    if (slaRiskCount > 0) {\n      slaChips.push({\n        id: \"sla-risk\",\n        label: `Em risco: ${slaRiskCount}`,\n        tone: \"warning\",\n      });\n    }\n    if (slaChips.length === 0) {\n      slaChips.push({\n        id: \"sla-ok\",\n        label: \"OK\",\n        tone: \"success\",\n      });\n    }\n\n    const pipelineChips: KPIChip[] = [];\n    if (slaBreachedCount > 0) {\n      pipelineChips.push({\n        id: \"pipeline-overdue\",\n        label: `Estourados: ${slaBreachedCount}`,\n        tone: \"danger\",\n      });\n    }\n\n    const slaTargetPath = slaBreachedCount > 0\n      ? \"/pipes?filter=sla_overdue\"\n      : \"/pipes?filter=sla_risk\";\n\n    return {\n      pipeline: {\n        label: \"Pipeline Total\",\n        value: pipelineTotal,\n        valueFormat: \"currency\",\n        subtext: `${openOpps.length} oportunidades abertas`,\n        chips: pipelineChips,\n        line4Text: pipelineChips.length === 0 && staleCount === 0 ? \"Sem alertas hoje\" : undefined,\n        detailAction:\n          staleCount > 0\n            ? { label: \"Ver sem atividade\", targetPath: \"/pipes?filter=stale\" }\n            : undefined,\n        targetPath: \"/pipes\",\n        state: \"default\",\n      },\n      conversion: {\n        label: \"Conversão Global\",\n        value: currentConversion.rate,\n        valueFormat: \"percent\",\n        subtext: hasCurrentConversionData\n          ? `Ganhos no período: ${currentConversion.won}`\n          : \"Sem dados no período\",\n        chips: conversionChips,\n        line4Text: hasCurrentConversionData\n          ? hasPreviousBase\n            ? undefined\n            : \"Sem base comparável\"\n          : \"Ajuste o período para comparar.\",\n        disabled: !hasCurrentConversionData,\n        targetPath: \"/dashboard?view=conversion\",\n        state: \"default\",\n      },\n      activities: {\n        label: \"Atividades\",\n        value: pendingActivities.length,\n        valueFormat: \"integer\",\n        subtext: `${overdueActivityCount} atrasadas · ${todayPendingCount} para hoje`,\n        chips: activityChips.slice(0, 2),\n        targetPath: \"/activities?statuses=pending,overdue\",\n        state: \"default\",\n      },\n      sla: {\n        label: \"SLA Crítico\",\n        value: slaBreachedCount,\n        valueFormat: \"integer\",\n        valueSuffix: \"estourados\",\n        subtext: `${slaRiskCount} em risco`,\n        chips: slaChips.slice(0, 2),\n        detailAction:\n          slaBreachedCount > 0 || slaRiskCount > 0\n            ? { label: \"Ver deals\", targetPath: slaTargetPath }\n            : undefined,\n        microText: `${riskPct}% da carteira em risco`,\n        targetPath: slaTargetPath,\n        state: \"default\",\n      },\n    };\n  }, [\n    filteredActivities,\n    openOpportunities,\n    now,\n    period,\n    context,\n    userId,\n    userRole,\n    opportunities,\n  ]);\n}\n\nfunction formatKpiValue(value: number, format: KPIData[\"valueFormat\"]): string {\n  if (format === \"currency\") {\n    const absValue = Math.abs(value);\n    if (absValue >= 1_000) {\n      return new Intl.NumberFormat(\"pt-BR\", {\n        style: \"currency\",\n        currency: \"BRL\",\n        notation: \"compact\",\n        maximumFractionDigits: absValue >= 1_000_000 ? 2 : 1,\n      }).format(value);\n    }\n\n    return new Intl.NumberFormat(\"pt-BR\", {\n      style: \"currency\",\n      currency: \"BRL\",\n      maximumFractionDigits: 0,\n    }).format(value);\n  }\n\n  if (format === \"percent\") {\n    return `${value.toFixed(1)}%`;\n  }\n\n  return Math.round(value).toString();\n}\n\nfunction AnimatedKpiValue({\n  value,\n  format,\n}: {\n  value: number;\n  format: KPIData[\"valueFormat\"];\n}) {\n  const motionValue = useMotionValue(value);\n  const [displayValue, setDisplayValue] = useState(value);\n\n  useEffect(() => {\n    const unsubscribe = motionValue.on(\"change\", (latest) => {\n      setDisplayValue(latest);\n    });\n    return unsubscribe;\n  }, [motionValue]);\n\n  useEffect(() => {\n    const controls = animate(motionValue, value, {\n      duration: 0.22,\n      ease: [0.22, 0.61, 0.36, 1],\n    });\n    return controls.stop;\n  }, [motionValue, value]);\n\n  return <>{formatKpiValue(displayValue, format)}</>;\n}\n\nfunction KpiChipBadge({ chip }: { chip: KPIChip }) {\n  return (\n    <span\n      className={cn(\n        \"inline-flex h-[24px] max-w-full items-center rounded-full border px-2.5 text-[11px] font-semibold tracking-tight whitespace-nowrap\",\n        chip.tone === \"neutral\" && \"border-zinc-200/85 bg-zinc-100/80 text-zinc-700\",\n        chip.tone === \"info\" && \"border-sky-200/80 bg-sky-50/80 text-sky-700\",\n        chip.tone === \"warning\" && \"border-amber-200/80 bg-amber-50/80 text-amber-700\",\n        chip.tone === \"danger\" && \"border-rose-200/80 bg-rose-50/80 text-rose-700\",\n        chip.tone === \"success\" && \"border-emerald-200/80 bg-emerald-50/80 text-emerald-700\"\n      )}\n      title={chip.label}\n    >\n      <span className=\"truncate\">{chip.label}</span>\n    </span>\n  );\n}\n\nfunction KPITemplateCard({\n  icon,\n  data,\n  onNavigate,\n  onRetry,\n}: {\n  icon: React.ReactNode;\n  data: KPIData;\n  onNavigate: (path: string) => void;\n  onRetry: () => void;\n}) {\n  const state = data.state ?? \"default\";\n  const isInteractive = state === \"default\" && !data.disabled;\n  const chips = data.chips.slice(0, 2);\n  const hasOverflow = data.chips.length > 2;\n  const detailAction = hasOverflow\n    ? { label: \"Ver detalhes\", targetPath: data.targetPath }\n    : data.detailAction;\n\n  function handleCardAction() {\n    if (!isInteractive) return;\n    onNavigate(data.targetPath);\n  }\n\n  function handleCardKeyDown(event: React.KeyboardEvent<HTMLElement>) {\n    if (!isInteractive) return;\n    if (event.key === \"Enter\" || event.key === \" \") {\n      event.preventDefault();\n      onNavigate(data.targetPath);\n    }\n  }\n\n  return (\n    <motion.article\n      onClick={handleCardAction}\n      onKeyDown={handleCardKeyDown}\n      role={isInteractive ? \"button\" : undefined}\n      tabIndex={isInteractive ? 0 : -1}\n      aria-disabled={!isInteractive}\n      whileTap={isInteractive ? { scale: 0.99 } : undefined}\n      transition={{ duration: 0.09, ease: \"easeInOut\" }}\n      className={cn(\n        \"premium-shine group flex h-[222px] w-full flex-col overflow-hidden rounded-[24px] border border-zinc-200/80 bg-white/90 p-5 text-left\",\n        \"shadow-(--shadow-bento-sm) transition-[box-shadow,border-color,background-color] duration-150 ease-out\",\n        isInteractive && \"cursor-pointer hover:shadow-(--shadow-bento-sm-hover)\",\n        \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/25\"\n      )}\n    >\n      {state === \"loading\" ? (\n        <div className=\"flex h-full flex-col gap-4\">\n          <Skeleton className=\"h-4 w-28 rounded-md before:animation-duration-[900ms]\" />\n          <Skeleton className=\"h-10 w-36 rounded-lg before:animation-duration-[900ms]\" />\n        </div>\n      ) : state === \"error\" ? (\n        <div className=\"flex h-full flex-col justify-between gap-3\">\n          <div>\n            <p className=\"text-[13px] font-semibold text-zinc-900\">{data.label}</p>\n            <p className=\"mt-2 text-xs text-red-700\">Erro ao carregar métrica.</p>\n          </div>\n          <button\n            type=\"button\"\n            onClick={(event) => {\n              event.stopPropagation();\n              onRetry();\n            }}\n            className=\"w-fit text-xs font-semibold text-brand underline underline-offset-4\"\n          >\n            Tentar novamente\n          </button>\n        </div>\n      ) : (\n        <>\n          <header className=\"flex h-8 items-center justify-between gap-3\">\n            <div className=\"flex min-w-0 items-center gap-2.5\">\n              <div className=\"flex h-8 w-8 shrink-0 items-center justify-center rounded-[10px] bg-zinc-100 text-zinc-700\">\n                {icon}\n              </div>\n              <p className=\"truncate text-[13px] font-medium text-zinc-600\">\n                {data.label}\n              </p>\n            </div>\n            {isInteractive ? (\n              <ChevronRight className=\"h-4 w-4 shrink-0 text-zinc-400 transition-[color,transform] duration-150 group-hover:translate-x-[1px] group-hover:text-zinc-600\" />\n            ) : null}\n          </header>\n\n          <div className=\"mt-3 flex h-[66px] min-w-0 items-end gap-1.5\">\n            <p className=\"tabular-nums whitespace-nowrap text-[clamp(1.9rem,2.35vw,2.85rem)] leading-[0.92] font-bold tracking-tight text-zinc-900\">\n              <AnimatedKpiValue value={data.value} format={data.valueFormat} />\n            </p>\n            {data.valueSuffix ? (\n              <p className=\"tabular-nums shrink-0 truncate pb-1 text-[13px] font-semibold text-zinc-500\">{data.valueSuffix}</p>\n            ) : null}\n          </div>\n\n          <p className=\"mt-2 h-6 truncate text-[13px] font-medium text-zinc-500\">{data.subtext}</p>\n\n          <footer className=\"mt-auto flex h-[58px] flex-col justify-end pt-3\">\n            <div className=\"flex min-h-[24px] items-center gap-2 overflow-hidden\">\n              {chips.map((chip) => (\n                <KpiChipBadge key={chip.id} chip={chip} />\n              ))}\n\n              {chips.length === 0 && !detailAction ? (\n                <p className=\"truncate text-[12px] text-zinc-500\" title={data.line4Text || \"Sem alertas hoje\"}>\n                  {data.line4Text || \"Sem alertas hoje\"}\n                </p>\n              ) : null}\n\n              {detailAction ? (\n                <button\n                  type=\"button\"\n                  onClick={(event) => {\n                    event.stopPropagation();\n                    onNavigate(detailAction.targetPath);\n                  }}\n                  className=\"inline-flex h-[24px] shrink-0 items-center text-[12px] font-semibold text-brand underline underline-offset-4 transition-[color,transform,opacity] duration-150 hover:translate-x-[1px] hover:text-brand/80\"\n                >\n                  {detailAction.label}\n                </button>\n              ) : null}\n            </div>\n\n            <p className=\"tabular-nums mt-1.5 h-[16px] truncate text-[11px] text-zinc-500\">\n              {data.microText ?? \"\"}\n            </p>\n          </footer>\n        </>\n      )}\n    </motion.article>\n  );\n}\n\nexport function KpiSection() {\n  const router = useRouter();\n  const baseData = useKpiData();\n  const [cardState, setCardState] = useState<Record<keyof typeof baseData, KPIState>>({\n    pipeline: \"default\",\n    conversion: \"default\",\n    activities: \"default\",\n    sla: \"default\",\n  });\n\n  const kpis = useMemo(\n    () => ({\n      pipeline: { ...baseData.pipeline, state: cardState.pipeline },\n      conversion: { ...baseData.conversion, state: cardState.conversion },\n      activities: { ...baseData.activities, state: cardState.activities },\n      sla: { ...baseData.sla, state: cardState.sla },\n    }),\n    [baseData, cardState]\n  );\n\n  function retryCard(card: keyof typeof kpis) {\n    setCardState((prev) => ({ ...prev, [card]: \"loading\" }));\n    window.setTimeout(() => {\n      setCardState((prev) => ({ ...prev, [card]: \"default\" }));\n    }, 240);\n  }\n\n  return (\n    <motion.div\n      variants={cardStaggerContainer}\n      initial=\"hidden\"\n      animate=\"show\"\n      className=\"grid grid-cols-1 items-stretch gap-4 sm:grid-cols-2 xl:grid-cols-4\"\n    >\n      <motion.div custom={0} variants={listItemReveal} className=\"h-full\">\n        <KPITemplateCard\n          icon={<Gauge className=\"h-4 w-4\" />}\n          data={kpis.pipeline}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"pipeline\")}\n        />\n      </motion.div>\n\n      <motion.div custom={1} variants={listItemReveal} className=\"h-full\">\n        <KPITemplateCard\n          icon={<TrendingUp className=\"h-4 w-4\" />}\n          data={kpis.conversion}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"conversion\")}\n        />\n      </motion.div>\n\n      <motion.div custom={2} variants={listItemReveal} className=\"h-full\">\n        <KPITemplateCard\n          icon={<Clock3 className=\"h-4 w-4\" />}\n          data={kpis.activities}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"activities\")}\n        />\n      </motion.div>\n\n      <motion.div custom={3} variants={listItemReveal} className=\"h-full\">\n        <KPITemplateCard\n          icon={<ShieldAlert className=\"h-4 w-4\" />}\n          data={kpis.sla}\n          onNavigate={(path) => router.push(path)}\n          onRetry={() => retryCard(\"sla\")}\n        />\n      </motion.div>\n    </motion.div>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1569, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/ui/bento-card.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { motion } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\nimport { premiumPressMotion } from \"@/lib/motion\";\n\nexport interface BentoCardProps {\n  title?: string;\n  description?: string;\n  actions?: React.ReactNode;\n  children: React.ReactNode;\n  size?: \"sm\" | \"md\" | \"lg\" | \"tall\" | \"wide\";\n  state?: \"default\" | \"loading\" | \"error\" | \"empty\";\n  className?: string;\n  noPadding?: boolean;\n  elevated?: boolean;\n  hoverable?: boolean;\n  shine?: boolean;\n}\n\nconst BentoCard = React.forwardRef<HTMLDivElement, BentoCardProps>(\n  (\n    {\n      title,\n      description,\n      actions,\n      children,\n      size = \"md\",\n      state = \"default\",\n      className,\n      noPadding = false,\n      elevated = false,\n      hoverable = false,\n      shine = true,\n      ...props\n    },\n    ref\n  ) => {\n    const hasHeader = title || description || actions;\n    const sizeClass =\n      size === \"sm\"\n        ? \"min-h-[140px]\"\n        : size === \"lg\"\n          ? \"min-h-[260px]\"\n          : size === \"tall\"\n            ? \"min-h-[340px]\"\n            : size === \"wide\"\n              ? \"min-h-[200px]\"\n              : \"min-h-[180px]\";\n\n    return (\n      <motion.div\n        ref={ref}\n        whileHover={hoverable ? premiumPressMotion.whileHover : undefined}\n        whileTap={hoverable ? premiumPressMotion.whileTap : undefined}\n        transition={\n          hoverable\n            ? { duration: 0.22, ease: [0.22, 0.61, 0.36, 1] }\n            : undefined\n        }\n        className={cn(\n          // Base styles\n          \"group/card relative overflow-hidden\",\n          \"bento-card-base premium-panel\",\n          \"rounded-[var(--radius-bento-card)]\",\n          \"border border-[var(--border-bento-default)]\",\n          \"focus-within:ring-2 focus-within:ring-brand/20\",\n\n          // Shadow elevation\n          elevated && \"bento-card-elevated\",\n          !elevated && \"shadow-[var(--shadow-bento-sm)]\",\n\n          // Hover state\n          hoverable && elevated && \"bento-card-elevated-hover\",\n          hoverable && !elevated && \"bento-card-hover\",\n          hoverable && \"premium-lift\",\n          hoverable && shine && \"premium-shine\",\n\n          // Size\n          sizeClass,\n\n          // State-specific styles\n          state === \"error\" && \"border-[var(--border-bento-error)]\",\n          state === \"loading\" && \"pointer-events-none opacity-80\",\n\n          className\n        )}\n        {...props}\n      >\n        {shine && (\n          <>\n            <div\n              aria-hidden\n              className=\"pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-300 ease-out group-hover/card:opacity-100\"\n            >\n              <div className=\"absolute -top-16 right-[-12%] h-40 w-40 rounded-full bg-brand/15 blur-3xl\" />\n              <div className=\"absolute -bottom-16 left-[-10%] h-36 w-36 rounded-full bg-cyan-300/15 blur-3xl\" />\n            </div>\n            <div\n              aria-hidden\n              className=\"pointer-events-none absolute inset-x-0 top-0 h-px bg-linear-to-r from-transparent via-white/90 to-transparent opacity-70\"\n            />\n          </>\n        )}\n\n        {/* Header */}\n        {hasHeader && (\n          <div\n            className={cn(\n              \"flex items-start justify-between gap-4\",\n              noPadding ? \"px-6 pt-6\" : \"px-6 pt-6 pb-4\"\n            )}\n          >\n            <div className=\"min-w-0 flex-1\">\n              {title && (\n                <h3 className=\"font-heading text-lg font-semibold text-black\">\n                  {title}\n                </h3>\n              )}\n              {description && (\n                <p className=\"mt-1 font-body text-sm text-zinc-500\">\n                  {description}\n                </p>\n              )}\n            </div>\n            {actions && <div className=\"flex shrink-0 gap-2\">{actions}</div>}\n          </div>\n        )}\n\n        {/* Content */}\n        <div className={cn(!noPadding && (hasHeader ? \"px-6 pb-6\" : \"p-6\"))}>\n          {children}\n        </div>\n      </motion.div>\n    );\n  }\n);\n\nBentoCard.displayName = \"BentoCard\";\n\nexport { BentoCard };\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;;AAgBA,MAAM,0BAAY,2KAAgB,MAChC,CACE,EACE,KAAK,EACL,WAAW,EACX,OAAO,EACP,QAAQ,EACR,OAAO,IAAI,EACX,QAAQ,SAAS,EACjB,SAAS,EACT,YAAY,KAAK,EACjB,WAAW,KAAK,EAChB,YAAY,KAAK,EACjB,QAAQ,IAAI,EACZ,GAAG,OACJ,EACD;IAEA,MAAM,YAAY,SAAS,eAAe;IAC1C,MAAM,YACJ,SAAS,OACL,kBACA,SAAS,OACP,kBACA,SAAS,SACP,kBACA,SAAS,SACP,kBACA;IAEZ,qBACE,6LAAC,uMAAM,CAAC,GAAG;QACT,KAAK;QACL,YAAY,YAAY,6IAAkB,CAAC,UAAU,GAAG;QACxD,UAAU,YAAY,6IAAkB,CAAC,QAAQ,GAAG;QACpD,YACE,YACI;YAAE,UAAU;YAAM,MAAM;gBAAC;gBAAM;gBAAM;gBAAM;aAAE;QAAC,IAC9C;QAEN,WAAW,IAAA,4HAAE,EACX,cAAc;QACd,uCACA,iCACA,sCACA,+CACA,kDAEA,mBAAmB;QACnB,YAAY,uBACZ,CAAC,YAAY,mCAEb,cAAc;QACd,aAAa,YAAY,6BACzB,aAAa,CAAC,YAAY,oBAC1B,aAAa,gBACb,aAAa,SAAS,iBAEtB,OAAO;QACP,WAEA,wBAAwB;QACxB,UAAU,WAAW,sCACrB,UAAU,aAAa,kCAEvB;QAED,GAAG,KAAK;;YAER,uBACC;;kCACE,6LAAC;wBACC,aAAW;wBACX,WAAU;;0CAEV,6LAAC;gCAAI,WAAU;;;;;;0CACf,6LAAC;gCAAI,WAAU;;;;;;;;;;;;kCAEjB,6LAAC;wBACC,aAAW;wBACX,WAAU;;;;;;;;YAMf,2BACC,6LAAC;gBACC,WAAW,IAAA,4HAAE,EACX,0CACA,YAAY,cAAc;;kCAG5B,6LAAC;wBAAI,WAAU;;4BACZ,uBACC,6LAAC;gCAAG,WAAU;0CACX;;;;;;4BAGJ,6BACC,6LAAC;gCAAE,WAAU;0CACV;;;;;;;;;;;;oBAIN,yBAAW,6LAAC;wBAAI,WAAU;kCAAuB;;;;;;;;;;;;0BAKtD,6LAAC;gBAAI,WAAW,IAAA,4HAAE,EAAC,CAAC,aAAa,CAAC,YAAY,cAAc,KAAK;0BAC9D;;;;;;;;;;;;AAIT;;AAGF,UAAU,WAAW,GAAG"}},
    {"offset": {"line": 1713, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/funnel-config.ts"],"sourcesContent":["import type { Opportunity } from \"@/types\";\n\ntype FlowStageId = \"lead\" | \"contact\" | \"meeting\" | \"proposal\" | \"negotiation\" | \"won\";\ntype FunnelXRayState = \"ready\" | \"loading\" | \"error\";\ntype ActionState = \"idle\" | \"loading\" | \"success\" | \"error\";\n\ninterface FlowStage {\n  id: FlowStageId;\n  label: string;\n  volume: number;\n  value: number;\n  stalledCount: number;\n  stalledDays: number;\n}\n\ninterface FlowTransition {\n  from: FlowStage;\n  to: FlowStage;\n  conversion: number;\n  advanced: number;\n  base: number;\n}\n\ninterface StageInsight {\n  riskDeals: string[];\n  highlight: string;\n  recommendation: string;\n}\n\nconst STAGE_TO_PIPELINE: Record<FlowStageId, string> = {\n  lead: \"lead-in\",\n  contact: \"contato-feito\",\n  meeting: \"reuniao-agendada\",\n  proposal: \"proposta-enviada\",\n  negotiation: \"negociacao\",\n  won: \"fechamento\",\n};\n\nconst PIPELINE_TO_FLOW: Record<string, FlowStageId> = {\n  \"lead-in\": \"lead\",\n  \"contato-feito\": \"contact\",\n  \"reuniao-agendada\": \"meeting\",\n  \"proposta-enviada\": \"proposal\",\n  \"negociacao\": \"negotiation\",\n  \"fechamento\": \"won\",\n};\n\nconst FLOW_STAGE_LABELS: Record<FlowStageId, string> = {\n  lead: \"Leads\",\n  contact: \"Contato\",\n  meeting: \"Reunião\",\n  proposal: \"Proposta\",\n  negotiation: \"Negociação\",\n  won: \"Fechamento\",\n};\n\nconst FLOW_STAGE_ORDER: FlowStageId[] = [\n  \"lead\",\n  \"contact\",\n  \"meeting\",\n  \"proposal\",\n  \"negotiation\",\n  \"won\",\n];\n\n// ── Dynamic builders ────────────────────────────────────────────────\n\n/**\n * Build FlowStage[] from real opportunity data.\n * Groups open opportunities by pipeline stage and computes volume, value,\n * stalled count & average stalled days.\n */\nfunction buildStagesFromOpportunities(\n  opportunities: Opportunity[],\n  now: Date\n): FlowStage[] {\n  const openOpps = opportunities.filter((o) => o.status === \"open\");\n\n  return FLOW_STAGE_ORDER.map((flowId) => {\n    const pipelineStage = STAGE_TO_PIPELINE[flowId];\n    const stageOpps = openOpps.filter((o) => o.stage === pipelineStage);\n\n    const volume = stageOpps.length;\n    const value = stageOpps.reduce((sum, o) => sum + (o.value || 0), 0);\n\n    // Stalled = not updated in 5+ days\n    const stalledThreshold = 5 * 24 * 60 * 60 * 1000;\n    const stalledOpps = stageOpps.filter(\n      (o) => now.getTime() - new Date(o.updatedAt).getTime() > stalledThreshold\n    );\n    const stalledCount = stalledOpps.length;\n\n    let stalledDays = 0;\n    if (stalledOpps.length > 0) {\n      const totalDays = stalledOpps.reduce((sum, o) => {\n        return sum + Math.round(\n          (now.getTime() - new Date(o.updatedAt).getTime()) / (1000 * 60 * 60 * 24)\n        );\n      }, 0);\n      stalledDays = Math.round(totalDays / stalledOpps.length);\n    }\n\n    return {\n      id: flowId,\n      label: FLOW_STAGE_LABELS[flowId],\n      volume,\n      value,\n      stalledCount,\n      stalledDays,\n    };\n  });\n}\n\n/**\n * Build contextual insights from real data.\n * riskDeals = top 3 stalled opportunity titles per stage.\n * highlight = dynamic text comparing stage performance.\n * recommendation = contextual action based on stage state.\n */\nfunction buildInsightsFromData(\n  stages: FlowStage[],\n  opportunities: Opportunity[],\n  now: Date\n): Record<FlowStageId, StageInsight> {\n  const openOpps = opportunities.filter((o) => o.status === \"open\");\n  const stalledThreshold = 5 * 24 * 60 * 60 * 1000;\n\n  const result = {} as Record<FlowStageId, StageInsight>;\n\n  for (const stage of stages) {\n    const pipelineStage = STAGE_TO_PIPELINE[stage.id];\n    const stageOpps = openOpps.filter((o) => o.stage === pipelineStage);\n\n    // Top 3 stalled deals by days stalled (desc)\n    const stalledOpps = stageOpps\n      .filter((o) => now.getTime() - new Date(o.updatedAt).getTime() > stalledThreshold)\n      .sort(\n        (a, b) =>\n          new Date(a.updatedAt).getTime() - new Date(b.updatedAt).getTime()\n      )\n      .slice(0, 3);\n\n    const riskDeals =\n      stalledOpps.length > 0\n        ? stalledOpps.map((o) => o.title || o.clientName)\n        : stageOpps.slice(0, 3).map((o) => o.title || o.clientName);\n\n    // Dynamic highlight\n    const stalledPct =\n      stage.volume > 0\n        ? Math.round((stage.stalledCount / stage.volume) * 100)\n        : 0;\n    const highlight =\n      stage.stalledCount > 0\n        ? `${stalledPct}% parados há +${stage.stalledDays} dias`\n        : stage.volume > 0\n          ? `${stage.volume} oportunidades ativas`\n          : \"Nenhuma oportunidade nesta etapa\";\n\n    // Context-aware recommendation\n    let recommendation: string;\n    if (stage.stalledCount > 0 && stage.stalledCount >= stage.volume * 0.5) {\n      recommendation = `Atenção: ${stage.stalledCount} oportunidades paradas. Priorizar follow-up urgente.`;\n    } else if (stage.id === \"lead\") {\n      recommendation = \"Priorizar contato inicial com leads das últimas 24h.\";\n    } else if (stage.id === \"contact\") {\n      recommendation = \"Escalar follow-up com decisores sem retorno há 3 dias.\";\n    } else if (stage.id === \"meeting\") {\n      recommendation = \"Fechar agenda com prova de valor em até 48h.\";\n    } else if (stage.id === \"proposal\") {\n      recommendation = \"Cobrar feedbacks das propostas paradas para destravar fechamento.\";\n    } else if (stage.id === \"negotiation\") {\n      recommendation = \"Alinhar objeções e preparar última contraproposta.\";\n    } else {\n      recommendation = \"Subir ticket com pacote premium na reta final.\";\n    }\n\n    result[stage.id] = { riskDeals, highlight, recommendation };\n  }\n\n  return result;\n}\n\nexport type {\n  FlowStageId,\n  FunnelXRayState,\n  ActionState,\n  FlowStage,\n  FlowTransition,\n  StageInsight,\n};\nexport {\n  STAGE_TO_PIPELINE,\n  PIPELINE_TO_FLOW,\n  FLOW_STAGE_ORDER,\n  FLOW_STAGE_LABELS,\n  buildStagesFromOpportunities,\n  buildInsightsFromData,\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1843, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/funnel-utils.ts"],"sourcesContent":["import type { FlowStage, FlowTransition } from \"./funnel-config\";\n\nexport function buildTransitions(stages: FlowStage[]): FlowTransition[] {\n  return stages.slice(0, -1).map((from, index) => {\n    const to = stages[index + 1];\n    const conversion =\n      from.volume > 0 ? Math.round((to.volume / from.volume) * 100) : 0;\n    return {\n      from,\n      to,\n      conversion,\n      advanced: to.volume,\n      base: from.volume,\n    };\n  });\n}\n\nexport function formatCurrencyCompact(value: number): string {\n  if (value >= 1_000_000) return `R$ ${(value / 1_000_000).toFixed(1)}M`;\n  if (value >= 1_000) return `R$ ${(value / 1_000).toFixed(0)}k`;\n  return `R$ ${value}`;\n}\n\nexport function formatCurrencyBRL(value: number): string {\n  return new Intl.NumberFormat(\"pt-BR\", {\n    style: \"currency\",\n    currency: \"BRL\",\n    maximumFractionDigits: 0,\n  }).format(value);\n}\n"],"names":[],"mappings":";;;;;;;;AAEO,SAAS,iBAAiB,MAAmB;IAClD,OAAO,OAAO,KAAK,CAAC,GAAG,CAAC,GAAG,GAAG,CAAC,CAAC,MAAM;QACpC,MAAM,KAAK,MAAM,CAAC,QAAQ,EAAE;QAC5B,MAAM,aACJ,KAAK,MAAM,GAAG,IAAI,KAAK,KAAK,CAAC,AAAC,GAAG,MAAM,GAAG,KAAK,MAAM,GAAI,OAAO;QAClE,OAAO;YACL;YACA;YACA;YACA,UAAU,GAAG,MAAM;YACnB,MAAM,KAAK,MAAM;QACnB;IACF;AACF;AAEO,SAAS,sBAAsB,KAAa;IACjD,IAAI,SAAS,WAAW,OAAO,CAAC,GAAG,EAAE,CAAC,QAAQ,SAAS,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IACtE,IAAI,SAAS,OAAO,OAAO,CAAC,GAAG,EAAE,CAAC,QAAQ,KAAK,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC;IAC9D,OAAO,CAAC,GAAG,EAAE,OAAO;AACtB;AAEO,SAAS,kBAAkB,KAAa;IAC7C,OAAO,IAAI,KAAK,YAAY,CAAC,SAAS;QACpC,OAAO;QACP,UAAU;QACV,uBAAuB;IACzB,GAAG,MAAM,CAAC;AACZ"}},
    {"offset": {"line": 1883, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/flow-step-card.tsx"],"sourcesContent":["\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { cn } from \"@/lib/utils\";\nimport type { FlowStageId, FlowStage } from \"./funnel-config\";\nimport { formatCurrencyCompact } from \"./funnel-utils\";\n\nexport function FlowStepCard({\n  stage,\n  selected,\n  onSelectStage,\n  compact,\n}: {\n  stage: FlowStage;\n  selected: boolean;\n  onSelectStage: (stageId: FlowStageId) => void;\n  compact: boolean;\n}) {\n  return (\n    <motion.button\n      type=\"button\"\n      onClick={() => onSelectStage(stage.id)}\n      whileTap={{ scale: 0.99 }}\n      transition={{ duration: 0.14, ease: \"easeOut\" }}\n      className={cn(\n        \"group/step min-w-0 rounded-xl border px-3 py-3 text-left transition-[background-color,border-color,box-shadow,opacity] duration-[140ms] ease-out\",\n        \"shadow-[0_8px_22px_-18px_rgba(15,23,42,0.45)] hover:shadow-[0_10px_26px_-16px_rgba(15,23,42,0.5)]\",\n        compact ? \"w-full\" : \"flex-[1_1_148px]\",\n        selected\n          ? \"border-brand/40 bg-brand/10 shadow-[0_0_0_1px_rgba(29,78,216,0.14),0_10px_26px_-16px_rgba(29,78,216,0.55)]\"\n          : \"border-zinc-200/85 bg-white/90 hover:border-zinc-300/90\"\n      )}\n      aria-pressed={selected}\n    >\n      <p className=\"truncate text-[11px] font-semibold uppercase tracking-[0.07em] text-zinc-500\">\n        {stage.label}\n      </p>\n      <p className=\"mt-1 text-xl font-bold leading-none text-zinc-900\">\n        {stage.volume}\n      </p>\n      <p className=\"mt-1 text-[11px] text-zinc-500\">{formatCurrencyCompact(stage.value)}</p>\n    </motion.button>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAEA;AALA;;;;;AAOO,SAAS,aAAa,EAC3B,KAAK,EACL,QAAQ,EACR,aAAa,EACb,OAAO,EAMR;IACC,qBACE,6LAAC,uMAAM,CAAC,MAAM;QACZ,MAAK;QACL,SAAS,IAAM,cAAc,MAAM,EAAE;QACrC,UAAU;YAAE,OAAO;QAAK;QACxB,YAAY;YAAE,UAAU;YAAM,MAAM;QAAU;QAC9C,WAAW,IAAA,4HAAE,EACX,oJACA,qGACA,UAAU,WAAW,oBACrB,WACI,+GACA;QAEN,gBAAc;;0BAEd,6LAAC;gBAAE,WAAU;0BACV,MAAM,KAAK;;;;;;0BAEd,6LAAC;gBAAE,WAAU;0BACV,MAAM,MAAM;;;;;;0BAEf,6LAAC;gBAAE,WAAU;0BAAkC,IAAA,mMAAqB,EAAC,MAAM,KAAK;;;;;;;;;;;;AAGtF;KApCgB"}},
    {"offset": {"line": 1951, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/flow-connector.tsx"],"sourcesContent":["\"use client\";\n\nimport { motion } from \"framer-motion\";\nimport { ArrowDown, ArrowRight } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { Tooltip, TooltipContent, TooltipTrigger } from \"@/components/ui/tooltip\";\nimport type { FlowTransition } from \"./funnel-config\";\n\nexport function FlowConnector({\n  transition,\n  isBottleneck,\n  orientation,\n  delay,\n}: {\n  transition: FlowTransition;\n  isBottleneck: boolean;\n  orientation: \"horizontal\" | \"vertical\";\n  delay: number;\n}) {\n  const lineClass = isBottleneck ? \"bg-amber-300/80\" : \"bg-zinc-300/85\";\n  const pillClass = isBottleneck\n    ? \"border-amber-300/80 bg-amber-50 text-amber-700\"\n    : \"border-zinc-200 bg-white text-zinc-600\";\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>\n        <motion.div\n          className={cn(\n            \"group/connector relative flex shrink-0 items-center justify-center\",\n            orientation === \"horizontal\"\n              ? \"min-w-[46px] flex-1 md:max-w-[64px]\"\n              : \"h-6 w-full\"\n          )}\n        >\n          {orientation === \"horizontal\" ? (\n            <>\n              <motion.div\n                initial={{ scaleX: 0 }}\n                animate={{ scaleX: 1 }}\n                transition={{ duration: 0.22, delay, ease: \"easeOut\" }}\n                className={cn(\n                  \"h-px w-full origin-left transition-opacity duration-[120ms] group-hover/connector:opacity-100\",\n                  lineClass,\n                  isBottleneck ? \"opacity-95\" : \"opacity-70\"\n                )}\n              />\n              <ArrowRight className=\"ml-1 h-3 w-3 text-zinc-400 transition-opacity duration-[120ms] group-hover/connector:opacity-100\" />\n            </>\n          ) : (\n            <>\n              <motion.div\n                initial={{ scaleY: 0 }}\n                animate={{ scaleY: 1 }}\n                transition={{ duration: 0.22, delay, ease: \"easeOut\" }}\n                className={cn(\n                  \"h-full w-px origin-top transition-opacity duration-[120ms] group-hover/connector:opacity-100\",\n                  lineClass,\n                  isBottleneck ? \"opacity-95\" : \"opacity-70\"\n                )}\n              />\n              <ArrowDown className=\"absolute bottom-[-3px] h-3 w-3 text-zinc-400 transition-opacity duration-[120ms] group-hover/connector:opacity-100\" />\n            </>\n          )}\n\n          <span\n            className={cn(\n              \"absolute rounded-full border px-1.5 py-0.5 text-[10px] font-semibold shadow-sm transition-opacity duration-[120ms] group-hover/connector:opacity-100\",\n              orientation === \"horizontal\" ? \"top-[-11px]\" : \"right-2 top-[2px]\",\n              pillClass,\n              isBottleneck ? \"opacity-100\" : \"opacity-85\"\n            )}\n          >\n            {transition.conversion}%\n          </span>\n        </motion.div>\n      </TooltipTrigger>\n      <TooltipContent side=\"top\" className=\"text-[11px]\">\n        {transition.advanced} de {transition.base} avançaram\n      </TooltipContent>\n    </Tooltip>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AALA;;;;;;AAQO,SAAS,cAAc,EAC5B,UAAU,EACV,YAAY,EACZ,WAAW,EACX,KAAK,EAMN;IACC,MAAM,YAAY,eAAe,oBAAoB;IACrD,MAAM,YAAY,eACd,mDACA;IAEJ,qBACE,6LAAC,iJAAO;;0BACN,6LAAC,wJAAc;gBAAC,OAAO;0BACrB,cAAA,6LAAC,uMAAM,CAAC,GAAG;oBACT,WAAW,IAAA,4HAAE,EACX,sEACA,gBAAgB,eACZ,wCACA;;wBAGL,gBAAgB,6BACf;;8CACE,6LAAC,uMAAM,CAAC,GAAG;oCACT,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,YAAY;wCAAE,UAAU;wCAAM;wCAAO,MAAM;oCAAU;oCACrD,WAAW,IAAA,4HAAE,EACX,iGACA,WACA,eAAe,eAAe;;;;;;8CAGlC,6LAAC,mOAAU;oCAAC,WAAU;;;;;;;yDAGxB;;8CACE,6LAAC,uMAAM,CAAC,GAAG;oCACT,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,SAAS;wCAAE,QAAQ;oCAAE;oCACrB,YAAY;wCAAE,UAAU;wCAAM;wCAAO,MAAM;oCAAU;oCACrD,WAAW,IAAA,4HAAE,EACX,gGACA,WACA,eAAe,eAAe;;;;;;8CAGlC,6LAAC,gOAAS;oCAAC,WAAU;;;;;;;;sCAIzB,6LAAC;4BACC,WAAW,IAAA,4HAAE,EACX,wJACA,gBAAgB,eAAe,gBAAgB,qBAC/C,WACA,eAAe,gBAAgB;;gCAGhC,WAAW,UAAU;gCAAC;;;;;;;;;;;;;;;;;;0BAI7B,6LAAC,wJAAc;gBAAC,MAAK;gBAAM,WAAU;;oBAClC,WAAW,QAAQ;oBAAC;oBAAK,WAAW,IAAI;oBAAC;;;;;;;;;;;;;AAIlD;KA1EgB"}},
    {"offset": {"line": 2087, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/flow-steps-connected.tsx"],"sourcesContent":["\"use client\";\n\nimport { Fragment } from \"react\";\nimport type { FlowStageId, FlowStage, FlowTransition } from \"./funnel-config\";\nimport { FlowStepCard } from \"./flow-step-card\";\nimport { FlowConnector } from \"./flow-connector\";\n\nexport function FlowStepsConnected({\n  stages,\n  transitions,\n  selectedStageId,\n  bottleneckToStageId,\n  onSelectStage,\n}: {\n  stages: FlowStage[];\n  transitions: FlowTransition[];\n  selectedStageId: FlowStageId | null;\n  bottleneckToStageId: FlowStageId | null;\n  onSelectStage: (stageId: FlowStageId) => void;\n}) {\n  return (\n    <>\n      <div className=\"hidden items-stretch gap-2 md:flex md:flex-wrap xl:flex-nowrap\">\n        {stages.map((stage, index) => (\n          <Fragment key={stage.id}>\n            <FlowStepCard\n              stage={stage}\n              selected={selectedStageId === stage.id}\n              onSelectStage={onSelectStage}\n              compact={false}\n            />\n            {index < transitions.length && (\n              <FlowConnector\n                transition={transitions[index]}\n                isBottleneck={bottleneckToStageId === transitions[index].to.id}\n                orientation=\"horizontal\"\n                delay={index * 0.03}\n              />\n            )}\n          </Fragment>\n        ))}\n      </div>\n\n      <div className=\"space-y-2 md:hidden\">\n        {stages.map((stage, index) => (\n          <Fragment key={`mobile-${stage.id}`}>\n            <FlowStepCard\n              stage={stage}\n              selected={selectedStageId === stage.id}\n              onSelectStage={onSelectStage}\n              compact\n            />\n            {index < transitions.length && (\n              <FlowConnector\n                transition={transitions[index]}\n                isBottleneck={bottleneckToStageId === transitions[index].to.id}\n                orientation=\"vertical\"\n                delay={index * 0.03}\n              />\n            )}\n          </Fragment>\n        ))}\n      </div>\n    </>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AAEA;AACA;AALA;;;;;AAOO,SAAS,mBAAmB,EACjC,MAAM,EACN,WAAW,EACX,eAAe,EACf,mBAAmB,EACnB,aAAa,EAOd;IACC,qBACE;;0BACE,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,OAAO,sBAClB,6LAAC,yKAAQ;;0CACP,6LAAC,gMAAY;gCACX,OAAO;gCACP,UAAU,oBAAoB,MAAM,EAAE;gCACtC,eAAe;gCACf,SAAS;;;;;;4BAEV,QAAQ,YAAY,MAAM,kBACzB,6LAAC,8LAAa;gCACZ,YAAY,WAAW,CAAC,MAAM;gCAC9B,cAAc,wBAAwB,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;gCAC9D,aAAY;gCACZ,OAAO,QAAQ;;;;;;;uBAZN,MAAM,EAAE;;;;;;;;;;0BAmB3B,6LAAC;gBAAI,WAAU;0BACZ,OAAO,GAAG,CAAC,CAAC,OAAO,sBAClB,6LAAC,yKAAQ;;0CACP,6LAAC,gMAAY;gCACX,OAAO;gCACP,UAAU,oBAAoB,MAAM,EAAE;gCACtC,eAAe;gCACf,OAAO;;;;;;4BAER,QAAQ,YAAY,MAAM,kBACzB,6LAAC,8LAAa;gCACZ,YAAY,WAAW,CAAC,MAAM;gCAC9B,cAAc,wBAAwB,WAAW,CAAC,MAAM,CAAC,EAAE,CAAC,EAAE;gCAC9D,aAAY;gCACZ,OAAO,QAAQ;;;;;;;uBAZN,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;;;;;;;;;;;;AAoB7C;KA1DgB"}},
    {"offset": {"line": 2186, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/funnel-x-ray.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { AnimatePresence, motion } from \"framer-motion\";\nimport {\n  AlertTriangle,\n  ArrowRight,\n  ArrowUpRight,\n  Sparkles,\n  TrendingDown,\n} from \"lucide-react\";\nimport { usePathname, useRouter, useSearchParams } from \"next/navigation\";\nimport { BentoCard } from \"@/components/ui/bento-card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { cn } from \"@/lib/utils\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport type { FlowStageId, FunnelXRayState, ActionState } from \"./funnel-config\";\nimport {\n  FLOW_STAGE_LABELS,\n  FLOW_STAGE_ORDER,\n  PIPELINE_TO_FLOW,\n  STAGE_TO_PIPELINE,\n  buildStagesFromOpportunities,\n} from \"./funnel-config\";\nimport { buildTransitions } from \"./funnel-utils\";\nimport { FlowStepsConnected } from \"./flow-steps-connected\";\n\nconst STALLED_OPPORTUNITY_DAYS = 5;\nconst DAY_MS = 24 * 60 * 60 * 1000;\n\ntype InsightCardStatus = \"default\" | \"loading\" | \"error\";\ntype InsightCardTone = \"neutral\" | \"danger\" | \"success\";\n\ninterface InsightCardAction {\n  label: string;\n  onAction: () => void;\n  loading?: boolean;\n  disabled?: boolean;\n  asButton?: boolean;\n}\n\ninterface InsightCardSecondaryAction {\n  label: string;\n  onAction: () => void;\n  loading?: boolean;\n}\n\nfunction parseDashboardStageParam(stageParam: string | null): FlowStageId | null {\n  if (!stageParam) return null;\n\n  if (FLOW_STAGE_ORDER.includes(stageParam as FlowStageId)) {\n    return stageParam as FlowStageId;\n  }\n\n  return PIPELINE_TO_FLOW[stageParam] ?? null;\n}\n\nfunction InsightLineCard({\n  tag,\n  headline,\n  description,\n  meta,\n  primaryAction,\n  secondaryAction,\n  onRetry,\n  status = \"default\",\n  tone = \"neutral\",\n  icon,\n  feedback,\n}: {\n  tag: string;\n  headline: string;\n  description: string;\n  meta?: string;\n  primaryAction: InsightCardAction;\n  secondaryAction?: InsightCardSecondaryAction;\n  onRetry: () => void;\n  status?: InsightCardStatus;\n  tone?: InsightCardTone;\n  icon?: React.ReactNode;\n  feedback?: React.ReactNode;\n}) {\n  const isInteractive = status === \"default\";\n\n  const toneClass =\n    tone === \"danger\"\n      ? \"border-red-200/80 bg-red-50/55 hover:border-red-300/90\"\n      : tone === \"success\"\n        ? \"border-emerald-200/80 bg-emerald-50/55 hover:border-emerald-300/90\"\n        : \"border-zinc-200/80 bg-white/85 hover:border-zinc-300/90\";\n\n  function handleCardAction() {\n    if (!isInteractive || primaryAction.disabled || primaryAction.loading) return;\n    primaryAction.onAction();\n  }\n\n  function handleCardKeyDown(event: React.KeyboardEvent<HTMLElement>) {\n    if (!isInteractive || primaryAction.disabled || primaryAction.loading) return;\n    if (event.key === \"Enter\" || event.key === \" \") {\n      event.preventDefault();\n      primaryAction.onAction();\n    }\n  }\n\n  return (\n    <motion.article\n      onClick={handleCardAction}\n      onKeyDown={handleCardKeyDown}\n      role={isInteractive ? \"button\" : undefined}\n      tabIndex={isInteractive ? 0 : -1}\n      aria-disabled={!isInteractive}\n      whileTap={isInteractive ? { scale: 0.99 } : undefined}\n      transition={{ duration: 0.1, ease: \"easeOut\" }}\n      className={cn(\n        \"flex min-h-[186px] flex-col rounded-[20px] border p-4\",\n        \"shadow-[0_10px_20px_-18px_rgba(15,23,42,0.5)]\",\n        \"transition-[background-color,border-color,box-shadow,opacity,color] duration-140 ease-out\",\n        toneClass,\n        isInteractive && \"cursor-pointer hover:shadow-[0_14px_24px_-18px_rgba(15,23,42,0.55)]\",\n        \"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-brand/25\"\n      )}\n    >\n      {status === \"loading\" ? (\n        <div className=\"flex h-full flex-col gap-3\">\n          <Skeleton className=\"h-5 w-28 rounded-md\" />\n          <Skeleton className=\"h-8 w-4/5 rounded-md\" />\n          <Skeleton className=\"h-4 w-3/4 rounded-md\" />\n          <div className=\"mt-auto\">\n            <Skeleton className=\"h-4 w-20 rounded-md\" />\n          </div>\n        </div>\n      ) : status === \"error\" ? (\n        <div className=\"flex h-full flex-col\">\n          <p className=\"text-[11px] font-semibold uppercase tracking-[0.08em] text-zinc-500\">\n            {tag}\n          </p>\n          <p className=\"mt-3 text-sm font-semibold text-zinc-900\">Erro ao carregar este insight.</p>\n          <p className=\"mt-1 text-xs text-zinc-500\">Os dados não puderam ser processados agora.</p>\n          <button\n            type=\"button\"\n            onClick={(event) => {\n              event.stopPropagation();\n              onRetry();\n            }}\n            className=\"mt-auto w-fit text-xs font-semibold text-brand underline underline-offset-4\"\n          >\n            Tentar novamente\n          </button>\n        </div>\n      ) : (\n        <>\n          <div className=\"flex items-center justify-between gap-2\">\n            <p className=\"text-[11px] font-semibold uppercase tracking-[0.08em] text-zinc-500\">\n              {tag}\n            </p>\n            {icon ? <span className=\"text-zinc-500\">{icon}</span> : null}\n          </div>\n\n          <p className=\"mt-2 truncate text-[1.18rem] font-bold leading-tight text-zinc-900\">\n            {headline}\n          </p>\n\n          <div className=\"mt-2\">\n            <p className=\"truncate text-[13px] text-zinc-600\">{description}</p>\n            {meta ? <p className=\"mt-0.5 text-[11px] text-zinc-500\">{meta}</p> : null}\n          </div>\n\n          <div className=\"mt-auto pt-3\">\n            {feedback ? <div className=\"mb-2 text-[11px]\">{feedback}</div> : null}\n\n            {primaryAction.asButton ? (\n              <button\n                type=\"button\"\n                disabled={Boolean(primaryAction.disabled || primaryAction.loading)}\n                onClick={(event) => {\n                  event.stopPropagation();\n                  if (primaryAction.disabled || primaryAction.loading) return;\n                  primaryAction.onAction();\n                }}\n                className=\"h-9 w-full rounded-full bg-zinc-900 text-xs font-semibold text-white transition-colors hover:bg-zinc-800 disabled:cursor-not-allowed disabled:opacity-65\"\n              >\n                {primaryAction.label}\n              </button>\n            ) : (\n              <button\n                type=\"button\"\n                onClick={(event) => {\n                  event.stopPropagation();\n                  primaryAction.onAction();\n                }}\n                className=\"inline-flex items-center gap-1 text-xs font-semibold text-brand underline-offset-4 transition-colors hover:text-brand-strong hover:underline\"\n              >\n                {primaryAction.label}\n                <ArrowRight className=\"h-3 w-3\" />\n              </button>\n            )}\n\n            {secondaryAction ? (\n              <button\n                type=\"button\"\n                onClick={(event) => {\n                  event.stopPropagation();\n                  secondaryAction.onAction();\n                }}\n                disabled={Boolean(secondaryAction.loading)}\n                className=\"mt-2 w-full text-center text-xs font-semibold text-zinc-600 underline-offset-4 transition-colors hover:text-zinc-800 hover:underline disabled:cursor-not-allowed disabled:opacity-65\"\n              >\n                {secondaryAction.label}\n              </button>\n            ) : null}\n          </div>\n        </>\n      )}\n    </motion.article>\n  );\n}\n\nexport function FunnelXRay({ state = \"ready\" }: { state?: FunnelXRayState }) {\n  const router = useRouter();\n  const pathname = usePathname();\n  const searchParams = useSearchParams();\n  const addActivity = useActivityStore((store) => store.addActivity);\n  const [viewState, setViewState] = useState<FunnelXRayState>(state);\n  const [actionState, setActionState] = useState<ActionState>(\"idle\");\n  const [createdCount, setCreatedCount] = useState(0);\n\n  const {\n    filteredOpportunities,\n    openOpportunities,\n    now,\n    userId,\n  } = useDashboardFilters();\n\n  const stages = useMemo(\n    () => buildStagesFromOpportunities(filteredOpportunities, now),\n    [filteredOpportunities, now]\n  );\n\n  const transitions = useMemo(() => buildTransitions(stages), [stages]);\n  const hasEnoughData = stages.length >= 2 && stages.some((stage) => stage.volume > 0);\n\n  const selectedStageId = useMemo(\n    () =>\n      parseDashboardStageParam(\n        searchParams.get(\"stage\") ?? searchParams.get(\"stageId\")\n      ),\n    [searchParams]\n  );\n\n  const selectedStage = useMemo(() => {\n    if (!selectedStageId) return null;\n    return stages.find((stage) => stage.id === selectedStageId) ?? null;\n  }, [selectedStageId, stages]);\n\n  const bottleneck = useMemo(() => {\n    if (transitions.length === 0) return null;\n    return transitions.reduce((min, current) =>\n      current.conversion < min.conversion ? current : min\n    );\n  }, [transitions]);\n\n  const criticalStage = useMemo(() => {\n    const criticalStageId = bottleneck?.to.id ?? stages[0]?.id ?? null;\n    if (!criticalStageId) return null;\n    return stages.find((stage) => stage.id === criticalStageId) ?? null;\n  }, [bottleneck, stages]);\n\n  const scopeStage = selectedStage ?? criticalStage;\n  const insightScopeKey = selectedStage?.id ?? \"all\";\n\n  const bestStage = useMemo(() => {\n    if (transitions.length === 0) return null;\n    return transitions.reduce((best, current) =>\n      current.conversion > best.conversion ? current : best\n    );\n  }, [transitions]);\n\n  const highlightConversion = bestStage?.conversion ?? 0;\n  const highlightStageName = bestStage?.from.label ?? \"—\";\n  const highlightReason = bestStage\n    ? `${bestStage.advanced} de ${bestStage.base} oportunidades avançaram no período.`\n    : \"Sem base comparável no período.\";\n\n  const riskData = useMemo(() => {\n    const threshold = now.getTime() - STALLED_OPPORTUNITY_DAYS * DAY_MS;\n    const selectedPipelineStage = selectedStage\n      ? STAGE_TO_PIPELINE[selectedStage.id]\n      : null;\n\n    const scopedOpps = openOpportunities.filter((opportunity) => {\n      if (!selectedPipelineStage) return true;\n      return opportunity.stage === selectedPipelineStage;\n    });\n\n    const stalledOpps = scopedOpps\n      .filter((opportunity) => new Date(opportunity.updatedAt).getTime() < threshold)\n      .sort(\n        (first, second) =>\n          new Date(first.updatedAt).getTime() - new Date(second.updatedAt).getTime()\n      );\n\n    const topDeal = stalledOpps[0] ?? null;\n    const total = stalledOpps.length;\n\n    if (!topDeal) {\n      const fallbackFlowId = selectedStage?.id ?? criticalStage?.id ?? null;\n      return {\n        topDealLabel: \"Sem oportunidades em risco hoje\",\n        description: selectedStage\n          ? `Etapa ${selectedStage.label} sem alertas críticos.`\n          : \"Sua carteira está sem riscos críticos no momento.\",\n        meta: \"Total em risco: 0\",\n        total,\n        stageId: fallbackFlowId,\n      };\n    }\n\n    const topDealFlowId = PIPELINE_TO_FLOW[topDeal.stage] ?? selectedStage?.id ?? null;\n    const stageLabel = topDealFlowId\n      ? FLOW_STAGE_LABELS[topDealFlowId]\n      : \"Etapa atual\";\n    const stalledDays = Math.max(\n      1,\n      Math.round((now.getTime() - new Date(topDeal.updatedAt).getTime()) / DAY_MS)\n    );\n\n    return {\n      topDealLabel: topDeal.title || topDeal.clientName,\n      description: `${stalledDays} dias sem retorno · ${stageLabel}`,\n      meta: `Total em risco: ${total}`,\n      total,\n      stageId: topDealFlowId,\n    };\n  }, [openOpportunities, now, selectedStage, criticalStage]);\n\n  const bottleneckDrop = bottleneck ? Math.max(0, 100 - bottleneck.conversion) : 0;\n\n  useEffect(() => {\n    setViewState(state);\n  }, [state]);\n\n  useEffect(() => {\n    setActionState(\"idle\");\n    setCreatedCount(0);\n  }, [selectedStage?.id]);\n\n  // Auto-dismiss action feedback after 6 seconds\n  useEffect(() => {\n    if (actionState !== \"success\" && actionState !== \"error\") return;\n    const t = setTimeout(() => setActionState(\"idle\"), 6000);\n    return () => clearTimeout(t);\n  }, [actionState]);\n\n\n  function setStageSelection(nextStageId: FlowStageId | null) {\n    const current = selectedStage?.id ?? null;\n    if (current === nextStageId) return;\n\n    const params = new URLSearchParams(searchParams.toString());\n    if (nextStageId) {\n      params.set(\"stage\", STAGE_TO_PIPELINE[nextStageId]);\n    } else {\n      params.delete(\"stage\");\n      params.delete(\"stageId\");\n    }\n\n    const serialized = params.toString();\n    router.replace(serialized ? `${pathname}?${serialized}` : pathname, {\n      scroll: false,\n    });\n  }\n\n  function openPipeline({\n    stageId,\n    filters,\n  }: {\n    stageId?: FlowStageId;\n    filters?: \"risk\" | \"stalled\" | \"no_activity\" | \"sla_overdue\" | \"sla_risk\";\n  } = {}) {\n    const params = new URLSearchParams();\n\n    if (stageId) {\n      params.set(\"stageId\", STAGE_TO_PIPELINE[stageId]);\n    }\n\n    if (filters) {\n      params.set(\"filters\", filters);\n    }\n\n    const serialized = params.toString();\n    router.push(serialized ? `/pipes?${serialized}` : \"/pipes\");\n  }\n\n  function openHighlightReason() {\n    if (bestStage?.from.id) {\n      setStageSelection(bestStage.from.id);\n    }\n  }\n\n  function openActivitiesFromAction() {\n    router.push(\"/activities?statuses=pending,overdue&q=Follow-up\");\n  }\n\n\n  function handleRecommendedAction() {\n    if (actionState === \"loading\") return;\n    if (!scopeStage) {\n      setActionState(\"error\");\n      return;\n    }\n\n    setActionState(\"loading\");\n\n    const pipelineStage = STAGE_TO_PIPELINE[scopeStage.id];\n    const stalledThreshold = STALLED_OPPORTUNITY_DAYS * DAY_MS;\n    const stalledOpps = openOpportunities\n      .filter(\n        (opportunity) =>\n          opportunity.stage === pipelineStage &&\n          now.getTime() - new Date(opportunity.updatedAt).getTime() > stalledThreshold\n      )\n      .slice(0, 3);\n\n    const tomorrow = new Date(now);\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    const tomorrowStr = tomorrow.toISOString().split(\"T\")[0];\n\n    let count = 0;\n\n    for (const opportunity of stalledOpps) {\n      addActivity({\n        title: `Follow-up: ${opportunity.title || opportunity.clientName}`,\n        description: `Cobrar feedback — oportunidade parada há +${Math.round(\n          (now.getTime() - new Date(opportunity.updatedAt).getTime()) / DAY_MS\n        )} dias`,\n        type: \"call\",\n        status: \"pending\",\n        dueDate: tomorrowStr,\n        dueTime: \"10:00\",\n        opportunityId: opportunity.id,\n        clientId: opportunity.clientId || \"\",\n        responsibleId: userId || opportunity.responsibleId,\n        responsibleName: opportunity.responsibleName,\n      });\n      count += 1;\n    }\n\n    if (count === 0) {\n      setCreatedCount(0);\n      setActionState(\"error\");\n      return;\n    }\n\n    setCreatedCount(count);\n    setActionState(\"success\");\n  }\n\n  function handleRetry() {\n    setViewState(\"loading\");\n    window.setTimeout(() => {\n      setViewState(\"ready\");\n    }, 260);\n  }\n\n  return (\n    <BentoCard\n      noPadding\n      elevated\n      className=\"premium-panel min-h-0 overflow-hidden border-zinc-200/80 bg-white/86 shadow-[0_20px_32px_-28px_rgba(15,23,42,0.45)]\"\n    >\n      <div className=\"border-b border-zinc-200/75 bg-white/85 px-3.5 py-3 backdrop-blur-sm\">\n        <div className=\"flex items-start justify-between gap-3\">\n          <div className=\"min-w-0\">\n            <h3 className=\"font-heading text-[1.02rem] font-semibold text-zinc-900\">\n              Raio X do Funil\n            </h3>\n            <p className=\"truncate text-xs text-zinc-500\">\n              Fluxo de conversão, gargalos e ação recomendada para hoje\n            </p>\n          </div>\n          <motion.button\n            type=\"button\"\n            onClick={() => openPipeline({ stageId: selectedStage?.id })}\n            whileTap={{ scale: 0.99 }}\n            transition={{ duration: 0.09, ease: \"easeOut\" }}\n            className=\"group inline-flex shrink-0 items-center gap-1.5 rounded-full px-2 py-1 text-xs font-semibold text-zinc-700 transition-[background-color,color,border-color,opacity] duration-120 ease-out hover:bg-zinc-100 hover:text-zinc-900\"\n          >\n            <span className=\"underline-offset-4 transition-colors duration-120 group-hover:underline\">\n              Ver Pipeline\n            </span>\n            <ArrowRight className=\"h-3.5 w-3.5\" />\n          </motion.button>\n        </div>\n      </div>\n\n      {viewState === \"ready\" && !hasEnoughData ? (\n        <div className=\"p-5\">\n          <div className=\"rounded-xl border border-dashed border-zinc-300 bg-zinc-50/70 p-4\">\n            <p className=\"text-sm font-semibold text-zinc-900\">\n              Sem dados suficientes para o Raio X\n            </p>\n            <p className=\"mt-1 text-xs text-zinc-500\">\n              Cadastre oportunidades para gerar conversão e gargalos acionáveis.\n            </p>\n            <Button\n              size=\"sm\"\n              className=\"mt-3 h-8 rounded-full bg-zinc-900 text-xs text-white hover:bg-zinc-800\"\n              onClick={() => openPipeline()}\n            >\n              Ver pipeline\n            </Button>\n          </div>\n        </div>\n      ) : null}\n\n      {viewState === \"loading\" || viewState === \"error\" ? (\n        <div className=\"p-5\">\n          <div className=\"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4\">\n            <InsightLineCard\n              tag=\"Oportunidades em risco\"\n              headline=\"\"\n              description=\"\"\n              primaryAction={{ label: \"Ver etapa\", onAction: () => {} }}\n              onRetry={handleRetry}\n              status={viewState === \"loading\" ? \"loading\" : \"error\"}\n            />\n            <InsightLineCard\n              tag=\"Top gargalo\"\n              headline=\"\"\n              description=\"\"\n              primaryAction={{ label: \"Ver lista\", onAction: () => {} }}\n              onRetry={handleRetry}\n              status={viewState === \"loading\" ? \"loading\" : \"error\"}\n            />\n            <InsightLineCard\n              tag=\"Destaque\"\n              headline=\"\"\n              description=\"\"\n              primaryAction={{ label: \"Ver motivo\", onAction: () => {} }}\n              onRetry={handleRetry}\n              status={viewState === \"loading\" ? \"loading\" : \"error\"}\n            />\n            <InsightLineCard\n              tag=\"Ação recomendada\"\n              headline=\"\"\n              description=\"\"\n              primaryAction={{ label: \"Cobrar feedbacks\", onAction: () => {}, asButton: true }}\n              onRetry={handleRetry}\n              status={viewState === \"loading\" ? \"loading\" : \"error\"}\n            />\n          </div>\n        </div>\n      ) : null}\n\n      {viewState === \"ready\" && hasEnoughData ? (\n        <motion.div\n          initial={{ opacity: 0, y: 6 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.18, ease: \"easeOut\" }}\n          className=\"flex flex-col gap-5 p-5\"\n        >\n          <div className=\"space-y-4\">\n            <TooltipProvider delayDuration={80}>\n              <FlowStepsConnected\n                stages={stages}\n                transitions={transitions}\n                selectedStageId={selectedStage?.id ?? null}\n                bottleneckToStageId={bottleneck?.to.id ?? null}\n                onSelectStage={setStageSelection}\n              />\n            </TooltipProvider>\n\n            {selectedStage ? (\n              <div className=\"flex flex-wrap items-center justify-between gap-2 rounded-xl border border-zinc-200/80 bg-zinc-50/70 px-3 py-2\">\n                <p className=\"text-xs text-zinc-600\">\n                  Exibindo insights da etapa:{\" \"}\n                  <span className=\"font-semibold text-zinc-900\">{selectedStage.label}</span>\n                </p>\n                <button\n                  type=\"button\"\n                  onClick={() => setStageSelection(null)}\n                  className=\"text-xs font-semibold text-brand underline underline-offset-4\"\n                >\n                  Limpar seleção\n                </button>\n              </div>\n            ) : null}\n\n            <AnimatePresence mode=\"wait\">\n              <motion.div\n                key={insightScopeKey}\n                initial={{ opacity: 0 }}\n                animate={{ opacity: 1 }}\n                exit={{ opacity: 0 }}\n                transition={{ duration: 0.14 }}\n                className=\"grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-4\"\n              >\n                <InsightLineCard\n                  tag=\"Oportunidades em risco\"\n                  headline={riskData.topDealLabel}\n                  description={riskData.description}\n                  meta={riskData.meta}\n                  primaryAction={{\n                    label: riskData.total > 0 ? \"Ver etapa\" : \"Ver pipeline\",\n                    onAction: () =>\n                      riskData.total > 0\n                        ? openPipeline({ stageId: riskData.stageId ?? undefined, filters: \"risk\" })\n                        : openPipeline({ stageId: selectedStage?.id }),\n                  }}\n                  onRetry={handleRetry}\n                  icon={<AlertTriangle className=\"h-4 w-4 text-amber-600\" />}\n                />\n\n                <InsightLineCard\n                  tag=\"Top gargalo\"\n                  headline={\n                    bottleneck\n                      ? `Queda de ${bottleneckDrop}% em ${bottleneck.to.label}`\n                      : \"Sem gargalos relevantes no período\"\n                  }\n                  description={\n                    bottleneck\n                      ? `${bottleneck.to.stalledCount} oportunidades paradas há +${bottleneck.to.stalledDays} dias`\n                      : \"Nenhuma etapa com queda crítica no período atual.\"\n                  }\n                  primaryAction={{\n                    label: bottleneck ? \"Ver lista\" : \"Ver pipeline\",\n                    onAction: () =>\n                      bottleneck\n                        ? openPipeline({ stageId: bottleneck.to.id, filters: \"stalled\" })\n                        : openPipeline(),\n                  }}\n                  onRetry={handleRetry}\n                  tone={bottleneck ? \"danger\" : \"neutral\"}\n                  icon={<TrendingDown className=\"h-4 w-4 text-red-600\" />}\n                />\n\n                <InsightLineCard\n                  tag=\"Destaque\"\n                  headline={\n                    bestStage && bestStage.base > 0\n                      ? `Melhor conversão: ${highlightConversion}% em ${highlightStageName}`\n                      : \"Sem base comparável no período\"\n                  }\n                  description={highlightReason}\n                  primaryAction={{\n                    label: bestStage && bestStage.base > 0 ? \"Ver motivo\" : \"Ver pipeline\",\n                    onAction: () =>\n                      bestStage && bestStage.base > 0 ? openHighlightReason() : openPipeline(),\n                  }}\n                  onRetry={handleRetry}\n                  tone={bestStage && bestStage.base > 0 ? \"success\" : \"neutral\"}\n                  icon={<ArrowUpRight className=\"h-4 w-4 text-emerald-600\" />}\n                />\n\n                <InsightLineCard\n                  tag=\"Ação recomendada\"\n                  headline={scopeStage ? \"Cobrar feedbacks\" : \"Nenhuma ação recomendada agora\"}\n                  description={\n                    scopeStage\n                      ? `Atenção: ${riskData.total} oportunidades paradas. Priorizar follow-up hoje.`\n                      : \"Sem oportunidades paradas críticas neste momento.\"\n                  }\n                  primaryAction={{\n                    label:\n                      actionState === \"loading\"\n                        ? \"Criando ações...\"\n                        : scopeStage\n                          ? \"Cobrar feedbacks\"\n                          : \"Ver pipeline\",\n                    onAction: () =>\n                      scopeStage ? handleRecommendedAction() : openPipeline(),\n                    asButton: true,\n                    disabled: actionState === \"loading\",\n                    loading: actionState === \"loading\",\n                  }}\n                  feedback={\n                    <>\n                      {actionState === \"success\" ? (\n                        <p className=\"rounded-md border border-emerald-200 bg-emerald-50 px-2 py-1 text-emerald-700\">\n                          Ações criadas ({createdCount}).{\" \"}\n                          <button\n                            type=\"button\"\n                            onClick={(event) => {\n                              event.stopPropagation();\n                              openActivitiesFromAction();\n                            }}\n                            className=\"font-semibold underline underline-offset-4\"\n                          >\n                            Ver atividades\n                          </button>\n                        </p>\n                      ) : null}\n\n                      {actionState === \"error\" ? (\n                        <p className=\"rounded-md border border-red-200 bg-red-50 px-2 py-1 text-red-700\">\n                          Não foi possível criar ações agora.{\" \"}\n                          <button\n                            type=\"button\"\n                            onClick={(event) => {\n                              event.stopPropagation();\n                              handleRecommendedAction();\n                            }}\n                            className=\"font-semibold underline underline-offset-4\"\n                          >\n                            Tentar novamente\n                          </button>\n                        </p>\n                      ) : null}\n\n                    </>\n                  }\n                  onRetry={handleRetry}\n                  icon={<Sparkles className=\"h-4 w-4 text-brand\" />}\n                />\n              </motion.div>\n            </AnimatePresence>\n          </div>\n\n        </motion.div>\n      ) : null}\n    </BentoCard>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3207, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/funnel-x-ray/index.ts"],"sourcesContent":["export { FunnelXRay } from \"./funnel-x-ray\";\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 3217, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-execution-panel-data.ts"],"sourcesContent":["\"use client\";\n\n// ============================================================================\n// Hook que computa dados em tempo real para o Execution Panel\n// ============================================================================\n\nimport { useMemo } from \"react\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useClientStore } from \"@/stores/client-store\";\nimport { useGoalStore } from \"@/stores/goal-store\";\nimport { usePipelineStore } from \"@/stores/pipeline-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport {\n  computeTodaysPriorities,\n  computeSmartInsights,\n  computeQuickWins,\n  computeRiskAlerts,\n} from \"@/lib/proactive-engine\";\nimport type {\n  ProactiveEngineInput,\n  ExecutionPanelData,\n} from \"@/lib/proactive-engine\";\n\nexport function useExecutionPanelData(): ExecutionPanelData {\n  const opportunities = useOpportunityStore((s) => s.opportunities);\n  const activities = useActivityStore((s) => s.activities);\n  const clients = useClientStore((s) => s.clients);\n  const goals = useGoalStore((s) => s.goals);\n  const pipelines = usePipelineStore((s) => s.pipelines);\n  const user = useAuthStore((s) => s.user);\n\n  return useMemo(() => {\n    const empty: ExecutionPanelData = { priorities: [], insights: [], quickWins: [], riskAlerts: [] };\n    if (!user) return empty;\n\n    try {\n      const input: ProactiveEngineInput = {\n        opportunities,\n        activities,\n        clients,\n        goals,\n        pipelines,\n        userId: user.id,\n        userRole: user.role,\n      };\n\n      return {\n        priorities: computeTodaysPriorities(input),\n        insights: computeSmartInsights(input),\n        quickWins: computeQuickWins(input),\n        riskAlerts: computeRiskAlerts(input),\n      };\n    } catch (err) {\n      console.error(\"[ExecutionPanelData] Erro ao computar dados:\", err);\n      return empty;\n    }\n  }, [opportunities, activities, clients, goals, pipelines, user]);\n}\n"],"names":[],"mappings":";;;;AAEA,+EAA+E;AAC/E,8DAA8D;AAC9D,+EAA+E;AAE/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAbA;;;;;;;;;AAwBO,SAAS;;IACd,MAAM,gBAAgB,IAAA,+JAAmB;oEAAC,CAAC,IAAM,EAAE,aAAa;;IAChE,MAAM,aAAa,IAAA,yJAAgB;8DAAC,CAAC,IAAM,EAAE,UAAU;;IACvD,MAAM,UAAU,IAAA,qJAAc;yDAAC,CAAC,IAAM,EAAE,OAAO;;IAC/C,MAAM,QAAQ,IAAA,iJAAY;qDAAC,CAAC,IAAM,EAAE,KAAK;;IACzC,MAAM,YAAY,IAAA,yJAAgB;6DAAC,CAAC,IAAM,EAAE,SAAS;;IACrD,MAAM,OAAO,IAAA,iJAAY;oDAAC,CAAC,IAAM,EAAE,IAAI;;IAEvC,OAAO,IAAA,wKAAO;yCAAC;YACb,MAAM,QAA4B;gBAAE,YAAY,EAAE;gBAAE,UAAU,EAAE;gBAAE,WAAW,EAAE;gBAAE,YAAY,EAAE;YAAC;YAChG,IAAI,CAAC,MAAM,OAAO;YAElB,IAAI;gBACF,MAAM,QAA8B;oBAClC;oBACA;oBACA;oBACA;oBACA;oBACA,QAAQ,KAAK,EAAE;oBACf,UAAU,KAAK,IAAI;gBACrB;gBAEA,OAAO;oBACL,YAAY,IAAA,2KAAuB,EAAC;oBACpC,UAAU,IAAA,wKAAoB,EAAC;oBAC/B,WAAW,IAAA,oKAAgB,EAAC;oBAC5B,YAAY,IAAA,mKAAiB,EAAC;gBAChC;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,gDAAgD;gBAC9D,OAAO;YACT;QACF;wCAAG;QAAC;QAAe;QAAY;QAAS;QAAO;QAAW;KAAK;AACjE;GAlCgB;;QACQ,+JAAmB;QACtB,yJAAgB;QACnB,qJAAc;QAChB,iJAAY;QACR,yJAAgB;QACrB,iJAAY"}},
    {"offset": {"line": 3320, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/execution-section.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport {\n  AlertCircle,\n  AlertTriangle,\n  CalendarClock,\n  CheckCircle2,\n  ChevronRight,\n  Clock3,\n  Copy,\n  ExternalLink,\n  Info,\n  Mail,\n  MessageCircle,\n  MoreHorizontal,\n  Phone,\n  RefreshCw,\n  ShieldAlert,\n  Target,\n} from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { BentoCard } from \"@/components/ui/bento-card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n  Popover,\n  PopoverContent,\n  PopoverDescription,\n  PopoverHeader,\n  PopoverTitle,\n  PopoverTrigger,\n} from \"@/components/ui/popover\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useClientStore } from \"@/stores/client-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport { useExecutionPanelData } from \"@/hooks/use-execution-panel-data\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport { getActivityDueAt } from \"@/lib/business-rules\";\nimport type { RiskAlert } from \"@/lib/proactive-engine\";\nimport type { Activity, PipelineStage } from \"@/types\";\n\ntype AlertSeverity = \"critical\" | \"high\" | \"medium\";\ntype AlertKind =\n  | \"health_critical\"\n  | \"goal_risk\"\n  | \"stalled_deal\"\n  | \"overdue_activities\"\n  | \"sla_risk\"\n  | \"contract_risk\";\ntype AlertGroup = \"churn\" | \"pipeline\" | \"activities\" | \"goals\";\ntype AlertFilter = \"all\" | \"critical\" | AlertGroup;\ntype AlertLifecycle = \"open\" | \"in_progress\" | \"resolved\" | \"snoozed\";\ntype FeedbackTone = \"success\" | \"error\" | \"info\";\n\ninterface AlertFeedback {\n  tone: FeedbackTone;\n  message: string;\n  linkLabel?: string;\n  linkPath?: string;\n}\n\ninterface AlertRuntime {\n  status: AlertLifecycle;\n  feedback?: AlertFeedback;\n}\n\ninterface DisplayAlert {\n  id: string;\n  title: string;\n  context: string;\n  impact: string;\n  recommendation: string;\n  consequence: string;\n  severity: AlertSeverity;\n  kind: AlertKind;\n  group: AlertGroup;\n  reasonCode: string;\n  viewPath: string;\n  entityId?: string;\n  impactScore: number;\n  duplicateCount: number;\n}\n\ninterface SnoozedAlert {\n  id: string;\n  label: string;\n}\n\ninterface ResolveResult {\n  message: string;\n  linkLabel?: string;\n  linkPath?: string;\n}\n\ninterface ActivityAgendaItem {\n  id: string;\n  title: string;\n  clientLine: string;\n  description: string;\n  type: Activity[\"type\"];\n  status: \"pending\" | \"overdue\";\n  dueDate: string;\n  dueTime?: string;\n  dueAt: Date;\n  hasTime: boolean;\n  delayLabel: string | null;\n}\n\ninterface AgendaNotice {\n  tone: FeedbackTone;\n  message: string;\n  linkLabel?: string;\n  linkPath?: string;\n}\n\ninterface AgendaItemRuntime {\n  loading?: boolean;\n  error?: string;\n}\n\ninterface RescheduleDraft {\n  dueDate: string;\n  dueTime: string;\n}\n\nconst STAGE_LABELS: Record<PipelineStage, string> = {\n  \"lead-in\": \"Leads\",\n  \"contato-feito\": \"Contato\",\n  \"reuniao-agendada\": \"Reunião\",\n  \"proposta-enviada\": \"Proposta\",\n  negociacao: \"Negociação\",\n  fechamento: \"Fechamento\",\n};\n\nconst ALERT_FILTER_OPTIONS: Array<{ id: AlertFilter; label: string }> = [\n  { id: \"all\", label: \"Todos\" },\n  { id: \"critical\", label: \"Críticos\" },\n  { id: \"churn\", label: \"Risco de churn\" },\n  { id: \"pipeline\", label: \"Pipeline parado\" },\n  { id: \"activities\", label: \"Atividades\" },\n  { id: \"goals\", label: \"Metas\" },\n];\n\nconst SNOOZE_OPTIONS = [\n  { label: \"1h\", hours: 1 },\n  { label: \"Amanhã\", hours: 24 },\n  { label: \"1 semana\", hours: 24 * 7 },\n] as const;\n\nconst ALERT_SEVERITY_ORDER: Record<AlertSeverity, number> = {\n  critical: 0,\n  high: 1,\n  medium: 2,\n};\n\nconst ALERT_STATUS_ORDER: Record<AlertLifecycle, number> = {\n  in_progress: 0,\n  open: 1,\n  resolved: 2,\n  snoozed: 3,\n};\n\nconst FALLBACK_RETRY_MESSAGE = \"Não consegui resolver agora.\";\n\nfunction toDateOnly(date: Date): string {\n  const year = date.getFullYear();\n  const month = `${date.getMonth() + 1}`.padStart(2, \"0\");\n  const day = `${date.getDate()}`.padStart(2, \"0\");\n  return `${year}-${month}-${day}`;\n}\n\nfunction addDays(baseDate: Date, days: number): Date {\n  const next = new Date(baseDate);\n  next.setDate(next.getDate() + days);\n  return next;\n}\n\nfunction formatStage(stage?: PipelineStage): string {\n  if (!stage) return \"Sem etapa\";\n  return STAGE_LABELS[stage] ?? \"Sem etapa\";\n}\n\nfunction mapRiskSeverity(severity: RiskAlert[\"severity\"]): AlertSeverity {\n  return severity === \"critical\" ? \"critical\" : \"high\";\n}\n\nfunction formatDelay(ms: number): string {\n  if (!Number.isFinite(ms) || ms <= 0) return \"0min\";\n  const totalMinutes = Math.max(1, Math.round(ms / (1000 * 60)));\n  if (totalMinutes < 60) return `${totalMinutes}min`;\n\n  const totalHours = Math.round(totalMinutes / 60);\n  if (totalHours < 24) return `${totalHours}h`;\n\n  const days = Math.round(totalHours / 24);\n  return `${days}d`;\n}\n\nfunction formatSnoozeUntil(baseDate: Date, hours: number): string {\n  const until = new Date(baseDate.getTime() + hours * 60 * 60 * 1000);\n  return until.toLocaleString(\"pt-BR\", {\n    day: \"2-digit\",\n    month: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n  });\n}\n\nfunction formatRescheduleLabel(dueDate: string, dueTime?: string): string {\n  const parsed = new Date(`${dueDate}T${dueTime || \"09:00\"}:00`);\n  if (Number.isNaN(parsed.getTime())) {\n    return dueTime ? `${dueDate} ${dueTime}` : dueDate;\n  }\n\n  return parsed.toLocaleString(\"pt-BR\", {\n    day: \"2-digit\",\n    month: \"2-digit\",\n    hour: \"2-digit\",\n    minute: \"2-digit\",\n  });\n}\n\nfunction getAlertBadgeClass(severity: AlertSeverity): string {\n  if (severity === \"critical\") {\n    return \"border-red-200 bg-red-50 text-red-700\";\n  }\n\n  if (severity === \"high\") {\n    return \"border-amber-200 bg-amber-50 text-amber-700\";\n  }\n\n  return \"border-sky-200 bg-sky-50 text-sky-700\";\n}\n\nfunction getSeverityLabel(severity: AlertSeverity): string {\n  if (severity === \"critical\") return \"Crítico\";\n  if (severity === \"high\") return \"Alto\";\n  return \"Médio\";\n}\n\nfunction getAlertIcon(alert: DisplayAlert) {\n  if (alert.kind === \"sla_risk\") {\n    return <ShieldAlert className=\"h-4 w-4 text-red-600\" />;\n  }\n\n  if (alert.kind === \"goal_risk\") {\n    return <Target className=\"h-4 w-4 text-amber-600\" />;\n  }\n\n  if (alert.severity === \"critical\") {\n    return <AlertCircle className=\"h-4 w-4 text-red-600\" />;\n  }\n\n  if (alert.severity === \"high\") {\n    return <AlertTriangle className=\"h-4 w-4 text-amber-600\" />;\n  }\n\n  return <Info className=\"h-4 w-4 text-sky-600\" />;\n}\n\nfunction matchesAlertFilter(alert: DisplayAlert, filter: AlertFilter): boolean {\n  if (filter === \"all\") return true;\n  if (filter === \"critical\") return alert.severity === \"critical\";\n  return alert.group === filter;\n}\n\nfunction getExecuteLabel(type: Activity[\"type\"]): string {\n  if (type === \"call\") return \"Ligar\";\n  if (type === \"whatsapp\") return \"WhatsApp\";\n  if (type === \"email\") return \"Email\";\n  if (type === \"meeting\") return \"Entrar\";\n  return \"Executar\";\n}\n\nfunction getExecutePath(activityId: string, type: Activity[\"type\"]): string {\n  return `/activities?activityId=${activityId}&execute=${type}`;\n}\n\nfunction getActivityTypeIcon(type: Activity[\"type\"]) {\n  if (type === \"call\") return Phone;\n  if (type === \"email\") return Mail;\n  if (type === \"whatsapp\") return MessageCircle;\n  return CalendarClock;\n}\n\nfunction isActionableAlert(status: AlertLifecycle): boolean {\n  return status === \"open\" || status === \"in_progress\";\n}\n\nfunction sleep(ms: number): Promise<void> {\n  return new Promise((resolve) => {\n    window.setTimeout(resolve, ms);\n  });\n}\n\nexport function CriticalAlerts() {\n  const router = useRouter();\n  const { riskAlerts } = useExecutionPanelData();\n  const {\n    filteredActivities,\n    openOpportunities,\n    now,\n    userId,\n  } = useDashboardFilters();\n\n  const userName = useAuthStore((s) => s.user?.name ?? \"Sales Executive\");\n  const clients = useClientStore((s) => s.clients);\n  const allActivities = useActivityStore((s) => s.activities);\n  const activityLoading = useActivityStore((s) => s.isLoading);\n  const opportunityLoading = useOpportunityStore((s) => s.isLoading);\n\n  const addActivity = useActivityStore((s) => s.addActivity);\n  const updateOpportunity = useOpportunityStore((s) => s.updateOpportunity);\n\n  const [activeFilter, setActiveFilter] = useState<AlertFilter>(\"all\");\n  const [runtimeById, setRuntimeById] = useState<Record<string, AlertRuntime>>({});\n  const [dismissedIds, setDismissedIds] = useState<Set<string>>(new Set());\n  const [snoozePopoverId, setSnoozePopoverId] = useState<string | null>(null);\n  const [snoozeReasonById, setSnoozeReasonById] = useState<Record<string, string>>({});\n  const [snoozedAlerts, setSnoozedAlerts] = useState<SnoozedAlert[]>([]);\n  const [confirmBatchResolveOpen, setConfirmBatchResolveOpen] = useState(false);\n\n  const alerts = useMemo(() => {\n    const opportunityById = new Map(openOpportunities.map((opportunity) => [opportunity.id, opportunity]));\n    const clientById = new Map(clients.map((client) => [client.id, client]));\n    const map = new Map<string, DisplayAlert>();\n\n    const pushAlert = (candidate: Omit<DisplayAlert, \"duplicateCount\">) => {\n      const dedupeKey = `${candidate.kind}:${candidate.entityId ?? \"global\"}:${candidate.reasonCode}`;\n      const existing = map.get(dedupeKey);\n      if (!existing) {\n        map.set(dedupeKey, { ...candidate, duplicateCount: 1 });\n        return;\n      }\n\n      map.set(dedupeKey, {\n        ...existing,\n        impactScore: Math.max(existing.impactScore, candidate.impactScore),\n        severity:\n          ALERT_SEVERITY_ORDER[candidate.severity] < ALERT_SEVERITY_ORDER[existing.severity]\n            ? candidate.severity\n            : existing.severity,\n        duplicateCount: existing.duplicateCount + 1,\n      });\n    };\n\n    for (const alert of riskAlerts) {\n      if (alert.type === \"health-drop\") {\n        const client = alert.linkedEntityId ? clientById.get(alert.linkedEntityId) : null;\n        pushAlert({\n          id: alert.id,\n          title: \"Saúde crítica\",\n          context: client?.companyName ?? alert.title,\n          impact: alert.description,\n          recommendation: \"Reengajar cliente com follow-up imediato.\",\n          consequence: \"Vai criar atividade de WhatsApp para hoje.\",\n          severity: mapRiskSeverity(alert.severity),\n          kind: \"health_critical\",\n          group: \"churn\",\n          reasonCode: \"health_drop\",\n          viewPath: alert.linkedEntityId ? `/clients/${alert.linkedEntityId}` : \"/clients?health=critical\",\n          entityId: alert.linkedEntityId,\n          impactScore: client?.monthlyRevenue ?? 0,\n        });\n        continue;\n      }\n\n      if (alert.type === \"stale\") {\n        const opportunity = alert.linkedEntityId ? opportunityById.get(alert.linkedEntityId) : null;\n        const staleDays = opportunity\n          ? Math.max(1, Math.round((now.getTime() - new Date(opportunity.updatedAt).getTime()) / (1000 * 60 * 60 * 24)))\n          : null;\n\n        pushAlert({\n          id: alert.id,\n          title: staleDays ? `Parado há ${staleDays}d` : \"Pipeline parado\",\n          context: opportunity\n            ? `${opportunity.clientName} - ${formatStage(opportunity.stage)}`\n            : alert.title,\n          impact: alert.description,\n          recommendation: \"Cobrar resposta e registrar próxima ação.\",\n          consequence: \"Vai criar follow-up para hoje e abrir a oportunidade filtrada.\",\n          severity: mapRiskSeverity(alert.severity),\n          kind: \"stalled_deal\",\n          group: \"pipeline\",\n          reasonCode: \"stalled_deal\",\n          viewPath: alert.linkedEntityId\n            ? `/pipes?opportunityId=${alert.linkedEntityId}&tab=activities`\n            : \"/pipes?filter=stale\",\n          entityId: alert.linkedEntityId,\n          impactScore: opportunity?.value ?? 0,\n        });\n        continue;\n      }\n\n      if (alert.type === \"sla-breach\") {\n        const opportunity = alert.linkedEntityId ? opportunityById.get(alert.linkedEntityId) : null;\n\n        pushAlert({\n          id: alert.id,\n          title: \"SLA estourado\",\n          context: opportunity\n            ? `${opportunity.clientName} - ${formatStage(opportunity.stage)}`\n            : alert.title,\n          impact: alert.description,\n          recommendation: \"Tratar SLA imediatamente e formalizar próxima ação.\",\n          consequence: \"Vai criar atividade crítica de follow-up para hoje.\",\n          severity: \"critical\",\n          kind: \"sla_risk\",\n          group: \"pipeline\",\n          reasonCode: \"sla_breach\",\n          viewPath: alert.linkedEntityId\n            ? `/pipes?opportunityId=${alert.linkedEntityId}&filter=sla_overdue`\n            : \"/pipes?filter=sla_overdue\",\n          entityId: alert.linkedEntityId,\n          impactScore: (opportunity?.value ?? 0) + 200000,\n        });\n        continue;\n      }\n\n      if (alert.type === \"goal-risk\") {\n        pushAlert({\n          id: alert.id,\n          title: \"Meta em risco\",\n          context: alert.title,\n          impact: alert.description,\n          recommendation: \"Ajustar plano de recuperação da meta agora.\",\n          consequence: \"Vai criar tarefa de recuperação e abrir metas em risco.\",\n          severity: \"critical\",\n          kind: \"goal_risk\",\n          group: \"goals\",\n          reasonCode: \"goal_risk\",\n          viewPath: \"/goals\",\n          entityId: alert.linkedEntityId,\n          impactScore: 120000,\n        });\n        continue;\n      }\n\n      if (alert.type === \"contract-expiring\") {\n        const client = alert.linkedEntityId ? clientById.get(alert.linkedEntityId) : null;\n\n        pushAlert({\n          id: alert.id,\n          title: \"Contrato expirando\",\n          context: client?.companyName ?? alert.title,\n          impact: alert.description,\n          recommendation: \"Iniciar renovação com proposta de valor objetiva.\",\n          consequence: \"Vai criar atividade de renovação para hoje.\",\n          severity: mapRiskSeverity(alert.severity),\n          kind: \"contract_risk\",\n          group: \"churn\",\n          reasonCode: \"contract_expiring\",\n          viewPath: alert.linkedEntityId ? `/clients/${alert.linkedEntityId}` : \"/clients\",\n          entityId: alert.linkedEntityId,\n          impactScore: client?.monthlyRevenue ?? 0,\n        });\n      }\n    }\n\n    const overdueActivities = filteredActivities.filter(\n      (activity) => activity.effectiveStatus === \"overdue\"\n    );\n\n    if (overdueActivities.length > 0) {\n      const maxDelayMs = overdueActivities.reduce((maxDelay, activity) => {\n        const dueAt = getActivityDueAt(activity);\n        return Math.max(maxDelay, now.getTime() - dueAt.getTime());\n      }, 0);\n\n      const severity: AlertSeverity =\n        overdueActivities.length >= 8 ? \"critical\" : overdueActivities.length >= 3 ? \"high\" : \"medium\";\n\n      pushAlert({\n        id: \"overdue-activities\",\n        title: \"Atividades atrasadas\",\n        context: `${overdueActivities.length} item(ns) aguardando execução`,\n        impact: `Maior atraso acumulado: ${formatDelay(maxDelayMs)}.`,\n        recommendation: \"Priorizar backlog atrasado para proteger o SLA.\",\n        consequence: \"Vai abrir a lista de atrasadas e criar tarefa de mutirão.\",\n        severity,\n        kind: \"overdue_activities\",\n        group: \"activities\",\n        reasonCode: \"overdue_activities\",\n        viewPath: \"/activities?status=overdue\",\n        impactScore: overdueActivities.length * 10000,\n      });\n    }\n\n    return Array.from(map.values()).sort((a, b) => {\n      const bySeverity = ALERT_SEVERITY_ORDER[a.severity] - ALERT_SEVERITY_ORDER[b.severity];\n      if (bySeverity !== 0) return bySeverity;\n      return b.impactScore - a.impactScore;\n    });\n  }, [riskAlerts, filteredActivities, openOpportunities, clients, now]);\n\n  const visibleAlerts = useMemo(() => {\n    return alerts\n      .filter((alert) => !dismissedIds.has(alert.id))\n      .filter((alert) => (runtimeById[alert.id]?.status ?? \"open\") !== \"snoozed\")\n      .filter((alert) => matchesAlertFilter(alert, activeFilter))\n      .sort((a, b) => {\n        const statusA = runtimeById[a.id]?.status ?? \"open\";\n        const statusB = runtimeById[b.id]?.status ?? \"open\";\n        const statusOrder = ALERT_STATUS_ORDER[statusA] - ALERT_STATUS_ORDER[statusB];\n        if (statusOrder !== 0) return statusOrder;\n        return ALERT_SEVERITY_ORDER[a.severity] - ALERT_SEVERITY_ORDER[b.severity];\n      });\n  }, [alerts, dismissedIds, runtimeById, activeFilter]);\n\n  const actionableVisible = visibleAlerts.filter((alert) => {\n    const status = runtimeById[alert.id]?.status ?? \"open\";\n    return isActionableAlert(status);\n  });\n\n  const counterByFilter = useMemo(() => {\n    const next: Record<AlertFilter, number> = {\n      all: 0,\n      critical: 0,\n      churn: 0,\n      pipeline: 0,\n      activities: 0,\n      goals: 0,\n    };\n\n    for (const alert of alerts) {\n      if (dismissedIds.has(alert.id)) continue;\n      const status = runtimeById[alert.id]?.status ?? \"open\";\n      if (!isActionableAlert(status)) continue;\n\n      next.all += 1;\n      if (alert.severity === \"critical\") next.critical += 1;\n      next[alert.group] += 1;\n    }\n\n    return next;\n  }, [alerts, dismissedIds, runtimeById]);\n\n  const isLoading = activityLoading || opportunityLoading;\n\n  const setAlertRuntime = (alertId: string, runtime: AlertRuntime) => {\n    setRuntimeById((prev) => ({\n      ...prev,\n      [alertId]: runtime,\n    }));\n  };\n\n  const scheduleDismiss = (alertId: string) => {\n    window.setTimeout(() => {\n      setDismissedIds((prev) => {\n        const next = new Set(prev);\n        next.add(alertId);\n        return next;\n      });\n    }, 1800);\n  };\n\n  // Auto-dismiss info feedback on alerts after 5 seconds\n  useEffect(() => {\n    const infoAlertIds = Object.entries(runtimeById)\n      .filter(([, r]) => r.feedback?.tone === \"info\" && r.status !== \"resolved\")\n      .map(([id]) => id);\n    if (infoAlertIds.length === 0) return;\n\n    const t = setTimeout(() => {\n      setRuntimeById((prev) => {\n        const next = { ...prev };\n        for (const id of infoAlertIds) {\n          const current = next[id];\n          if (current?.feedback?.tone === \"info\") {\n            const { feedback: _, ...rest } = current;\n            next[id] = rest;\n          }\n        }\n        return next;\n      });\n    }, 5000);\n    return () => clearTimeout(t);\n  }, [runtimeById]);\n\n  const ensureFollowUpActivity = (\n    opts: {\n      title: string;\n      description: string;\n      type: Activity[\"type\"];\n      dueTime: string;\n      opportunityId?: string;\n      clientId?: string;\n      searchTerm: string;\n    }\n  ): string => {\n    const openActivity = allActivities.find((activity) => {\n      if (activity.status === \"completed\" || activity.status === \"cancelled\") return false;\n\n      const lowerTitle = activity.title.toLowerCase();\n      const linkedToOpportunity = opts.opportunityId && activity.opportunityId === opts.opportunityId;\n      const linkedToClient = opts.clientId && activity.clientId === opts.clientId;\n\n      return (Boolean(linkedToOpportunity) || Boolean(linkedToClient)) && lowerTitle.includes(opts.searchTerm);\n    });\n\n    if (openActivity) {\n      return openActivity.id;\n    }\n\n    const created = addActivity({\n      title: opts.title,\n      description: opts.description,\n      type: opts.type,\n      status: \"pending\",\n      dueDate: toDateOnly(now),\n      dueTime: opts.dueTime,\n      opportunityId: opts.opportunityId,\n      clientId: opts.clientId,\n      responsibleId: userId,\n      responsibleName: userName,\n    });\n\n    return created.id;\n  };\n\n  const resolveAlertByType = async (alert: DisplayAlert): Promise<ResolveResult> => {\n    if (alert.kind === \"health_critical\") {\n      const activityId = ensureFollowUpActivity({\n        title: `Follow-up de saúde: ${alert.context}`,\n        description: `Gerado a partir de alerta: ${alert.title}`,\n        type: \"whatsapp\",\n        dueTime: \"16:00\",\n        clientId: alert.entityId,\n        searchTerm: \"saúde\",\n      });\n\n      return {\n        message: \"Resolvido, atividade criada para hoje.\",\n        linkLabel: \"Ver atividade\",\n        linkPath: `/activities?activityId=${activityId}`,\n      };\n    }\n\n    if (alert.kind === \"contract_risk\") {\n      const activityId = ensureFollowUpActivity({\n        title: `Renovacao de contrato: ${alert.context}`,\n        description: `Gerado a partir de alerta: ${alert.title}`,\n        type: \"meeting\",\n        dueTime: \"15:00\",\n        clientId: alert.entityId,\n        searchTerm: \"renovação\",\n      });\n\n      return {\n        message: \"Resolvido, atividade de renovação criada.\",\n        linkLabel: \"Ver atividade\",\n        linkPath: `/activities?activityId=${activityId}`,\n      };\n    }\n\n    if (alert.kind === \"stalled_deal\") {\n      const opportunity = alert.entityId\n        ? openOpportunities.find((item) => item.id === alert.entityId)\n        : null;\n\n      const activityId = ensureFollowUpActivity({\n        title: `Follow-up urgente: ${opportunity?.clientName ?? alert.context}`,\n        description: `Gerado a partir de alerta: ${alert.title}`,\n        type: \"follow-up\",\n        dueTime: \"11:00\",\n        opportunityId: opportunity?.id,\n        clientId: opportunity?.clientId,\n        searchTerm: \"follow-up\",\n      });\n\n      if (opportunity?.id) {\n        updateOpportunity(opportunity.id, { updatedAt: new Date().toISOString() });\n      }\n\n      return {\n        message: \"Resolvido, follow-up registrado e deal atualizado.\",\n        linkLabel: \"Ver atividade\",\n        linkPath: `/activities?activityId=${activityId}`,\n      };\n    }\n\n    if (alert.kind === \"sla_risk\") {\n      const opportunity = alert.entityId\n        ? openOpportunities.find((item) => item.id === alert.entityId)\n        : null;\n\n      const activityId = ensureFollowUpActivity({\n        title: `SLA crítico: ${opportunity?.clientName ?? alert.context}`,\n        description: `Gerado a partir de alerta: ${alert.title}`,\n        type: \"call\",\n        dueTime: \"10:00\",\n        opportunityId: opportunity?.id,\n        clientId: opportunity?.clientId,\n        searchTerm: \"sla\",\n      });\n\n      if (opportunity?.id) {\n        updateOpportunity(opportunity.id, { updatedAt: new Date().toISOString() });\n      }\n\n      return {\n        message: \"Resolvido, plano de SLA registrado para hoje.\",\n        linkLabel: \"Ver atividade\",\n        linkPath: `/activities?activityId=${activityId}`,\n      };\n    }\n\n    if (alert.kind === \"goal_risk\") {\n      const activityId = ensureFollowUpActivity({\n        title: \"Plano de recuperação da meta\",\n        description: `Gerado a partir de alerta: ${alert.context}`,\n        type: \"task\",\n        dueTime: \"09:00\",\n        searchTerm: \"recuperação da meta\",\n      });\n\n      return {\n        message: \"Resolvido, plano de recuperação criado.\",\n        linkLabel: \"Ver plano\",\n        linkPath: `/activities?activityId=${activityId}`,\n      };\n    }\n\n    if (alert.kind === \"overdue_activities\") {\n      const activityId = ensureFollowUpActivity({\n        title: \"Mutirão de atividades atrasadas\",\n        description: \"Priorizar backlog atrasado e concluir itens críticos.\",\n        type: \"task\",\n        dueTime: \"09:30\",\n        searchTerm: \"mutirão\",\n      });\n\n      return {\n        message: \"Resolvido, mutirão criado para limpar atrasos.\",\n        linkLabel: \"Ver mutirão\",\n        linkPath: `/activities?activityId=${activityId}`,\n      };\n    }\n\n    return {\n      message: \"Alerta tratado com sucesso.\",\n      linkLabel: \"Ver detalhes\",\n      linkPath: alert.viewPath,\n    };\n  };\n\n  const handleResolve = async (alert: DisplayAlert) => {\n    setAlertRuntime(alert.id, { status: \"in_progress\" });\n\n    try {\n      await sleep(180);\n      const result = await resolveAlertByType(alert);\n      setAlertRuntime(alert.id, {\n        status: \"resolved\",\n        feedback: {\n          tone: \"success\",\n          message: result.message,\n          linkLabel: result.linkLabel,\n          linkPath: result.linkPath,\n        },\n      });\n      scheduleDismiss(alert.id);\n    } catch {\n      setAlertRuntime(alert.id, {\n        status: \"open\",\n        feedback: {\n          tone: \"error\",\n          message: FALLBACK_RETRY_MESSAGE,\n        },\n      });\n    }\n  };\n\n  const handleMarkAsTreated = (alert: DisplayAlert) => {\n    setAlertRuntime(alert.id, {\n      status: \"resolved\",\n      feedback: {\n        tone: \"success\",\n        message: \"Marcado como tratado.\",\n        linkLabel: \"Ver entidade\",\n        linkPath: alert.viewPath,\n      },\n    });\n    scheduleDismiss(alert.id);\n  };\n\n  const handleCopySummary = async (alert: DisplayAlert) => {\n    try {\n      await navigator.clipboard.writeText(\n        `${alert.title} | ${alert.context} | ${alert.impact} | Ação: ${alert.recommendation}`\n      );\n      setAlertRuntime(alert.id, {\n        status: runtimeById[alert.id]?.status ?? \"open\",\n        feedback: {\n          tone: \"info\",\n          message: \"Resumo copiado.\",\n        },\n      });\n    } catch {\n      setAlertRuntime(alert.id, {\n        status: runtimeById[alert.id]?.status ?? \"open\",\n        feedback: {\n          tone: \"error\",\n          message: \"Não consegui copiar o resumo.\",\n        },\n      });\n    }\n  };\n\n  const handleSnooze = (alert: DisplayAlert, hours: number) => {\n    const reason = (snoozeReasonById[alert.id] ?? \"\").trim();\n    const untilLabel = formatSnoozeUntil(now, hours);\n\n    setAlertRuntime(alert.id, {\n      status: \"snoozed\",\n      feedback: {\n        tone: \"info\",\n        message: reason\n          ? `Adiado ate ${untilLabel}. Motivo: ${reason}.`\n          : `Adiado ate ${untilLabel}.`,\n      },\n    });\n\n    setSnoozedAlerts((prev) => [...prev, { id: alert.id, label: alert.title }]);\n    setSnoozePopoverId(null);\n  };\n\n  const handleUndoLastSnooze = () => {\n    setSnoozedAlerts((prev) => {\n      if (prev.length === 0) return prev;\n\n      const next = [...prev];\n      const last = next.pop();\n      if (last) {\n        setAlertRuntime(last.id, {\n          status: \"open\",\n          feedback: {\n            tone: \"info\",\n            message: \"Adiamento desfeito.\",\n          },\n        });\n      }\n      return next;\n    });\n  };\n\n  const handleRequestBatchResolve = () => {\n    if (actionableVisible.length < 2) return;\n    setConfirmBatchResolveOpen(true);\n  };\n\n  const handleConfirmBatchResolve = async () => {\n    setConfirmBatchResolveOpen(false);\n    for (const alert of actionableVisible) {\n      await handleResolve(alert);\n    }\n  };\n\n  return (\n    <BentoCard className=\"premium-panel flex flex-col gap-4 border-zinc-200/80 bg-white/88 p-5 shadow-[0_18px_32px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\n        <div className=\"flex min-w-0 items-center gap-2\">\n          <h3 className=\"text-base font-semibold text-zinc-900\">Alertas Críticos</h3>\n          <span className=\"inline-flex h-6 min-w-6 items-center justify-center rounded-full border border-red-200 bg-red-50 px-2 text-xs font-semibold text-red-700\">\n            {counterByFilter.all}\n          </span>\n          {snoozedAlerts.length > 0 ? (\n            <span className=\"inline-flex items-center gap-1 rounded-full border border-sky-200 bg-sky-50 px-2 py-1 text-[11px] font-medium text-sky-700\">\n              Adiados {snoozedAlerts.length}\n              <button\n                type=\"button\"\n                className=\"underline underline-offset-4\"\n                onClick={handleUndoLastSnooze}\n              >\n                Desfazer\n              </button>\n            </span>\n          ) : null}\n        </div>\n\n        {actionableVisible.length > 1 ? (\n          <Button\n            size=\"xs\"\n            variant=\"outline\"\n            className=\"h-7 rounded-full border-zinc-200 px-3 text-xs\"\n            onClick={handleRequestBatchResolve}\n          >\n            Resolver todos do tipo\n          </Button>\n        ) : null}\n\n        <AlertDialog open={confirmBatchResolveOpen} onOpenChange={setConfirmBatchResolveOpen}>\n          <AlertDialogContent>\n            <AlertDialogHeader>\n              <AlertDialogTitle>Resolver {actionableVisible.length} alerta(s)?</AlertDialogTitle>\n              <AlertDialogDescription>\n                Isso vai criar atividades de follow-up para cada alerta acionável visível.\n              </AlertDialogDescription>\n            </AlertDialogHeader>\n            <AlertDialogFooter>\n              <AlertDialogCancel>Cancelar</AlertDialogCancel>\n              <AlertDialogAction onClick={handleConfirmBatchResolve}>Resolver todos</AlertDialogAction>\n            </AlertDialogFooter>\n          </AlertDialogContent>\n        </AlertDialog>\n      </div>\n\n      <div className=\"flex flex-wrap gap-1.5\">\n        {ALERT_FILTER_OPTIONS.map((option) => {\n          const active = activeFilter === option.id;\n          const count = counterByFilter[option.id];\n          return (\n            <button\n              key={option.id}\n              type=\"button\"\n              onClick={() => setActiveFilter(option.id)}\n              className={cn(\n                \"inline-flex h-7 items-center gap-1 rounded-full border px-2.5 text-[11px] font-medium transition-[border-color,background-color,color] duration-150\",\n                active\n                  ? \"border-zinc-900 bg-zinc-900 text-white\"\n                  : \"border-zinc-200 bg-white text-zinc-600 hover:border-zinc-300 hover:text-zinc-900\"\n              )}\n            >\n              {option.label}\n              <span className={cn(\"text-[10px]\", active ? \"text-white/80\" : \"text-zinc-400\")}>{count}</span>\n            </button>\n          );\n        })}\n      </div>\n\n      {isLoading ? (\n        <div className=\"space-y-2\">\n          {Array.from({ length: 3 }).map((_, index) => (\n            <div key={index} className=\"rounded-xl border border-zinc-200/80 p-3\">\n              <Skeleton className=\"h-4 w-44\" />\n              <Skeleton className=\"mt-2 h-3 w-full\" />\n              <Skeleton className=\"mt-2 h-3 w-[82%]\" />\n            </div>\n          ))}\n        </div>\n      ) : null}\n\n      {!isLoading && visibleAlerts.length === 0 ? (\n        <div className=\"rounded-xl border border-zinc-200/80 bg-zinc-50/40 p-6 text-center\">\n          <CheckCircle2 className=\"mx-auto h-7 w-7 text-emerald-600\" />\n          <p className=\"mt-2 text-sm font-medium text-zinc-900\">Sem alertas ativos no seu escopo.</p>\n          <p className=\"mt-1 text-xs text-zinc-500\">Tudo estável por enquanto.</p>\n        </div>\n      ) : null}\n\n      {!isLoading ? (\n        <div className=\"space-y-2.5\">\n          {visibleAlerts.map((alert) => {\n            const runtime = runtimeById[alert.id];\n            const status = runtime?.status ?? \"open\";\n            const isProcessing = status === \"in_progress\";\n            const isResolved = status === \"resolved\";\n\n            return (\n              <article\n                key={alert.id}\n                className={cn(\n                  \"rounded-xl border bg-white p-3 transition-[border-color,box-shadow,background-color] duration-150\",\n                  \"hover:border-zinc-300 hover:bg-zinc-50/40 hover:shadow-[0_14px_24px_-24px_rgba(15,23,42,0.45)]\",\n                  isResolved && \"border-emerald-200 bg-emerald-50/30\",\n                  !isResolved && alert.severity === \"critical\" && \"border-red-200/85\",\n                  !isResolved && alert.severity === \"high\" && \"border-amber-200/85\",\n                  !isResolved && alert.severity === \"medium\" && \"border-sky-200/85\"\n                )}\n              >\n                <div className=\"flex items-start justify-between gap-3\">\n                  <div className=\"min-w-0 flex-1\">\n                    <div className=\"flex items-start gap-2\">\n                      <span className=\"mt-0.5 shrink-0\">{getAlertIcon(alert)}</span>\n                      <div className=\"min-w-0\">\n                        <div className=\"flex flex-wrap items-center gap-1.5\">\n                          <p className=\"text-sm font-semibold text-zinc-900\">{alert.title}</p>\n                          <span className={cn(\"inline-flex items-center rounded-full border px-2 py-0.5 text-[10px] font-semibold\", getAlertBadgeClass(alert.severity))}>\n                            {getSeverityLabel(alert.severity)}\n                          </span>\n                          {alert.duplicateCount > 1 ? (\n                            <span className=\"inline-flex items-center rounded-full border border-zinc-200 bg-zinc-100 px-2 py-0.5 text-[10px] font-semibold text-zinc-600\">\n                              +{alert.duplicateCount - 1}\n                            </span>\n                          ) : null}\n                        </div>\n\n                        <p className=\"mt-1 truncate text-sm text-zinc-700\">{alert.context}</p>\n                        <p className=\"mt-0.5 text-xs text-zinc-500\">Impacto: {alert.impact}</p>\n                      </div>\n                    </div>\n\n                    <div className=\"mt-2 rounded-lg border border-zinc-200/80 bg-zinc-50/70 p-2.5\">\n                      <p className=\"text-xs font-semibold text-zinc-700\">Ação recomendada: {alert.recommendation}</p>\n                      <p className=\"mt-0.5 text-xs text-zinc-500\">{alert.consequence}</p>\n                    </div>\n                  </div>\n\n                  <div className=\"flex shrink-0 flex-col items-end gap-1.5\">\n                    <Button\n                      size=\"xs\"\n                      className=\"h-7 rounded-md bg-zinc-900 px-3 text-xs font-semibold text-white hover:bg-zinc-800\"\n                      disabled={isProcessing || isResolved}\n                      onClick={() => handleResolve(alert)}\n                    >\n                      {isProcessing ? (\n                        <>\n                          <RefreshCw className=\"h-3.5 w-3.5 animate-spin\" />\n                          Executando...\n                        </>\n                      ) : (\n                        \"Resolver\"\n                      )}\n                    </Button>\n\n                    <Button\n                      size=\"xs\"\n                      variant=\"outline\"\n                      className=\"h-7 rounded-md border-zinc-200 px-3 text-xs\"\n                      onClick={() => router.push(alert.viewPath)}\n                    >\n                      Ver\n                    </Button>\n\n                    <div className=\"flex items-center gap-1\">\n                      <Popover\n                        open={snoozePopoverId === alert.id}\n                        onOpenChange={(open) => setSnoozePopoverId(open ? alert.id : null)}\n                      >\n                        <PopoverTrigger asChild>\n                          <Button size=\"xs\" variant=\"ghost\" className=\"h-7 px-2 text-xs text-zinc-600\">\n                            <Clock3 className=\"h-3.5 w-3.5\" />\n                            Adiar\n                          </Button>\n                        </PopoverTrigger>\n                        <PopoverContent align=\"end\" className=\"w-64 rounded-xl border-zinc-200 p-3\">\n                          <PopoverHeader className=\"gap-0.5\">\n                            <PopoverTitle>Adiar alerta</PopoverTitle>\n                            <PopoverDescription>Escolha o tempo e informe o motivo.</PopoverDescription>\n                          </PopoverHeader>\n                          <Input\n                            className=\"mt-2 h-8\"\n                            placeholder=\"Motivo (opcional)\"\n                            value={snoozeReasonById[alert.id] ?? \"\"}\n                            onChange={(event) =>\n                              setSnoozeReasonById((prev) => ({\n                                ...prev,\n                                [alert.id]: event.target.value,\n                              }))\n                            }\n                          />\n                          <div className=\"mt-2 grid grid-cols-3 gap-1.5\">\n                            {SNOOZE_OPTIONS.map((option) => (\n                              <Button\n                                key={option.label}\n                                size=\"xs\"\n                                variant=\"outline\"\n                                className=\"h-7 rounded-md border-zinc-200 text-[11px]\"\n                                onClick={() => handleSnooze(alert, option.hours)}\n                              >\n                                {option.label}\n                              </Button>\n                            ))}\n                          </div>\n                        </PopoverContent>\n                      </Popover>\n\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button size=\"icon-xs\" variant=\"ghost\" className=\"h-7 w-7 text-zinc-500\">\n                            <MoreHorizontal className=\"h-3.5 w-3.5\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\" className=\"w-52 rounded-xl\">\n                          <DropdownMenuItem onClick={() => handleMarkAsTreated(alert)}>\n                            <CheckCircle2 className=\"h-3.5 w-3.5\" />\n                            Marcar como tratado\n                          </DropdownMenuItem>\n                          <DropdownMenuItem onClick={() => handleCopySummary(alert)}>\n                            <Copy className=\"h-3.5 w-3.5\" />\n                            Copiar resumo\n                          </DropdownMenuItem>\n                          <DropdownMenuSeparator />\n                          <DropdownMenuItem onClick={() => router.push(alert.viewPath)}>\n                            <ExternalLink className=\"h-3.5 w-3.5\" />\n                            Abrir entidade\n                          </DropdownMenuItem>\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </div>\n                  </div>\n                </div>\n\n                {runtime?.feedback ? (\n                  <div\n                    className={cn(\n                      \"mt-2 flex flex-wrap items-center gap-2 rounded-md border px-2.5 py-1.5 text-xs\",\n                      runtime.feedback.tone === \"success\" && \"border-emerald-200 bg-emerald-50/70 text-emerald-700\",\n                      runtime.feedback.tone === \"info\" && \"border-sky-200 bg-sky-50/70 text-sky-700\",\n                      runtime.feedback.tone === \"error\" && \"border-red-200 bg-red-50/70 text-red-700\"\n                    )}\n                  >\n                    <span>{runtime.feedback.message}</span>\n                    {runtime.feedback.linkPath && runtime.feedback.linkLabel ? (\n                      <button\n                        type=\"button\"\n                        className=\"font-semibold underline underline-offset-4\"\n                        onClick={() => router.push(runtime.feedback?.linkPath ?? alert.viewPath)}\n                      >\n                        {runtime.feedback.linkLabel}\n                      </button>\n                    ) : null}\n                    {runtime.feedback.tone === \"error\" ? (\n                      <button\n                        type=\"button\"\n                        className=\"font-semibold underline underline-offset-4\"\n                        onClick={() => handleResolve(alert)}\n                      >\n                        Tentar novamente\n                      </button>\n                    ) : null}\n                  </div>\n                ) : null}\n              </article>\n            );\n          })}\n        </div>\n      ) : null}\n    </BentoCard>\n  );\n}\n\nexport function TodayActivities() {\n  const router = useRouter();\n  const { filteredActivities, now } = useDashboardFilters();\n\n  const completeActivity = useActivityStore((s) => s.completeActivity);\n  const postponeActivity = useActivityStore((s) => s.postponeActivity);\n  const cancelActivity = useActivityStore((s) => s.cancelActivity);\n  const activityLoading = useActivityStore((s) => s.isLoading);\n\n  const [executedIds, setExecutedIds] = useState<Set<string>>(new Set());\n  const [editingId, setEditingId] = useState<string | null>(null);\n  const [rescheduleDraftById, setRescheduleDraftById] = useState<Record<string, RescheduleDraft>>({});\n  const [notice, setNotice] = useState<AgendaNotice | null>(null);\n  const [runtimeById, setRuntimeById] = useState<Record<string, AgendaItemRuntime>>({});\n  const [confirmCancelId, setConfirmCancelId] = useState<string | null>(null);\n\n  // Auto-dismiss notice after 6 seconds\n  useEffect(() => {\n    if (!notice) return;\n    const t = setTimeout(() => setNotice(null), 6000);\n    return () => clearTimeout(t);\n  }, [notice]);\n\n  const todayIso = toDateOnly(now);\n\n  const agendaItems = useMemo<ActivityAgendaItem[]>(() => {\n    return filteredActivities\n      .filter((activity) => activity.effectiveStatus === \"pending\" || activity.effectiveStatus === \"overdue\")\n      .filter((activity) => activity.dueDate <= todayIso)\n      .map((activity) => {\n        const dueAt = getActivityDueAt(activity);\n        const isOverdue = activity.effectiveStatus === \"overdue\";\n        const status: ActivityAgendaItem[\"status\"] = isOverdue ? \"overdue\" : \"pending\";\n\n        return {\n          id: activity.id,\n          title: activity.title,\n          clientLine:\n            activity.clientName ||\n            activity.opportunityTitle ||\n            \"Sem cliente associado\",\n          description: activity.description || \"Sem descrição registrada.\",\n          type: activity.type,\n          status,\n          dueDate: activity.dueDate,\n          dueTime: activity.dueTime,\n          dueAt,\n          hasTime: Boolean(activity.dueTime),\n          delayLabel: isOverdue ? `Atrasada ${formatDelay(now.getTime() - dueAt.getTime())}` : null,\n        };\n      })\n      .sort((a, b) => a.dueAt.getTime() - b.dueAt.getTime())\n      .slice(0, 10);\n  }, [filteredActivities, now, todayIso]);\n\n  const timedItems = agendaItems.filter((item) => item.hasTime);\n  const unscheduledItems = agendaItems.filter((item) => !item.hasTime);\n\n  const overdueCount = agendaItems.filter((item) => item.status === \"overdue\").length;\n  const todayCount = agendaItems.filter((item) => item.dueDate === todayIso).length;\n\n  const setItemRuntime = (activityId: string, runtime: AgendaItemRuntime) => {\n    setRuntimeById((prev) => ({\n      ...prev,\n      [activityId]: runtime,\n    }));\n  };\n\n  const openReschedule = (item: ActivityAgendaItem) => {\n    const fallbackDate = toDateOnly(addDays(now, 1));\n    setEditingId(item.id);\n    setRescheduleDraftById((prev) => ({\n      ...prev,\n      [item.id]: {\n        dueDate: item.dueDate || fallbackDate,\n        dueTime: item.dueTime || \"09:00\",\n      },\n    }));\n  };\n\n  const handleExecute = (item: ActivityAgendaItem) => {\n    setExecutedIds((prev) => {\n      const next = new Set(prev);\n      next.add(item.id);\n      return next;\n    });\n\n    setNotice({\n      tone: \"info\",\n      message: `${getExecuteLabel(item.type)} iniciado. Ao voltar, conclua ou registre nota.`,\n      linkLabel: \"Abrir atividade\",\n      linkPath: `/activities?activityId=${item.id}`,\n    });\n\n    router.push(getExecutePath(item.id, item.type));\n  };\n\n  const handleComplete = (item: ActivityAgendaItem) => {\n    setItemRuntime(item.id, { loading: true });\n    try {\n      completeActivity(item.id, \"Concluída pela Agenda de Hoje\");\n      setNotice({\n        tone: \"success\",\n        message: \"Atividade concluída com sucesso.\",\n        linkLabel: \"Ver historico\",\n        linkPath: \"/activities?status=completed\",\n      });\n      setExecutedIds((prev) => {\n        const next = new Set(prev);\n        next.delete(item.id);\n        return next;\n      });\n      setItemRuntime(item.id, {});\n    } catch {\n      setItemRuntime(item.id, { error: \"Não consegui concluir agora.\" });\n    }\n  };\n\n  const handleSaveReschedule = (item: ActivityAgendaItem) => {\n    const draft = rescheduleDraftById[item.id];\n    if (!draft?.dueDate) {\n      setItemRuntime(item.id, { error: \"Escolha uma data válida.\" });\n      return;\n    }\n\n    setItemRuntime(item.id, { loading: true });\n\n    try {\n      postponeActivity(item.id, draft.dueDate, draft.dueTime || undefined);\n      setEditingId(null);\n      setNotice({\n        tone: \"success\",\n        message: `Reagendado para ${formatRescheduleLabel(draft.dueDate, draft.dueTime)}.`,\n      });\n      setExecutedIds((prev) => {\n        const next = new Set(prev);\n        next.delete(item.id);\n        return next;\n      });\n      setItemRuntime(item.id, {});\n    } catch {\n      setItemRuntime(item.id, { error: \"Não consegui reagendar agora.\" });\n    }\n  };\n\n  const handleRequestCancel = (item: ActivityAgendaItem) => {\n    setConfirmCancelId(item.id);\n  };\n\n  const handleConfirmCancel = () => {\n    const targetId = confirmCancelId;\n    setConfirmCancelId(null);\n    if (!targetId) return;\n\n    setItemRuntime(targetId, { loading: true });\n\n    try {\n      cancelActivity(targetId);\n      setNotice({\n        tone: \"info\",\n        message: \"Atividade cancelada.\",\n      });\n      setItemRuntime(targetId, {});\n    } catch {\n      setItemRuntime(targetId, { error: \"Não consegui cancelar agora.\" });\n    }\n  };\n\n  return (\n    <BentoCard className=\"premium-panel flex min-h-[320px] flex-col gap-4 border-zinc-200/80 bg-white/88 p-5 shadow-[0_18px_32px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex flex-wrap items-center justify-between gap-3\">\n        <div className=\"flex min-w-0 items-center gap-2\">\n          <h3 className=\"text-base font-semibold text-zinc-900\">Agenda de Hoje</h3>\n          <span className=\"inline-flex h-6 items-center rounded-full border border-red-200 bg-red-50 px-2 text-[11px] font-semibold text-red-700\">\n            Atrasadas {overdueCount}\n          </span>\n          <span className=\"inline-flex h-6 items-center rounded-full border border-zinc-200 bg-zinc-100 px-2 text-[11px] font-semibold text-zinc-700\">\n            Hoje {todayCount}\n          </span>\n        </div>\n\n        <div className=\"flex items-center gap-1.5\">\n          <Button\n            size=\"xs\"\n            variant=\"outline\"\n            className=\"h-7 rounded-full border-zinc-200 px-3 text-xs\"\n            onClick={() => router.push(\"/activities?view=agenda\")}\n          >\n            Ver tudo\n            <ChevronRight className=\"h-3.5 w-3.5\" />\n          </Button>\n\n          <DropdownMenu>\n            <DropdownMenuTrigger asChild>\n              <Button size=\"icon-xs\" variant=\"ghost\" className=\"h-7 w-7 text-zinc-500\">\n                <MoreHorizontal className=\"h-3.5 w-3.5\" />\n              </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent align=\"end\" className=\"w-52 rounded-xl\">\n              <DropdownMenuItem onClick={() => router.push(\"/activities?status=overdue\")}>Ver apenas atrasadas</DropdownMenuItem>\n            </DropdownMenuContent>\n          </DropdownMenu>\n        </div>\n      </div>\n\n      {notice ? (\n        <div\n          className={cn(\n            \"flex flex-wrap items-center gap-2 rounded-lg border px-3 py-2 text-xs\",\n            notice.tone === \"success\" && \"border-emerald-200 bg-emerald-50/70 text-emerald-700\",\n            notice.tone === \"info\" && \"border-sky-200 bg-sky-50/70 text-sky-700\",\n            notice.tone === \"error\" && \"border-red-200 bg-red-50/70 text-red-700\"\n          )}\n        >\n          <span>{notice.message}</span>\n          {notice.linkPath && notice.linkLabel ? (\n            <button\n              type=\"button\"\n              className=\"font-semibold underline underline-offset-4\"\n              onClick={() => router.push(notice.linkPath ?? \"/activities\")}\n            >\n              {notice.linkLabel}\n            </button>\n          ) : null}\n        </div>\n      ) : null}\n\n      {activityLoading ? (\n        <div className=\"space-y-2\">\n          {Array.from({ length: 4 }).map((_, index) => (\n            <div key={index} className=\"rounded-xl border border-zinc-200/80 p-3\">\n              <Skeleton className=\"h-4 w-32\" />\n              <Skeleton className=\"mt-2 h-3 w-[88%]\" />\n              <Skeleton className=\"mt-2 h-8 w-40\" />\n            </div>\n          ))}\n        </div>\n      ) : null}\n\n      {!activityLoading && agendaItems.length === 0 ? (\n        <div className=\"rounded-xl border border-zinc-200/80 bg-zinc-50/40 p-6 text-center\">\n          <CheckCircle2 className=\"mx-auto h-7 w-7 text-emerald-600\" />\n          <p className=\"mt-2 text-sm font-medium text-zinc-900\">Sem atividades pendentes para hoje.</p>\n          <p className=\"mt-1 text-xs text-zinc-500\">A agenda está limpa no seu escopo.</p>\n          <Button\n            size=\"xs\"\n            variant=\"outline\"\n            className=\"mt-3 h-7 rounded-full border-zinc-200 px-3 text-xs\"\n            onClick={() => router.push(\"/activities?view=agenda\")}\n          >\n            Abrir agenda completa\n          </Button>\n        </div>\n      ) : null}\n\n      {!activityLoading && agendaItems.length > 0 ? (\n        <div className=\"space-y-2\">\n          {timedItems.map((item) => {\n            const Icon = getActivityTypeIcon(item.type);\n            const runtime = runtimeById[item.id];\n            const draft = rescheduleDraftById[item.id];\n            const isEditing = editingId === item.id;\n            const wasExecuted = executedIds.has(item.id);\n\n            return (\n              <article\n                key={item.id}\n                className={cn(\n                  \"rounded-xl border border-zinc-200/85 bg-white p-3 transition-[border-color,box-shadow,background-color] duration-150\",\n                  \"hover:border-zinc-300 hover:bg-zinc-50/40 hover:shadow-[0_12px_24px_-24px_rgba(15,23,42,0.45)]\",\n                  item.status === \"overdue\" && \"border-red-200/90\"\n                )}\n              >\n                <div className=\"grid gap-3 md:grid-cols-[96px_minmax(0,1fr)_auto] md:items-start\">\n                  <div className=\"space-y-1\">\n                    <p className=\"text-xl font-semibold tabular-nums text-zinc-900\">{item.dueTime || \"--:--\"}</p>\n                    {item.delayLabel ? <p className=\"text-xs font-medium text-red-600\">{item.delayLabel}</p> : <p className=\"text-xs text-zinc-500\">No prazo</p>}\n                  </div>\n\n                  <div className=\"min-w-0\">\n                    <div className=\"flex items-start gap-2\">\n                      <Icon className=\"mt-0.5 h-4 w-4 text-zinc-500\" />\n                      <div className=\"min-w-0\">\n                        <p className=\"truncate text-sm font-semibold text-zinc-900\">{item.title}</p>\n                        <p className=\"truncate text-xs text-zinc-600\">{item.clientLine}</p>\n                        <p className=\"mt-0.5 truncate text-xs text-zinc-500\">{item.description}</p>\n                      </div>\n                    </div>\n\n                    {wasExecuted ? (\n                      <div className=\"mt-2 flex flex-wrap items-center gap-1.5 rounded-md border border-zinc-200 bg-zinc-50/80 p-2\">\n                        <span className=\"text-xs text-zinc-600\">Execução iniciada:</span>\n                        <Button\n                          size=\"xs\"\n                          className=\"h-7 rounded-md bg-zinc-900 px-2.5 text-xs text-white hover:bg-zinc-800\"\n                          onClick={() => handleComplete(item)}\n                        >\n                          Marcar concluída\n                        </Button>\n                        <Button\n                          size=\"xs\"\n                          variant=\"outline\"\n                          className=\"h-7 rounded-md border-zinc-200 px-2.5 text-xs\"\n                          onClick={() => router.push(`/activities?activityId=${item.id}`)}\n                        >\n                          Registrar nota\n                        </Button>\n                      </div>\n                    ) : null}\n\n                    {isEditing ? (\n                      <div className=\"mt-2 grid gap-1.5 rounded-md border border-zinc-200 bg-zinc-50/80 p-2 md:grid-cols-[1fr_110px_auto] md:items-center\">\n                        <Input\n                          type=\"date\"\n                          className=\"h-8\"\n                          value={draft?.dueDate ?? \"\"}\n                          onChange={(event) =>\n                            setRescheduleDraftById((prev) => ({\n                              ...prev,\n                              [item.id]: {\n                                dueDate: event.target.value,\n                                dueTime: prev[item.id]?.dueTime ?? item.dueTime ?? \"09:00\",\n                              },\n                            }))\n                          }\n                        />\n                        <Input\n                          type=\"time\"\n                          className=\"h-8\"\n                          value={draft?.dueTime ?? \"\"}\n                          onChange={(event) =>\n                            setRescheduleDraftById((prev) => ({\n                              ...prev,\n                              [item.id]: {\n                                dueDate: prev[item.id]?.dueDate ?? item.dueDate,\n                                dueTime: event.target.value,\n                              },\n                            }))\n                          }\n                        />\n                        <div className=\"flex items-center gap-1\">\n                          <Button\n                            size=\"xs\"\n                            className=\"h-8 rounded-md bg-zinc-900 px-2.5 text-xs text-white hover:bg-zinc-800\"\n                            onClick={() => handleSaveReschedule(item)}\n                          >\n                            Salvar\n                          </Button>\n                          <Button\n                            size=\"xs\"\n                            variant=\"ghost\"\n                            className=\"h-8 rounded-md px-2.5 text-xs\"\n                            onClick={() => setEditingId(null)}\n                          >\n                            Cancelar\n                          </Button>\n                        </div>\n                      </div>\n                    ) : null}\n\n                    {runtime?.error ? (\n                      <div className=\"mt-2 rounded-md border border-red-200 bg-red-50/70 px-2.5 py-1.5 text-xs text-red-700\">\n                        {runtime.error}\n                        <button\n                          type=\"button\"\n                          className=\"ml-2 font-semibold underline underline-offset-4\"\n                          onClick={() => setItemRuntime(item.id, {})}\n                        >\n                          Tentar novamente\n                        </button>\n                      </div>\n                    ) : null}\n                  </div>\n\n                  <div className=\"flex flex-wrap items-center gap-1.5 md:flex-col md:items-end\">\n                    <Button\n                      size=\"xs\"\n                      className=\"h-7 rounded-md bg-zinc-900 px-3 text-xs text-white hover:bg-zinc-800\"\n                      disabled={runtime?.loading}\n                      onClick={() => handleExecute(item)}\n                    >\n                      {runtime?.loading ? (\n                        <RefreshCw className=\"h-3.5 w-3.5 animate-spin\" />\n                      ) : (\n                        getExecuteLabel(item.type)\n                      )}\n                    </Button>\n\n                    <Button\n                      size=\"xs\"\n                      variant=\"outline\"\n                      className=\"h-7 rounded-md border-zinc-200 px-3 text-xs\"\n                      disabled={runtime?.loading}\n                      onClick={() => openReschedule(item)}\n                    >\n                      Reagendar\n                    </Button>\n\n                    <DropdownMenu>\n                      <DropdownMenuTrigger asChild>\n                        <Button size=\"icon-xs\" variant=\"ghost\" className=\"h-7 w-7 text-zinc-500\">\n                          <MoreHorizontal className=\"h-3.5 w-3.5\" />\n                        </Button>\n                      </DropdownMenuTrigger>\n                      <DropdownMenuContent align=\"end\" className=\"w-44 rounded-xl\">\n                        <DropdownMenuItem onClick={() => handleComplete(item)}>\n                          <CheckCircle2 className=\"h-3.5 w-3.5\" />\n                          Concluir\n                        </DropdownMenuItem>\n                        <DropdownMenuItem onClick={() => router.push(`/activities?activityId=${item.id}`)}>\n                          <ExternalLink className=\"h-3.5 w-3.5\" />\n                          Ver detalhes\n                        </DropdownMenuItem>\n                        <DropdownMenuSeparator />\n                        <DropdownMenuItem onClick={() => handleRequestCancel(item)}>\n                          Cancelar\n                        </DropdownMenuItem>\n                      </DropdownMenuContent>\n                    </DropdownMenu>\n                  </div>\n                </div>\n              </article>\n            );\n          })}\n\n          {unscheduledItems.length > 0 ? (\n            <div className=\"rounded-xl border border-zinc-200/85 bg-zinc-50/30 p-3\">\n              <div className=\"mb-2 flex items-center justify-between\">\n                <p className=\"text-xs font-semibold uppercase tracking-wide text-zinc-500\">Sem horário</p>\n                <Button\n                  size=\"xs\"\n                  variant=\"ghost\"\n                  className=\"h-7 px-2 text-xs text-zinc-600\"\n                  onClick={() => {\n                    const first = unscheduledItems[0];\n                    if (first) openReschedule(first);\n                  }}\n                >\n                  Definir horário\n                </Button>\n              </div>\n\n              <div className=\"space-y-2\">\n                {unscheduledItems.map((item) => {\n                  const Icon = getActivityTypeIcon(item.type);\n                  return (\n                    <div\n                      key={item.id}\n                      className=\"rounded-lg border border-zinc-200/85 bg-white p-2.5\"\n                    >\n                      <div className=\"flex items-start justify-between gap-2\">\n                        <div className=\"flex min-w-0 items-start gap-2\">\n                          <Icon className=\"mt-0.5 h-4 w-4 text-zinc-500\" />\n                          <div className=\"min-w-0\">\n                            <p className=\"truncate text-sm font-medium text-zinc-900\">{item.title}</p>\n                            <p className=\"truncate text-xs text-zinc-600\">{item.clientLine}</p>\n                          </div>\n                        </div>\n                        <Button\n                          size=\"xs\"\n                          variant=\"outline\"\n                          className=\"h-7 rounded-md border-zinc-200 px-2.5 text-xs\"\n                          onClick={() => openReschedule(item)}\n                        >\n                          Definir horário\n                        </Button>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            </div>\n          ) : null}\n        </div>\n      ) : null}\n\n      <AlertDialog open={confirmCancelId !== null} onOpenChange={(open) => { if (!open) setConfirmCancelId(null); }}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Cancelar atividade?</AlertDialogTitle>\n            <AlertDialogDescription>\n              A atividade será cancelada permanentemente.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Manter</AlertDialogCancel>\n            <AlertDialogAction onClick={handleConfirmCancel}>Cancelar atividade</AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </BentoCard>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5821, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/ui/avatar.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport { Avatar as AvatarPrimitive } from \"radix-ui\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Avatar({\n  className,\n  size = \"default\",\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Root> & {\n  size?: \"default\" | \"sm\" | \"lg\"\n}) {\n  return (\n    <AvatarPrimitive.Root\n      data-slot=\"avatar\"\n      data-size={size}\n      className={cn(\n        \"group/avatar relative flex size-8 shrink-0 overflow-hidden rounded-full select-none data-[size=lg]:size-10 data-[size=sm]:size-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarImage({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Image>) {\n  return (\n    <AvatarPrimitive.Image\n      data-slot=\"avatar-image\"\n      className={cn(\"aspect-square size-full\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarFallback({\n  className,\n  ...props\n}: React.ComponentProps<typeof AvatarPrimitive.Fallback>) {\n  return (\n    <AvatarPrimitive.Fallback\n      data-slot=\"avatar-fallback\"\n      className={cn(\n        \"bg-muted text-muted-foreground flex size-full items-center justify-center rounded-full text-sm group-data-[size=sm]/avatar:text-xs\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarBadge({ className, ...props }: React.ComponentProps<\"span\">) {\n  return (\n    <span\n      data-slot=\"avatar-badge\"\n      className={cn(\n        \"bg-primary text-primary-foreground ring-background absolute right-0 bottom-0 z-10 inline-flex items-center justify-center rounded-full ring-2 select-none\",\n        \"group-data-[size=sm]/avatar:size-2 group-data-[size=sm]/avatar:[&>svg]:hidden\",\n        \"group-data-[size=default]/avatar:size-2.5 group-data-[size=default]/avatar:[&>svg]:size-2\",\n        \"group-data-[size=lg]/avatar:size-3 group-data-[size=lg]/avatar:[&>svg]:size-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"avatar-group\"\n      className={cn(\n        \"*:data-[slot=avatar]:ring-background group/avatar-group flex -space-x-2 *:data-[slot=avatar]:ring-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction AvatarGroupCount({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"avatar-group-count\"\n      className={cn(\n        \"bg-muted text-muted-foreground ring-background relative flex size-8 shrink-0 items-center justify-center rounded-full text-sm ring-2 group-has-data-[size=lg]/avatar-group:size-10 group-has-data-[size=sm]/avatar-group:size-6 [&>svg]:size-4 group-has-data-[size=lg]/avatar-group:[&>svg]:size-5 group-has-data-[size=sm]/avatar-group:[&>svg]:size-3\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Avatar,\n  AvatarImage,\n  AvatarFallback,\n  AvatarBadge,\n  AvatarGroup,\n  AvatarGroupCount,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,OAAO,EACd,SAAS,EACT,OAAO,SAAS,EAChB,GAAG,OAGJ;IACC,qBACE,6LAAC,iNAAe,CAAC,IAAI;QACnB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,4HAAE,EACX,oIACA;QAED,GAAG,KAAK;;;;;;AAGf;KAlBS;AAoBT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,iNAAe,CAAC,KAAK;QACpB,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,2BAA2B;QACxC,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,eAAe,EACtB,SAAS,EACT,GAAG,OACmD;IACtD,qBACE,6LAAC,iNAAe,CAAC,QAAQ;QACvB,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,sIACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAqC;IACxE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,6JACA,iFACA,6FACA,iFACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS;AAgBT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,uGACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,iBAAiB,EACxB,SAAS,EACT,GAAG,OACyB;IAC5B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,4VACA;QAED,GAAG,KAAK;;;;;;AAGf;MAdS"}},
    {"offset": {"line": 5930, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/components/dashboard/performance-section.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { useRouter } from \"next/navigation\";\nimport { Users, ThermometerSun, ChevronRight } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { BentoCard } from \"@/components/ui/bento-card\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useDashboardFilters } from \"@/hooks/use-dashboard-filters\";\nimport {\n  calculateTemperature,\n  calculateProjectedCommission,\n  formatCurrencyBRL,\n} from \"@/lib/business-rules\";\nimport { mockUsers } from \"@/lib/mock-data\";\n\n// --- Pipeline Health Component ---\nexport function PipelineHealth() {\n  const router = useRouter();\n  const {\n    openOpportunities,\n    filteredOpportunities,\n    now,\n  } = useDashboardFilters();\n\n  const { healthMetrics, temperature, avgDays } = useMemo(() => {\n    const openOpps = openOpportunities;\n\n    const stalledCount = openOpps.filter((o) => {\n      const daysSinceUpdate = Math.round(\n        (now.getTime() - new Date(o.updatedAt).getTime()) / (1000 * 60 * 60 * 24)\n      );\n      return daysSinceUpdate > 30;\n    }).length;\n\n    const activities = useActivityStore.getState().activities;\n    const oppsWithoutAction = openOpps.filter((o) => {\n      const oppActivities = activities.filter(\n        (a) =>\n          a.opportunityId === o.id &&\n          (a.status === \"pending\" || a.status === \"overdue\")\n      );\n      return oppActivities.length === 0;\n    }).length;\n\n    const noValueCount = openOpps.filter((o) => !o.value || o.value === 0).length;\n\n    const maxDenominator = Math.max(openOpps.length, 1);\n\n    // Calculate temperature using business rules\n    const avgValue =\n      openOpps.length > 0\n        ? openOpps.reduce((sum, o) => sum + (o.value || 0), 0) / openOpps.length\n        : 10000;\n\n    let hotCount = 0;\n    let coldCount = 0;\n    for (const opp of openOpps) {\n      const temp = calculateTemperature(opp, avgValue, now);\n      if (temp === \"hot\") hotCount++;\n      else if (temp === \"cold\") coldCount++;\n    }\n    const computedTemp =\n      hotCount > coldCount ? \"Quente\" : coldCount > hotCount ? \"Frio\" : \"Morno\";\n\n    const wonOpps = filteredOpportunities.filter((o) => o.status === \"won\");\n    let totalDays = 0;\n    wonOpps.forEach((o) => {\n      const created = new Date(o.createdAt).getTime();\n      const closed = new Date(o.updatedAt).getTime();\n      totalDays += Math.max(\n        1,\n        Math.round((closed - created) / (1000 * 60 * 60 * 24))\n      );\n    });\n    const computedAvgDays =\n      wonOpps.length > 0 ? Math.round(totalDays / wonOpps.length) : 0;\n\n    return {\n      healthMetrics: [\n        {\n          label: \"Estagnados (+30 dias)\",\n          value: stalledCount,\n          color: \"bg-red-500\",\n          filter: \"stale\",\n          max: maxDenominator,\n        },\n        {\n          label: \"Sem próxima ação\",\n          value: oppsWithoutAction,\n          color: \"bg-amber-500\",\n          filter: \"no_activity\",\n          max: maxDenominator,\n        },\n        {\n          label: \"Valor vazio\",\n          value: noValueCount,\n          color: \"bg-zinc-400\",\n          filter: \"stale\",\n          max: maxDenominator,\n        },\n      ],\n      temperature: computedTemp,\n      avgDays: computedAvgDays,\n    };\n  }, [openOpportunities, filteredOpportunities, now]);\n\n  const tempColor =\n    temperature === \"Quente\"\n      ? \"text-emerald-600\"\n      : temperature === \"Frio\"\n        ? \"text-red-600\"\n        : \"text-amber-600\";\n\n  return (\n    <BentoCard className=\"premium-panel flex flex-col gap-4 border-zinc-200/80 bg-white/86 p-5 shadow-[0_16px_28px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"flex items-center gap-2 font-semibold text-zinc-900\">\n          <ThermometerSun className=\"h-4 w-4 text-orange-500\" />\n          Saúde do Pipeline\n        </h3>\n      </div>\n\n      <div className=\"space-y-4\">\n        {healthMetrics.map((metric) => (\n          <div\n            key={metric.label}\n            className=\"group cursor-pointer\"\n            onClick={() => router.push(`/pipes?filter=${metric.filter}`)}\n            role=\"button\"\n            tabIndex={0}\n            onKeyDown={(e) => {\n              if (e.key === \"Enter\")\n                router.push(`/pipes?filter=${metric.filter}`);\n            }}\n          >\n            <div className=\"mb-1.5 flex items-center justify-between\">\n              <span className=\"text-xs font-medium text-zinc-600 transition-colors group-hover:text-zinc-900\">\n                {metric.label}\n              </span>\n              <span className=\"text-xs font-bold text-zinc-900\">\n                {metric.value} deals\n              </span>\n            </div>\n            <div className=\"h-2 w-full overflow-hidden rounded-full bg-zinc-100\">\n              <motion.div\n                initial={{ width: 0 }}\n                animate={{\n                  width: `${Math.min(\n                    (metric.value / Math.max(metric.max, 1)) * 100,\n                    100\n                  )}%`,\n                }}\n                transition={{ duration: 0.24, ease: \"easeOut\" }}\n                className={cn(\n                  \"h-full rounded-full transition-all group-hover:brightness-110\",\n                  metric.color\n                )}\n              />\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"mt-auto border-t border-zinc-100 pt-4\">\n        <div className=\"flex items-center justify-center gap-6\">\n          <div className=\"text-center\">\n            <p className=\"text-[10px] font-semibold uppercase tracking-wider text-zinc-400\">\n              Temperatura\n            </p>\n            <p className={cn(\"text-lg font-bold\", tempColor)}>{temperature}</p>\n          </div>\n          <div className=\"h-8 w-px bg-zinc-100\" />\n          <div className=\"text-center\">\n            <p className=\"text-[10px] font-semibold uppercase tracking-wider text-zinc-400\">\n              Velocidade\n            </p>\n            <p className=\"text-lg font-bold text-zinc-900\">\n              {avgDays > 0 ? `${avgDays} dias` : \"—\"}\n            </p>\n          </div>\n        </div>\n      </div>\n    </BentoCard>\n  );\n}\n\n// --- Performance Component ---\nexport function TeamPerformance() {\n  const router = useRouter();\n  const { filteredOpportunities, context, userId, userRole } = useDashboardFilters();\n\n  const isBroadRole = userRole === \"master\" || userRole === \"admin\";\n\n  const teamData = useMemo(() => {\n    // filteredOpportunities already respects context via useDashboardFilters:\n    // - context \"me\" + role master/admin → returns ALL items\n    // - context \"me\" + role comercial → returns only own items\n    // So we only need the extra responsibleId filter for non-admin roles\n    const allOpps = filteredOpportunities.filter(\n      (o) => o.status === \"won\" || o.status === \"lost\"\n    );\n\n    const byUser: Record<\n      string,\n      {\n        name: string;\n        role: string;\n        revenue: number;\n        won: number;\n        total: number;\n      }\n    > = {};\n\n    for (const opp of allOpps) {\n      if (!opp.responsibleId) continue;\n      // When context is \"me\" for non-admin roles, only show own data\n      if (context === \"me\" && !isBroadRole && opp.responsibleId !== userId) continue;\n\n      if (!byUser[opp.responsibleId]) {\n        const user = mockUsers.find((u) => u.id === opp.responsibleId);\n        byUser[opp.responsibleId] = {\n          name: user?.name ?? opp.responsibleName ?? \"—\",\n          role: user?.role ?? \"comercial\",\n          revenue: 0,\n          won: 0,\n          total: 0,\n        };\n      }\n      byUser[opp.responsibleId].total += 1;\n      if (opp.status === \"won\") {\n        byUser[opp.responsibleId].revenue += opp.value || 0;\n        byUser[opp.responsibleId].won += 1;\n      }\n    }\n\n    return Object.entries(byUser)\n      .map(([id, data]) => {\n        const commission = calculateProjectedCommission(data.revenue);\n        return {\n          id,\n          name: data.name,\n          role: data.role,\n          revenue: data.revenue,\n          commission: commission.commissionValue,\n          conversion:\n            data.total > 0 ? Math.round((data.won / data.total) * 100) : 0,\n          won: data.won,\n          isMe: id === userId,\n        };\n      })\n      .sort((a, b) => b.revenue - a.revenue)\n      .slice(0, 3);\n  }, [filteredOpportunities, context, userId, isBroadRole]);\n\n  return (\n    <BentoCard className=\"premium-panel flex flex-col gap-4 border-zinc-200/80 bg-white/86 p-5 shadow-[0_16px_28px_-24px_rgba(15,23,42,0.45)] md:p-6\">\n      <div className=\"flex items-center justify-between\">\n        <h3 className=\"flex items-center gap-2 font-semibold text-zinc-900\">\n          <Users className=\"h-4 w-4 text-blue-500\" />\n          {isBroadRole ? \"Performance do time\" : \"Performance pessoal\"}\n        </h3>\n        <button\n          className=\"text-xs font-medium text-zinc-500 transition-colors hover:text-zinc-900\"\n          onClick={() => router.push(\"/goals\")}\n        >\n          Ver metas\n        </button>\n      </div>\n\n      {teamData.length === 0 ? (\n        <div className=\"py-6 text-center text-sm text-zinc-500\">\n          Sem dados de performance ainda.\n        </div>\n      ) : (\n        <div className=\"space-y-3\">\n          {teamData.map((member, i) => (\n            <div\n              key={member.id}\n              className=\"flex cursor-pointer items-center justify-between rounded-lg p-2 transition-colors hover:bg-zinc-50\"\n              onClick={() => router.push(\"/goals\")}\n              role=\"button\"\n              tabIndex={0}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") router.push(\"/goals\");\n              }}\n            >\n              <div className=\"flex items-center gap-3\">\n                <span\n                  className={cn(\n                    \"flex h-5 w-5 items-center justify-center rounded text-[10px] font-bold\",\n                    i === 0\n                      ? \"bg-amber-100 text-amber-700\"\n                      : i === 1\n                        ? \"bg-zinc-100 text-zinc-600\"\n                        : \"bg-zinc-100 text-zinc-400\"\n                  )}\n                >\n                  {i + 1}\n                </span>\n                <Avatar className=\"h-8 w-8 border border-zinc-100\">\n                  <AvatarFallback className=\"bg-zinc-100 text-[10px]\">\n                    {member.name.substring(0, 2)}\n                  </AvatarFallback>\n                </Avatar>\n                <div>\n                  <p className=\"text-xs font-bold text-zinc-900\">{member.name}</p>\n                  <p className=\"text-[10px] text-zinc-500\">{member.role}</p>\n                </div>\n              </div>\n\n              <div className=\"text-right\">\n                <p className=\"text-xs font-bold text-zinc-900\">\n                  {member.isMe || isBroadRole\n                    ? formatCurrencyBRL(member.revenue)\n                    : `${member.won} ganhos`}\n                </p>\n                <div className=\"flex items-center justify-end gap-1.5\">\n                  <span className=\"text-[10px] text-zinc-500\">\n                    {member.conversion}% conv.\n                  </span>\n                  {(member.isMe || isBroadRole) && member.commission > 0 && (\n                    <span className=\"text-[10px] font-medium text-emerald-600\">\n                      +{formatCurrencyBRL(member.commission)}\n                    </span>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n\n      <button\n        className=\"mt-auto flex w-full items-center justify-center gap-1 rounded-lg border border-zinc-100 py-2 text-xs font-medium text-zinc-600 transition-colors hover:bg-zinc-50\"\n        onClick={() => router.push(\"/finance\")}\n      >\n        Ver relatório de comissão <ChevronRight className=\"h-3 w-3\" />\n      </button>\n    </BentoCard>\n  );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6511, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/app/%28auth%29/dashboard/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { Suspense, useEffect, useState } from \"react\";\nimport { motion } from \"framer-motion\";\nimport { useSearchParams } from \"next/navigation\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { DashboardHeader } from \"@/components/dashboard/header\";\nimport { KpiSection } from \"@/components/dashboard/kpi-section\";\nimport { FunnelXRay } from \"@/components/dashboard/funnel-x-ray\";\nimport { CriticalAlerts, TodayActivities } from \"@/components/dashboard/execution-section\";\nimport { PipelineHealth, TeamPerformance } from \"@/components/dashboard/performance-section\";\nimport { useProactiveEngine } from \"@/hooks/use-proactive-engine\";\nimport { screenContainer, sectionEnter } from \"@/lib/motion\";\n\nfunction DashboardLoadingSkeleton() {\n  return (\n    <div className=\"space-y-6 p-6 md:p-8\">\n      <div className=\"flex items-center justify-between\">\n        <Skeleton className=\"h-8 w-56\" />\n        <Skeleton className=\"h-9 w-36 rounded-full\" />\n      </div>\n      <div className=\"grid grid-cols-2 gap-4 md:grid-cols-4\">\n        {Array.from({ length: 4 }).map((_, i) => (\n          <Skeleton key={i} className=\"h-24 rounded-xl\" />\n        ))}\n      </div>\n      <Skeleton className=\"h-64 rounded-xl\" />\n      <div className=\"grid grid-cols-1 gap-6 lg:grid-cols-12\">\n        <div className=\"lg:col-span-8 flex flex-col gap-6\">\n          <Skeleton className=\"h-48 rounded-xl\" />\n          <Skeleton className=\"h-48 rounded-xl\" />\n        </div>\n        <div className=\"lg:col-span-4 flex flex-col gap-6\">\n          <Skeleton className=\"h-48 rounded-xl\" />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction DashboardContent() {\n  // Activate proactive engine in background — feeds alerts & suggestions\n  useProactiveEngine();\n  const searchParams = useSearchParams();\n  const viewParam = searchParams.get(\"view\");\n\n  const [isLoading, setIsLoading] = useState(true);\n  useEffect(() => { const t = setTimeout(() => setIsLoading(false), 800); return () => clearTimeout(t); }, []);\n\n  useEffect(() => {\n    if (viewParam !== \"conversion\") return;\n    const target = document.getElementById(\"dashboard-funnel\");\n    if (!target) return;\n    target.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n  }, [viewParam]);\n\n  if (isLoading) {\n    return <DashboardLoadingSkeleton />;\n  }\n\n  return (\n    <motion.div\n      variants={screenContainer}\n      initial=\"hidden\"\n      animate=\"show\"\n      className=\"w-full max-w-full space-y-6\"\n    >\n      {/* Header */}\n      <motion.div variants={sectionEnter}>\n        <DashboardHeader />\n      </motion.div>\n\n      {/* Faixa B: KPIs */}\n      <motion.section id=\"dashboard-kpis\" variants={sectionEnter} className=\"scroll-mt-44\">\n        <KpiSection />\n      </motion.section>\n\n      {/* Faixa C: Funnel X-Ray */}\n      <motion.section id=\"dashboard-funnel\" variants={sectionEnter} className=\"scroll-mt-44\">\n        <FunnelXRay />\n      </motion.section>\n\n      {/* Faixa D: Execução */}\n      <motion.section\n        id=\"dashboard-execution\"\n        variants={sectionEnter}\n        className=\"grid grid-cols-1 gap-6 scroll-mt-44 lg:grid-cols-12\"\n      >\n         {/* Left Column: Alerts & Activities (8 cols) */}\n         <div className=\"lg:col-span-8 flex flex-col gap-6\">\n            <CriticalAlerts />\n            <TodayActivities />\n         </div>\n         \n         {/* Right Column: Health + Performance (4 cols) */}\n         <div className=\"lg:col-span-4 flex flex-col gap-6\">\n            <PipelineHealth />\n            <TeamPerformance />\n         </div>\n      </motion.section>\n    </motion.div>\n  );\n}\n\nexport default function Dashboard() {\n  return (\n    <Suspense fallback={<DashboardLoadingSkeleton />}>\n      <DashboardContent />\n    </Suspense>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;;;AAZA;;;;;;;;;;;;AAcA,SAAS;IACP,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC,mJAAQ;wBAAC,WAAU;;;;;;kCACpB,6LAAC,mJAAQ;wBAAC,WAAU;;;;;;;;;;;;0BAEtB,6LAAC;gBAAI,WAAU;0BACZ,MAAM,IAAI,CAAC;oBAAE,QAAQ;gBAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBACjC,6LAAC,mJAAQ;wBAAS,WAAU;uBAAb;;;;;;;;;;0BAGnB,6LAAC,mJAAQ;gBAAC,WAAU;;;;;;0BACpB,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBAAI,WAAU;;0CACb,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;0CACpB,6LAAC,mJAAQ;gCAAC,WAAU;;;;;;;;;;;;kCAEtB,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC,mJAAQ;4BAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;AAK9B;KAxBS;AA0BT,SAAS;;IACP,uEAAuE;IACvE,IAAA,mKAAkB;IAClB,MAAM,eAAe,IAAA,wJAAe;IACpC,MAAM,YAAY,aAAa,GAAG,CAAC;IAEnC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAC3C,IAAA,0KAAS;sCAAC;YAAQ,MAAM,IAAI;gDAAW,IAAM,aAAa;+CAAQ;YAAM;8CAAO,IAAM,aAAa;;QAAI;qCAAG,EAAE;IAE3G,IAAA,0KAAS;sCAAC;YACR,IAAI,cAAc,cAAc;YAChC,MAAM,SAAS,SAAS,cAAc,CAAC;YACvC,IAAI,CAAC,QAAQ;YACb,OAAO,cAAc,CAAC;gBAAE,UAAU;gBAAU,OAAO;YAAQ;QAC7D;qCAAG;QAAC;KAAU;IAEd,IAAI,WAAW;QACb,qBAAO,6LAAC;;;;;IACV;IAEA,qBACE,6LAAC,uMAAM,CAAC,GAAG;QACT,UAAU,0IAAe;QACzB,SAAQ;QACR,SAAQ;QACR,WAAU;;0BAGV,6LAAC,uMAAM,CAAC,GAAG;gBAAC,UAAU,uIAAY;0BAChC,cAAA,6LAAC,+JAAe;;;;;;;;;;0BAIlB,6LAAC,uMAAM,CAAC,OAAO;gBAAC,IAAG;gBAAiB,UAAU,uIAAY;gBAAE,WAAU;0BACpE,cAAA,6LAAC,kKAAU;;;;;;;;;;0BAIb,6LAAC,uMAAM,CAAC,OAAO;gBAAC,IAAG;gBAAmB,UAAU,uIAAY;gBAAE,WAAU;0BACtE,cAAA,6LAAC,4LAAU;;;;;;;;;;0BAIb,6LAAC,uMAAM,CAAC,OAAO;gBACb,IAAG;gBACH,UAAU,uIAAY;gBACtB,WAAU;;kCAGT,6LAAC;wBAAI,WAAU;;0CACZ,6LAAC,4KAAc;;;;;0CACf,6LAAC,6KAAe;;;;;;;;;;;kCAInB,6LAAC;wBAAI,WAAU;;0CACZ,6LAAC,8KAAc;;;;;0CACf,6LAAC,+KAAe;;;;;;;;;;;;;;;;;;;;;;;AAK5B;GA9DS;;QAEP,mKAAkB;QACG,wJAAe;;;MAH7B;AAgEM,SAAS;IACtB,qBACE,6LAAC,yKAAQ;QAAC,wBAAU,6LAAC;;;;;kBACnB,cAAA,6LAAC;;;;;;;;;;AAGP;MANwB"}}]
}