{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/sidebar-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { persist } from \"zustand/middleware\";\n\ninterface SidebarState {\n  isExpanded: boolean;\n  toggle: () => void;\n  setExpanded: (expanded: boolean) => void;\n}\n\nexport const useSidebarStore = create<SidebarState>()(\n  persist(\n    (set) => ({\n      isExpanded: true,\n      toggle: () => set((state) => ({ isExpanded: !state.isExpanded })),\n      setExpanded: (isExpanded) => set({ isExpanded }),\n    }),\n    {\n      name: \"flow-sidebar\",\n    }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAQO,MAAM,kBAAkB,IAAA,qJAAM,IACnC,IAAA,2JAAO,EACL,CAAC,MAAQ,CAAC;QACR,YAAY;QACZ,QAAQ,IAAM,IAAI,CAAC,QAAU,CAAC;oBAAE,YAAY,CAAC,MAAM,UAAU;gBAAC,CAAC;QAC/D,aAAa,CAAC,aAAe,IAAI;gBAAE;YAAW;IAChD,CAAC,GACD;IACE,MAAM;AACR"}},
    {"offset": {"line": 30, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/ui-store.ts"],"sourcesContent":["import { create } from \"zustand\";\n\nexport type DrawerType =\n  | \"lead-card\"\n  | \"client-card\"\n  | \"new-opportunity\"\n  | \"new-activity\"\n  | \"win-opportunity\"\n  | \"lose-opportunity\"\n  | \"filters\"\n  | null;\n\nexport type ModalType =\n  | \"lead-card\"\n  | \"invite-user\"\n  | \"new-opportunity\"\n  | \"new-activity\"\n  | \"win-opportunity\"\n  | \"lose-opportunity\"\n  | \"confirm-delete\"\n  | \"confirm-deactivate\"\n  | null;\n\ninterface UIState {\n  // Drawer state\n  drawerType: DrawerType;\n  drawerData: Record<string, unknown> | null;\n  openDrawer: (type: DrawerType, data?: Record<string, unknown>) => void;\n  closeDrawer: () => void;\n\n  // Modal state\n  modalType: ModalType;\n  modalData: Record<string, unknown> | null;\n  openModal: (type: ModalType, data?: Record<string, unknown>) => void;\n  closeModal: () => void;\n\n  // Global search\n  isSearchOpen: boolean;\n  setSearchOpen: (open: boolean) => void;\n\n  // Notifications\n  isNotificationsOpen: boolean;\n  setNotificationsOpen: (open: boolean) => void;\n}\n\nexport const useUIStore = create<UIState>((set) => ({\n  drawerType: null,\n  drawerData: null,\n  openDrawer: (drawerType, drawerData) =>\n    set({ drawerType, drawerData: drawerData ?? null }),\n  closeDrawer: () => set({ drawerType: null, drawerData: null }),\n\n  modalType: null,\n  modalData: null,\n  openModal: (modalType, modalData) => set({ modalType, modalData: modalData ?? null }),\n  closeModal: () => set({ modalType: null, modalData: null }),\n\n  isSearchOpen: false,\n  setSearchOpen: (isSearchOpen) => set({ isSearchOpen }),\n\n  isNotificationsOpen: false,\n  setNotificationsOpen: (isNotificationsOpen) => set({ isNotificationsOpen }),\n}));\n"],"names":[],"mappings":";;;;AAAA;;AA6CO,MAAM,aAAa,IAAA,qJAAM,EAAU,CAAC,MAAQ,CAAC;QAClD,YAAY;QACZ,YAAY;QACZ,YAAY,CAAC,YAAY,aACvB,IAAI;gBAAE;gBAAY,YAAY,cAAc;YAAK;QACnD,aAAa,IAAM,IAAI;gBAAE,YAAY;gBAAM,YAAY;YAAK;QAE5D,WAAW;QACX,WAAW;QACX,WAAW,CAAC,WAAW,YAAc,IAAI;gBAAE;gBAAW,WAAW,aAAa;YAAK;QACnF,YAAY,IAAM,IAAI;gBAAE,WAAW;gBAAM,WAAW;YAAK;QAEzD,cAAc;QACd,eAAe,CAAC,eAAiB,IAAI;gBAAE;YAAa;QAEpD,qBAAqB;QACrB,sBAAsB,CAAC,sBAAwB,IAAI;gBAAE;YAAoB;IAC3E,CAAC"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/stage-fields-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { PipelineStage } from \"@/types\";\nimport {\n  stageFieldsConfig,\n  isFieldValueEmpty,\n  validateFieldValue,\n  type StageField,\n  type StageFieldValue,\n} from \"@/lib/mock-stage-fields\";\n\n// ===== Types =====\n\ntype FieldSaveState = \"idle\" | \"saving\" | \"saved\" | \"error\";\n\ninterface StageFieldsState {\n  // Current opportunity context\n  opportunityId: string | null;\n  opportunityStage: PipelineStage | null;\n\n  // Field definitions per stage (keyed by stageId)\n  fieldDefinitions: Record<string, StageField[]>;\n\n  // Field values per opportunity+stage (keyed by `${opportunityId}:${stageId}`)\n  fieldValues: Record<string, Record<string, StageFieldValue>>;\n\n  // Per-field save state\n  fieldSaveStates: Record<string, FieldSaveState>;\n\n  // Per-field validation errors\n  fieldErrors: Record<string, string>;\n\n  // Global save/loading states\n  isSaving: boolean;\n  isLoadingFields: boolean;\n  isChangingStage: boolean;\n  loadError: string | null;\n\n  // Banner messages\n  banner: { message: string; variant: \"success\" | \"error\" | \"warning\" | \"info\" } | null;\n\n  // New field modal\n  isNewFieldModalOpen: boolean;\n\n  // Actions\n  initForOpportunity: (opportunityId: string, stage: PipelineStage, initialValues?: Record<string, StageFieldValue>) => void;\n  updateFieldValue: (fieldId: string, value: StageFieldValue) => void;\n  saveAllFields: () => void;\n  updateOpportunityStage: (\n    nextStageId: PipelineStage,\n    onAdvance: (nextStage: PipelineStage) => boolean | void\n  ) => void;\n  advanceStage: (\n    nextStageId: PipelineStage,\n    onAdvance: (nextStage: PipelineStage) => boolean | void\n  ) => void;\n  addFieldDefinition: (stageId: string, field: Omit<StageField, \"id\" | \"order\" | \"isActive\" | \"stageId\">) => void;\n  setNewFieldModalOpen: (open: boolean) => void;\n  setBanner: (banner: StageFieldsState[\"banner\"]) => void;\n  reset: () => void;\n}\n\n// ===== Helpers =====\n\nfunction valuesKey(opportunityId: string, stageId: string) {\n  return `${opportunityId}:${stageId}`;\n}\n\n// ===== Store =====\n\nexport const useStageFieldsStore = create<StageFieldsState>()(\n  devtools(\n    (set, get) => ({\n      opportunityId: null,\n      opportunityStage: null,\n      fieldDefinitions: {},\n      fieldValues: {},\n      fieldSaveStates: {},\n      fieldErrors: {},\n      isSaving: false,\n      isLoadingFields: false,\n      isChangingStage: false,\n      loadError: null,\n      banner: null,\n      isNewFieldModalOpen: false,\n\n      initForOpportunity: (opportunityId, stage, initialValues) => {\n        // Load field definitions for all stages from config\n        const definitions: Record<string, StageField[]> = {};\n        for (const [stageId, fields] of Object.entries(stageFieldsConfig)) {\n          definitions[stageId] = fields.filter((f) => f.isActive);\n        }\n\n        // Initialize values for current stage\n        const key = valuesKey(opportunityId, stage);\n        const existingValues = get().fieldValues[key];\n        const values = existingValues ?? initialValues ?? {};\n\n        set({\n          opportunityId,\n          opportunityStage: stage,\n          fieldDefinitions: definitions,\n          fieldValues: { ...get().fieldValues, [key]: values },\n          fieldSaveStates: {},\n          fieldErrors: {},\n          isSaving: false,\n          isLoadingFields: false,\n          isChangingStage: false,\n          loadError: null,\n          banner: null,\n          isNewFieldModalOpen: false,\n        });\n      },\n\n      updateFieldValue: (fieldId, value) => {\n        const { opportunityId, opportunityStage, fieldValues } = get();\n        if (!opportunityId || !opportunityStage) return;\n\n        const key = valuesKey(opportunityId, opportunityStage);\n        const currentValues = fieldValues[key] || {};\n        const updatedValues = { ...currentValues, [fieldId]: value };\n\n        // Clear error for this field\n        const nextErrors = { ...get().fieldErrors };\n        delete nextErrors[fieldId];\n\n        set({\n          fieldValues: { ...fieldValues, [key]: updatedValues },\n          fieldErrors: nextErrors,\n          banner: null,\n          fieldSaveStates: { ...get().fieldSaveStates, [fieldId]: \"saving\" },\n        });\n\n        // Simulate auto-save with debounce feedback\n        setTimeout(() => {\n          set((s) => ({\n            fieldSaveStates: { ...s.fieldSaveStates, [fieldId]: \"saved\" },\n          }));\n          setTimeout(() => {\n            set((s) => ({\n              fieldSaveStates: { ...s.fieldSaveStates, [fieldId]: \"idle\" },\n            }));\n          }, 1400);\n        }, 280);\n      },\n\n      saveAllFields: () => {\n        const { opportunityId, opportunityStage, fieldDefinitions, fieldValues } = get();\n        if (!opportunityId || !opportunityStage) return;\n\n        const fields = fieldDefinitions[opportunityStage] || [];\n        const key = valuesKey(opportunityId, opportunityStage);\n        const values = fieldValues[key] || {};\n\n        // Validate required fields\n        const errors: Record<string, string> = {};\n        const missingRequired: StageField[] = [];\n        for (const field of fields) {\n          const error = validateFieldValue(field, values[field.id]);\n          if (error) {\n            errors[field.id] = error;\n            if (field.required) missingRequired.push(field);\n          }\n        }\n\n        if (missingRequired.length > 0) {\n          set({\n            fieldErrors: errors,\n            banner: {\n              message: `Faltam ${missingRequired.length} campo(s) obrigatório(s) para salvar e avançar.`,\n              variant: \"warning\",\n            },\n          });\n          return;\n        }\n\n        set({ isSaving: true });\n\n        // Mark all as saving\n        const savingMap: Record<string, FieldSaveState> = {};\n        fields.forEach((f) => { savingMap[f.id] = \"saving\"; });\n        set({ fieldSaveStates: savingMap });\n\n        // Simulate save\n        setTimeout(() => {\n          const savedMap: Record<string, FieldSaveState> = {};\n          fields.forEach((f) => { savedMap[f.id] = \"saved\"; });\n\n          const now = new Date();\n          const timeString = now.toLocaleTimeString(\"pt-BR\", { hour: \"2-digit\", minute: \"2-digit\" });\n\n          set({\n            fieldSaveStates: savedMap,\n            isSaving: false,\n            fieldErrors: {},\n            banner: {\n              message: `Salvo agora às ${timeString}`,\n              variant: \"success\",\n            },\n          });\n\n          setTimeout(() => {\n            // Dismiss banner after 3 seconds, keep idle state reset\n            const idleMap: Record<string, FieldSaveState> = {};\n            fields.forEach((f) => { idleMap[f.id] = \"idle\"; });\n            set({ fieldSaveStates: idleMap });\n          }, 1400);\n        }, 380);\n      },\n\n      updateOpportunityStage: (nextStageId, onAdvance) => {\n        const { opportunityId } = get();\n        if (!opportunityId) return;\n\n        set({ isChangingStage: true, banner: null });\n\n        // 1. Trigger the actual stage change\n        const didAdvance = onAdvance(nextStageId);\n\n        // Let the normal React context flow update the current stage prop.\n        // We will simulate the \"fetch fields for new stage\" here.\n        setTimeout(() => {\n          if (didAdvance === false) {\n            set({\n              isChangingStage: false,\n              banner: {\n                message: \"Não consegui mudar a etapa. Tente novamente.\",\n                variant: \"error\",\n              }\n            });\n            return;\n          }\n\n          // Fetch definitions for the new stage if we don't have them\n          const { fieldDefinitions, fieldValues } = get();\n          const newDefinitions = { ...fieldDefinitions };\n          if (!newDefinitions[nextStageId]) {\n            newDefinitions[nextStageId] = (stageFieldsConfig[nextStageId as PipelineStage] || []).filter((f) => f.isActive);\n          }\n\n          // Ensure values exist\n          const key = valuesKey(opportunityId, nextStageId);\n          const newValues = { ...fieldValues };\n          if (!newValues[key]) {\n            newValues[key] = {};\n          }\n\n          set({\n            opportunityStage: nextStageId,\n            fieldDefinitions: newDefinitions,\n            fieldValues: newValues,\n            fieldSaveStates: {},\n            fieldErrors: {},\n            isChangingStage: false,\n            banner: {\n              message: `Etapa alterada. Preencha os campos para continuar.`, // The stage label is inserted in the UI\n              variant: \"success\"\n            }\n          });\n        }, 600);\n      },\n\n      advanceStage: (nextStageId, onAdvance) => {\n        const { opportunityId, opportunityStage, fieldDefinitions, fieldValues } = get();\n        if (!opportunityId || !opportunityStage) return;\n\n        const fields = fieldDefinitions[opportunityStage] || [];\n        const key = valuesKey(opportunityId, opportunityStage);\n        const values = fieldValues[key] || {};\n\n        // Validate required fields\n        const errors: Record<string, string> = {};\n        const missing: StageField[] = [];\n        for (const field of fields) {\n          if (field.required && isFieldValueEmpty(values[field.id])) {\n            errors[field.id] = \"Preencha este campo para avançar etapa.\";\n            missing.push(field);\n          }\n        }\n\n        if (missing.length > 0) {\n          set({\n            fieldErrors: errors,\n            banner: {\n              message: \"Preencha os campos obrigatórios para avançar etapa.\",\n              variant: \"warning\",\n            },\n          });\n          return;\n        }\n\n        // Advance stage via callback\n        const didAdvance = onAdvance(nextStageId);\n        if (didAdvance === false) {\n          return;\n        }\n\n        // Update internal state to reflect new stage\n        set({\n          opportunityStage: nextStageId,\n          fieldSaveStates: {},\n          fieldErrors: {},\n          banner: null,\n        });\n      },\n\n      addFieldDefinition: (stageId, fieldData) => {\n        const { fieldDefinitions } = get();\n        const existingFields = fieldDefinitions[stageId] || [];\n        const newField: StageField = {\n          ...fieldData,\n          id: `sf-${stageId}-${Date.now()}`,\n          stageId,\n          order: existingFields.length,\n          isActive: true,\n        };\n\n        // Also update the global config so it persists in the mock layer\n        const configFields = stageFieldsConfig[stageId as PipelineStage];\n        if (configFields) {\n          configFields.push(newField);\n        }\n\n        set({\n          fieldDefinitions: {\n            ...fieldDefinitions,\n            [stageId]: [...existingFields, newField],\n          },\n          isNewFieldModalOpen: false,\n          banner: {\n            message: `Campo \"${newField.label}\" criado com sucesso.`,\n            variant: \"success\",\n          },\n        });\n      },\n\n      setNewFieldModalOpen: (open) => set({ isNewFieldModalOpen: open }),\n\n      setBanner: (banner) => set({ banner }),\n\n      reset: () =>\n        set({\n          opportunityId: null,\n          opportunityStage: null,\n          fieldSaveStates: {},\n          fieldErrors: {},\n          isSaving: false,\n          isLoadingFields: false,\n          isChangingStage: false,\n          loadError: null,\n          banner: null,\n          isNewFieldModalOpen: false,\n        }),\n    }),\n    { name: \"stage-fields-store\" },\n  ),\n);\n\n// ===== Selectors =====\n\nexport function useViewStageFields() {\n  const stage = useStageFieldsStore((s) => s.opportunityStage);\n  const fieldDefinitions = useStageFieldsStore((s) => s.fieldDefinitions);\n  if (!stage) return [];\n  return (fieldDefinitions[stage] || []).sort((a, b) => a.order - b.order);\n}\n\nexport function useViewStageValues() {\n  const opportunityId = useStageFieldsStore((s) => s.opportunityId);\n  const stage = useStageFieldsStore((s) => s.opportunityStage);\n  const fieldValues = useStageFieldsStore((s) => s.fieldValues);\n  if (!opportunityId || !stage) return {};\n  return fieldValues[valuesKey(opportunityId, stage)] || {};\n}\n\nexport function useRequiredProgress() {\n  const fields = useViewStageFields();\n  const values = useViewStageValues();\n  const requiredFields = fields.filter((f) => f.required);\n  const completed = requiredFields.filter((f) => !isFieldValueEmpty(values[f.id]));\n  return {\n    total: requiredFields.length,\n    completed: completed.length,\n    missing: requiredFields.length - completed.length,\n    missingFields: requiredFields.filter((f) => isFieldValueEmpty(values[f.id])),\n  };\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 453, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/opportunity-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { Opportunity, PipelineStage, OpportunityStatus } from \"@/types\";\nimport { mockOpportunities } from \"@/lib/mock-data\";\nimport { calculateSlaDeadline } from \"@/lib/business-rules\";\n\ninterface OpportunityState {\n  opportunities: Opportunity[];\n  isLoading: boolean;\n\n  // CRUD\n  addOpportunity: (data: Omit<Opportunity, \"id\" | \"createdAt\" | \"updatedAt\" | \"status\">) => Opportunity;\n  updateOpportunity: (id: string, data: Partial<Opportunity>) => void;\n  deleteOpportunity: (id: string) => void;\n\n  // Stage management\n  moveToStage: (id: string, stage: PipelineStage, slaHours?: number) => void;\n  replaceOpportunities: (opportunities: Opportunity[]) => void;\n\n  // Status management\n  winOpportunity: (id: string) => void;\n  loseOpportunity: (id: string, reason: string, competitor?: string, notes?: string) => void;\n\n  // Computed\n  getByStage: (stage: PipelineStage) => Opportunity[];\n  getOpen: () => Opportunity[];\n  getById: (id: string) => Opportunity | undefined;\n}\n\nexport const useOpportunityStore = create<OpportunityState>()(\n  devtools(\n    (set, get) => ({\n      opportunities: mockOpportunities,\n      isLoading: false,\n\n      addOpportunity: (data) => {\n        const newOpp: Opportunity = {\n          ...data,\n          id: `opp-${Date.now()}`,\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n          status: \"open\",\n        };\n        set((state) => ({\n          opportunities: [...state.opportunities, newOpp],\n        }));\n        return newOpp;\n      },\n\n      updateOpportunity: (id, data) =>\n        set((state) => ({\n          opportunities: state.opportunities.map((opp) =>\n            opp.id === id\n              ? { ...opp, ...data, updatedAt: new Date().toISOString() }\n              : opp\n          ),\n        })),\n\n      deleteOpportunity: (id) =>\n        set((state) => ({\n          opportunities: state.opportunities.filter((opp) => opp.id !== id),\n        })),\n\n      moveToStage: (id, stage, slaHours) =>\n        set((state) => ({\n          opportunities: state.opportunities.map((opp) =>\n            opp.id === id\n              ? {\n                  ...opp,\n                  stage,\n                  updatedAt: new Date().toISOString(),\n                  slaDeadline: slaHours ? calculateSlaDeadline(slaHours) : opp.slaDeadline,\n                }\n              : opp\n          ),\n        })),\n\n      replaceOpportunities: (opportunities) =>\n        set(() => ({\n          opportunities,\n        })),\n\n      winOpportunity: (id) =>\n        set((state) => ({\n          opportunities: state.opportunities.map((opp) =>\n            opp.id === id\n              ? { ...opp, status: \"won\" as OpportunityStatus, updatedAt: new Date().toISOString() }\n              : opp\n          ),\n        })),\n\n      loseOpportunity: (id, reason, competitor, notes) =>\n        set((state) => ({\n          opportunities: state.opportunities.map((opp) =>\n            opp.id === id\n              ? {\n                  ...opp,\n                  status: \"lost\" as OpportunityStatus,\n                  lossReason: reason,\n                  competitor: competitor || opp.competitor,\n                  notes: notes || opp.notes,\n                  updatedAt: new Date().toISOString(),\n                }\n              : opp\n          ),\n        })),\n\n      getByStage: (stage) => get().opportunities.filter((o) => o.stage === stage && o.status === \"open\"),\n      getOpen: () => get().opportunities.filter((o) => o.status === \"open\"),\n      getById: (id) => get().opportunities.find((o) => o.id === id),\n    }),\n    { name: \"opportunity-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;AACA;;;;;AAyBO,MAAM,sBAAsB,IAAA,qJAAM,IACvC,IAAA,4JAAQ,EACN,CAAC,KAAK,MAAQ,CAAC;QACb,eAAe,mKAAiB;QAChC,WAAW;QAEX,gBAAgB,CAAC;YACf,MAAM,SAAsB;gBAC1B,GAAG,IAAI;gBACP,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;gBACvB,WAAW,IAAI,OAAO,WAAW;gBACjC,WAAW,IAAI,OAAO,WAAW;gBACjC,QAAQ;YACV;YACA,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe;2BAAI,MAAM,aAAa;wBAAE;qBAAO;gBACjD,CAAC;YACD,OAAO;QACT;QAEA,mBAAmB,CAAC,IAAI,OACtB,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,GAAG,CAAC,CAAC,MACtC,IAAI,EAAE,KAAK,KACP;4BAAE,GAAG,GAAG;4BAAE,GAAG,IAAI;4BAAE,WAAW,IAAI,OAAO,WAAW;wBAAG,IACvD;gBAER,CAAC;QAEH,mBAAmB,CAAC,KAClB,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,MAAM,CAAC,CAAC,MAAQ,IAAI,EAAE,KAAK;gBAChE,CAAC;QAEH,aAAa,CAAC,IAAI,OAAO,WACvB,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,GAAG,CAAC,CAAC,MACtC,IAAI,EAAE,KAAK,KACP;4BACE,GAAG,GAAG;4BACN;4BACA,WAAW,IAAI,OAAO,WAAW;4BACjC,aAAa,WAAW,IAAA,0JAAoB,EAAC,YAAY,IAAI,WAAW;wBAC1E,IACA;gBAER,CAAC;QAEH,sBAAsB,CAAC,gBACrB,IAAI,IAAM,CAAC;oBACT;gBACF,CAAC;QAEH,gBAAgB,CAAC,KACf,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,GAAG,CAAC,CAAC,MACtC,IAAI,EAAE,KAAK,KACP;4BAAE,GAAG,GAAG;4BAAE,QAAQ;4BAA4B,WAAW,IAAI,OAAO,WAAW;wBAAG,IAClF;gBAER,CAAC;QAEH,iBAAiB,CAAC,IAAI,QAAQ,YAAY,QACxC,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,GAAG,CAAC,CAAC,MACtC,IAAI,EAAE,KAAK,KACP;4BACE,GAAG,GAAG;4BACN,QAAQ;4BACR,YAAY;4BACZ,YAAY,cAAc,IAAI,UAAU;4BACxC,OAAO,SAAS,IAAI,KAAK;4BACzB,WAAW,IAAI,OAAO,WAAW;wBACnC,IACA;gBAER,CAAC;QAEH,YAAY,CAAC,QAAU,MAAM,aAAa,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK,SAAS,EAAE,MAAM,KAAK;QAC3F,SAAS,IAAM,MAAM,aAAa,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;QAC9D,SAAS,CAAC,KAAO,MAAM,aAAa,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IAC5D,CAAC,GACD;IAAE,MAAM;AAAoB"}},
    {"offset": {"line": 536, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/client-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { Client, ClientStage } from \"@/types\";\nimport { mockClients } from \"@/lib/mock-data\";\n\ninterface ClientState {\n  clients: Client[];\n  isLoading: boolean;\n\n  // CRUD\n  addClient: (data: Omit<Client, \"id\" | \"createdAt\" | \"updatedAt\">) => Client;\n  updateClient: (id: string, data: Partial<Client>) => void;\n  deleteClient: (id: string) => void;\n\n  // Stage management\n  moveToStage: (id: string, stage: ClientStage) => void;\n\n  // Computed\n  getById: (id: string) => Client | undefined;\n  getByStage: (stage: ClientStage) => Client[];\n}\n\nexport const useClientStore = create<ClientState>()(\n  devtools(\n    (set, get) => ({\n      clients: mockClients,\n      isLoading: false,\n\n      addClient: (data) => {\n        const newClient: Client = {\n          ...data,\n          id: `client-${Date.now()}`,\n          createdAt: new Date().toISOString(),\n          updatedAt: new Date().toISOString(),\n        };\n        set((state) => ({\n          clients: [...state.clients, newClient],\n        }));\n        return newClient;\n      },\n\n      updateClient: (id, data) =>\n        set((state) => ({\n          clients: state.clients.map((cli) =>\n            cli.id === id\n              ? { ...cli, ...data, updatedAt: new Date().toISOString() }\n              : cli\n          ),\n        })),\n\n      deleteClient: (id) =>\n        set((state) => ({\n          clients: state.clients.filter((cli) => cli.id !== id),\n        })),\n\n      moveToStage: (id, stage) =>\n        set((state) => ({\n          clients: state.clients.map((cli) =>\n            cli.id === id\n              ? { ...cli, stage, updatedAt: new Date().toISOString() }\n              : cli\n          ),\n        })),\n\n      getById: (id) => get().clients.find((c) => c.id === id),\n      getByStage: (stage) => get().clients.filter((c) => c.stage === stage),\n    }),\n    { name: \"client-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;;;;AAmBO,MAAM,iBAAiB,IAAA,qJAAM,IAClC,IAAA,4JAAQ,EACN,CAAC,KAAK,MAAQ,CAAC;QACb,SAAS,uJAAW;QACpB,WAAW;QAEX,WAAW,CAAC;YACV,MAAM,YAAoB;gBACxB,GAAG,IAAI;gBACP,IAAI,CAAC,OAAO,EAAE,KAAK,GAAG,IAAI;gBAC1B,WAAW,IAAI,OAAO,WAAW;gBACjC,WAAW,IAAI,OAAO,WAAW;YACnC;YACA,IAAI,CAAC,QAAU,CAAC;oBACd,SAAS;2BAAI,MAAM,OAAO;wBAAE;qBAAU;gBACxC,CAAC;YACD,OAAO;QACT;QAEA,cAAc,CAAC,IAAI,OACjB,IAAI,CAAC,QAAU,CAAC;oBACd,SAAS,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,MAC1B,IAAI,EAAE,KAAK,KACP;4BAAE,GAAG,GAAG;4BAAE,GAAG,IAAI;4BAAE,WAAW,IAAI,OAAO,WAAW;wBAAG,IACvD;gBAER,CAAC;QAEH,cAAc,CAAC,KACb,IAAI,CAAC,QAAU,CAAC;oBACd,SAAS,MAAM,OAAO,CAAC,MAAM,CAAC,CAAC,MAAQ,IAAI,EAAE,KAAK;gBACpD,CAAC;QAEH,aAAa,CAAC,IAAI,QAChB,IAAI,CAAC,QAAU,CAAC;oBACd,SAAS,MAAM,OAAO,CAAC,GAAG,CAAC,CAAC,MAC1B,IAAI,EAAE,KAAK,KACP;4BAAE,GAAG,GAAG;4BAAE;4BAAO,WAAW,IAAI,OAAO,WAAW;wBAAG,IACrD;gBAER,CAAC;QAEH,SAAS,CAAC,KAAO,MAAM,OAAO,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QACpD,YAAY,CAAC,QAAU,MAAM,OAAO,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,KAAK,KAAK;IACjE,CAAC,GACD;IAAE,MAAM;AAAe"}},
    {"offset": {"line": 594, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/contact-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { Contact } from \"@/types\";\nimport { mockContacts } from \"@/lib/mock-data\";\n\ninterface ContactState {\n  contacts: Contact[];\n  isLoading: boolean;\n\n  // Queries\n  getByClient: (clientId: string) => Contact[];\n  getById: (id: string) => Contact | undefined;\n}\n\nexport const useContactStore = create<ContactState>()(\n  devtools(\n    (_set, get) => ({\n      contacts: mockContacts,\n      isLoading: false,\n\n      getByClient: (clientId) =>\n        get().contacts.filter((c) => c.clientId === clientId),\n      getById: (id) => get().contacts.find((c) => c.id === id),\n    }),\n    { name: \"contact-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;;;;AAWO,MAAM,kBAAkB,IAAA,qJAAM,IACnC,IAAA,4JAAQ,EACN,CAAC,MAAM,MAAQ,CAAC;QACd,UAAU,yJAAY;QACtB,WAAW;QAEX,aAAa,CAAC,WACZ,MAAM,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;QAC9C,SAAS,CAAC,KAAO,MAAM,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IACvD,CAAC,GACD;IAAE,MAAM;AAAgB"}},
    {"offset": {"line": 620, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/visit-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { Visit } from \"@/types\";\nimport { mockVisits } from \"@/lib/mock-data\";\n\ninterface VisitState {\n  visits: Visit[];\n  isLoading: boolean;\n\n  // Queries\n  getByOpportunity: (opportunityId: string) => Visit[];\n  getByClient: (clientId: string) => Visit[];\n  getById: (id: string) => Visit | undefined;\n}\n\nexport const useVisitStore = create<VisitState>()(\n  devtools(\n    (_set, get) => ({\n      visits: mockVisits,\n      isLoading: false,\n\n      getByOpportunity: (opportunityId) =>\n        get().visits.filter((v) => v.opportunityId === opportunityId),\n      getByClient: (clientId) =>\n        get().visits.filter((v) => v.clientId === clientId),\n      getById: (id) => get().visits.find((v) => v.id === id),\n    }),\n    { name: \"visit-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;;;;AAYO,MAAM,gBAAgB,IAAA,qJAAM,IACjC,IAAA,4JAAQ,EACN,CAAC,MAAM,MAAQ,CAAC;QACd,QAAQ,qJAAU;QAClB,WAAW;QAEX,kBAAkB,CAAC,gBACjB,MAAM,MAAM,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,aAAa,KAAK;QACjD,aAAa,CAAC,WACZ,MAAM,MAAM,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;QAC5C,SAAS,CAAC,KAAO,MAAM,MAAM,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IACrD,CAAC,GACD;IAAE,MAAM;AAAc"}},
    {"offset": {"line": 647, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/note-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { OpportunityNote } from \"@/types\";\nimport { mockNotes } from \"@/lib/mock-data\";\n\ninterface NoteState {\n  notes: OpportunityNote[];\n  isLoading: boolean;\n\n  // Queries\n  getByOpportunity: (opportunityId: string) => OpportunityNote[];\n  getById: (id: string) => OpportunityNote | undefined;\n}\n\nexport const useNoteStore = create<NoteState>()(\n  devtools(\n    (_set, get) => ({\n      notes: mockNotes,\n      isLoading: false,\n\n      getByOpportunity: (opportunityId) =>\n        get().notes.filter((n) => n.opportunityId === opportunityId),\n      getById: (id) => get().notes.find((n) => n.id === id),\n    }),\n    { name: \"note-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;;;;AAWO,MAAM,eAAe,IAAA,qJAAM,IAChC,IAAA,4JAAQ,EACN,CAAC,MAAM,MAAQ,CAAC;QACd,OAAO,mJAAS;QAChB,WAAW;QAEX,kBAAkB,CAAC,gBACjB,MAAM,KAAK,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,aAAa,KAAK;QAChD,SAAS,CAAC,KAAO,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;IACpD,CAAC,GACD;IAAE,MAAM;AAAa"}},
    {"offset": {"line": 673, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/notification-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { Notification } from \"@/types\";\nimport { mockNotifications } from \"@/lib/mock-data\";\n\ninterface NotificationState {\n  notifications: Notification[];\n\n  // Actions\n  addNotification: (data: Omit<Notification, \"id\" | \"createdAt\" | \"isRead\">) => void;\n  markAsRead: (id: string) => void;\n  markAllAsRead: () => void;\n  deleteNotification: (id: string) => void;\n\n  // Computed\n  getUnread: () => Notification[];\n  getUnreadCount: () => number;\n}\n\nexport const useNotificationStore = create<NotificationState>()(\n  devtools(\n    (set, get) => ({\n      notifications: mockNotifications,\n\n      addNotification: (data) =>\n        set((state) => ({\n          notifications: [\n            {\n              ...data,\n              id: `notif-${Date.now()}`,\n              createdAt: new Date().toISOString(),\n              isRead: false,\n            },\n            ...state.notifications,\n          ],\n        })),\n\n      markAsRead: (id) =>\n        set((state) => ({\n          notifications: state.notifications.map((n) =>\n            n.id === id ? { ...n, isRead: true } : n\n          ),\n        })),\n\n      markAllAsRead: () =>\n        set((state) => ({\n          notifications: state.notifications.map((n) => ({ ...n, isRead: true })),\n        })),\n\n      deleteNotification: (id) =>\n        set((state) => ({\n          notifications: state.notifications.filter((n) => n.id !== id),\n        })),\n\n      getUnread: () => get().notifications.filter((n) => !n.isRead),\n      getUnreadCount: () => get().notifications.filter((n) => !n.isRead).length,\n    }),\n    { name: \"notification-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;;;;AAgBO,MAAM,uBAAuB,IAAA,qJAAM,IACxC,IAAA,4JAAQ,EACN,CAAC,KAAK,MAAQ,CAAC;QACb,eAAe,mKAAiB;QAEhC,iBAAiB,CAAC,OAChB,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe;wBACb;4BACE,GAAG,IAAI;4BACP,IAAI,CAAC,MAAM,EAAE,KAAK,GAAG,IAAI;4BACzB,WAAW,IAAI,OAAO,WAAW;4BACjC,QAAQ;wBACV;2BACG,MAAM,aAAa;qBACvB;gBACH,CAAC;QAEH,YAAY,CAAC,KACX,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,GAAG,CAAC,CAAC,IACtC,EAAE,EAAE,KAAK,KAAK;4BAAE,GAAG,CAAC;4BAAE,QAAQ;wBAAK,IAAI;gBAE3C,CAAC;QAEH,eAAe,IACb,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,GAAG,CAAC,CAAC,IAAM,CAAC;4BAAE,GAAG,CAAC;4BAAE,QAAQ;wBAAK,CAAC;gBACvE,CAAC;QAEH,oBAAoB,CAAC,KACnB,IAAI,CAAC,QAAU,CAAC;oBACd,eAAe,MAAM,aAAa,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;gBAC5D,CAAC;QAEH,WAAW,IAAM,MAAM,aAAa,CAAC,MAAM,CAAC,CAAC,IAAM,CAAC,EAAE,MAAM;QAC5D,gBAAgB,IAAM,MAAM,aAAa,CAAC,MAAM,CAAC,CAAC,IAAM,CAAC,EAAE,MAAM,EAAE,MAAM;IAC3E,CAAC,GACD;IAAE,MAAM;AAAqB"}},
    {"offset": {"line": 724, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/user-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { TeamUser } from \"@/types\";\nimport { mockUsers } from \"@/lib/mock-data\";\n\ninterface UserState {\n  users: TeamUser[];\n\n  // CRUD\n  addUser: (data: Omit<TeamUser, \"id\" | \"createdAt\">) => TeamUser;\n  updateUser: (id: string, data: Partial<TeamUser>) => void;\n  deactivateUser: (id: string) => void;\n  activateUser: (id: string) => void;\n\n  // Computed\n  getById: (id: string) => TeamUser | undefined;\n  getActive: () => TeamUser[];\n}\n\nexport const useUserStore = create<UserState>()(\n  devtools(\n    (set, get) => ({\n      users: mockUsers,\n\n      addUser: (data) => {\n        const newUser: TeamUser = {\n          ...data,\n          id: `user-${Date.now()}`,\n          createdAt: new Date().toISOString(),\n        };\n        set((state) => ({\n          users: [...state.users, newUser],\n        }));\n        return newUser;\n      },\n\n      updateUser: (id, data) =>\n        set((state) => ({\n          users: state.users.map((u) =>\n            u.id === id ? { ...u, ...data } : u\n          ),\n        })),\n\n      deactivateUser: (id) =>\n        set((state) => ({\n          users: state.users.map((u) =>\n            u.id === id ? { ...u, isActive: false } : u\n          ),\n        })),\n\n      activateUser: (id) =>\n        set((state) => ({\n          users: state.users.map((u) =>\n            u.id === id ? { ...u, isActive: true } : u\n          ),\n        })),\n\n      getById: (id) => get().users.find((u) => u.id === id),\n      getActive: () => get().users.filter((u) => u.isActive),\n    }),\n    { name: \"user-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;;;;AAgBO,MAAM,eAAe,IAAA,qJAAM,IAChC,IAAA,4JAAQ,EACN,CAAC,KAAK,MAAQ,CAAC;QACb,OAAO,mJAAS;QAEhB,SAAS,CAAC;YACR,MAAM,UAAoB;gBACxB,GAAG,IAAI;gBACP,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;gBACxB,WAAW,IAAI,OAAO,WAAW;YACnC;YACA,IAAI,CAAC,QAAU,CAAC;oBACd,OAAO;2BAAI,MAAM,KAAK;wBAAE;qBAAQ;gBAClC,CAAC;YACD,OAAO;QACT;QAEA,YAAY,CAAC,IAAI,OACf,IAAI,CAAC,QAAU,CAAC;oBACd,OAAO,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,IACtB,EAAE,EAAE,KAAK,KAAK;4BAAE,GAAG,CAAC;4BAAE,GAAG,IAAI;wBAAC,IAAI;gBAEtC,CAAC;QAEH,gBAAgB,CAAC,KACf,IAAI,CAAC,QAAU,CAAC;oBACd,OAAO,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,IACtB,EAAE,EAAE,KAAK,KAAK;4BAAE,GAAG,CAAC;4BAAE,UAAU;wBAAM,IAAI;gBAE9C,CAAC;QAEH,cAAc,CAAC,KACb,IAAI,CAAC,QAAU,CAAC;oBACd,OAAO,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,IACtB,EAAE,EAAE,KAAK,KAAK;4BAAE,GAAG,CAAC;4BAAE,UAAU;wBAAK,IAAI;gBAE7C,CAAC;QAEH,SAAS,CAAC,KAAO,MAAM,KAAK,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QAClD,WAAW,IAAM,MAAM,KAAK,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ;IACvD,CAAC,GACD;IAAE,MAAM;AAAa"}},
    {"offset": {"line": 781, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/activity-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { Activity, ActivityStatus } from \"@/types\";\nimport { mockActivities } from \"@/lib/mock-data\";\nimport { getEffectiveActivityStatus } from \"@/lib/business-rules\";\n\ninterface ActivityState {\n  activities: Activity[];\n  isLoading: boolean;\n\n  // CRUD\n  addActivity: (data: Omit<Activity, \"id\" | \"createdAt\">) => Activity;\n  updateActivity: (id: string, data: Partial<Activity>) => void;\n  deleteActivity: (id: string) => void;\n\n  // Status management\n  completeActivity: (id: string, notes?: string) => void;\n  cancelActivity: (id: string) => void;\n  postponeActivity: (id: string, newDueDate: string, newDueTime?: string) => void;\n\n  // Computed\n  getById: (id: string) => Activity | undefined;\n  getByOpportunity: (opportunityId: string) => Activity[];\n  getByClient: (clientId: string) => Activity[];\n  getPending: () => Activity[];\n  getOverdue: () => Activity[];\n}\n\nexport const useActivityStore = create<ActivityState>()(\n  devtools(\n    (set, get) => ({\n      activities: mockActivities,\n      isLoading: false,\n\n      addActivity: (data) => {\n        const newActivity: Activity = {\n          ...data,\n          id: `act-${Date.now()}`,\n          createdAt: new Date().toISOString(),\n        };\n        set((state) => ({\n          activities: [...state.activities, newActivity],\n        }));\n        return newActivity;\n      },\n\n      updateActivity: (id, data) =>\n        set((state) => ({\n          activities: state.activities.map((act) =>\n            act.id === id\n              ? { ...act, ...data, updatedAt: new Date().toISOString() }\n              : act\n          ),\n        })),\n\n      deleteActivity: (id) =>\n        set((state) => ({\n          activities: state.activities.filter((act) => act.id !== id),\n        })),\n\n      completeActivity: (id, notes) =>\n        set((state) => ({\n          activities: state.activities.map((act) =>\n            act.id === id\n              ? {\n                  ...act,\n                  status: \"completed\" as ActivityStatus,\n                  completedAt: new Date().toISOString().split(\"T\")[0],\n                  completionNotes: notes || undefined,\n                  updatedAt: new Date().toISOString(),\n                }\n              : act\n          ),\n        })),\n\n      cancelActivity: (id) =>\n        set((state) => ({\n          activities: state.activities.map((act) =>\n            act.id === id\n              ? { ...act, status: \"cancelled\" as ActivityStatus, updatedAt: new Date().toISOString() }\n              : act\n          ),\n        })),\n\n      postponeActivity: (id, newDueDate, newDueTime) =>\n        set((state) => {\n          return {\n            activities: state.activities.map((act) => {\n              if (act.id !== id) return act;\n\n              const candidate = {\n                ...act,\n                dueDate: newDueDate,\n                dueTime: newDueTime ?? act.dueTime,\n                status: \"pending\" as ActivityStatus,\n              };\n\n              const effectiveStatus = getEffectiveActivityStatus(candidate);\n              const newStatus: ActivityStatus =\n                effectiveStatus === \"overdue\" ? \"overdue\" : \"pending\";\n\n              return {\n                ...candidate,\n                status: newStatus,\n              };\n            }),\n          };\n        }),\n\n      getById: (id) => get().activities.find((a) => a.id === id),\n      getByOpportunity: (opportunityId) =>\n        get().activities.filter((a) => a.opportunityId === opportunityId),\n      getByClient: (clientId) =>\n        get().activities.filter((a) => a.clientId === clientId),\n      getPending: () =>\n        get().activities.filter((a) => a.status === \"pending\"),\n      getOverdue: () => {\n        const todayStr = new Date().toISOString().split(\"T\")[0];\n        return get().activities.filter(\n          (a) =>\n            a.status === \"overdue\" ||\n            (a.status === \"pending\" && a.dueDate < todayStr)\n        );\n      },\n    }),\n    { name: \"activity-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;AACA;;;;;AAwBO,MAAM,mBAAmB,IAAA,qJAAM,IACpC,IAAA,4JAAQ,EACN,CAAC,KAAK,MAAQ,CAAC;QACb,YAAY,6JAAc;QAC1B,WAAW;QAEX,aAAa,CAAC;YACZ,MAAM,cAAwB;gBAC5B,GAAG,IAAI;gBACP,IAAI,CAAC,IAAI,EAAE,KAAK,GAAG,IAAI;gBACvB,WAAW,IAAI,OAAO,WAAW;YACnC;YACA,IAAI,CAAC,QAAU,CAAC;oBACd,YAAY;2BAAI,MAAM,UAAU;wBAAE;qBAAY;gBAChD,CAAC;YACD,OAAO;QACT;QAEA,gBAAgB,CAAC,IAAI,OACnB,IAAI,CAAC,QAAU,CAAC;oBACd,YAAY,MAAM,UAAU,CAAC,GAAG,CAAC,CAAC,MAChC,IAAI,EAAE,KAAK,KACP;4BAAE,GAAG,GAAG;4BAAE,GAAG,IAAI;4BAAE,WAAW,IAAI,OAAO,WAAW;wBAAG,IACvD;gBAER,CAAC;QAEH,gBAAgB,CAAC,KACf,IAAI,CAAC,QAAU,CAAC;oBACd,YAAY,MAAM,UAAU,CAAC,MAAM,CAAC,CAAC,MAAQ,IAAI,EAAE,KAAK;gBAC1D,CAAC;QAEH,kBAAkB,CAAC,IAAI,QACrB,IAAI,CAAC,QAAU,CAAC;oBACd,YAAY,MAAM,UAAU,CAAC,GAAG,CAAC,CAAC,MAChC,IAAI,EAAE,KAAK,KACP;4BACE,GAAG,GAAG;4BACN,QAAQ;4BACR,aAAa,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;4BACnD,iBAAiB,SAAS;4BAC1B,WAAW,IAAI,OAAO,WAAW;wBACnC,IACA;gBAER,CAAC;QAEH,gBAAgB,CAAC,KACf,IAAI,CAAC,QAAU,CAAC;oBACd,YAAY,MAAM,UAAU,CAAC,GAAG,CAAC,CAAC,MAChC,IAAI,EAAE,KAAK,KACP;4BAAE,GAAG,GAAG;4BAAE,QAAQ;4BAA+B,WAAW,IAAI,OAAO,WAAW;wBAAG,IACrF;gBAER,CAAC;QAEH,kBAAkB,CAAC,IAAI,YAAY,aACjC,IAAI,CAAC;gBACH,OAAO;oBACL,YAAY,MAAM,UAAU,CAAC,GAAG,CAAC,CAAC;wBAChC,IAAI,IAAI,EAAE,KAAK,IAAI,OAAO;wBAE1B,MAAM,YAAY;4BAChB,GAAG,GAAG;4BACN,SAAS;4BACT,SAAS,cAAc,IAAI,OAAO;4BAClC,QAAQ;wBACV;wBAEA,MAAM,kBAAkB,IAAA,gKAA0B,EAAC;wBACnD,MAAM,YACJ,oBAAoB,YAAY,YAAY;wBAE9C,OAAO;4BACL,GAAG,SAAS;4BACZ,QAAQ;wBACV;oBACF;gBACF;YACF;QAEF,SAAS,CAAC,KAAO,MAAM,UAAU,CAAC,IAAI,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;QACvD,kBAAkB,CAAC,gBACjB,MAAM,UAAU,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,aAAa,KAAK;QACrD,aAAa,CAAC,WACZ,MAAM,UAAU,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,QAAQ,KAAK;QAChD,YAAY,IACV,MAAM,UAAU,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,MAAM,KAAK;QAC9C,YAAY;YACV,MAAM,WAAW,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;YACvD,OAAO,MAAM,UAAU,CAAC,MAAM,CAC5B,CAAC,IACC,EAAE,MAAM,KAAK,aACZ,EAAE,MAAM,KAAK,aAAa,EAAE,OAAO,GAAG;QAE7C;IACF,CAAC,GACD;IAAE,MAAM;AAAiB"}},
    {"offset": {"line": 874, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/goal-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\nimport type { Goal } from \"@/types\";\nimport { mockGoals } from \"@/lib/mock-data\";\n\ninterface GoalState {\n  goals: Goal[];\n\n  // CRUD\n  addGoal: (data: Omit<Goal, \"id\">) => Goal;\n  updateGoal: (id: string, data: Partial<Goal>) => void;\n  deleteGoal: (id: string) => void;\n}\n\nexport const useGoalStore = create<GoalState>()(\n  devtools(\n    (set) => ({\n      goals: mockGoals,\n\n      addGoal: (data) => {\n        const newGoal: Goal = {\n          ...data,\n          id: `goal-${Date.now()}`,\n        };\n        set((state) => ({\n          goals: [...state.goals, newGoal],\n        }));\n        return newGoal;\n      },\n\n      updateGoal: (id, data) =>\n        set((state) => ({\n          goals: state.goals.map((g) =>\n            g.id === id ? { ...g, ...data } : g\n          ),\n        })),\n\n      deleteGoal: (id) =>\n        set((state) => ({\n          goals: state.goals.filter((g) => g.id !== id),\n        })),\n    }),\n    { name: \"goal-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;AAEA;AAAA;;;;AAWO,MAAM,eAAe,IAAA,qJAAM,IAChC,IAAA,4JAAQ,EACN,CAAC,MAAQ,CAAC;QACR,OAAO,mJAAS;QAEhB,SAAS,CAAC;YACR,MAAM,UAAgB;gBACpB,GAAG,IAAI;gBACP,IAAI,CAAC,KAAK,EAAE,KAAK,GAAG,IAAI;YAC1B;YACA,IAAI,CAAC,QAAU,CAAC;oBACd,OAAO;2BAAI,MAAM,KAAK;wBAAE;qBAAQ;gBAClC,CAAC;YACD,OAAO;QACT;QAEA,YAAY,CAAC,IAAI,OACf,IAAI,CAAC,QAAU,CAAC;oBACd,OAAO,MAAM,KAAK,CAAC,GAAG,CAAC,CAAC,IACtB,EAAE,EAAE,KAAK,KAAK;4BAAE,GAAG,CAAC;4BAAE,GAAG,IAAI;wBAAC,IAAI;gBAEtC,CAAC;QAEH,YAAY,CAAC,KACX,IAAI,CAAC,QAAU,CAAC;oBACd,OAAO,MAAM,KAAK,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;gBAC5C,CAAC;IACL,CAAC,GACD;IAAE,MAAM;AAAa"}},
    {"offset": {"line": 919, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/pipeline-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools } from \"zustand/middleware\";\n\n// ===== Types =====\n\nexport interface PipelineStageConfig {\n  id: string;\n  name: string;\n  order: number;\n  slaHours?: number;\n}\n\nexport interface Pipeline {\n  id: string;\n  name: string;\n  description?: string;\n  stages: PipelineStageConfig[];\n  isDefault: boolean;\n  cardCount: number;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface PipelineState {\n  // State\n  pipelines: Pipeline[];\n  isLoading: boolean;\n\n  // Actions\n  setPipelines: (pipelines: Pipeline[]) => void;\n  addPipeline: (pipeline: Omit<Pipeline, \"id\" | \"createdAt\" | \"updatedAt\">) => void;\n  updatePipeline: (id: string, data: Partial<Pipeline>) => void;\n  deletePipeline: (id: string) => void;\n  reorderPipelines: (pipelines: Pipeline[]) => void;\n  addStage: (pipelineId: string, stage: Omit<PipelineStageConfig, \"order\">) => void;\n  updateStage: (pipelineId: string, stageId: string, data: Partial<PipelineStageConfig>) => void;\n  deleteStage: (pipelineId: string, stageId: string) => void;\n  reorderStages: (pipelineId: string, stages: PipelineStageConfig[]) => void;\n}\n\n// ===== Initial Data (mock) =====\n\nconst initialPipelines: Pipeline[] = [\n  {\n    id: \"pipeline-leads\",\n    name: \"Leads\",\n    description: \"Funil padrão de vendas\",\n    isDefault: true,\n    cardCount: 42,\n    createdAt: \"2026-01-01T00:00:00Z\",\n    updatedAt: \"2026-01-01T00:00:00Z\",\n    stages: [\n      { id: \"lead-in\", name: \"Lead-In\", order: 0, slaHours: 48 },\n      { id: \"contato-feito\", name: \"Contato Feito\", order: 1, slaHours: 72 },\n      { id: \"reuniao-agendada\", name: \"Reuniao Agendada\", order: 2, slaHours: 120 },\n      { id: \"proposta-enviada\", name: \"Proposta Enviada\", order: 3, slaHours: 96 },\n      { id: \"negociacao\", name: \"Negociacao\", order: 4, slaHours: 168 },\n      { id: \"fechamento\", name: \"Fechamento\", order: 5, slaHours: 48 },\n    ],\n  },\n  {\n    id: \"pipeline-indicacao\",\n    name: \"Indicação\",\n    description: \"Funil para leads vindos de indicação\",\n    isDefault: false,\n    cardCount: 8,\n    createdAt: \"2026-01-15T00:00:00Z\",\n    updatedAt: \"2026-01-15T00:00:00Z\",\n    stages: [\n      { id: \"lead-in-ind\", name: \"Lead-In\", order: 0, slaHours: 24 },\n      { id: \"contato-feito-ind\", name: \"Contato Feito\", order: 1, slaHours: 48 },\n      { id: \"proposta-enviada-ind\", name: \"Proposta Enviada\", order: 2, slaHours: 72 },\n      { id: \"fechamento-ind\", name: \"Fechamento\", order: 3, slaHours: 48 },\n    ],\n  },\n];\n\n// ===== Store =====\n\nexport const usePipelineStore = create<PipelineState>()(\n  devtools(\n    (set) => ({\n      // Initial state\n      pipelines: initialPipelines,\n      isLoading: false,\n\n      // Actions\n      setPipelines: (pipelines) => set({ pipelines }),\n\n      addPipeline: (pipelineData) =>\n        set((state) => {\n          const newPipeline: Pipeline = {\n            ...pipelineData,\n            id: `pipeline-${Date.now()}`,\n            createdAt: new Date().toISOString(),\n            updatedAt: new Date().toISOString(),\n          };\n\n          return {\n            pipelines: [...state.pipelines, newPipeline],\n          };\n        }),\n\n      updatePipeline: (id, data) =>\n        set((state) => ({\n          pipelines: state.pipelines.map((pipeline) =>\n            pipeline.id === id\n              ? { ...pipeline, ...data, updatedAt: new Date().toISOString() }\n              : pipeline\n          ),\n        })),\n\n      deletePipeline: (id) =>\n        set((state) => ({\n          pipelines: state.pipelines.filter((p) => p.id !== id),\n        })),\n\n      reorderPipelines: (pipelines) => set({ pipelines }),\n\n      addStage: (pipelineId, stageData) =>\n        set((state) => ({\n          pipelines: state.pipelines.map((pipeline) => {\n            if (pipeline.id !== pipelineId) return pipeline;\n\n            const newStage: PipelineStageConfig = {\n              ...stageData,\n              order: pipeline.stages.length,\n            };\n\n            return {\n              ...pipeline,\n              stages: [...pipeline.stages, newStage],\n              updatedAt: new Date().toISOString(),\n            };\n          }),\n        })),\n\n      updateStage: (pipelineId, stageId, data) =>\n        set((state) => ({\n          pipelines: state.pipelines.map((pipeline) => {\n            if (pipeline.id !== pipelineId) return pipeline;\n\n            return {\n              ...pipeline,\n              stages: pipeline.stages.map((stage) =>\n                stage.id === stageId ? { ...stage, ...data } : stage\n              ),\n              updatedAt: new Date().toISOString(),\n            };\n          }),\n        })),\n\n      deleteStage: (pipelineId, stageId) =>\n        set((state) => ({\n          pipelines: state.pipelines.map((pipeline) => {\n            if (pipeline.id !== pipelineId) return pipeline;\n\n            const filteredStages = pipeline.stages.filter((s) => s.id !== stageId);\n            const reorderedStages = filteredStages.map((stage, index) => ({\n              ...stage,\n              order: index,\n            }));\n\n            return {\n              ...pipeline,\n              stages: reorderedStages,\n              updatedAt: new Date().toISOString(),\n            };\n          }),\n        })),\n\n      reorderStages: (pipelineId, stages) =>\n        set((state) => ({\n          pipelines: state.pipelines.map((pipeline) => {\n            if (pipeline.id !== pipelineId) return pipeline;\n\n            const reorderedStages = stages.map((stage, index) => ({\n              ...stage,\n              order: index,\n            }));\n\n            return {\n              ...pipeline,\n              stages: reorderedStages,\n              updatedAt: new Date().toISOString(),\n            };\n          }),\n        })),\n    }),\n    { name: \"pipeline-store\" }\n  )\n);\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAuCA,kCAAkC;AAElC,MAAM,mBAA+B;IACnC;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,WAAW;QACX,WAAW;QACX,WAAW;QACX,WAAW;QACX,QAAQ;YACN;gBAAE,IAAI;gBAAW,MAAM;gBAAW,OAAO;gBAAG,UAAU;YAAG;YACzD;gBAAE,IAAI;gBAAiB,MAAM;gBAAiB,OAAO;gBAAG,UAAU;YAAG;YACrE;gBAAE,IAAI;gBAAoB,MAAM;gBAAoB,OAAO;gBAAG,UAAU;YAAI;YAC5E;gBAAE,IAAI;gBAAoB,MAAM;gBAAoB,OAAO;gBAAG,UAAU;YAAG;YAC3E;gBAAE,IAAI;gBAAc,MAAM;gBAAc,OAAO;gBAAG,UAAU;YAAI;YAChE;gBAAE,IAAI;gBAAc,MAAM;gBAAc,OAAO;gBAAG,UAAU;YAAG;SAChE;IACH;IACA;QACE,IAAI;QACJ,MAAM;QACN,aAAa;QACb,WAAW;QACX,WAAW;QACX,WAAW;QACX,WAAW;QACX,QAAQ;YACN;gBAAE,IAAI;gBAAe,MAAM;gBAAW,OAAO;gBAAG,UAAU;YAAG;YAC7D;gBAAE,IAAI;gBAAqB,MAAM;gBAAiB,OAAO;gBAAG,UAAU;YAAG;YACzE;gBAAE,IAAI;gBAAwB,MAAM;gBAAoB,OAAO;gBAAG,UAAU;YAAG;YAC/E;gBAAE,IAAI;gBAAkB,MAAM;gBAAc,OAAO;gBAAG,UAAU;YAAG;SACpE;IACH;CACD;AAIM,MAAM,mBAAmB,IAAA,qJAAM,IACpC,IAAA,4JAAQ,EACN,CAAC,MAAQ,CAAC;QACR,gBAAgB;QAChB,WAAW;QACX,WAAW;QAEX,UAAU;QACV,cAAc,CAAC,YAAc,IAAI;gBAAE;YAAU;QAE7C,aAAa,CAAC,eACZ,IAAI,CAAC;gBACH,MAAM,cAAwB;oBAC5B,GAAG,YAAY;oBACf,IAAI,CAAC,SAAS,EAAE,KAAK,GAAG,IAAI;oBAC5B,WAAW,IAAI,OAAO,WAAW;oBACjC,WAAW,IAAI,OAAO,WAAW;gBACnC;gBAEA,OAAO;oBACL,WAAW;2BAAI,MAAM,SAAS;wBAAE;qBAAY;gBAC9C;YACF;QAEF,gBAAgB,CAAC,IAAI,OACnB,IAAI,CAAC,QAAU,CAAC;oBACd,WAAW,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC,WAC9B,SAAS,EAAE,KAAK,KACZ;4BAAE,GAAG,QAAQ;4BAAE,GAAG,IAAI;4BAAE,WAAW,IAAI,OAAO,WAAW;wBAAG,IAC5D;gBAER,CAAC;QAEH,gBAAgB,CAAC,KACf,IAAI,CAAC,QAAU,CAAC;oBACd,WAAW,MAAM,SAAS,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;gBACpD,CAAC;QAEH,kBAAkB,CAAC,YAAc,IAAI;gBAAE;YAAU;QAEjD,UAAU,CAAC,YAAY,YACrB,IAAI,CAAC,QAAU,CAAC;oBACd,WAAW,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC;wBAC9B,IAAI,SAAS,EAAE,KAAK,YAAY,OAAO;wBAEvC,MAAM,WAAgC;4BACpC,GAAG,SAAS;4BACZ,OAAO,SAAS,MAAM,CAAC,MAAM;wBAC/B;wBAEA,OAAO;4BACL,GAAG,QAAQ;4BACX,QAAQ;mCAAI,SAAS,MAAM;gCAAE;6BAAS;4BACtC,WAAW,IAAI,OAAO,WAAW;wBACnC;oBACF;gBACF,CAAC;QAEH,aAAa,CAAC,YAAY,SAAS,OACjC,IAAI,CAAC,QAAU,CAAC;oBACd,WAAW,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC;wBAC9B,IAAI,SAAS,EAAE,KAAK,YAAY,OAAO;wBAEvC,OAAO;4BACL,GAAG,QAAQ;4BACX,QAAQ,SAAS,MAAM,CAAC,GAAG,CAAC,CAAC,QAC3B,MAAM,EAAE,KAAK,UAAU;oCAAE,GAAG,KAAK;oCAAE,GAAG,IAAI;gCAAC,IAAI;4BAEjD,WAAW,IAAI,OAAO,WAAW;wBACnC;oBACF;gBACF,CAAC;QAEH,aAAa,CAAC,YAAY,UACxB,IAAI,CAAC,QAAU,CAAC;oBACd,WAAW,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC;wBAC9B,IAAI,SAAS,EAAE,KAAK,YAAY,OAAO;wBAEvC,MAAM,iBAAiB,SAAS,MAAM,CAAC,MAAM,CAAC,CAAC,IAAM,EAAE,EAAE,KAAK;wBAC9D,MAAM,kBAAkB,eAAe,GAAG,CAAC,CAAC,OAAO,QAAU,CAAC;gCAC5D,GAAG,KAAK;gCACR,OAAO;4BACT,CAAC;wBAED,OAAO;4BACL,GAAG,QAAQ;4BACX,QAAQ;4BACR,WAAW,IAAI,OAAO,WAAW;wBACnC;oBACF;gBACF,CAAC;QAEH,eAAe,CAAC,YAAY,SAC1B,IAAI,CAAC,QAAU,CAAC;oBACd,WAAW,MAAM,SAAS,CAAC,GAAG,CAAC,CAAC;wBAC9B,IAAI,SAAS,EAAE,KAAK,YAAY,OAAO;wBAEvC,MAAM,kBAAkB,OAAO,GAAG,CAAC,CAAC,OAAO,QAAU,CAAC;gCACpD,GAAG,KAAK;gCACR,OAAO;4BACT,CAAC;wBAED,OAAO;4BACL,GAAG,QAAQ;4BACX,QAAQ;4BACR,WAAW,IAAI,OAAO,WAAW;wBACnC;oBACF;gBACF,CAAC;IACL,CAAC,GACD;IAAE,MAAM;AAAiB"}},
    {"offset": {"line": 1116, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/stores/intelligence-store.ts"],"sourcesContent":["// ============================================================================\n// Menux Intelligence — Zustand Store\n// Ref: docs/Menux Intelligence.md — seção 14\n// ============================================================================\n\nimport { create } from \"zustand\";\nimport type {\n  IntelligenceStore,\n  Message,\n  Conversation,\n  CardContext,\n  ClientPickerItem,\n  ClientPickerFilters,\n  SlashCommand,\n  ActiveScreen,\n  UserRoleIntelligence,\n  AiTone,\n  ProactiveFrequency,\n} from \"@/types/intelligence\";\nimport { INTELLIGENCE_LIMITS } from \"@/types/intelligence\";\nimport {\n  processMessage,\n  generateGreeting,\n  generateContextLoaded,\n  generateErrorMessage,\n} from \"@/lib/intelligence-engine\";\nimport { getCommandDefinition } from \"@/lib/intelligence-commands\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { computePipelineContext } from \"@/lib/proactive-engine\";\n\n// ─── Helpers ──────────────────────────────────────────────────────────────\n\nfunction uid(): string {\n  return `${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n}\n\nfunction now(): string {\n  return new Date().toISOString();\n}\n\nfunction isIntelligenceRole(\n  role: string | undefined\n): role is UserRoleIntelligence {\n  return (\n    role === \"master\" ||\n    role === \"admin\" ||\n    role === \"comercial\" ||\n    role === \"cs\"\n  );\n}\n\nfunction createConversation(messages: Message[] = []): Conversation {\n  return {\n    id: uid(),\n    preview: messages[0]?.content?.slice(0, 80) ?? \"\",\n    messages,\n    createdAt: now(),\n    updatedAt: now(),\n    messageCount: messages.length,\n  };\n}\n\nfunction getVendorContext() {\n  const user = useAuthStore.getState().user;\n  const opportunities = useOpportunityStore.getState().opportunities;\n  const userOpps = opportunities.filter((o) => o.responsibleId === user?.id);\n  const closed = userOpps.filter((o) => o.status === \"won\" || o.status === \"lost\");\n  const won = closed.filter((o) => o.status === \"won\");\n  const conversionRate = closed.length >= 3 ? Math.round((won.length / closed.length) * 100) : undefined;\n\n  return {\n    id: user?.id ?? \"unknown\",\n    name: user?.name ?? \"Vendedor\",\n    role: (user?.role ?? \"comercial\") as UserRoleIntelligence,\n    assignedCardCount: userOpps.filter((o) => o.status === \"open\").length,\n    conversionRate,\n  };\n}\n\nfunction getPipelineContext() {\n  try {\n    const user = useAuthStore.getState().user;\n    if (!user) return null;\n\n    const opportunities = useOpportunityStore.getState().opportunities;\n    const activities = useActivityStore.getState().activities;\n    return computePipelineContext(opportunities, activities, user.id, user.role);\n  } catch (err) {\n    console.error(\"[Menux Intelligence] Erro ao computar pipeline context:\", err);\n    return null;\n  }\n}\n\n// ─── Store ────────────────────────────────────────────────────────────────\n\nexport const useIntelligenceStore = create<IntelligenceStore>((set, get) => ({\n  // ── State ──────────────────────────────────────────────────────────────\n  isOpen: false,\n  activeConversation: null,\n  messages: [],\n  isTyping: false,\n  greetingSent: false,\n  contextCard: null,\n  isClientPickerOpen: false,\n  clientPickerSearch: \"\",\n  clientPickerFilters: {},\n  proactiveSuggestions: [],\n  history: [],\n  isHistoryOpen: false,\n  viewingHistoryConversation: null,\n  activeScreen: \"other\",\n  remainingQueries: INTELLIGENCE_LIMITS.MAX_QUERIES_PER_HOUR,\n  rateLimitResetAt: null,\n  menuxIntelligenceMode: \"focus\",\n  aiTone: \"neutral\" as AiTone,\n  proactiveFrequency: 5 as ProactiveFrequency,\n  proactiveNotifications: true,\n  isSettingsOpen: false,\n  isThinking: false,\n\n  // ── Actions ────────────────────────────────────────────────────────────\n\n  open: () => {\n    const state = get();\n\n    // Se já tem conversa ativa com saudação enviada, apenas abre\n    if (state.greetingSent && state.messages.length > 0) {\n      set({ isOpen: true });\n      return;\n    }\n\n    // Nova sessão → gerar saudação\n    const vendor = getVendorContext();\n    const greeting = generateGreeting(vendor, state.contextCard, true);\n\n    set({\n      isOpen: true,\n      greetingSent: true,\n      messages: [greeting],\n      activeConversation: createConversation([greeting]),\n    });\n  },\n\n  close: () => set({ isOpen: false }),\n\n  toggle: () => {\n    const state = get();\n    if (state.isOpen) {\n      state.close();\n    } else {\n      state.open();\n    }\n  },\n\n  sendMessage: async (text: string) => {\n    const state = get();\n\n    // Validações — seção 10 e 11\n    if (!text.trim()) return;\n\n    if (text.length > INTELLIGENCE_LIMITS.MAX_USER_MESSAGE_LENGTH) {\n      return; // Silenciosamente ignora — o UI deve já travar no limite\n    }\n\n    if (state.messages.length >= INTELLIGENCE_LIMITS.MAX_MESSAGES_PER_CONVERSATION) {\n      const errorMsg = generateErrorMessage(\"max-messages\");\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    if (state.remainingQueries <= 0) {\n      const errorMsg = generateErrorMessage(\"rate-limit\", {\n        resetTime: state.rateLimitResetAt\n          ? new Date(state.rateLimitResetAt).toLocaleTimeString(\"pt-BR\", {\n              hour: \"2-digit\",\n              minute: \"2-digit\",\n            })\n          : \"--:--\",\n      });\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    // Criar mensagem do vendedor\n    const userMessage: Message = {\n      id: uid(),\n      role: \"user\",\n      content: text,\n      contentType: \"text\",\n      timestamp: now(),\n    };\n\n    set((s) => ({\n      messages: [...s.messages, userMessage],\n      isTyping: true,\n    }));\n\n    // Processar resposta da IA\n    try {\n      const vendor = getVendorContext();\n      const response = await processMessage({\n        text,\n        card: state.contextCard,\n        vendor,\n        pipeline: getPipelineContext(),\n        mode: state.menuxIntelligenceMode,\n        tone: state.aiTone,\n      });\n\n      set((s) => ({\n        messages: [...s.messages, response],\n        isTyping: false,\n        remainingQueries: s.remainingQueries - 1,\n        activeConversation: s.activeConversation\n          ? {\n              ...s.activeConversation,\n              messages: [...s.messages, response],\n              messageCount: s.messages.length + 1,\n              updatedAt: now(),\n            }\n          : null,\n      }));\n    } catch {\n      const errorMsg = generateErrorMessage(\"api-error\");\n      set((s) => ({\n        messages: [...s.messages, errorMsg],\n        isTyping: false,\n      }));\n    }\n  },\n\n  executeSlashCommand: async (command: SlashCommand, payload?: string) => {\n    const state = get();\n    const rawRole = useAuthStore.getState().user?.role;\n    const role = isIntelligenceRole(rawRole) ? rawRole : null;\n    const definition = getCommandDefinition(command);\n\n    if (!definition) {\n      const errorMsg = generateErrorMessage(\"invalid-command\");\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    if (!role || !definition.availableFor.includes(role)) {\n      const errorMsg = generateErrorMessage(\"forbidden-command\", {\n        command: definition.command,\n      });\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    if (definition.requiresCard && !state.contextCard) {\n      const errorMsg = generateErrorMessage(\"no-card\");\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    if (definition.requiresInput && !(payload ?? \"\").trim()) {\n      const errorMsg = generateErrorMessage(\"missing-command-input\", {\n        command: definition.command,\n        hint: definition.inputPlaceholder ?? \"\",\n      });\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    if (state.remainingQueries <= 0) {\n      const errorMsg = generateErrorMessage(\"rate-limit\");\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    if (state.messages.length >= INTELLIGENCE_LIMITS.MAX_MESSAGES_PER_CONVERSATION) {\n      const errorMsg = generateErrorMessage(\"max-messages\");\n      set((s) => ({ messages: [...s.messages, errorMsg] }));\n      return;\n    }\n\n    // Criar mensagem do vendedor mostrando o comando\n    const userMessage: Message = {\n      id: uid(),\n      role: \"user\",\n      content: payload ? `${command} ${payload}` : command,\n      contentType: \"text\",\n      timestamp: now(),\n      sourceCommand: command,\n    };\n\n    set((s) => ({\n      messages: [...s.messages, userMessage],\n      isTyping: true,\n    }));\n\n    try {\n      const vendor = getVendorContext();\n      const response = await processMessage({\n        text: payload ?? \"\",\n        command,\n        card: state.contextCard,\n        vendor,\n        pipeline: getPipelineContext(),\n        mode: state.menuxIntelligenceMode,\n        tone: state.aiTone,\n      });\n\n      set((s) => ({\n        messages: [...s.messages, response],\n        isTyping: false,\n        remainingQueries: s.remainingQueries - 1,\n        activeConversation: s.activeConversation\n          ? {\n              ...s.activeConversation,\n              messages: [...s.messages, response],\n              messageCount: s.messages.length + 1,\n              updatedAt: now(),\n            }\n          : null,\n      }));\n    } catch {\n      const errorMsg = generateErrorMessage(\"api-error\");\n      set((s) => ({\n        messages: [...s.messages, errorMsg],\n        isTyping: false,\n      }));\n    }\n  },\n\n  setContextCard: (card: CardContext | null) => {\n    set({ contextCard: card });\n  },\n\n  openClientPicker: () => {\n    set({\n      isClientPickerOpen: true,\n      clientPickerSearch: \"\",\n      clientPickerFilters: {},\n    });\n  },\n\n  closeClientPicker: () => {\n    set({ isClientPickerOpen: false });\n  },\n\n  setClientPickerSearch: (search: string) => {\n    set({ clientPickerSearch: search });\n  },\n\n  setClientPickerFilters: (filters: ClientPickerFilters) => {\n    set({ clientPickerFilters: filters });\n  },\n\n  selectClient: (item: ClientPickerItem) => {\n    const cardContext: CardContext = {\n      cardId: item.entityId,\n      cardName: item.companyName,\n      stage: item.stage,\n      stageLabel: item.stageLabel,\n      temperature: item.temperature,\n      contacts: [],\n      tags: item.tags ?? [],\n      overdueActivities: [],\n      timelineNotes: [],\n      registeredObjections: [],\n      entityType: item.entityType,\n    };\n\n    // Gerar mensagem de confirmação\n    const confirmMsg = generateContextLoaded(cardContext);\n\n    set((s) => ({\n      contextCard: cardContext,\n      isClientPickerOpen: false,\n      messages: [...s.messages, confirmMsg],\n    }));\n  },\n\n  dismissSuggestion: (id: string) => {\n    set((s) => ({\n      proactiveSuggestions: s.proactiveSuggestions.map((sug) =>\n        sug.id === id ? { ...sug, dismissed: true } : sug\n      ),\n    }));\n  },\n\n  startNewConversation: () => {\n    const state = get();\n\n    // Salvar conversa atual no histórico (se tiver mensagens)\n    if (state.activeConversation && state.messages.length > 1) {\n      const history = [\n        {\n          ...state.activeConversation,\n          messages: state.messages,\n          messageCount: state.messages.length,\n          updatedAt: now(),\n        },\n        ...state.history,\n      ].slice(0, INTELLIGENCE_LIMITS.MAX_STORED_CONVERSATIONS);\n\n      set({ history });\n    }\n\n    // Gerar nova saudação\n    const vendor = getVendorContext();\n    const greeting = generateGreeting(vendor, null, false);\n\n    set({\n      messages: [greeting],\n      greetingSent: true,\n      activeConversation: createConversation([greeting]),\n      contextCard: null,\n      viewingHistoryConversation: null,\n      isHistoryOpen: false,\n    });\n  },\n\n  loadConversation: (id: string) => {\n    const state = get();\n    const convo = state.history.find((c) => c.id === id);\n    if (convo) {\n      set({\n        viewingHistoryConversation: convo,\n        isHistoryOpen: false,\n      });\n    }\n  },\n\n  exitHistoryView: () => {\n    set({ viewingHistoryConversation: null });\n  },\n\n  toggleHistory: () => {\n    set((s) => ({ isHistoryOpen: !s.isHistoryOpen }));\n  },\n\n  setActiveScreen: (screen: ActiveScreen) => {\n    set({ activeScreen: screen });\n  },\n\n  addProactiveSuggestion: (suggestion) => {\n    const state = get();\n    const todaySuggestions = state.proactiveSuggestions.filter((s) => {\n      const created = new Date(s.createdAt);\n      const today = new Date();\n      return (\n        created.getDate() === today.getDate() &&\n        created.getMonth() === today.getMonth() &&\n        created.getFullYear() === today.getFullYear() &&\n        !s.dismissed\n      );\n    });\n\n    // Limite de 3 sugestões proativas por dia — seção 5.2\n    if (todaySuggestions.length >= INTELLIGENCE_LIMITS.MAX_PROACTIVE_SUGGESTIONS_PER_DAY) {\n      return;\n    }\n\n    set((s) => ({\n      proactiveSuggestions: [\n        ...s.proactiveSuggestions,\n        {\n          ...suggestion,\n          id: uid(),\n          dismissed: false,\n          createdAt: now(),\n        },\n      ],\n    }));\n  },\n\n  markActionExecuted: (messageId: string, actionId: string) => {\n    set((s) => ({\n      messages: s.messages.map((msg) =>\n        msg.id === messageId\n          ? {\n              ...msg,\n              suggestedActions: msg.suggestedActions?.map((action) =>\n                action.id === actionId\n                  ? { ...action, executed: true }\n                  : action\n              ),\n            }\n          : msg\n      ),\n    }));\n  },\n\n  addAssistantMessage: (message) => {\n    const fullMessage: Message = {\n      ...message,\n      id: uid(),\n      timestamp: now(),\n      role: \"assistant\",\n    };\n\n    set((s) => ({\n      messages: [...s.messages, fullMessage],\n    }));\n  },\n\n  decrementRateLimit: () => {\n    set((s) => {\n      const remaining = s.remainingQueries - 1;\n      return {\n        remainingQueries: Math.max(0, remaining),\n        rateLimitResetAt:\n          remaining <= 0 && !s.rateLimitResetAt\n            ? new Date(Date.now() + 60 * 60 * 1000).toISOString()\n            : s.rateLimitResetAt,\n      };\n    });\n  },\n\n  resetRateLimit: () => {\n    set({\n      remainingQueries: INTELLIGENCE_LIMITS.MAX_QUERIES_PER_HOUR,\n      rateLimitResetAt: null,\n    });\n  },\n\n  setMenuxIntelligenceMode: (mode) => set({ menuxIntelligenceMode: mode }),\n  openSettings: () => set({ isSettingsOpen: true }),\n  closeSettings: () => set({ isSettingsOpen: false }),\n  setAiTone: (aiTone) => set({ aiTone }),\n  setProactiveFrequency: (proactiveFrequency) => set({ proactiveFrequency }),\n  setProactiveNotifications: (proactiveNotifications) => set({ proactiveNotifications }),\n}));\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1668, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-media-query.ts"],"sourcesContent":["\nimport * as React from \"react\";\n\nexport function useMediaQuery(query: string) {\n    const [value, setValue] = React.useState(false);\n\n    React.useEffect(() => {\n        function onChange(event: MediaQueryListEvent) {\n            setValue(event.matches);\n        }\n\n        const result = window.matchMedia(query);\n        result.addEventListener(\"change\", onChange);\n        setValue(result.matches);\n\n        return () => result.removeEventListener(\"change\", onChange);\n    }, [query]);\n\n    return value;\n}\n"],"names":[],"mappings":";;;;AACA;;;AAEO,SAAS,cAAc,KAAa;;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,yKAAc,CAAC;IAEzC,0KAAe;mCAAC;YACZ,SAAS,SAAS,KAA0B;gBACxC,SAAS,MAAM,OAAO;YAC1B;YAEA,MAAM,SAAS,OAAO,UAAU,CAAC;YACjC,OAAO,gBAAgB,CAAC,UAAU;YAClC,SAAS,OAAO,OAAO;YAEvB;2CAAO,IAAM,OAAO,mBAAmB,CAAC,UAAU;;QACtD;kCAAG;QAAC;KAAM;IAEV,OAAO;AACX;GAhBgB"}},
    {"offset": {"line": 1703, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/hooks/use-proactive-engine.ts"],"sourcesContent":["\"use client\";\n\n// ============================================================================\n// Hook que executa o motor proativo periodicamente e alimenta o store\n// ============================================================================\n\nimport { useEffect, useRef } from \"react\";\nimport { useOpportunityStore } from \"@/stores/opportunity-store\";\nimport { useActivityStore } from \"@/stores/activity-store\";\nimport { useClientStore } from \"@/stores/client-store\";\nimport { useGoalStore } from \"@/stores/goal-store\";\nimport { usePipelineStore } from \"@/stores/pipeline-store\";\nimport { useAuthStore } from \"@/stores/auth-store\";\nimport { useIntelligenceStore } from \"@/stores/intelligence-store\";\nimport { generateAllSuggestions } from \"@/lib/proactive-engine\";\nimport type { ProactiveEngineInput } from \"@/lib/proactive-engine\";\n\nexport function useProactiveEngine() {\n  const hasRun = useRef(false);\n\n  useEffect(() => {\n    function getIntervalMs(): number {\n      const freq = useIntelligenceStore.getState().proactiveFrequency;\n      return freq * 60 * 1000;\n    }\n\n    function gatherInput(): ProactiveEngineInput | null {\n      const user = useAuthStore.getState().user;\n      if (!user) return null;\n\n      return {\n        opportunities: useOpportunityStore.getState().opportunities,\n        activities: useActivityStore.getState().activities,\n        clients: useClientStore.getState().clients,\n        goals: useGoalStore.getState().goals,\n        pipelines: usePipelineStore.getState().pipelines,\n        userId: user.id,\n        userRole: user.role,\n      };\n    }\n\n    function runEngine() {\n      try {\n        const { proactiveNotifications } = useIntelligenceStore.getState();\n        if (!proactiveNotifications) return;\n\n        const input = gatherInput();\n        if (!input) return;\n\n        const suggestions = generateAllSuggestions(input);\n        const store = useIntelligenceStore.getState();\n        const existing = store.proactiveSuggestions;\n\n        // Dedup: don't add suggestions that match existing type + cardId/cardName\n        for (const suggestion of suggestions) {\n          const isDuplicate = existing.some(\n            (e) =>\n              e.type === suggestion.type &&\n              !e.dismissed &&\n              ((suggestion.cardId && e.cardId === suggestion.cardId) ||\n                (suggestion.cardName && e.cardName === suggestion.cardName) ||\n                (!suggestion.cardId && !suggestion.cardName && e.type === suggestion.type))\n          );\n\n          if (!isDuplicate) {\n            store.addProactiveSuggestion(suggestion);\n          }\n        }\n      } catch (err) {\n        console.error(\"[ProactiveEngine] Erro ao rodar motor:\", err);\n      }\n    }\n\n    // Run immediately on first mount\n    if (!hasRun.current) {\n      // Small delay to let stores hydrate\n      const timeout = setTimeout(() => {\n        runEngine();\n        hasRun.current = true;\n      }, 1500);\n\n      const interval = setInterval(runEngine, getIntervalMs());\n\n      return () => {\n        clearTimeout(timeout);\n        clearInterval(interval);\n      };\n    }\n\n    const interval = setInterval(runEngine, getIntervalMs());\n    return () => clearInterval(interval);\n  }, []);\n}\n"],"names":[],"mappings":";;;;AAEA,+EAA+E;AAC/E,sEAAsE;AACtE,+EAA+E;AAE/E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;;AAdA;;;;;;;;;;AAiBO,SAAS;;IACd,MAAM,SAAS,IAAA,uKAAM,EAAC;IAEtB,IAAA,0KAAS;wCAAC;YACR,SAAS;gBACP,MAAM,OAAO,iKAAoB,CAAC,QAAQ,GAAG,kBAAkB;gBAC/D,OAAO,OAAO,KAAK;YACrB;YAEA,SAAS;gBACP,MAAM,OAAO,iJAAY,CAAC,QAAQ,GAAG,IAAI;gBACzC,IAAI,CAAC,MAAM,OAAO;gBAElB,OAAO;oBACL,eAAe,+JAAmB,CAAC,QAAQ,GAAG,aAAa;oBAC3D,YAAY,yJAAgB,CAAC,QAAQ,GAAG,UAAU;oBAClD,SAAS,qJAAc,CAAC,QAAQ,GAAG,OAAO;oBAC1C,OAAO,iJAAY,CAAC,QAAQ,GAAG,KAAK;oBACpC,WAAW,yJAAgB,CAAC,QAAQ,GAAG,SAAS;oBAChD,QAAQ,KAAK,EAAE;oBACf,UAAU,KAAK,IAAI;gBACrB;YACF;YAEA,SAAS;gBACP,IAAI;oBACF,MAAM,EAAE,sBAAsB,EAAE,GAAG,iKAAoB,CAAC,QAAQ;oBAChE,IAAI,CAAC,wBAAwB;oBAE7B,MAAM,QAAQ;oBACd,IAAI,CAAC,OAAO;oBAEZ,MAAM,cAAc,IAAA,6KAAsB,EAAC;oBAC3C,MAAM,QAAQ,iKAAoB,CAAC,QAAQ;oBAC3C,MAAM,WAAW,MAAM,oBAAoB;oBAE3C,0EAA0E;oBAC1E,KAAK,MAAM,cAAc,YAAa;wBACpC,MAAM,cAAc,SAAS,IAAI;kFAC/B,CAAC,IACC,EAAE,IAAI,KAAK,WAAW,IAAI,IAC1B,CAAC,EAAE,SAAS,IACZ,CAAC,AAAC,WAAW,MAAM,IAAI,EAAE,MAAM,KAAK,WAAW,MAAM,IAClD,WAAW,QAAQ,IAAI,EAAE,QAAQ,KAAK,WAAW,QAAQ,IACzD,CAAC,WAAW,MAAM,IAAI,CAAC,WAAW,QAAQ,IAAI,EAAE,IAAI,KAAK,WAAW,IAAI,AAAC;;wBAGhF,IAAI,CAAC,aAAa;4BAChB,MAAM,sBAAsB,CAAC;wBAC/B;oBACF;gBACF,EAAE,OAAO,KAAK;oBACZ,QAAQ,KAAK,CAAC,0CAA0C;gBAC1D;YACF;YAEA,iCAAiC;YACjC,IAAI,CAAC,OAAO,OAAO,EAAE;gBACnB,oCAAoC;gBACpC,MAAM,UAAU;4DAAW;wBACzB;wBACA,OAAO,OAAO,GAAG;oBACnB;2DAAG;gBAEH,MAAM,WAAW,YAAY,WAAW;gBAExC;oDAAO;wBACL,aAAa;wBACb,cAAc;oBAChB;;YACF;YAEA,MAAM,WAAW,YAAY,WAAW;YACxC;gDAAO,IAAM,cAAc;;QAC7B;uCAAG,EAAE;AACP;GA3EgB"}},
    {"offset": {"line": 1807, "column": 0}, "map": {"version":3,"sources":["file:///Users/fernandocalado/Desktop/menux-flow/src/types/intelligence.ts"],"sourcesContent":["// ============================================================================\n// Menux Intelligence — Types & Interfaces\n// Ref: docs/Menux Intelligence.md (v1.1)\n// ============================================================================\n\nimport type { Activity, Temperature } from \"@/types\";\n\n// ─── Slash Commands ────────────────────────────────────────────────────────\n\nexport type SlashCommand =\n  | \"/briefing\"\n  | \"/objecao\"\n  | \"/mensagem\"\n  | \"/pitch\"\n  | \"/funil\"\n  | \"/analise\"\n  | \"/comparar\"\n  | \"/planos\"\n  | \"/followup\"\n  | \"/ajuda\"\n  | \"/resumo\"\n  | \"/riscos\"\n  | \"/meta\"\n  | \"/coaching\"\n  | \"/agenda\";\n\nexport interface SlashCommandDefinition {\n  command: SlashCommand;\n  label: string;\n  icon: string;\n  description: string;\n  requiresCard: boolean;\n  availableFor: UserRoleIntelligence[];\n  /** Se true, pede input adicional após seleção */\n  requiresInput: boolean;\n  /** Placeholder do input quando o comando é selecionado */\n  inputPlaceholder?: string;\n}\n\n// ─── User / Permission ────────────────────────────────────────────────────\n\nexport type UserRoleIntelligence =\n  | \"master\"\n  | \"admin\"\n  | \"comercial\"\n  | \"cs\";\n\nexport type MenuxIntelligenceMode = \"focus\" | \"audit\" | \"reply\" | \"proposal\";\n\nexport type AiTone = \"formal\" | \"casual\" | \"neutral\";\nexport type ProactiveFrequency = 5 | 15 | 30;\n\n/** Mapa de capacidades por perfil — seção 9.1 do documento */\nexport interface IntelligencePermissions {\n  canAccessIntelligence: boolean;\n  canBriefingAllCards: boolean;\n  canBriefingOwnCards: boolean;\n  canViewAllFunnel: boolean;\n  canViewOwnFunnel: boolean;\n  canGhostwrite: boolean;\n  canUseObjectionsAndPitch: boolean;\n  canQueryMenuxBase: boolean;\n  canViewOthersHistory: boolean;\n  canReceiveProactiveSuggestions: boolean;\n  canSelectAllClientsInPicker: boolean;\n}\n\n// ─── Messages ─────────────────────────────────────────────────────────────\n\nexport type MessageRole = \"user\" | \"assistant\" | \"system\";\n\nexport type MessageContentType =\n  | \"text\"\n  | \"briefing\"\n  | \"objection-response\"\n  | \"ghostwriting\"\n  | \"pitch\"\n  | \"funnel-summary\"\n  | \"card-analysis\"\n  | \"comparison\"\n  | \"plans-info\"\n  | \"followup\"\n  | \"help\"\n  | \"greeting\"\n  | \"context-loaded\"\n  | \"error\"\n  | \"morning-briefing\"\n  | \"risk-report\"\n  | \"goal-progress\"\n  | \"coaching\"\n  | \"agenda\";\n\n/** Bloco copiável dentro de uma mensagem — seção 6.1 */\nexport interface CopyableBlock {\n  id: string;\n  content: string;\n  channel?: \"whatsapp\" | \"email\" | \"call\";\n  /** Limite de caracteres para este canal */\n  charLimit?: number;\n  /** Label do bloco (ex: \"Assunto\", \"Corpo\") */\n  label?: string;\n}\n\n/** Ação sugerida pela IA — seção 6.2 */\nexport type SuggestedActionType =\n  | \"create-activity\"\n  | \"save-note\"\n  | \"schedule-followup\"\n  | \"open-card\";\n\nexport interface SuggestedAction {\n  id: string;\n  type: SuggestedActionType;\n  label: string;\n  icon: string;\n  /** Dados pré-preenchidos para a ação */\n  payload?: Record<string, unknown>;\n  /** Se a ação já foi executada */\n  executed?: boolean;\n}\n\n/** Badge de contexto exibido no topo de uma resposta — seção 4.1.2 */\nexport interface ContextBadge {\n  cardId: string;\n  cardName: string;\n  stage: string;\n  temperature: Temperature;\n}\n\nexport interface Message {\n  id: string;\n  role: MessageRole;\n  content: string;\n  contentType: MessageContentType;\n  timestamp: string;\n  /** Blocos copiáveis dentro da mensagem */\n  copyableBlocks?: CopyableBlock[];\n  /** Ações sugeridas abaixo da mensagem */\n  suggestedActions?: SuggestedAction[];\n  /** Badge de contexto (se baseado em card) */\n  contextBadge?: ContextBadge;\n  /** Slash command que gerou esta mensagem */\n  sourceCommand?: SlashCommand;\n  /** Se a mensagem está sendo gerada (streaming) */\n  isStreaming?: boolean;\n}\n\n// ─── Conversations ────────────────────────────────────────────────────────\n\nexport interface Conversation {\n  id: string;\n  /** Primeira mensagem (truncada) para preview no histórico */\n  preview: string;\n  messages: Message[];\n  /** Card relacionado (se houver) */\n  relatedCardId?: string;\n  relatedCardName?: string;\n  createdAt: string;\n  updatedAt: string;\n  /** Total de mensagens */\n  messageCount: number;\n}\n\n// ─── Proactive Suggestions — seção 5 ─────────────────────────────────────\n\nexport type ProactiveSuggestionType =\n  | \"overdue-activity\"\n  | \"hot-lead-idle\"\n  | \"advanced-stage-opened\"\n  | \"morning-summary\"\n  | \"missing-fields\"\n  | \"sla-approaching\"\n  | \"stale-deal\"\n  | \"follow-up-reminder\"\n  | \"goal-risk\"\n  | \"win-probability-drop\"\n  | \"contract-expiring\"\n  | \"cross-sell-opportunity\"\n  | \"competitive-intelligence\"\n  | \"team-performance\";\n\nexport type ProactiveSuggestionPriority = \"high\" | \"medium\" | \"low\";\n\nexport interface ProactiveSuggestion {\n  id: string;\n  type: ProactiveSuggestionType;\n  priority: ProactiveSuggestionPriority;\n  message: string;\n  /** Card relacionado */\n  cardId?: string;\n  cardName?: string;\n  /** Se já foi dispensada */\n  dismissed: boolean;\n  createdAt: string;\n}\n\n// ─── Client Picker (Modal D11) — seção 2.3.2 ────────────────────────────\n\nexport interface ClientPickerItem {\n  id: string;\n  /** ID da oportunidade ou cliente */\n  entityId: string;\n  entityType: \"opportunity\" | \"client\";\n  companyName: string;\n  segment?: string;\n  stage: string;\n  stageLabel: string;\n  temperature: Temperature;\n  lastContact?: string;\n  value?: number;\n  /** Tags do card */\n  tags?: string[];\n}\n\nexport interface ClientPickerFilters {\n  pipeId?: string;\n  temperature?: Temperature[];\n}\n\n// ─── Context — seção 4.1.1 ───────────────────────────────────────────────\n\nexport interface ContactInfo {\n  name: string;\n  role?: string;\n  isDecisionMaker?: boolean;\n  /** Score de patente (0-100) */\n  patentScore?: number;\n}\n\nexport interface CardContext {\n  cardId: string;\n  cardName: string;\n  cnpj?: string;\n  contacts: ContactInfo[];\n  stage: string;\n  stageLabel: string;\n  temperature: Temperature;\n  leadScore?: number;\n  patentScore?: number;\n  quotedPlan?: string;\n  setupValue?: number;\n  mrrValue?: number;\n  tags: string[];\n  /** Última atividade */\n  lastActivity?: {\n    type: string;\n    date: string;\n    description?: string;\n  };\n  /** Próxima atividade */\n  nextActivity?: {\n    type: string;\n    date: string;\n    description?: string;\n  };\n  /** Atividades vencidas */\n  overdueActivities: Activity[];\n  /** Últimas 10 notas da timeline */\n  timelineNotes: string[];\n  /** Objeções registradas */\n  registeredObjections: string[];\n  /** Tipo da entidade (oportunidade ou cliente) */\n  entityType: \"opportunity\" | \"client\";\n}\n\nexport interface VendorContext {\n  id: string;\n  name: string;\n  role: UserRoleIntelligence | \"leitura\";\n  /** Cards atribuídos ao vendedor */\n  assignedCardCount: number;\n  /** Taxa de conversão */\n  conversionRate?: number;\n}\n\nexport interface PipelineContext {\n  /** Cards por etapa */\n  cardsByStage: Record<string, number>;\n  /** Cards com atividade vencida */\n  overdueCards: number;\n  /** Cards quentes sem atividade */\n  hotIdleCards: number;\n  /** Cards parados > 7 dias */\n  staleCards: number;\n  /** Total MRR potencial */\n  totalMRR: number;\n}\n\n/** Tela ativa do vendedor — define placeholder e comportamento */\nexport type ActiveScreen =\n  | \"dashboard\"\n  | \"pipes\"\n  | \"clients\"\n  | \"activities\"\n  | \"finance\"\n  | \"settings\"\n  | \"other\";\n\nexport interface IntelligenceContext {\n  card: CardContext | null;\n  vendor: VendorContext;\n  pipeline: PipelineContext | null;\n  activeScreen: ActiveScreen;\n}\n\n// ─── Store State ─────────────────────────────────────────────────────────\n\nexport interface IntelligenceState {\n  /** Drawer aberto/fechado */\n  isOpen: boolean;\n  /** Conversa ativa */\n  activeConversation: Conversation | null;\n  /** Mensagens da conversa ativa */\n  messages: Message[];\n  /** IA está digitando */\n  isTyping: boolean;\n  /** Saudação já foi enviada nesta sessão */\n  greetingSent: boolean;\n  /** Card de contexto atualmente carregado */\n  contextCard: CardContext | null;\n  /** Modal de seleção de cliente aberto */\n  isClientPickerOpen: boolean;\n  /** Texto de busca no modal de seleção */\n  clientPickerSearch: string;\n  /** Filtros ativos no modal de seleção */\n  clientPickerFilters: ClientPickerFilters;\n  /** Sugestões proativas pendentes */\n  proactiveSuggestions: ProactiveSuggestion[];\n  /** Histórico de conversas (últimas 50) */\n  history: Conversation[];\n  /** Se o histórico está sendo visualizado */\n  isHistoryOpen: boolean;\n  /** Conversa do histórico sendo visualizada (somente leitura) */\n  viewingHistoryConversation: Conversation | null;\n  /** Tela ativa do vendedor */\n  activeScreen: ActiveScreen;\n  /** Rate limit: consultas restantes nesta hora */\n  remainingQueries: number;\n  /** Timestamp de reset do rate limit */\n  rateLimitResetAt: string | null;\n  /** Modo atual da Menux Intelligence */\n  menuxIntelligenceMode: MenuxIntelligenceMode;\n  /** Tom da IA */\n  aiTone: AiTone;\n  /** Frequência do motor proativo em minutos */\n  proactiveFrequency: ProactiveFrequency;\n  /** Notificações proativas habilitadas */\n  proactiveNotifications: boolean;\n  /** Settings dialog aberto */\n  isSettingsOpen: boolean;\n}\n\nexport interface IntelligenceActions {\n  /** Abre o drawer */\n  open: () => void;\n  /** Fecha o drawer */\n  close: () => void;\n  /** Toggle do drawer */\n  toggle: () => void;\n  /** Envia mensagem e dispara processamento da IA */\n  sendMessage: (text: string) => void;\n  /** Executa slash command */\n  executeSlashCommand: (command: SlashCommand, payload?: string) => void;\n  /** Define card de contexto */\n  setContextCard: (card: CardContext | null) => void;\n  /** Abre modal de seleção de cliente */\n  openClientPicker: () => void;\n  /** Fecha modal de seleção de cliente */\n  closeClientPicker: () => void;\n  /** Atualiza busca do client picker */\n  setClientPickerSearch: (search: string) => void;\n  /** Atualiza filtros do client picker */\n  setClientPickerFilters: (filters: ClientPickerFilters) => void;\n  /** Seleciona cliente no modal → setContextCard + close + mensagem de confirmação */\n  selectClient: (item: ClientPickerItem) => void;\n  /** Dispensa sugestão proativa */\n  dismissSuggestion: (id: string) => void;\n  /** Inicia nova conversa + saudação */\n  startNewConversation: () => void;\n  /** Carrega conversa do histórico (somente leitura) */\n  loadConversation: (id: string) => void;\n  /** Define modo da Menux Intelligence */\n  setMenuxIntelligenceMode: (mode: MenuxIntelligenceMode) => void;\n  /** Volta para conversa ativa (sai do histórico) */\n  exitHistoryView: () => void;\n  /** Abre/fecha painel de histórico */\n  toggleHistory: () => void;\n  /** Define tela ativa */\n  setActiveScreen: (screen: ActiveScreen) => void;\n  /** Adiciona sugestão proativa */\n  addProactiveSuggestion: (suggestion: Omit<ProactiveSuggestion, \"id\" | \"dismissed\" | \"createdAt\">) => void;\n  /** Marca ação sugerida como executada */\n  markActionExecuted: (messageId: string, actionId: string) => void;\n  /** Adiciona mensagem da IA (usado internamente pelo engine) */\n  addAssistantMessage: (message: Omit<Message, \"id\" | \"timestamp\" | \"role\">) => void;\n  /** Decrementa rate limit */\n  decrementRateLimit: () => void;\n  /** Reseta rate limit */\n  resetRateLimit: () => void;\n  /** Abre settings dialog */\n  openSettings: () => void;\n  /** Fecha settings dialog */\n  closeSettings: () => void;\n  /** Atualiza tom da IA */\n  setAiTone: (tone: AiTone) => void;\n  /** Atualiza frequência proativa */\n  setProactiveFrequency: (freq: ProactiveFrequency) => void;\n  /** Atualiza notificações proativas */\n  setProactiveNotifications: (enabled: boolean) => void;\n}\n\nexport type IntelligenceStore = IntelligenceState & IntelligenceActions;\n\n// ─── Constantes ──────────────────────────────────────────────────────────\n\n/** Limites técnicos — seção 10 */\nexport const INTELLIGENCE_LIMITS = {\n  /** Máx mensagens por conversa */\n  MAX_MESSAGES_PER_CONVERSATION: 100,\n  /** Máx conversas armazenadas por vendedor */\n  MAX_STORED_CONVERSATIONS: 50,\n  /** Máx caracteres por mensagem do vendedor */\n  MAX_USER_MESSAGE_LENGTH: 2000,\n  /** Máx caracteres por resposta da IA */\n  MAX_AI_RESPONSE_LENGTH: 6000,\n  /** Sugestões proativas por dia */\n  MAX_PROACTIVE_SUGGESTIONS_PER_DAY: 15,\n  /** Consultas por hora */\n  MAX_QUERIES_PER_HOUR: 60,\n  /** Janela de contexto (mensagens) */\n  CONTEXT_WINDOW_MESSAGES: 20,\n  /** Retenção de histórico em dias */\n  HISTORY_RETENTION_DAYS: 30,\n  /** Limite de caracteres para WhatsApp */\n  WHATSAPP_CHAR_LIMIT: 280,\n  /** Limite de caracteres para email (corpo) */\n  EMAIL_BODY_CHAR_LIMIT: 500,\n} as const;\n\n/** SLA de resposta em ms — seção 10 */\nexport const INTELLIGENCE_SLA = {\n  SIMPLE_RESPONSE_MS: 5000,\n  COMPLEX_RESPONSE_MS: 15000,\n} as const;\n"],"names":[],"mappings":"AAAA,+EAA+E;AAC/E,0CAA0C;AAC1C,yCAAyC;AACzC,+EAA+E;;;;;;;AA6ZxE,MAAM,sBAAsB;IACjC,+BAA+B,GAC/B,+BAA+B;IAC/B,2CAA2C,GAC3C,0BAA0B;IAC1B,4CAA4C,GAC5C,yBAAyB;IACzB,sCAAsC,GACtC,wBAAwB;IACxB,gCAAgC,GAChC,mCAAmC;IACnC,uBAAuB,GACvB,sBAAsB;IACtB,mCAAmC,GACnC,yBAAyB;IACzB,kCAAkC,GAClC,wBAAwB;IACxB,uCAAuC,GACvC,qBAAqB;IACrB,4CAA4C,GAC5C,uBAAuB;AACzB;AAGO,MAAM,mBAAmB;IAC9B,oBAAoB;IACpB,qBAAqB;AACvB"}}]
}